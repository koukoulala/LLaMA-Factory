nohup: ignoring input
[2024-05-27 09:51:01,811] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
05/27/2024 09:51:03 - WARNING - llamafactory.hparams.parser - We recommend enable `upcast_layernorm` in quantized training.
05/27/2024 09:51:03 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: torch.float16
[INFO|tokenization_utils_base.py:2106] 2024-05-27 09:51:03,216 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2106] 2024-05-27 09:51:03,216 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2106] 2024-05-27 09:51:03,216 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2106] 2024-05-27 09:51:03,216 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2106] 2024-05-27 09:51:03,216 >> loading file tokenizer_config.json
05/27/2024 09:51:03 - INFO - llamafactory.data.template - Add pad token: </s>
05/27/2024 09:51:03 - INFO - llamafactory.data.loader - Loading dataset AssetGeneration/train.json...
Converting format of dataset (num_proc=16):   0%|          | 0/500000 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):   1%|          | 5000/500000 [00:00<00:11, 44737.72 examples/s]Converting format of dataset (num_proc=16):  31%|███▏      | 157000/500000 [00:00<00:00, 791974.68 examples/s]Converting format of dataset (num_proc=16):  65%|██████▌   | 327000/500000 [00:00<00:00, 1167597.41 examples/s]Converting format of dataset (num_proc=16):  91%|█████████▏| 456250/500000 [00:00<00:00, 1185070.70 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 500000/500000 [00:02<00:00, 237893.93 examples/s] 
Running tokenizer on dataset (num_proc=16):   0%|          | 0/500000 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   0%|          | 1000/500000 [00:00<04:44, 1753.93 examples/s]Running tokenizer on dataset (num_proc=16):   1%|▏         | 7000/500000 [00:00<00:36, 13351.27 examples/s]Running tokenizer on dataset (num_proc=16):   3%|▎         | 13000/500000 [00:00<00:20, 23329.50 examples/s]Running tokenizer on dataset (num_proc=16):   4%|▎         | 18000/500000 [00:01<00:23, 20832.28 examples/s]Running tokenizer on dataset (num_proc=16):   5%|▍         | 24000/500000 [00:01<00:17, 27484.80 examples/s]Running tokenizer on dataset (num_proc=16):   6%|▌         | 30000/500000 [00:01<00:13, 33614.16 examples/s]Running tokenizer on dataset (num_proc=16):   7%|▋         | 35000/500000 [00:01<00:17, 26797.36 examples/s]Running tokenizer on dataset (num_proc=16):   8%|▊         | 41000/500000 [00:01<00:14, 31779.24 examples/s]Running tokenizer on dataset (num_proc=16):  10%|▉         | 48000/500000 [00:01<00:11, 38729.63 examples/s]Running tokenizer on dataset (num_proc=16):  11%|█         | 53000/500000 [00:02<00:15, 28258.83 examples/s]Running tokenizer on dataset (num_proc=16):  12%|█▏        | 61000/500000 [00:02<00:12, 35971.66 examples/s]Running tokenizer on dataset (num_proc=16):  13%|█▎        | 66000/500000 [00:02<00:15, 28380.88 examples/s]Running tokenizer on dataset (num_proc=16):  14%|█▍        | 71000/500000 [00:02<00:13, 31678.71 examples/s]Running tokenizer on dataset (num_proc=16):  16%|█▌        | 79000/500000 [00:02<00:11, 37482.79 examples/s]Running tokenizer on dataset (num_proc=16):  17%|█▋        | 84000/500000 [00:03<00:13, 30592.78 examples/s]Running tokenizer on dataset (num_proc=16):  18%|█▊        | 89000/500000 [00:03<00:12, 33456.10 examples/s]Running tokenizer on dataset (num_proc=16):  19%|█▉        | 95000/500000 [00:03<00:10, 37961.04 examples/s]Running tokenizer on dataset (num_proc=16):  20%|██        | 100000/500000 [00:03<00:13, 30016.40 examples/s]Running tokenizer on dataset (num_proc=16):  21%|██        | 105000/500000 [00:03<00:11, 33277.27 examples/s]Running tokenizer on dataset (num_proc=16):  22%|██▏       | 111000/500000 [00:03<00:10, 38344.93 examples/s]Running tokenizer on dataset (num_proc=16):  23%|██▎       | 116000/500000 [00:03<00:13, 28986.46 examples/s]Running tokenizer on dataset (num_proc=16):  24%|██▍       | 122000/500000 [00:04<00:10, 34760.77 examples/s]Running tokenizer on dataset (num_proc=16):  26%|██▌       | 128000/500000 [00:04<00:09, 38780.57 examples/s]Running tokenizer on dataset (num_proc=16):  27%|██▋       | 133000/500000 [00:04<00:12, 29244.67 examples/s]Running tokenizer on dataset (num_proc=16):  28%|██▊       | 139000/500000 [00:04<00:10, 34402.39 examples/s]Running tokenizer on dataset (num_proc=16):  29%|██▉       | 145000/500000 [00:04<00:12, 27611.10 examples/s]Running tokenizer on dataset (num_proc=16):  30%|███       | 151000/500000 [00:05<00:10, 32964.09 examples/s]Running tokenizer on dataset (num_proc=16):  32%|███▏      | 158000/500000 [00:05<00:08, 39606.00 examples/s]Running tokenizer on dataset (num_proc=16):  33%|███▎      | 163000/500000 [00:05<00:11, 29810.07 examples/s]Running tokenizer on dataset (num_proc=16):  34%|███▍      | 169000/500000 [00:05<00:09, 34382.91 examples/s]Running tokenizer on dataset (num_proc=16):  35%|███▌      | 175000/500000 [00:05<00:08, 39099.65 examples/s]Running tokenizer on dataset (num_proc=16):  36%|███▌      | 180000/500000 [00:05<00:11, 28534.30 examples/s]Running tokenizer on dataset (num_proc=16):  37%|███▋      | 187000/500000 [00:06<00:08, 34927.68 examples/s]Running tokenizer on dataset (num_proc=16):  39%|███▊      | 193000/500000 [00:06<00:10, 28148.12 examples/s]Running tokenizer on dataset (num_proc=16):  40%|████      | 200000/500000 [00:06<00:08, 34877.09 examples/s]Running tokenizer on dataset (num_proc=16):  41%|████      | 206000/500000 [00:06<00:07, 37734.35 examples/s]Running tokenizer on dataset (num_proc=16):  42%|████▏     | 211000/500000 [00:06<00:09, 29855.78 examples/s]Running tokenizer on dataset (num_proc=16):  43%|████▎     | 217000/500000 [00:06<00:08, 34384.84 examples/s]Running tokenizer on dataset (num_proc=16):  44%|████▍     | 222000/500000 [00:07<00:07, 36877.16 examples/s]Running tokenizer on dataset (num_proc=16):  45%|████▌     | 227000/500000 [00:07<00:09, 29382.40 examples/s]Running tokenizer on dataset (num_proc=16):  47%|████▋     | 233000/500000 [00:07<00:07, 34566.46 examples/s]Running tokenizer on dataset (num_proc=16):  48%|████▊     | 238000/500000 [00:07<00:07, 36979.11 examples/s]Running tokenizer on dataset (num_proc=16):  49%|████▊     | 243000/500000 [00:07<00:08, 29156.98 examples/s]Running tokenizer on dataset (num_proc=16):  50%|████▉     | 249000/500000 [00:07<00:07, 34685.70 examples/s]Running tokenizer on dataset (num_proc=16):  51%|█████     | 254000/500000 [00:08<00:06, 37257.47 examples/s]Running tokenizer on dataset (num_proc=16):  52%|█████▏    | 259000/500000 [00:08<00:08, 28698.42 examples/s]Running tokenizer on dataset (num_proc=16):  53%|█████▎    | 266000/500000 [00:08<00:06, 35516.96 examples/s]Running tokenizer on dataset (num_proc=16):  54%|█████▍    | 271000/500000 [00:08<00:06, 38118.41 examples/s]Running tokenizer on dataset (num_proc=16):  55%|█████▌    | 276000/500000 [00:08<00:07, 29638.72 examples/s]Running tokenizer on dataset (num_proc=16):  56%|█████▋    | 282000/500000 [00:08<00:06, 34730.45 examples/s]Running tokenizer on dataset (num_proc=16):  57%|█████▋    | 287000/500000 [00:09<00:05, 36875.47 examples/s]Running tokenizer on dataset (num_proc=16):  58%|█████▊    | 292000/500000 [00:09<00:07, 28484.95 examples/s]Running tokenizer on dataset (num_proc=16):  60%|██████    | 300000/500000 [00:09<00:05, 35344.23 examples/s]Running tokenizer on dataset (num_proc=16):  61%|██████    | 305000/500000 [00:09<00:07, 27594.31 examples/s]Running tokenizer on dataset (num_proc=16):  63%|██████▎   | 313000/500000 [00:09<00:05, 35963.91 examples/s]Running tokenizer on dataset (num_proc=16):  64%|██████▎   | 318000/500000 [00:09<00:04, 36509.07 examples/s]Running tokenizer on dataset (num_proc=16):  65%|██████▍   | 323000/500000 [00:10<00:06, 29447.32 examples/s]Running tokenizer on dataset (num_proc=16):  66%|██████▌   | 330000/500000 [00:10<00:04, 35586.93 examples/s]Running tokenizer on dataset (num_proc=16):  67%|██████▋   | 335000/500000 [00:10<00:04, 36036.74 examples/s]Running tokenizer on dataset (num_proc=16):  68%|██████▊   | 340000/500000 [00:10<00:05, 29329.64 examples/s]Running tokenizer on dataset (num_proc=16):  69%|██████▉   | 347000/500000 [00:10<00:04, 34802.75 examples/s]Running tokenizer on dataset (num_proc=16):  70%|███████   | 352000/500000 [00:11<00:04, 36339.31 examples/s]Running tokenizer on dataset (num_proc=16):  71%|███████▏  | 357000/500000 [00:11<00:04, 30000.53 examples/s]Running tokenizer on dataset (num_proc=16):  73%|███████▎  | 363000/500000 [00:11<00:04, 34116.99 examples/s]Running tokenizer on dataset (num_proc=16):  74%|███████▎  | 368000/500000 [00:11<00:03, 35614.48 examples/s]Running tokenizer on dataset (num_proc=16):  74%|███████▍  | 372000/500000 [00:11<00:04, 28448.17 examples/s]Running tokenizer on dataset (num_proc=16):  76%|███████▌  | 379000/500000 [00:11<00:03, 34346.21 examples/s]Running tokenizer on dataset (num_proc=16):  77%|███████▋  | 384000/500000 [00:11<00:03, 35901.25 examples/s]Running tokenizer on dataset (num_proc=16):  78%|███████▊  | 388000/500000 [00:12<00:03, 28288.27 examples/s]Running tokenizer on dataset (num_proc=16):  79%|███████▉  | 395000/500000 [00:12<00:03, 34531.41 examples/s]Running tokenizer on dataset (num_proc=16):  80%|████████  | 400000/500000 [00:12<00:02, 35970.71 examples/s]Running tokenizer on dataset (num_proc=16):  81%|████████  | 404000/500000 [00:12<00:03, 28649.66 examples/s]Running tokenizer on dataset (num_proc=16):  82%|████████▏ | 411000/500000 [00:12<00:02, 34858.38 examples/s]Running tokenizer on dataset (num_proc=16):  83%|████████▎ | 415000/500000 [00:12<00:02, 35851.10 examples/s]Running tokenizer on dataset (num_proc=16):  84%|████████▍ | 419000/500000 [00:13<00:02, 27321.27 examples/s]Running tokenizer on dataset (num_proc=16):  85%|████████▌ | 427000/500000 [00:13<00:02, 35824.68 examples/s]Running tokenizer on dataset (num_proc=16):  86%|████████▋ | 432000/500000 [00:13<00:01, 35820.63 examples/s]Running tokenizer on dataset (num_proc=16):  87%|████████▋ | 436000/500000 [00:13<00:02, 28545.80 examples/s]Running tokenizer on dataset (num_proc=16):  89%|████████▊ | 443000/500000 [00:13<00:01, 35793.46 examples/s]Running tokenizer on dataset (num_proc=16):  90%|████████▉ | 448000/500000 [00:13<00:01, 35450.84 examples/s]Running tokenizer on dataset (num_proc=16):  90%|█████████ | 452000/500000 [00:14<00:01, 28222.11 examples/s]Running tokenizer on dataset (num_proc=16):  92%|█████████▏| 459000/500000 [00:14<00:01, 25782.79 examples/s]Running tokenizer on dataset (num_proc=16):  93%|█████████▎| 464000/500000 [00:14<00:01, 28970.23 examples/s]Running tokenizer on dataset (num_proc=16):  95%|█████████▍| 473000/500000 [00:14<00:00, 39777.21 examples/s]Running tokenizer on dataset (num_proc=16):  96%|█████████▌| 478000/500000 [00:15<00:00, 28255.07 examples/s]Running tokenizer on dataset (num_proc=16):  97%|█████████▋| 483000/500000 [00:15<00:00, 31521.30 examples/s]Running tokenizer on dataset (num_proc=16):  98%|█████████▊| 490750/500000 [00:15<00:00, 38590.70 examples/s]Running tokenizer on dataset (num_proc=16):  99%|█████████▉| 495750/500000 [00:15<00:00, 29678.93 examples/s]Running tokenizer on dataset (num_proc=16): 100%|█████████▉| 499750/500000 [00:15<00:00, 29229.24 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 500000/500000 [00:22<00:00, 22075.24 examples/s]
[INFO|configuration_utils.py:731] 2024-05-27 09:51:28,897 >> loading configuration file /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2/config.json
[INFO|configuration_utils.py:796] 2024-05-27 09:51:28,898 >> Model config MistralConfig {
  "_name_or_path": "/data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2",
  "architectures": [
    "MistralForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 32768,
  "model_type": "mistral",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "rms_norm_eps": 1e-05,
  "rope_theta": 1000000.0,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 32000
}

input_ids:
[1, 28705, 733, 16289, 28793, 5919, 8270, 28705, 28750, 1964, 9655, 1081, 297, 8092, 3842, 28725, 2818, 356, 272, 2296, 1871, 28747, 13, 13, 17500, 5140, 28747, 4449, 1508, 2913, 383, 28709, 28723, 28768, 28720, 28748, 28169, 350, 380, 28748, 11178, 12141, 28748, 824, 28730, 1240, 1827, 28748, 28705, 13, 12075, 28747, 519, 383, 28709, 28723, 28768, 28720, 28705, 13, 9633, 28747, 7960, 22563, 1939, 4194, 973, 28705, 13, 15962, 13063, 28747, 1444, 28705, 28740, 28734, 298, 28705, 28750, 28734, 6128, 28723, 28705, 13, 17621, 454, 28747, 560, 4754, 2006, 380, 10616, 23247, 8561, 296, 298, 1038, 574, 616, 680, 8598, 298, 5709, 28723, 28705, 13, 733, 28748, 16289, 28793, 1964, 26856, 22345, 28747, 29506, 29056, 30163, 29535, 29011, 29078, 233, 178, 145, 236, 131, 180, 29250, 29056, 29494, 233, 139, 187, 29193, 29418, 30544, 28752, 13, 3261, 28747, 29506, 28751, 24318, 28747, 30913, 29209, 28993, 29056, 234, 178, 140, 28969, 233, 139, 187, 29193, 29257, 29270, 29572, 28752, 29494, 13, 2]
inputs:
<s>  [INST] Please generate 2 Ad Headline in Japanese language, based on the following information:

FinalUrl: https://suumo.jp/ikkodate/tokyo/sc_minato/ 
Domain: suumo.jp 
Category: Real Estate -- Portals 
CharacterLimit: between 10 to 20 characters. 
Insight: Incorporate dynamic keyword insertion to make your ad more relevant to query. 
 [/INST] Ad:{keyword:【新着物件を毎週更新】戸建情報}
Ad:【{Keyword:港区の新築一戸建てなら}】
</s>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 1964, 26856, 22345, 28747, 29506, 29056, 30163, 29535, 29011, 29078, 233, 178, 145, 236, 131, 180, 29250, 29056, 29494, 233, 139, 187, 29193, 29418, 30544, 28752, 13, 3261, 28747, 29506, 28751, 24318, 28747, 30913, 29209, 28993, 29056, 234, 178, 140, 28969, 233, 139, 187, 29193, 29257, 29270, 29572, 28752, 29494, 13, 2]
labels:
Ad:{keyword:【新着物件を毎週更新】戸建情報}
Ad:【{Keyword:港区の新築一戸建てなら}】
</s>
05/27/2024 09:51:28 - INFO - llamafactory.model.utils.quantization - Quantizing model to 4 bit.
[INFO|modeling_utils.py:3460] 2024-05-27 09:51:28,910 >> loading weights file /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2/model.safetensors.index.json
[INFO|modeling_utils.py:1508] 2024-05-27 09:51:28,911 >> Instantiating MistralForCausalLM model under default dtype torch.float16.
[INFO|configuration_utils.py:962] 2024-05-27 09:51:28,911 >> Generate config GenerationConfig {
  "bos_token_id": 1,
  "eos_token_id": 2
}

Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.40s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.27s/it]
[INFO|modeling_utils.py:4269] 2024-05-27 09:51:33,097 >> All model checkpoint weights were used when initializing MistralForCausalLM.

[INFO|modeling_utils.py:4277] 2024-05-27 09:51:33,097 >> All the weights of MistralForCausalLM were initialized from the model checkpoint at /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2.
If your task is similar to the task the model of the checkpoint was trained on, you can already use MistralForCausalLM for predictions without further training.
[INFO|configuration_utils.py:915] 2024-05-27 09:51:33,099 >> loading configuration file /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2/generation_config.json
[INFO|configuration_utils.py:962] 2024-05-27 09:51:33,099 >> Generate config GenerationConfig {
  "bos_token_id": 1,
  "eos_token_id": 2
}

05/27/2024 09:51:33 - INFO - llamafactory.model.utils.checkpointing - Gradient checkpointing enabled.
05/27/2024 09:51:33 - INFO - llamafactory.model.utils.attention - Using torch SDPA for faster training and inference.
05/27/2024 09:51:33 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
05/27/2024 09:51:33 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
05/27/2024 09:51:33 - INFO - llamafactory.model.adapter - Loaded adapter(s): saves/mistral/qlora_sft_bitsandbytes/checkpoint-1100
05/27/2024 09:51:33 - INFO - llamafactory.model.loader - trainable params: 41943040 || all params: 7283675136 || trainable%: 0.5758
[INFO|trainer.py:641] 2024-05-27 09:51:33,860 >> Using auto half precision backend
[INFO|trainer.py:2078] 2024-05-27 09:51:34,061 >> ***** Running training *****
[INFO|trainer.py:2079] 2024-05-27 09:51:34,062 >>   Num examples = 495,000
[INFO|trainer.py:2080] 2024-05-27 09:51:34,062 >>   Num Epochs = 1
[INFO|trainer.py:2081] 2024-05-27 09:51:34,062 >>   Instantaneous batch size per device = 20
[INFO|trainer.py:2084] 2024-05-27 09:51:34,062 >>   Total train batch size (w. parallel, distributed & accumulation) = 40
[INFO|trainer.py:2085] 2024-05-27 09:51:34,062 >>   Gradient Accumulation steps = 2
[INFO|trainer.py:2086] 2024-05-27 09:51:34,062 >>   Total optimization steps = 12,375
[INFO|trainer.py:2087] 2024-05-27 09:51:34,065 >>   Number of trainable parameters = 41,943,040
  0%|          | 0/12375 [00:00<?, ?it/s]  0%|          | 1/12375 [00:14<48:14:02, 14.03s/it]  0%|          | 2/12375 [00:28<49:52:25, 14.51s/it]  0%|          | 3/12375 [00:46<55:15:47, 16.08s/it]  0%|          | 4/12375 [00:58<48:50:19, 14.21s/it]  0%|          | 5/12375 [01:18<56:28:29, 16.44s/it]  0%|          | 6/12375 [01:38<60:31:30, 17.62s/it]  0%|          | 7/12375 [01:54<58:42:21, 17.09s/it]  0%|          | 8/12375 [02:15<62:53:55, 18.31s/it]  0%|          | 9/12375 [02:28<56:49:57, 16.55s/it]  0%|          | 10/12375 [02:45<57:41:30, 16.80s/it]                                                       0%|          | 10/12375 [02:45<57:41:30, 16.80s/it]  0%|          | 11/12375 [02:59<55:02:52, 16.03s/it]  0%|          | 12/12375 [03:12<51:44:56, 15.07s/it]  0%|          | 13/12375 [03:27<51:33:35, 15.02s/it]  0%|          | 14/12375 [03:42<51:24:25, 14.97s/it]  0%|          | 15/12375 [04:00<54:48:49, 15.97s/it]  0%|          | 16/12375 [04:14<53:00:17, 15.44s/it]  0%|          | 17/12375 [04:26<49:18:37, 14.36s/it]  0%|          | 18/12375 [04:41<50:05:14, 14.59s/it]  0%|          | 19/12375 [04:56<50:09:34, 14.61s/it]  0%|          | 20/12375 [05:11<50:26:25, 14.70s/it]                                                       0%|          | 20/12375 [05:11<50:26:25, 14.70s/it]  0%|          | 21/12375 [05:29<54:16:52, 15.82s/it]  0%|          | 22/12375 [05:45<53:54:25, 15.71s/it]  0%|          | 23/12375 [06:01<54:32:48, 15.90s/it]  0%|          | 24/12375 [06:20<57:16:39, 16.69s/it]  0%|          | 25/12375 [06:38<58:42:49, 17.11s/it]  0%|          | 26/12375 [06:57<61:11:21, 17.84s/it]  0%|          | 27/12375 [07:09<54:31:31, 15.90s/it]  0%|          | 28/12375 [07:29<58:59:43, 17.20s/it]  0%|          | 29/12375 [07:42<54:58:48, 16.03s/it]  0%|          | 30/12375 [07:57<54:04:06, 15.77s/it]                                                       0%|          | 30/12375 [07:57<54:04:06, 15.77s/it]  0%|          | 31/12375 [08:13<54:03:03, 15.76s/it]  0%|          | 32/12375 [08:28<52:51:34, 15.42s/it]  0%|          | 33/12375 [08:48<57:25:58, 16.75s/it]  0%|          | 34/12375 [09:10<63:24:43, 18.50s/it]  0%|          | 35/12375 [09:23<57:42:03, 16.83s/it]  0%|          | 36/12375 [09:35<53:05:18, 15.49s/it]  0%|          | 37/12375 [09:58<59:55:35, 17.49s/it]  0%|          | 38/12375 [10:11<55:30:57, 16.20s/it]  0%|          | 39/12375 [10:27<55:19:18, 16.14s/it]  0%|          | 40/12375 [10:39<51:21:19, 14.99s/it]                                                       0%|          | 40/12375 [10:39<51:21:19, 14.99s/it]  0%|          | 41/12375 [10:56<53:19:34, 15.56s/it]  0%|          | 42/12375 [11:12<54:01:17, 15.77s/it]  0%|          | 43/12375 [11:26<52:19:41, 15.28s/it]  0%|          | 44/12375 [11:39<49:35:32, 14.48s/it]  0%|          | 45/12375 [11:51<46:36:57, 13.61s/it]  0%|          | 46/12375 [12:09<51:59:52, 15.18s/it]  0%|          | 47/12375 [12:25<52:46:25, 15.41s/it]  0%|          | 48/12375 [12:41<52:31:56, 15.34s/it]  0%|          | 49/12375 [12:57<53:24:23, 15.60s/it]  0%|          | 50/12375 [13:13<53:55:02, 15.75s/it]                                                       0%|          | 50/12375 [13:13<53:55:02, 15.75s/it]  0%|          | 51/12375 [13:33<58:32:42, 17.10s/it]  0%|          | 52/12375 [13:48<55:47:01, 16.30s/it]  0%|          | 53/12375 [14:04<55:30:34, 16.22s/it]  0%|          | 54/12375 [14:20<56:02:45, 16.38s/it]  0%|          | 55/12375 [14:39<58:12:18, 17.01s/it]  0%|          | 56/12375 [14:54<56:24:20, 16.48s/it]  0%|          | 57/12375 [15:10<56:02:29, 16.38s/it]  0%|          | 58/12375 [15:22<51:26:20, 15.03s/it]  0%|          | 59/12375 [15:46<60:38:17, 17.72s/it]  0%|          | 60/12375 [16:02<59:03:37, 17.26s/it]                                                       0%|          | 60/12375 [16:02<59:03:37, 17.26s/it]  0%|          | 61/12375 [16:19<58:55:04, 17.22s/it]  1%|          | 62/12375 [16:37<59:12:42, 17.31s/it]  1%|          | 63/12375 [16:50<55:21:21, 16.19s/it]  1%|          | 64/12375 [17:07<55:38:25, 16.27s/it]  1%|          | 65/12375 [17:24<56:22:35, 16.49s/it]  1%|          | 66/12375 [17:37<52:34:24, 15.38s/it]  1%|          | 67/12375 [17:49<49:17:30, 14.42s/it]  1%|          | 68/12375 [18:10<56:01:55, 16.39s/it]  1%|          | 69/12375 [18:27<57:08:40, 16.72s/it]  1%|          | 70/12375 [18:45<58:34:45, 17.14s/it]                                                       1%|          | 70/12375 [18:45<58:34:45, 17.14s/it]  1%|          | 71/12375 [19:03<58:31:31, 17.12s/it]  1%|          | 72/12375 [19:15<53:42:20, 15.71s/it]  1%|          | 73/12375 [19:34<57:07:28, 16.72s/it]  1%|          | 74/12375 [19:49<54:49:51, 16.05s/it]  1%|          | 75/12375 [20:06<56:16:59, 16.47s/it]  1%|          | 76/12375 [20:23<56:56:41, 16.67s/it]  1%|          | 77/12375 [20:44<61:28:05, 17.99s/it]  1%|          | 78/12375 [20:59<58:04:36, 17.00s/it]  1%|          | 79/12375 [21:17<59:10:34, 17.33s/it]  1%|          | 80/12375 [21:32<56:30:35, 16.55s/it]                                                       1%|          | 80/12375 [21:32<56:30:35, 16.55s/it]  1%|          | 81/12375 [21:47<54:44:23, 16.03s/it]  1%|          | 82/12375 [22:04<55:46:32, 16.33s/it]  1%|          | 83/12375 [22:19<54:50:29, 16.06s/it]  1%|          | 84/12375 [22:33<52:32:56, 15.39s/it]  1%|          | 85/12375 [22:48<51:53:40, 15.20s/it]  1%|          | 86/12375 [23:01<49:45:04, 14.57s/it]  1%|          | 87/12375 [23:23<57:15:08, 16.77s/it]  1%|          | 88/12375 [23:38<55:22:26, 16.22s/it]  1%|          | 89/12375 [23:56<58:00:38, 17.00s/it]  1%|          | 90/12375 [24:14<58:33:42, 17.16s/it]                                                       1%|          | 90/12375 [24:14<58:33:42, 17.16s/it]  1%|          | 91/12375 [24:29<56:03:12, 16.43s/it]  1%|          | 92/12375 [24:42<52:57:17, 15.52s/it]  1%|          | 93/12375 [24:59<54:40:19, 16.03s/it]  1%|          | 94/12375 [25:20<59:06:43, 17.33s/it]  1%|          | 95/12375 [25:39<61:15:48, 17.96s/it]  1%|          | 96/12375 [25:54<58:31:19, 17.16s/it]  1%|          | 97/12375 [26:06<53:12:30, 15.60s/it]  1%|          | 98/12375 [26:22<53:02:29, 15.55s/it]  1%|          | 99/12375 [26:37<52:44:04, 15.46s/it]  1%|          | 100/12375 [26:56<56:15:31, 16.50s/it]                                                        1%|          | 100/12375 [26:56<56:15:31, 16.50s/it][INFO|trainer.py:3410] 2024-05-27 10:18:30,463 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-100
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 10:18:30,631 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 10:18:30,632 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-100/special_tokens_map.json
  1%|          | 101/12375 [27:10<53:51:32, 15.80s/it]  1%|          | 102/12375 [27:31<59:12:54, 17.37s/it]  1%|          | 103/12375 [27:46<57:08:55, 16.76s/it]  1%|          | 104/12375 [28:06<59:37:44, 17.49s/it]  1%|          | 105/12375 [28:21<57:41:20, 16.93s/it]  1%|          | 106/12375 [28:38<57:16:10, 16.80s/it]  1%|          | 107/12375 [28:57<59:32:58, 17.47s/it]  1%|          | 108/12375 [29:13<58:17:49, 17.11s/it]  1%|          | 109/12375 [29:25<53:18:12, 15.64s/it]  1%|          | 110/12375 [29:41<53:42:13, 15.76s/it]                                                        1%|          | 110/12375 [29:41<53:42:13, 15.76s/it]  1%|          | 111/12375 [29:54<50:45:46, 14.90s/it]  1%|          | 112/12375 [30:14<55:14:53, 16.22s/it]  1%|          | 113/12375 [30:33<59:04:05, 17.34s/it]  1%|          | 114/12375 [30:54<62:16:17, 18.28s/it]  1%|          | 115/12375 [31:10<59:32:31, 17.48s/it]  1%|          | 116/12375 [31:28<60:15:20, 17.69s/it]  1%|          | 117/12375 [31:45<59:22:50, 17.44s/it]  1%|          | 118/12375 [31:59<56:30:06, 16.60s/it]  1%|          | 119/12375 [32:16<56:11:58, 16.51s/it]  1%|          | 120/12375 [32:29<53:23:56, 15.69s/it]                                                        1%|          | 120/12375 [32:29<53:23:56, 15.69s/it]  1%|          | 121/12375 [32:43<51:45:11, 15.20s/it]  1%|          | 122/12375 [33:00<53:13:27, 15.64s/it]  1%|          | 123/12375 [33:19<56:18:59, 16.55s/it]  1%|          | 124/12375 [33:33<54:14:40, 15.94s/it]  1%|          | 125/12375 [33:50<55:29:53, 16.31s/it]  1%|          | 126/12375 [34:11<59:25:11, 17.46s/it]  1%|          | 127/12375 [34:23<54:10:22, 15.92s/it]  1%|          | 128/12375 [34:35<50:36:42, 14.88s/it]  1%|          | 129/12375 [34:50<50:13:21, 14.76s/it]  1%|          | 130/12375 [35:07<52:35:59, 15.46s/it]                                                        1%|          | 130/12375 [35:07<52:35:59, 15.46s/it]  1%|          | 131/12375 [35:22<52:34:23, 15.46s/it]  1%|          | 132/12375 [35:39<53:31:57, 15.74s/it]  1%|          | 133/12375 [35:55<53:46:59, 15.82s/it]  1%|          | 134/12375 [36:09<52:25:00, 15.42s/it]  1%|          | 135/12375 [36:25<52:24:44, 15.42s/it]  1%|          | 136/12375 [36:43<54:55:32, 16.16s/it]  1%|          | 137/12375 [37:02<58:37:56, 17.25s/it]  1%|          | 138/12375 [37:18<56:50:15, 16.72s/it]  1%|          | 139/12375 [37:35<57:33:55, 16.94s/it]  1%|          | 140/12375 [37:52<57:44:54, 16.99s/it]                                                        1%|          | 140/12375 [37:52<57:44:54, 16.99s/it]  1%|          | 141/12375 [38:07<54:53:54, 16.15s/it]  1%|          | 142/12375 [38:19<51:14:52, 15.08s/it]  1%|          | 143/12375 [38:32<48:59:46, 14.42s/it]  1%|          | 144/12375 [38:48<50:07:25, 14.75s/it]  1%|          | 145/12375 [39:04<51:52:12, 15.27s/it]  1%|          | 146/12375 [39:22<54:15:05, 15.97s/it]  1%|          | 147/12375 [39:34<50:58:27, 15.01s/it]  1%|          | 148/12375 [39:49<50:09:33, 14.77s/it]  1%|          | 149/12375 [40:06<52:20:19, 15.41s/it]  1%|          | 150/12375 [40:22<52:59:04, 15.60s/it]                                                        1%|          | 150/12375 [40:22<52:59:04, 15.60s/it]  1%|          | 151/12375 [40:41<56:31:30, 16.65s/it]  1%|          | 152/12375 [40:55<54:26:03, 16.03s/it]  1%|          | 153/12375 [41:11<53:46:38, 15.84s/it]  1%|          | 154/12375 [41:24<51:05:22, 15.05s/it]  1%|▏         | 155/12375 [41:38<49:54:18, 14.70s/it]  1%|▏         | 156/12375 [41:56<53:38:41, 15.80s/it]  1%|▏         | 157/12375 [42:10<51:56:16, 15.30s/it]  1%|▏         | 158/12375 [42:26<52:17:14, 15.41s/it]  1%|▏         | 159/12375 [42:38<48:59:28, 14.44s/it]  1%|▏         | 160/12375 [42:56<52:14:49, 15.40s/it]                                                        1%|▏         | 160/12375 [42:56<52:14:49, 15.40s/it]  1%|▏         | 161/12375 [43:10<51:16:04, 15.11s/it]  1%|▏         | 162/12375 [43:22<48:26:48, 14.28s/it]  1%|▏         | 163/12375 [43:40<51:38:51, 15.23s/it]  1%|▏         | 164/12375 [43:57<53:32:38, 15.79s/it]  1%|▏         | 165/12375 [44:12<53:08:43, 15.67s/it]  1%|▏         | 166/12375 [44:27<52:05:55, 15.36s/it]  1%|▏         | 167/12375 [44:44<53:53:35, 15.89s/it]  1%|▏         | 168/12375 [45:05<58:24:40, 17.23s/it]  1%|▏         | 169/12375 [45:23<59:46:27, 17.63s/it]  1%|▏         | 170/12375 [45:46<64:52:19, 19.13s/it]                                                        1%|▏         | 170/12375 [45:46<64:52:19, 19.13s/it]  1%|▏         | 171/12375 [46:01<60:30:53, 17.85s/it]  1%|▏         | 172/12375 [46:17<58:48:48, 17.35s/it]  1%|▏         | 173/12375 [46:31<55:18:57, 16.32s/it]  1%|▏         | 174/12375 [46:45<53:37:06, 15.82s/it]  1%|▏         | 175/12375 [47:02<54:24:51, 16.06s/it]  1%|▏         | 176/12375 [47:20<56:55:13, 16.80s/it]  1%|▏         | 177/12375 [47:32<51:43:41, 15.27s/it]  1%|▏         | 178/12375 [47:51<55:05:39, 16.26s/it]  1%|▏         | 179/12375 [48:10<57:54:59, 17.10s/it]  1%|▏         | 180/12375 [48:24<55:22:39, 16.35s/it]                                                        1%|▏         | 180/12375 [48:24<55:22:39, 16.35s/it]  1%|▏         | 181/12375 [48:43<58:03:05, 17.14s/it]  1%|▏         | 182/12375 [49:08<66:03:56, 19.51s/it]  1%|▏         | 183/12375 [49:25<63:25:33, 18.73s/it]  1%|▏         | 184/12375 [49:40<59:19:41, 17.52s/it]  1%|▏         | 185/12375 [49:57<58:18:51, 17.22s/it]  2%|▏         | 186/12375 [50:10<54:04:53, 15.97s/it]  2%|▏         | 187/12375 [50:24<52:02:01, 15.37s/it]  2%|▏         | 188/12375 [50:37<50:24:26, 14.89s/it]  2%|▏         | 189/12375 [50:54<51:45:48, 15.29s/it]  2%|▏         | 190/12375 [51:05<47:32:59, 14.05s/it]                                                        2%|▏         | 190/12375 [51:05<47:32:59, 14.05s/it]  2%|▏         | 191/12375 [51:18<46:34:36, 13.76s/it]  2%|▏         | 192/12375 [51:34<49:19:39, 14.58s/it]  2%|▏         | 193/12375 [51:56<56:07:17, 16.58s/it]  2%|▏         | 194/12375 [52:15<58:53:01, 17.40s/it]  2%|▏         | 195/12375 [52:34<60:38:48, 17.93s/it]  2%|▏         | 196/12375 [52:48<56:53:15, 16.82s/it]  2%|▏         | 197/12375 [53:00<51:18:18, 15.17s/it]  2%|▏         | 198/12375 [53:14<50:02:47, 14.80s/it]  2%|▏         | 199/12375 [53:32<53:54:23, 15.94s/it]  2%|▏         | 200/12375 [53:54<59:38:17, 17.63s/it]                                                        2%|▏         | 200/12375 [53:54<59:38:17, 17.63s/it][INFO|trainer.py:3410] 2024-05-27 10:45:28,272 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-200
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 10:45:28,434 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 10:45:28,434 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-200/special_tokens_map.json
  2%|▏         | 201/12375 [54:06<53:46:11, 15.90s/it]  2%|▏         | 202/12375 [54:20<52:43:36, 15.59s/it]  2%|▏         | 203/12375 [54:40<56:38:26, 16.75s/it]  2%|▏         | 204/12375 [54:52<51:29:48, 15.23s/it]  2%|▏         | 205/12375 [55:10<54:47:26, 16.21s/it]  2%|▏         | 206/12375 [55:27<55:54:04, 16.54s/it]  2%|▏         | 207/12375 [55:39<51:10:51, 15.14s/it]  2%|▏         | 208/12375 [55:52<49:02:43, 14.51s/it]  2%|▏         | 209/12375 [56:09<50:53:42, 15.06s/it]  2%|▏         | 210/12375 [56:23<50:17:54, 14.88s/it]                                                        2%|▏         | 210/12375 [56:23<50:17:54, 14.88s/it]  2%|▏         | 211/12375 [56:37<48:59:02, 14.50s/it]  2%|▏         | 212/12375 [56:58<56:17:34, 16.66s/it]  2%|▏         | 213/12375 [57:14<55:36:03, 16.46s/it]  2%|▏         | 214/12375 [57:30<54:38:34, 16.18s/it]  2%|▏         | 215/12375 [57:48<56:23:40, 16.70s/it]  2%|▏         | 216/12375 [58:04<55:28:25, 16.42s/it]  2%|▏         | 217/12375 [58:21<56:24:00, 16.70s/it]  2%|▏         | 218/12375 [58:35<53:51:52, 15.95s/it]  2%|▏         | 219/12375 [58:52<55:13:47, 16.36s/it]  2%|▏         | 220/12375 [59:07<53:07:09, 15.73s/it]                                                        2%|▏         | 220/12375 [59:07<53:07:09, 15.73s/it]  2%|▏         | 221/12375 [59:24<54:39:04, 16.19s/it]  2%|▏         | 222/12375 [59:39<53:48:46, 15.94s/it]  2%|▏         | 223/12375 [59:57<55:37:21, 16.48s/it]  2%|▏         | 224/12375 [1:00:16<57:53:37, 17.15s/it]  2%|▏         | 225/12375 [1:00:30<54:47:34, 16.23s/it]  2%|▏         | 226/12375 [1:00:46<54:43:26, 16.22s/it]  2%|▏         | 227/12375 [1:01:03<55:27:31, 16.43s/it]  2%|▏         | 228/12375 [1:01:19<55:08:58, 16.34s/it]  2%|▏         | 229/12375 [1:01:35<54:52:15, 16.26s/it]  2%|▏         | 230/12375 [1:01:52<55:47:36, 16.54s/it]                                                          2%|▏         | 230/12375 [1:01:52<55:47:36, 16.54s/it]  2%|▏         | 231/12375 [1:02:07<53:28:41, 15.85s/it]  2%|▏         | 232/12375 [1:02:26<56:56:22, 16.88s/it]  2%|▏         | 233/12375 [1:02:45<58:56:36, 17.48s/it]  2%|▏         | 234/12375 [1:02:59<55:16:41, 16.39s/it]  2%|▏         | 235/12375 [1:03:12<52:33:30, 15.59s/it]  2%|▏         | 236/12375 [1:03:25<49:29:10, 14.68s/it]  2%|▏         | 237/12375 [1:03:41<50:54:29, 15.10s/it]  2%|▏         | 238/12375 [1:03:57<51:40:26, 15.33s/it]  2%|▏         | 239/12375 [1:04:15<54:49:27, 16.26s/it]  2%|▏         | 240/12375 [1:04:33<56:17:49, 16.70s/it]                                                          2%|▏         | 240/12375 [1:04:33<56:17:49, 16.70s/it]  2%|▏         | 241/12375 [1:04:54<60:14:46, 17.87s/it]  2%|▏         | 242/12375 [1:05:09<57:34:59, 17.09s/it]  2%|▏         | 243/12375 [1:05:23<54:41:33, 16.23s/it]  2%|▏         | 244/12375 [1:05:39<54:30:47, 16.18s/it]  2%|▏         | 245/12375 [1:05:53<51:38:51, 15.33s/it]  2%|▏         | 246/12375 [1:06:09<53:11:12, 15.79s/it]  2%|▏         | 247/12375 [1:06:26<53:31:58, 15.89s/it]  2%|▏         | 248/12375 [1:06:41<53:19:56, 15.83s/it]  2%|▏         | 249/12375 [1:06:54<50:32:22, 15.00s/it]  2%|▏         | 250/12375 [1:07:14<55:09:25, 16.38s/it]                                                          2%|▏         | 250/12375 [1:07:14<55:09:25, 16.38s/it]  2%|▏         | 251/12375 [1:07:27<51:29:52, 15.29s/it]  2%|▏         | 252/12375 [1:07:40<49:56:52, 14.83s/it]  2%|▏         | 253/12375 [1:07:55<49:33:15, 14.72s/it]  2%|▏         | 254/12375 [1:08:11<50:57:23, 15.13s/it]  2%|▏         | 255/12375 [1:08:25<50:10:44, 14.90s/it]  2%|▏         | 256/12375 [1:08:42<52:28:39, 15.59s/it]  2%|▏         | 257/12375 [1:08:57<51:44:59, 15.37s/it]  2%|▏         | 258/12375 [1:09:09<47:27:54, 14.10s/it]  2%|▏         | 259/12375 [1:09:27<51:35:04, 15.33s/it]  2%|▏         | 260/12375 [1:09:44<53:27:44, 15.89s/it]                                                          2%|▏         | 260/12375 [1:09:44<53:27:44, 15.89s/it]  2%|▏         | 261/12375 [1:09:58<51:12:28, 15.22s/it]  2%|▏         | 262/12375 [1:10:17<55:38:15, 16.54s/it]  2%|▏         | 263/12375 [1:10:29<50:37:35, 15.05s/it]  2%|▏         | 264/12375 [1:10:40<47:06:19, 14.00s/it]  2%|▏         | 265/12375 [1:10:58<51:20:59, 15.27s/it]  2%|▏         | 266/12375 [1:11:12<49:25:22, 14.69s/it]  2%|▏         | 267/12375 [1:11:28<51:19:10, 15.26s/it]  2%|▏         | 268/12375 [1:11:48<55:14:38, 16.43s/it]  2%|▏         | 269/12375 [1:12:03<54:21:33, 16.16s/it]  2%|▏         | 270/12375 [1:12:18<53:04:21, 15.78s/it]                                                          2%|▏         | 270/12375 [1:12:18<53:04:21, 15.78s/it]  2%|▏         | 271/12375 [1:12:34<52:48:53, 15.71s/it]  2%|▏         | 272/12375 [1:12:51<54:05:56, 16.09s/it]  2%|▏         | 273/12375 [1:13:08<55:10:38, 16.41s/it]  2%|▏         | 274/12375 [1:13:33<63:38:35, 18.93s/it]  2%|▏         | 275/12375 [1:13:48<59:58:48, 17.85s/it]  2%|▏         | 276/12375 [1:14:01<55:18:30, 16.46s/it]  2%|▏         | 277/12375 [1:14:20<57:20:47, 17.06s/it]  2%|▏         | 278/12375 [1:14:41<61:51:51, 18.41s/it]  2%|▏         | 279/12375 [1:14:56<57:51:40, 17.22s/it]  2%|▏         | 280/12375 [1:15:08<53:05:32, 15.80s/it]                                                          2%|▏         | 280/12375 [1:15:08<53:05:32, 15.80s/it]  2%|▏         | 281/12375 [1:15:19<48:23:22, 14.40s/it]  2%|▏         | 282/12375 [1:15:35<49:48:54, 14.83s/it]  2%|▏         | 283/12375 [1:15:49<49:26:43, 14.72s/it]  2%|▏         | 284/12375 [1:16:06<51:34:17, 15.35s/it]  2%|▏         | 285/12375 [1:16:20<49:52:15, 14.85s/it]  2%|▏         | 286/12375 [1:16:33<47:55:37, 14.27s/it]  2%|▏         | 287/12375 [1:16:53<53:58:27, 16.07s/it]  2%|▏         | 288/12375 [1:17:05<49:47:22, 14.83s/it]  2%|▏         | 289/12375 [1:17:24<53:30:09, 15.94s/it]  2%|▏         | 290/12375 [1:17:39<52:55:26, 15.77s/it]                                                          2%|▏         | 290/12375 [1:17:39<52:55:26, 15.77s/it]  2%|▏         | 291/12375 [1:17:57<54:45:39, 16.31s/it]  2%|▏         | 292/12375 [1:18:12<53:41:12, 16.00s/it]  2%|▏         | 293/12375 [1:18:25<51:19:25, 15.29s/it]  2%|▏         | 294/12375 [1:18:38<48:42:08, 14.51s/it]  2%|▏         | 295/12375 [1:18:56<51:56:55, 15.48s/it]  2%|▏         | 296/12375 [1:19:18<58:29:47, 17.43s/it]  2%|▏         | 297/12375 [1:19:33<56:05:28, 16.72s/it]  2%|▏         | 298/12375 [1:19:49<54:59:45, 16.39s/it]  2%|▏         | 299/12375 [1:20:06<55:39:55, 16.59s/it]  2%|▏         | 300/12375 [1:20:17<50:20:40, 15.01s/it]                                                          2%|▏         | 300/12375 [1:20:17<50:20:40, 15.01s/it][INFO|trainer.py:3410] 2024-05-27 11:11:51,535 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-300
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 11:11:51,699 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 11:11:51,699 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-300/special_tokens_map.json
  2%|▏         | 301/12375 [1:20:30<48:45:58, 14.54s/it]  2%|▏         | 302/12375 [1:20:50<54:15:02, 16.18s/it]  2%|▏         | 303/12375 [1:21:12<59:51:36, 17.85s/it]  2%|▏         | 304/12375 [1:21:27<57:03:54, 17.02s/it]  2%|▏         | 305/12375 [1:21:46<58:51:04, 17.55s/it]  2%|▏         | 306/12375 [1:21:59<53:48:58, 16.05s/it]  2%|▏         | 307/12375 [1:22:14<52:59:16, 15.81s/it]  2%|▏         | 308/12375 [1:22:27<49:55:51, 14.90s/it]  2%|▏         | 309/12375 [1:22:45<53:24:19, 15.93s/it]  3%|▎         | 310/12375 [1:23:02<54:08:35, 16.16s/it]                                                          3%|▎         | 310/12375 [1:23:02<54:08:35, 16.16s/it]  3%|▎         | 311/12375 [1:23:20<56:34:17, 16.88s/it]  3%|▎         | 312/12375 [1:23:33<52:37:21, 15.70s/it]  3%|▎         | 313/12375 [1:23:51<54:18:09, 16.21s/it]  3%|▎         | 314/12375 [1:24:08<55:27:57, 16.56s/it]  3%|▎         | 315/12375 [1:24:23<53:46:16, 16.05s/it]  3%|▎         | 316/12375 [1:24:38<52:58:36, 15.82s/it]  3%|▎         | 317/12375 [1:24:58<57:11:53, 17.08s/it]  3%|▎         | 318/12375 [1:25:14<56:31:07, 16.88s/it]  3%|▎         | 319/12375 [1:25:32<57:26:03, 17.15s/it]  3%|▎         | 320/12375 [1:25:48<55:39:47, 16.62s/it]                                                          3%|▎         | 320/12375 [1:25:48<55:39:47, 16.62s/it]  3%|▎         | 321/12375 [1:26:00<51:40:53, 15.44s/it]  3%|▎         | 322/12375 [1:26:16<52:21:16, 15.64s/it]  3%|▎         | 323/12375 [1:26:32<52:44:52, 15.76s/it]  3%|▎         | 324/12375 [1:26:53<57:29:19, 17.17s/it]  3%|▎         | 325/12375 [1:27:10<56:52:59, 16.99s/it]  3%|▎         | 326/12375 [1:27:22<52:44:59, 15.76s/it]  3%|▎         | 327/12375 [1:27:39<53:38:18, 16.03s/it]  3%|▎         | 328/12375 [1:27:54<52:51:55, 15.80s/it]  3%|▎         | 329/12375 [1:28:11<53:38:54, 16.03s/it]  3%|▎         | 330/12375 [1:28:32<58:27:00, 17.47s/it]                                                          3%|▎         | 330/12375 [1:28:32<58:27:00, 17.47s/it]  3%|▎         | 331/12375 [1:28:45<54:09:55, 16.19s/it]  3%|▎         | 332/12375 [1:28:58<50:52:44, 15.21s/it]  3%|▎         | 333/12375 [1:29:12<49:27:51, 14.79s/it]  3%|▎         | 334/12375 [1:29:35<57:41:32, 17.25s/it]  3%|▎         | 335/12375 [1:29:49<54:46:45, 16.38s/it]  3%|▎         | 336/12375 [1:30:05<54:16:15, 16.23s/it]  3%|▎         | 337/12375 [1:30:24<57:24:16, 17.17s/it]  3%|▎         | 338/12375 [1:30:39<54:32:15, 16.31s/it]  3%|▎         | 339/12375 [1:30:53<52:50:50, 15.81s/it]  3%|▎         | 340/12375 [1:31:10<53:27:52, 15.99s/it]                                                          3%|▎         | 340/12375 [1:31:10<53:27:52, 15.99s/it]  3%|▎         | 341/12375 [1:31:30<57:23:46, 17.17s/it]  3%|▎         | 342/12375 [1:31:50<60:35:39, 18.13s/it]  3%|▎         | 343/12375 [1:32:03<55:11:53, 16.52s/it]  3%|▎         | 344/12375 [1:32:21<57:02:29, 17.07s/it]  3%|▎         | 345/12375 [1:32:37<55:43:09, 16.67s/it]  3%|▎         | 346/12375 [1:32:52<54:16:37, 16.24s/it]  3%|▎         | 347/12375 [1:33:08<53:58:20, 16.15s/it]  3%|▎         | 348/12375 [1:33:21<51:22:01, 15.38s/it]  3%|▎         | 349/12375 [1:33:37<51:56:00, 15.55s/it]  3%|▎         | 350/12375 [1:33:56<54:37:47, 16.35s/it]                                                          3%|▎         | 350/12375 [1:33:56<54:37:47, 16.35s/it]  3%|▎         | 351/12375 [1:34:14<56:33:53, 16.94s/it]  3%|▎         | 352/12375 [1:34:30<55:36:29, 16.65s/it]  3%|▎         | 353/12375 [1:34:44<53:13:50, 15.94s/it]  3%|▎         | 354/12375 [1:35:00<53:02:56, 15.89s/it]  3%|▎         | 355/12375 [1:35:17<54:08:07, 16.21s/it]  3%|▎         | 356/12375 [1:35:32<53:12:47, 15.94s/it]  3%|▎         | 357/12375 [1:35:45<50:07:04, 15.01s/it]  3%|▎         | 358/12375 [1:35:59<48:30:07, 14.53s/it]  3%|▎         | 359/12375 [1:36:11<45:58:19, 13.77s/it]  3%|▎         | 360/12375 [1:36:26<47:40:46, 14.29s/it]                                                          3%|▎         | 360/12375 [1:36:26<47:40:46, 14.29s/it]  3%|▎         | 361/12375 [1:36:39<46:04:38, 13.81s/it]  3%|▎         | 362/12375 [1:37:03<56:21:17, 16.89s/it]  3%|▎         | 363/12375 [1:37:17<53:31:03, 16.04s/it]  3%|▎         | 364/12375 [1:37:32<52:10:26, 15.64s/it]  3%|▎         | 365/12375 [1:37:47<52:19:42, 15.69s/it]  3%|▎         | 366/12375 [1:38:04<52:57:42, 15.88s/it]  3%|▎         | 367/12375 [1:38:17<50:09:33, 15.04s/it]  3%|▎         | 368/12375 [1:38:29<47:44:13, 14.31s/it]  3%|▎         | 369/12375 [1:38:47<50:54:46, 15.27s/it]  3%|▎         | 370/12375 [1:39:07<55:40:31, 16.70s/it]                                                          3%|▎         | 370/12375 [1:39:07<55:40:31, 16.70s/it]  3%|▎         | 371/12375 [1:39:27<58:49:26, 17.64s/it]  3%|▎         | 372/12375 [1:39:45<59:21:19, 17.80s/it]  3%|▎         | 373/12375 [1:39:59<55:56:34, 16.78s/it]  3%|▎         | 374/12375 [1:40:14<53:28:58, 16.04s/it]  3%|▎         | 375/12375 [1:40:26<49:46:27, 14.93s/it]  3%|▎         | 376/12375 [1:40:43<52:10:40, 15.65s/it]  3%|▎         | 377/12375 [1:40:58<50:47:19, 15.24s/it]  3%|▎         | 378/12375 [1:41:11<49:09:33, 14.75s/it]  3%|▎         | 379/12375 [1:41:28<51:02:53, 15.32s/it]  3%|▎         | 380/12375 [1:41:45<53:07:10, 15.94s/it]                                                          3%|▎         | 380/12375 [1:41:45<53:07:10, 15.94s/it]  3%|▎         | 381/12375 [1:42:03<54:53:30, 16.48s/it]  3%|▎         | 382/12375 [1:42:23<58:10:59, 17.47s/it]  3%|▎         | 383/12375 [1:42:42<59:31:32, 17.87s/it]  3%|▎         | 384/12375 [1:42:57<57:27:21, 17.25s/it]  3%|▎         | 385/12375 [1:43:15<57:44:11, 17.34s/it]  3%|▎         | 386/12375 [1:43:29<54:14:30, 16.29s/it]  3%|▎         | 387/12375 [1:43:42<51:36:32, 15.50s/it]  3%|▎         | 388/12375 [1:43:56<49:20:30, 14.82s/it]  3%|▎         | 389/12375 [1:44:24<63:05:51, 18.95s/it]  3%|▎         | 390/12375 [1:44:42<61:58:46, 18.62s/it]                                                          3%|▎         | 390/12375 [1:44:42<61:58:46, 18.62s/it]  3%|▎         | 391/12375 [1:44:54<55:18:49, 16.62s/it]  3%|▎         | 392/12375 [1:45:09<54:02:18, 16.23s/it]  3%|▎         | 393/12375 [1:45:27<55:26:03, 16.66s/it]  3%|▎         | 394/12375 [1:45:41<52:20:32, 15.73s/it]  3%|▎         | 395/12375 [1:45:55<51:24:28, 15.45s/it]  3%|▎         | 396/12375 [1:46:12<52:34:03, 15.80s/it]  3%|▎         | 397/12375 [1:46:24<48:31:45, 14.59s/it]  3%|▎         | 398/12375 [1:46:39<48:58:29, 14.72s/it]  3%|▎         | 399/12375 [1:46:53<48:54:17, 14.70s/it]  3%|▎         | 400/12375 [1:47:09<49:54:59, 15.01s/it]                                                          3%|▎         | 400/12375 [1:47:09<49:54:59, 15.01s/it][INFO|trainer.py:3410] 2024-05-27 11:38:43,672 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-400
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 11:38:43,831 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 11:38:43,831 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-400/special_tokens_map.json
  3%|▎         | 401/12375 [1:47:27<52:51:10, 15.89s/it]  3%|▎         | 402/12375 [1:47:43<53:18:13, 16.03s/it]  3%|▎         | 403/12375 [1:47:58<52:06:17, 15.67s/it]  3%|▎         | 404/12375 [1:48:14<51:55:14, 15.61s/it]  3%|▎         | 405/12375 [1:48:29<51:20:27, 15.44s/it]  3%|▎         | 406/12375 [1:48:46<53:33:07, 16.11s/it]  3%|▎         | 407/12375 [1:48:59<50:18:36, 15.13s/it]  3%|▎         | 408/12375 [1:49:11<47:17:07, 14.22s/it]  3%|▎         | 409/12375 [1:49:28<50:06:04, 15.07s/it]  3%|▎         | 410/12375 [1:49:44<51:01:09, 15.35s/it]                                                          3%|▎         | 410/12375 [1:49:44<51:01:09, 15.35s/it]  3%|▎         | 411/12375 [1:50:03<54:30:48, 16.40s/it]  3%|▎         | 412/12375 [1:50:20<55:11:24, 16.61s/it]  3%|▎         | 413/12375 [1:50:33<51:02:42, 15.36s/it]  3%|▎         | 414/12375 [1:50:59<62:10:21, 18.71s/it]  3%|▎         | 415/12375 [1:51:18<62:02:13, 18.67s/it]  3%|▎         | 416/12375 [1:51:30<55:51:04, 16.81s/it]  3%|▎         | 417/12375 [1:51:46<54:28:05, 16.40s/it]  3%|▎         | 418/12375 [1:52:00<51:52:57, 15.62s/it]  3%|▎         | 419/12375 [1:52:17<53:33:16, 16.13s/it]  3%|▎         | 420/12375 [1:52:30<50:00:02, 15.06s/it]                                                          3%|▎         | 420/12375 [1:52:30<50:00:02, 15.06s/it]  3%|▎         | 421/12375 [1:52:42<47:32:30, 14.32s/it]  3%|▎         | 422/12375 [1:53:03<53:36:13, 16.14s/it]  3%|▎         | 423/12375 [1:53:16<50:46:35, 15.29s/it]  3%|▎         | 424/12375 [1:53:32<51:19:36, 15.46s/it]  3%|▎         | 425/12375 [1:53:49<52:59:54, 15.97s/it]  3%|▎         | 426/12375 [1:54:02<50:15:01, 15.14s/it]  3%|▎         | 427/12375 [1:54:18<50:50:19, 15.32s/it]  3%|▎         | 428/12375 [1:54:33<50:30:47, 15.22s/it]  3%|▎         | 429/12375 [1:54:53<55:36:38, 16.76s/it]  3%|▎         | 430/12375 [1:55:05<50:30:30, 15.22s/it]                                                          3%|▎         | 430/12375 [1:55:05<50:30:30, 15.22s/it]  3%|▎         | 431/12375 [1:55:20<50:54:35, 15.34s/it]  3%|▎         | 432/12375 [1:55:37<51:55:09, 15.65s/it]  3%|▎         | 433/12375 [1:55:50<49:27:49, 14.91s/it]  4%|▎         | 434/12375 [1:56:03<47:33:36, 14.34s/it]  4%|▎         | 435/12375 [1:56:16<46:19:58, 13.97s/it]  4%|▎         | 436/12375 [1:56:29<45:00:33, 13.57s/it]  4%|▎         | 437/12375 [1:56:46<49:04:55, 14.80s/it]  4%|▎         | 438/12375 [1:57:04<51:42:32, 15.59s/it]  4%|▎         | 439/12375 [1:57:25<57:29:20, 17.34s/it]  4%|▎         | 440/12375 [1:57:42<56:41:05, 17.10s/it]                                                          4%|▎         | 440/12375 [1:57:42<56:41:05, 17.10s/it]  4%|▎         | 441/12375 [1:58:00<57:50:29, 17.45s/it]  4%|▎         | 442/12375 [1:58:15<55:43:41, 16.81s/it]  4%|▎         | 443/12375 [1:58:27<50:48:38, 15.33s/it]  4%|▎         | 444/12375 [1:58:46<54:22:04, 16.40s/it]  4%|▎         | 445/12375 [1:58:58<50:16:44, 15.17s/it]  4%|▎         | 446/12375 [1:59:13<49:20:03, 14.89s/it]  4%|▎         | 447/12375 [1:59:31<52:37:58, 15.89s/it]  4%|▎         | 448/12375 [1:59:43<49:14:31, 14.86s/it]  4%|▎         | 449/12375 [1:59:56<47:14:21, 14.26s/it]  4%|▎         | 450/12375 [2:00:12<48:31:26, 14.65s/it]                                                          4%|▎         | 450/12375 [2:00:12<48:31:26, 14.65s/it]  4%|▎         | 451/12375 [2:00:34<56:15:13, 16.98s/it]  4%|▎         | 452/12375 [2:00:53<57:57:55, 17.50s/it]  4%|▎         | 453/12375 [2:01:10<57:59:42, 17.51s/it]  4%|▎         | 454/12375 [2:01:24<54:07:41, 16.35s/it]  4%|▎         | 455/12375 [2:01:37<50:41:45, 15.31s/it]  4%|▎         | 456/12375 [2:01:52<50:05:16, 15.13s/it]  4%|▎         | 457/12375 [2:02:06<48:58:31, 14.79s/it]  4%|▎         | 458/12375 [2:02:28<56:18:10, 17.01s/it]  4%|▎         | 459/12375 [2:02:43<54:34:07, 16.49s/it]  4%|▎         | 460/12375 [2:02:55<49:39:10, 15.00s/it]                                                          4%|▎         | 460/12375 [2:02:55<49:39:10, 15.00s/it]  4%|▎         | 461/12375 [2:03:13<52:49:32, 15.96s/it]  4%|▎         | 462/12375 [2:03:28<52:20:42, 15.82s/it]  4%|▎         | 463/12375 [2:03:45<53:05:09, 16.04s/it]  4%|▎         | 464/12375 [2:04:00<51:47:06, 15.65s/it]  4%|▍         | 465/12375 [2:04:15<51:24:34, 15.54s/it]  4%|▍         | 466/12375 [2:04:35<55:48:31, 16.87s/it]  4%|▍         | 467/12375 [2:04:46<50:02:11, 15.13s/it]  4%|▍         | 468/12375 [2:05:01<49:34:55, 14.99s/it]  4%|▍         | 469/12375 [2:05:24<57:52:37, 17.50s/it]  4%|▍         | 470/12375 [2:05:39<55:40:13, 16.83s/it]                                                          4%|▍         | 470/12375 [2:05:39<55:40:13, 16.83s/it]  4%|▍         | 471/12375 [2:05:52<51:15:43, 15.50s/it]  4%|▍         | 472/12375 [2:06:04<48:01:23, 14.52s/it]  4%|▍         | 473/12375 [2:06:29<58:14:54, 17.62s/it]  4%|▍         | 474/12375 [2:06:43<55:15:19, 16.71s/it]  4%|▍         | 475/12375 [2:06:59<54:00:41, 16.34s/it]  4%|▍         | 476/12375 [2:07:14<52:59:31, 16.03s/it]  4%|▍         | 477/12375 [2:07:29<52:09:19, 15.78s/it]  4%|▍         | 478/12375 [2:07:44<51:28:21, 15.58s/it]  4%|▍         | 479/12375 [2:08:02<53:06:06, 16.07s/it]  4%|▍         | 480/12375 [2:08:18<53:31:07, 16.20s/it]                                                          4%|▍         | 480/12375 [2:08:18<53:31:07, 16.20s/it]  4%|▍         | 481/12375 [2:08:32<51:10:27, 15.49s/it]  4%|▍         | 482/12375 [2:08:50<53:12:15, 16.10s/it]  4%|▍         | 483/12375 [2:09:03<50:54:00, 15.41s/it]  4%|▍         | 484/12375 [2:09:18<50:16:51, 15.22s/it]  4%|▍         | 485/12375 [2:09:35<51:34:10, 15.61s/it]  4%|▍         | 486/12375 [2:09:48<49:42:09, 15.05s/it]  4%|▍         | 487/12375 [2:10:00<46:35:18, 14.11s/it]  4%|▍         | 488/12375 [2:10:18<49:48:47, 15.09s/it]  4%|▍         | 489/12375 [2:10:33<50:02:48, 15.16s/it]  4%|▍         | 490/12375 [2:10:49<51:05:29, 15.48s/it]                                                          4%|▍         | 490/12375 [2:10:49<51:05:29, 15.48s/it]  4%|▍         | 491/12375 [2:11:03<49:54:46, 15.12s/it]  4%|▍         | 492/12375 [2:11:20<50:55:59, 15.43s/it]  4%|▍         | 493/12375 [2:11:33<49:03:07, 14.86s/it]  4%|▍         | 494/12375 [2:11:51<51:40:14, 15.66s/it]  4%|▍         | 495/12375 [2:12:06<51:08:01, 15.50s/it]  4%|▍         | 496/12375 [2:12:23<52:36:08, 15.94s/it]  4%|▍         | 497/12375 [2:12:37<50:54:25, 15.43s/it]  4%|▍         | 498/12375 [2:12:53<51:14:57, 15.53s/it]  4%|▍         | 499/12375 [2:13:06<49:01:02, 14.86s/it]  4%|▍         | 500/12375 [2:13:23<50:35:42, 15.34s/it]                                                          4%|▍         | 500/12375 [2:13:23<50:35:42, 15.34s/it][INFO|trainer.py:3719] 2024-05-27 12:04:57,078 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-27 12:04:57,079 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-27 12:04:57,079 >>   Batch size = 32
{'loss': 0.8644, 'grad_norm': 1.5548428297042847, 'learning_rate': 9.999984208386054e-05, 'epoch': 0.0}
{'loss': 0.8827, 'grad_norm': 1.4999521970748901, 'learning_rate': 9.999936193990103e-05, 'epoch': 0.0}
{'loss': 0.8829, 'grad_norm': 1.287071704864502, 'learning_rate': 9.999855955510368e-05, 'epoch': 0.0}
{'loss': 0.9299, 'grad_norm': 1.598858118057251, 'learning_rate': 9.999743493463982e-05, 'epoch': 0.0}
{'loss': 0.8914, 'grad_norm': 1.5174630880355835, 'learning_rate': 9.999598808575748e-05, 'epoch': 0.0}
{'loss': 0.8724, 'grad_norm': 1.5109788179397583, 'learning_rate': 9.999421901778147e-05, 'epoch': 0.0}
{'loss': 0.9153, 'grad_norm': 1.2287039756774902, 'learning_rate': 9.999212774211323e-05, 'epoch': 0.01}
{'loss': 0.8733, 'grad_norm': 1.7373244762420654, 'learning_rate': 9.998971427223086e-05, 'epoch': 0.01}
{'loss': 0.8855, 'grad_norm': 1.6196322441101074, 'learning_rate': 9.998697862368891e-05, 'epoch': 0.01}
{'loss': 0.8802, 'grad_norm': 1.89452064037323, 'learning_rate': 9.998392081411834e-05, 'epoch': 0.01}
{'loss': 0.9009, 'grad_norm': 2.112687826156616, 'learning_rate': 9.998054086322645e-05, 'epoch': 0.01}
{'loss': 0.8975, 'grad_norm': 1.641889214515686, 'learning_rate': 9.997683879279667e-05, 'epoch': 0.01}
{'loss': 0.8582, 'grad_norm': 1.656977653503418, 'learning_rate': 9.997281462668848e-05, 'epoch': 0.01}
{'loss': 0.8611, 'grad_norm': 1.4286702871322632, 'learning_rate': 9.996846839083723e-05, 'epoch': 0.01}
{'loss': 0.8885, 'grad_norm': 1.3697656393051147, 'learning_rate': 9.996380011325394e-05, 'epoch': 0.01}
{'loss': 0.9262, 'grad_norm': 1.5888527631759644, 'learning_rate': 9.995880982402522e-05, 'epoch': 0.01}
{'loss': 0.8924, 'grad_norm': 1.693198561668396, 'learning_rate': 9.995349755531295e-05, 'epoch': 0.01}
{'loss': 0.8952, 'grad_norm': 1.682163119316101, 'learning_rate': 9.994786334135419e-05, 'epoch': 0.01}
{'loss': 0.8571, 'grad_norm': 1.781592607498169, 'learning_rate': 9.994190721846086e-05, 'epoch': 0.02}
{'loss': 0.8604, 'grad_norm': 2.006300449371338, 'learning_rate': 9.99356292250196e-05, 'epoch': 0.02}
{'loss': 0.8915, 'grad_norm': 1.538354516029358, 'learning_rate': 9.992902940149143e-05, 'epoch': 0.02}
{'loss': 0.8831, 'grad_norm': 1.7336252927780151, 'learning_rate': 9.992210779041153e-05, 'epoch': 0.02}
{'loss': 0.8762, 'grad_norm': 1.6732864379882812, 'learning_rate': 9.9914864436389e-05, 'epoch': 0.02}
{'loss': 0.895, 'grad_norm': 1.4894921779632568, 'learning_rate': 9.990729938610653e-05, 'epoch': 0.02}
{'loss': 0.8678, 'grad_norm': 1.3785393238067627, 'learning_rate': 9.989941268832007e-05, 'epoch': 0.02}
{'loss': 0.867, 'grad_norm': 1.5335875749588013, 'learning_rate': 9.989120439385865e-05, 'epoch': 0.02}
{'loss': 0.8558, 'grad_norm': 1.7688003778457642, 'learning_rate': 9.988267455562383e-05, 'epoch': 0.02}
{'loss': 0.8521, 'grad_norm': 1.8564332723617554, 'learning_rate': 9.987382322858962e-05, 'epoch': 0.02}
{'loss': 0.8538, 'grad_norm': 1.6349986791610718, 'learning_rate': 9.986465046980189e-05, 'epoch': 0.02}
{'loss': 0.8611, 'grad_norm': 1.7314486503601074, 'learning_rate': 9.985515633837817e-05, 'epoch': 0.02}
{'loss': 0.8868, 'grad_norm': 1.614279866218567, 'learning_rate': 9.984534089550714e-05, 'epoch': 0.03}
{'loss': 0.8401, 'grad_norm': 1.5806547403335571, 'learning_rate': 9.983520420444836e-05, 'epoch': 0.03}
{'loss': 0.8925, 'grad_norm': 1.4561362266540527, 'learning_rate': 9.98247463305318e-05, 'epoch': 0.03}
{'loss': 0.8507, 'grad_norm': 1.5758209228515625, 'learning_rate': 9.981396734115737e-05, 'epoch': 0.03}
{'loss': 0.8616, 'grad_norm': 1.7561503648757935, 'learning_rate': 9.980286730579458e-05, 'epoch': 0.03}
{'loss': 0.8786, 'grad_norm': 1.6334303617477417, 'learning_rate': 9.979144629598204e-05, 'epoch': 0.03}
{'loss': 0.8554, 'grad_norm': 1.5531096458435059, 'learning_rate': 9.978089301478988e-05, 'epoch': 0.03}
{'loss': 0.9064, 'grad_norm': 1.7172876596450806, 'learning_rate': 9.976886235802015e-05, 'epoch': 0.03}
{'loss': 0.8186, 'grad_norm': 1.5505778789520264, 'learning_rate': 9.975651094595912e-05, 'epoch': 0.03}
{'loss': 0.8764, 'grad_norm': 1.874599575996399, 'learning_rate': 9.974383885821039e-05, 'epoch': 0.03}
{'loss': 0.8803, 'grad_norm': 1.7355329990386963, 'learning_rate': 9.97308461764443e-05, 'epoch': 0.03}
{'loss': 0.869, 'grad_norm': 1.496819257736206, 'learning_rate': 9.971753298439736e-05, 'epoch': 0.03}
{'loss': 0.8702, 'grad_norm': 1.7600196599960327, 'learning_rate': 9.970389936787174e-05, 'epoch': 0.03}
{'loss': 0.8305, 'grad_norm': 1.7045025825500488, 'learning_rate': 9.968994541473473e-05, 'epoch': 0.04}
{'loss': 0.8667, 'grad_norm': 1.7996801137924194, 'learning_rate': 9.967567121491817e-05, 'epoch': 0.04}
{'loss': 0.8725, 'grad_norm': 1.9335850477218628, 'learning_rate': 9.966107686041779e-05, 'epoch': 0.04}
{'loss': 0.8837, 'grad_norm': 1.6599631309509277, 'learning_rate': 9.964616244529277e-05, 'epoch': 0.04}
{'loss': 0.8475, 'grad_norm': 1.7778098583221436, 'learning_rate': 9.963092806566499e-05, 'epoch': 0.04}
{'loss': 0.859, 'grad_norm': 1.543164849281311, 'learning_rate': 9.961537381971851e-05, 'epoch': 0.04}
{'loss': 0.8739, 'grad_norm': 1.6246498823165894, 'learning_rate': 9.959949980769883e-05, 'epoch': 0.04}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:51,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:09,  2.01s/it][A
  3%|▎         | 4/157 [00:09<06:44,  2.65s/it][A
  3%|▎         | 5/157 [00:14<08:26,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:45,  3.48s/it][A
  4%|▍         | 7/157 [00:21<08:40,  3.47s/it][A
  5%|▌         | 8/157 [00:25<09:15,  3.73s/it][A
  6%|▌         | 9/157 [00:28<08:18,  3.37s/it][A
  6%|▋         | 10/157 [00:31<08:19,  3.39s/it][A
  7%|▋         | 11/157 [00:33<07:29,  3.08s/it][A
  8%|▊         | 12/157 [00:36<07:10,  2.97s/it][A
  8%|▊         | 13/157 [00:39<07:06,  2.96s/it][A
  9%|▉         | 14/157 [00:43<07:31,  3.16s/it][A
 10%|▉         | 15/157 [00:46<07:49,  3.31s/it][A
 10%|█         | 16/157 [00:50<08:18,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:45,  3.32s/it][A
 11%|█▏        | 18/157 [00:56<07:12,  3.11s/it][A
 12%|█▏        | 19/157 [01:00<07:52,  3.42s/it][A
 13%|█▎        | 20/157 [01:04<07:52,  3.45s/it][A
 13%|█▎        | 21/157 [01:07<07:47,  3.44s/it][A
 14%|█▍        | 22/157 [01:10<07:25,  3.30s/it][A
 15%|█▍        | 23/157 [01:13<07:11,  3.22s/it][A
 15%|█▌        | 24/157 [01:17<07:33,  3.41s/it][A
 16%|█▌        | 25/157 [01:20<07:30,  3.41s/it][A
 17%|█▋        | 26/157 [01:24<07:27,  3.41s/it][A
 17%|█▋        | 27/157 [01:29<08:32,  3.94s/it][A
 18%|█▊        | 28/157 [01:33<08:27,  3.94s/it][A
 18%|█▊        | 29/157 [01:36<07:43,  3.62s/it][A
 19%|█▉        | 30/157 [01:39<07:11,  3.40s/it][A
 20%|█▉        | 31/157 [01:42<07:19,  3.49s/it][A
 20%|██        | 32/157 [01:46<07:18,  3.51s/it][A
 21%|██        | 33/157 [01:50<07:39,  3.70s/it][A
 22%|██▏       | 34/157 [01:54<07:47,  3.80s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.72s/it][A
 23%|██▎       | 36/157 [02:02<08:00,  3.97s/it][A
 24%|██▎       | 37/157 [02:06<07:47,  3.89s/it][A
 24%|██▍       | 38/157 [02:09<07:33,  3.81s/it][A
 25%|██▍       | 39/157 [02:13<07:14,  3.68s/it][A
 25%|██▌       | 40/157 [02:16<06:36,  3.39s/it][A
 26%|██▌       | 41/157 [02:19<06:50,  3.54s/it][A
 27%|██▋       | 42/157 [02:25<07:45,  4.05s/it][A
 27%|██▋       | 43/157 [02:27<06:56,  3.65s/it][A
 28%|██▊       | 44/157 [02:31<07:00,  3.72s/it][A
 29%|██▊       | 45/157 [02:34<06:36,  3.54s/it][A
 29%|██▉       | 46/157 [02:37<06:07,  3.31s/it][A
 30%|██▉       | 47/157 [02:40<05:59,  3.27s/it][A
 31%|███       | 48/157 [02:47<07:55,  4.36s/it][A
 31%|███       | 49/157 [02:50<06:57,  3.87s/it][A
 32%|███▏      | 50/157 [02:53<06:29,  3.64s/it][A
 32%|███▏      | 51/157 [02:57<06:32,  3.70s/it][A
 33%|███▎      | 52/157 [03:01<06:36,  3.77s/it][A
 34%|███▍      | 53/157 [03:05<07:00,  4.04s/it][A
 34%|███▍      | 54/157 [03:09<06:36,  3.85s/it][A
 35%|███▌      | 55/157 [03:13<06:48,  4.01s/it][A
 36%|███▌      | 56/157 [03:17<06:50,  4.07s/it][A
 36%|███▋      | 57/157 [03:22<06:46,  4.07s/it][A
 37%|███▋      | 58/157 [03:25<06:26,  3.90s/it][A
 38%|███▊      | 59/157 [03:30<06:48,  4.17s/it][A
 38%|███▊      | 60/157 [03:34<06:40,  4.13s/it][A
 39%|███▉      | 61/157 [03:37<06:19,  3.96s/it][A
 39%|███▉      | 62/157 [03:42<06:37,  4.18s/it][A
 40%|████      | 63/157 [03:46<06:11,  3.95s/it][A
 41%|████      | 64/157 [03:50<06:19,  4.08s/it][A
 41%|████▏     | 65/157 [03:55<06:31,  4.25s/it][A
 42%|████▏     | 66/157 [03:57<05:40,  3.74s/it][A
 43%|████▎     | 67/157 [04:02<06:10,  4.12s/it][A
 43%|████▎     | 68/157 [04:05<05:25,  3.66s/it][A
 44%|████▍     | 69/157 [04:08<05:01,  3.42s/it][A
 45%|████▍     | 70/157 [04:12<05:22,  3.70s/it][A
 45%|████▌     | 71/157 [04:15<05:09,  3.60s/it][A
 46%|████▌     | 72/157 [04:18<04:47,  3.39s/it][A
 46%|████▋     | 73/157 [04:21<04:21,  3.11s/it][A
 47%|████▋     | 74/157 [04:25<04:41,  3.39s/it][A
 48%|████▊     | 75/157 [04:29<04:54,  3.59s/it][A
 48%|████▊     | 76/157 [04:33<05:02,  3.74s/it][A
 49%|████▉     | 77/157 [04:36<04:55,  3.70s/it][A
 50%|████▉     | 78/157 [04:39<04:30,  3.42s/it][A
 50%|█████     | 79/157 [04:44<04:58,  3.82s/it][A
 51%|█████     | 80/157 [04:47<04:29,  3.49s/it][A
 52%|█████▏    | 81/157 [04:49<04:04,  3.22s/it][A
 52%|█████▏    | 82/157 [04:52<04:00,  3.20s/it][A
 53%|█████▎    | 83/157 [04:56<04:15,  3.45s/it][A
 54%|█████▎    | 84/157 [05:01<04:27,  3.66s/it][A
 54%|█████▍    | 85/157 [05:05<04:30,  3.75s/it][A
 55%|█████▍    | 86/157 [05:09<04:44,  4.01s/it][A
 55%|█████▌    | 87/157 [05:13<04:34,  3.93s/it][A
 56%|█████▌    | 88/157 [05:17<04:23,  3.82s/it][A
 57%|█████▋    | 89/157 [05:20<04:09,  3.67s/it][A
 57%|█████▋    | 90/157 [05:24<04:13,  3.78s/it][A
 58%|█████▊    | 91/157 [05:27<04:06,  3.73s/it][A
 59%|█████▊    | 92/157 [05:30<03:47,  3.50s/it][A
 59%|█████▉    | 93/157 [05:36<04:15,  3.98s/it][A
 60%|█████▉    | 94/157 [05:39<03:54,  3.72s/it][A
 61%|██████    | 95/157 [05:42<03:44,  3.61s/it][A
 61%|██████    | 96/157 [05:45<03:32,  3.48s/it][A
 62%|██████▏   | 97/157 [05:48<03:23,  3.38s/it][A
 62%|██████▏   | 98/157 [05:51<03:02,  3.10s/it][A
 63%|██████▎   | 99/157 [05:55<03:16,  3.39s/it][A
 64%|██████▎   | 100/157 [05:58<03:06,  3.28s/it][A
 64%|██████▍   | 101/157 [06:01<02:55,  3.13s/it][A
 65%|██████▍   | 102/157 [06:04<02:49,  3.07s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.90s/it][A
 66%|██████▌   | 104/157 [06:10<02:55,  3.31s/it][A
 67%|██████▋   | 105/157 [06:14<03:03,  3.54s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.86s/it][A
 68%|██████▊   | 107/157 [06:23<03:20,  4.02s/it][A
 69%|██████▉   | 108/157 [06:27<03:14,  3.97s/it][A
 69%|██████▉   | 109/157 [06:31<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:35<03:01,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.47s/it][A
 72%|███████▏  | 113/157 [06:44<02:29,  3.40s/it][A
 73%|███████▎  | 114/157 [06:48<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:57<02:51,  4.18s/it][A
 75%|███████▍  | 117/157 [07:00<02:31,  3.79s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.50s/it][A
 76%|███████▌  | 119/157 [07:07<02:14,  3.54s/it][A
 76%|███████▋  | 120/157 [07:09<02:01,  3.29s/it][A
 77%|███████▋  | 121/157 [07:12<01:54,  3.19s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.33s/it][A
 78%|███████▊  | 123/157 [07:20<01:57,  3.46s/it][A
 79%|███████▉  | 124/157 [07:23<01:55,  3.49s/it][A
 80%|███████▉  | 125/157 [07:26<01:45,  3.29s/it][A
 80%|████████  | 126/157 [07:30<01:47,  3.46s/it][A
 81%|████████  | 127/157 [07:33<01:37,  3.25s/it][A
 82%|████████▏ | 128/157 [07:36<01:29,  3.09s/it][A
 82%|████████▏ | 129/157 [07:38<01:22,  2.94s/it][A
 83%|████████▎ | 130/157 [07:42<01:27,  3.23s/it][A
 83%|████████▎ | 131/157 [07:45<01:25,  3.29s/it][A
 84%|████████▍ | 132/157 [07:50<01:29,  3.59s/it][A
 85%|████████▍ | 133/157 [07:53<01:21,  3.40s/it][A
 85%|████████▌ | 134/157 [07:56<01:17,  3.38s/it][A
 86%|████████▌ | 135/157 [08:00<01:16,  3.49s/it][A
 87%|████████▋ | 136/157 [08:03<01:09,  3.31s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.58s/it][A
 88%|████████▊ | 138/157 [08:10<01:05,  3.44s/it][A
 89%|████████▊ | 139/157 [08:14<01:05,  3.63s/it][A
 89%|████████▉ | 140/157 [08:18<01:00,  3.57s/it][A
 90%|████████▉ | 141/157 [08:21<00:55,  3.44s/it][A
 90%|█████████ | 142/157 [08:25<00:54,  3.63s/it][A
 91%|█████████ | 143/157 [08:29<00:55,  3.96s/it][A
 92%|█████████▏| 144/157 [08:33<00:49,  3.84s/it][A
 92%|█████████▏| 145/157 [08:37<00:48,  4.00s/it][A
 93%|█████████▎| 146/157 [08:41<00:43,  3.91s/it][A
 94%|█████████▎| 147/157 [08:46<00:42,  4.26s/it][A
 94%|█████████▍| 148/157 [08:49<00:35,  3.91s/it][A
 95%|█████████▍| 149/157 [08:53<00:31,  3.95s/it][A
 96%|█████████▌| 150/157 [08:56<00:25,  3.70s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.63s/it][A
 97%|█████████▋| 152/157 [09:03<00:17,  3.47s/it][A
 97%|█████████▋| 153/157 [09:05<00:12,  3.18s/it][A
 98%|█████████▊| 154/157 [09:09<00:09,  3.28s/it][A
 99%|█████████▊| 155/157 [09:11<00:06,  3.01s/it][A
 99%|█████████▉| 156/157 [09:15<00:03,  3.32s/it][A
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A                                                        
                                                 [A  4%|▍         | 500/12375 [2:22:42<50:35:42, 15.34s/it]
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-27 12:14:16,950 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-500
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 12:14:17,114 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 12:14:17,114 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-500/special_tokens_map.json
  4%|▍         | 501/12375 [2:22:55<602:21:45, 182.63s/it]  4%|▍         | 502/12375 [2:23:10<436:06:39, 132.23s/it]  4%|▍         | 503/12375 [2:23:31<326:18:44, 98.95s/it]   4%|▍         | 504/12375 [2:23:49<246:15:34, 74.68s/it]  4%|▍         | 505/12375 [2:24:07<189:18:29, 57.41s/it]  4%|▍         | 506/12375 [2:24:24<149:32:44, 45.36s/it]  4%|▍         | 507/12375 [2:24:41<121:36:16, 36.89s/it]  4%|▍         | 508/12375 [2:24:57<101:15:16, 30.72s/it]  4%|▍         | 509/12375 [2:25:15<88:37:00, 26.89s/it]   4%|▍         | 510/12375 [2:25:32<78:31:22, 23.82s/it]                                                          4%|▍         | 510/12375 [2:25:32<78:31:22, 23.82s/it]  4%|▍         | 511/12375 [2:25:44<67:07:55, 20.37s/it]  4%|▍         | 512/12375 [2:26:02<64:09:06, 19.47s/it]  4%|▍         | 513/12375 [2:26:20<63:16:03, 19.20s/it]  4%|▍         | 514/12375 [2:26:35<59:07:03, 17.94s/it]  4%|▍         | 515/12375 [2:26:51<56:52:22, 17.26s/it]  4%|▍         | 516/12375 [2:27:05<54:13:03, 16.46s/it]  4%|▍         | 517/12375 [2:27:22<54:00:23, 16.40s/it]  4%|▍         | 518/12375 [2:27:37<53:05:45, 16.12s/it]  4%|▍         | 519/12375 [2:27:56<56:04:08, 17.02s/it]  4%|▍         | 520/12375 [2:28:12<54:58:37, 16.69s/it]                                                          4%|▍         | 520/12375 [2:28:12<54:58:37, 16.69s/it]  4%|▍         | 521/12375 [2:28:30<55:45:38, 16.93s/it]  4%|▍         | 522/12375 [2:28:48<57:28:08, 17.45s/it]  4%|▍         | 523/12375 [2:29:06<57:57:02, 17.60s/it]  4%|▍         | 524/12375 [2:29:21<54:40:34, 16.61s/it]  4%|▍         | 525/12375 [2:29:35<52:29:55, 15.95s/it]  4%|▍         | 526/12375 [2:29:52<53:42:14, 16.32s/it]  4%|▍         | 527/12375 [2:30:10<54:43:45, 16.63s/it]  4%|▍         | 528/12375 [2:30:25<53:22:40, 16.22s/it]  4%|▍         | 529/12375 [2:30:43<55:28:51, 16.86s/it]  4%|▍         | 530/12375 [2:30:58<53:27:04, 16.25s/it]                                                          4%|▍         | 530/12375 [2:30:58<53:27:04, 16.25s/it]  4%|▍         | 531/12375 [2:31:16<55:14:51, 16.79s/it]  4%|▍         | 532/12375 [2:31:32<54:18:30, 16.51s/it]  4%|▍         | 533/12375 [2:31:51<57:08:24, 17.37s/it]  4%|▍         | 534/12375 [2:32:05<53:51:48, 16.38s/it]  4%|▍         | 535/12375 [2:32:23<55:20:37, 16.83s/it]  4%|▍         | 536/12375 [2:32:38<53:23:28, 16.24s/it]  4%|▍         | 537/12375 [2:32:55<53:42:21, 16.33s/it]  4%|▍         | 538/12375 [2:33:09<51:45:45, 15.74s/it]  4%|▍         | 539/12375 [2:33:31<58:14:57, 17.72s/it]  4%|▍         | 540/12375 [2:33:47<55:47:41, 16.97s/it]                                                          4%|▍         | 540/12375 [2:33:47<55:47:41, 16.97s/it]  4%|▍         | 541/12375 [2:34:08<60:40:05, 18.46s/it]  4%|▍         | 542/12375 [2:34:26<60:12:22, 18.32s/it]  4%|▍         | 543/12375 [2:34:42<57:53:27, 17.61s/it]  4%|▍         | 544/12375 [2:34:59<56:35:27, 17.22s/it]  4%|▍         | 545/12375 [2:35:11<52:11:52, 15.88s/it]  4%|▍         | 546/12375 [2:35:33<58:05:07, 17.68s/it]  4%|▍         | 547/12375 [2:35:50<57:07:42, 17.39s/it]  4%|▍         | 548/12375 [2:36:07<56:56:07, 17.33s/it]  4%|▍         | 549/12375 [2:36:26<58:02:48, 17.67s/it]  4%|▍         | 550/12375 [2:36:41<55:32:46, 16.91s/it]                                                          4%|▍         | 550/12375 [2:36:41<55:32:46, 16.91s/it]  4%|▍         | 551/12375 [2:36:59<56:16:37, 17.13s/it]  4%|▍         | 552/12375 [2:37:11<52:08:58, 15.88s/it]  4%|▍         | 553/12375 [2:37:25<50:11:03, 15.28s/it]  4%|▍         | 554/12375 [2:37:40<49:50:53, 15.18s/it]  4%|▍         | 555/12375 [2:37:53<47:43:32, 14.54s/it]  4%|▍         | 556/12375 [2:38:08<47:35:40, 14.50s/it]  5%|▍         | 557/12375 [2:38:22<47:19:41, 14.42s/it]  5%|▍         | 558/12375 [2:38:35<46:18:55, 14.11s/it]  5%|▍         | 559/12375 [2:38:51<47:38:36, 14.52s/it]  5%|▍         | 560/12375 [2:39:05<47:43:51, 14.54s/it]                                                          5%|▍         | 560/12375 [2:39:05<47:43:51, 14.54s/it]  5%|▍         | 561/12375 [2:39:23<50:22:45, 15.35s/it]  5%|▍         | 562/12375 [2:39:36<48:03:42, 14.65s/it]  5%|▍         | 563/12375 [2:39:59<56:46:19, 17.30s/it]  5%|▍         | 564/12375 [2:40:11<50:57:56, 15.53s/it]  5%|▍         | 565/12375 [2:40:27<51:27:12, 15.68s/it]  5%|▍         | 566/12375 [2:40:41<49:45:41, 15.17s/it]  5%|▍         | 567/12375 [2:40:54<47:39:16, 14.53s/it]  5%|▍         | 568/12375 [2:41:09<48:23:40, 14.76s/it]  5%|▍         | 569/12375 [2:41:27<52:10:44, 15.91s/it]  5%|▍         | 570/12375 [2:41:45<53:27:28, 16.30s/it]                                                          5%|▍         | 570/12375 [2:41:45<53:27:28, 16.30s/it]  5%|▍         | 571/12375 [2:42:07<59:23:48, 18.11s/it]  5%|▍         | 572/12375 [2:42:22<56:20:29, 17.18s/it]  5%|▍         | 573/12375 [2:42:38<55:00:55, 16.78s/it]  5%|▍         | 574/12375 [2:42:52<51:59:00, 15.86s/it]  5%|▍         | 575/12375 [2:43:09<53:00:24, 16.17s/it]  5%|▍         | 576/12375 [2:43:24<52:30:36, 16.02s/it]  5%|▍         | 577/12375 [2:43:42<54:02:57, 16.49s/it]  5%|▍         | 578/12375 [2:43:59<54:39:10, 16.68s/it]  5%|▍         | 579/12375 [2:44:14<53:25:56, 16.31s/it]  5%|▍         | 580/12375 [2:44:33<56:09:06, 17.14s/it]                                                          5%|▍         | 580/12375 [2:44:33<56:09:06, 17.14s/it]  5%|▍         | 581/12375 [2:44:49<55:03:05, 16.80s/it]  5%|▍         | 582/12375 [2:45:03<51:22:45, 15.68s/it]  5%|▍         | 583/12375 [2:45:18<51:00:57, 15.57s/it]  5%|▍         | 584/12375 [2:45:32<49:43:52, 15.18s/it]  5%|▍         | 585/12375 [2:45:47<49:28:10, 15.11s/it]  5%|▍         | 586/12375 [2:46:01<48:13:10, 14.72s/it]  5%|▍         | 587/12375 [2:46:16<48:56:39, 14.95s/it]  5%|▍         | 588/12375 [2:46:34<51:19:52, 15.68s/it]  5%|▍         | 589/12375 [2:46:53<55:14:51, 16.88s/it]  5%|▍         | 590/12375 [2:47:07<52:07:45, 15.92s/it]                                                          5%|▍         | 590/12375 [2:47:07<52:07:45, 15.92s/it]  5%|▍         | 591/12375 [2:47:23<52:07:59, 15.93s/it]  5%|▍         | 592/12375 [2:47:40<52:46:10, 16.12s/it]  5%|▍         | 593/12375 [2:47:57<53:34:24, 16.37s/it]  5%|▍         | 594/12375 [2:48:11<51:13:11, 15.65s/it]  5%|▍         | 595/12375 [2:48:22<47:30:10, 14.52s/it]  5%|▍         | 596/12375 [2:48:41<51:38:54, 15.79s/it]  5%|▍         | 597/12375 [2:48:59<53:16:21, 16.28s/it]  5%|▍         | 598/12375 [2:49:14<52:30:23, 16.05s/it]  5%|▍         | 599/12375 [2:49:32<54:25:27, 16.64s/it]  5%|▍         | 600/12375 [2:49:53<58:23:23, 17.85s/it]                                                          5%|▍         | 600/12375 [2:49:53<58:23:23, 17.85s/it][INFO|trainer.py:3410] 2024-05-27 12:41:27,345 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-600
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 12:41:27,506 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 12:41:27,506 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-600/special_tokens_map.json
  5%|▍         | 601/12375 [2:50:09<56:39:22, 17.32s/it]  5%|▍         | 602/12375 [2:50:22<52:47:02, 16.14s/it]  5%|▍         | 603/12375 [2:50:41<55:25:48, 16.95s/it]  5%|▍         | 604/12375 [2:50:59<56:16:43, 17.21s/it]  5%|▍         | 605/12375 [2:51:17<56:52:43, 17.40s/it]  5%|▍         | 606/12375 [2:51:32<54:29:29, 16.67s/it]  5%|▍         | 607/12375 [2:51:48<53:41:33, 16.43s/it]  5%|▍         | 608/12375 [2:52:05<54:17:09, 16.61s/it]  5%|▍         | 609/12375 [2:52:17<49:49:07, 15.24s/it]  5%|▍         | 610/12375 [2:52:35<53:04:56, 16.24s/it]                                                          5%|▍         | 610/12375 [2:52:35<53:04:56, 16.24s/it]  5%|▍         | 611/12375 [2:52:51<52:21:41, 16.02s/it]  5%|▍         | 612/12375 [2:53:06<51:47:27, 15.85s/it]  5%|▍         | 613/12375 [2:53:24<53:38:46, 16.42s/it]  5%|▍         | 614/12375 [2:53:39<52:01:31, 15.92s/it]  5%|▍         | 615/12375 [2:53:50<47:58:07, 14.68s/it]  5%|▍         | 616/12375 [2:54:05<48:10:25, 14.75s/it]  5%|▍         | 617/12375 [2:54:17<45:14:38, 13.85s/it]  5%|▍         | 618/12375 [2:54:34<47:49:38, 14.64s/it]  5%|▌         | 619/12375 [2:54:46<45:43:52, 14.00s/it]  5%|▌         | 620/12375 [2:54:58<43:43:23, 13.39s/it]                                                          5%|▌         | 620/12375 [2:54:58<43:43:23, 13.39s/it]  5%|▌         | 621/12375 [2:55:17<48:46:00, 14.94s/it]  5%|▌         | 622/12375 [2:55:32<49:31:38, 15.17s/it]  5%|▌         | 623/12375 [2:55:44<46:18:36, 14.19s/it]  5%|▌         | 624/12375 [2:55:59<46:24:54, 14.22s/it]  5%|▌         | 625/12375 [2:56:11<44:43:56, 13.71s/it]  5%|▌         | 626/12375 [2:56:29<48:56:34, 15.00s/it]  5%|▌         | 627/12375 [2:56:42<47:23:43, 14.52s/it]  5%|▌         | 628/12375 [2:56:57<47:15:34, 14.48s/it]  5%|▌         | 629/12375 [2:57:09<45:10:20, 13.84s/it]  5%|▌         | 630/12375 [2:57:24<46:20:10, 14.20s/it]                                                          5%|▌         | 630/12375 [2:57:24<46:20:10, 14.20s/it]  5%|▌         | 631/12375 [2:57:44<51:31:51, 15.80s/it]  5%|▌         | 632/12375 [2:57:54<46:30:26, 14.26s/it]  5%|▌         | 633/12375 [2:58:11<48:33:41, 14.89s/it]  5%|▌         | 634/12375 [2:58:31<53:44:34, 16.48s/it]  5%|▌         | 635/12375 [2:58:48<54:09:30, 16.61s/it]  5%|▌         | 636/12375 [2:58:59<49:09:24, 15.07s/it]  5%|▌         | 637/12375 [2:59:11<46:12:52, 14.17s/it]  5%|▌         | 638/12375 [2:59:33<53:49:42, 16.51s/it]  5%|▌         | 639/12375 [2:59:49<52:43:36, 16.17s/it]  5%|▌         | 640/12375 [3:00:06<53:56:05, 16.55s/it]                                                          5%|▌         | 640/12375 [3:00:06<53:56:05, 16.55s/it]  5%|▌         | 641/12375 [3:00:21<52:34:11, 16.13s/it]  5%|▌         | 642/12375 [3:00:40<55:09:35, 16.92s/it]  5%|▌         | 643/12375 [3:00:54<52:20:37, 16.06s/it]  5%|▌         | 644/12375 [3:01:13<55:14:29, 16.95s/it]  5%|▌         | 645/12375 [3:01:31<55:53:29, 17.15s/it]  5%|▌         | 646/12375 [3:01:47<54:24:28, 16.70s/it]  5%|▌         | 647/12375 [3:02:03<53:46:12, 16.51s/it]  5%|▌         | 648/12375 [3:02:18<52:36:42, 16.15s/it]  5%|▌         | 649/12375 [3:02:32<50:53:47, 15.63s/it]  5%|▌         | 650/12375 [3:02:50<52:55:40, 16.25s/it]                                                          5%|▌         | 650/12375 [3:02:50<52:55:40, 16.25s/it]  5%|▌         | 651/12375 [3:03:02<48:35:10, 14.92s/it]  5%|▌         | 652/12375 [3:03:20<51:18:51, 15.76s/it]  5%|▌         | 653/12375 [3:03:36<51:57:43, 15.96s/it]  5%|▌         | 654/12375 [3:03:51<50:39:21, 15.56s/it]  5%|▌         | 655/12375 [3:04:02<46:55:05, 14.41s/it]  5%|▌         | 656/12375 [3:04:19<49:22:58, 15.17s/it]  5%|▌         | 657/12375 [3:04:36<50:37:41, 15.55s/it]  5%|▌         | 658/12375 [3:04:52<51:17:46, 15.76s/it]  5%|▌         | 659/12375 [3:05:05<49:01:37, 15.06s/it]  5%|▌         | 660/12375 [3:05:20<48:27:08, 14.89s/it]                                                          5%|▌         | 660/12375 [3:05:20<48:27:08, 14.89s/it]  5%|▌         | 661/12375 [3:05:35<48:16:54, 14.84s/it]  5%|▌         | 662/12375 [3:05:53<51:47:53, 15.92s/it]  5%|▌         | 663/12375 [3:06:08<50:53:44, 15.64s/it]  5%|▌         | 664/12375 [3:06:22<49:18:02, 15.16s/it]  5%|▌         | 665/12375 [3:06:40<52:03:58, 16.01s/it]  5%|▌         | 666/12375 [3:07:02<57:58:13, 17.82s/it]  5%|▌         | 667/12375 [3:07:14<52:24:53, 16.12s/it]  5%|▌         | 668/12375 [3:07:32<53:44:41, 16.53s/it]  5%|▌         | 669/12375 [3:07:46<51:49:18, 15.94s/it]  5%|▌         | 670/12375 [3:07:58<48:03:03, 14.78s/it]                                                          5%|▌         | 670/12375 [3:07:58<48:03:03, 14.78s/it]  5%|▌         | 671/12375 [3:08:17<52:09:16, 16.04s/it]  5%|▌         | 672/12375 [3:08:38<56:49:49, 17.48s/it]  5%|▌         | 673/12375 [3:08:53<54:31:41, 16.78s/it]  5%|▌         | 674/12375 [3:09:11<54:56:18, 16.90s/it]  5%|▌         | 675/12375 [3:09:23<50:29:00, 15.53s/it]  5%|▌         | 676/12375 [3:09:46<58:19:58, 17.95s/it]  5%|▌         | 677/12375 [3:10:04<57:45:55, 17.78s/it]  5%|▌         | 678/12375 [3:10:23<59:10:43, 18.21s/it]  5%|▌         | 679/12375 [3:10:43<61:04:11, 18.80s/it]  5%|▌         | 680/12375 [3:10:56<54:57:44, 16.92s/it]                                                          5%|▌         | 680/12375 [3:10:56<54:57:44, 16.92s/it]  6%|▌         | 681/12375 [3:11:14<55:59:16, 17.24s/it]  6%|▌         | 682/12375 [3:11:26<51:05:33, 15.73s/it]  6%|▌         | 683/12375 [3:11:41<50:29:06, 15.54s/it]  6%|▌         | 684/12375 [3:11:56<50:07:36, 15.44s/it]  6%|▌         | 685/12375 [3:12:11<49:06:43, 15.12s/it]  6%|▌         | 686/12375 [3:12:29<52:20:28, 16.12s/it]  6%|▌         | 687/12375 [3:12:47<53:41:45, 16.54s/it]  6%|▌         | 688/12375 [3:13:04<54:04:28, 16.66s/it]  6%|▌         | 689/12375 [3:13:22<55:32:39, 17.11s/it]  6%|▌         | 690/12375 [3:13:38<55:10:00, 17.00s/it]                                                          6%|▌         | 690/12375 [3:13:38<55:10:00, 17.00s/it]  6%|▌         | 691/12375 [3:13:51<50:46:52, 15.65s/it]  6%|▌         | 692/12375 [3:14:04<47:58:22, 14.78s/it]  6%|▌         | 693/12375 [3:14:21<50:31:23, 15.57s/it]  6%|▌         | 694/12375 [3:14:37<50:43:27, 15.63s/it]  6%|▌         | 695/12375 [3:14:51<49:20:45, 15.21s/it]  6%|▌         | 696/12375 [3:15:04<47:26:42, 14.62s/it]  6%|▌         | 697/12375 [3:15:17<45:34:48, 14.05s/it]  6%|▌         | 698/12375 [3:15:33<47:34:03, 14.67s/it]  6%|▌         | 699/12375 [3:15:48<47:43:28, 14.71s/it]  6%|▌         | 700/12375 [3:16:08<52:52:04, 16.30s/it]                                                          6%|▌         | 700/12375 [3:16:08<52:52:04, 16.30s/it][INFO|trainer.py:3410] 2024-05-27 13:07:42,587 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-700
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 13:07:42,745 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 13:07:42,745 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-700/special_tokens_map.json
  6%|▌         | 701/12375 [3:16:27<55:13:02, 17.03s/it]  6%|▌         | 702/12375 [3:16:41<52:44:23, 16.27s/it]  6%|▌         | 703/12375 [3:16:55<50:21:45, 15.53s/it]  6%|▌         | 704/12375 [3:17:16<55:23:51, 17.09s/it]  6%|▌         | 705/12375 [3:17:34<56:43:42, 17.50s/it]  6%|▌         | 706/12375 [3:17:49<54:26:18, 16.79s/it]  6%|▌         | 707/12375 [3:18:03<51:21:16, 15.84s/it]  6%|▌         | 708/12375 [3:18:17<49:49:21, 15.37s/it]  6%|▌         | 709/12375 [3:18:30<46:50:28, 14.45s/it]  6%|▌         | 710/12375 [3:18:45<47:29:19, 14.66s/it]                                                          6%|▌         | 710/12375 [3:18:45<47:29:19, 14.66s/it]  6%|▌         | 711/12375 [3:18:59<47:29:44, 14.66s/it]  6%|▌         | 712/12375 [3:19:17<50:33:54, 15.61s/it]  6%|▌         | 713/12375 [3:19:35<52:46:30, 16.29s/it]  6%|▌         | 714/12375 [3:19:50<51:37:14, 15.94s/it]  6%|▌         | 715/12375 [3:20:04<49:39:25, 15.33s/it]  6%|▌         | 716/12375 [3:20:22<51:54:52, 16.03s/it]  6%|▌         | 717/12375 [3:20:37<50:51:37, 15.71s/it]  6%|▌         | 718/12375 [3:20:57<55:26:42, 17.12s/it]  6%|▌         | 719/12375 [3:21:09<50:13:51, 15.51s/it]  6%|▌         | 720/12375 [3:21:30<55:19:33, 17.09s/it]                                                          6%|▌         | 720/12375 [3:21:30<55:19:33, 17.09s/it]  6%|▌         | 721/12375 [3:21:46<54:30:12, 16.84s/it]  6%|▌         | 722/12375 [3:22:02<53:28:17, 16.52s/it]  6%|▌         | 723/12375 [3:22:21<56:07:05, 17.34s/it]  6%|▌         | 724/12375 [3:22:37<54:46:25, 16.92s/it]  6%|▌         | 725/12375 [3:22:52<53:13:15, 16.45s/it]  6%|▌         | 726/12375 [3:23:11<55:04:19, 17.02s/it]  6%|▌         | 727/12375 [3:23:25<52:21:15, 16.18s/it]  6%|▌         | 728/12375 [3:23:41<52:18:15, 16.17s/it]  6%|▌         | 729/12375 [3:24:00<55:21:15, 17.11s/it]  6%|▌         | 730/12375 [3:24:15<52:48:50, 16.33s/it]                                                          6%|▌         | 730/12375 [3:24:15<52:48:50, 16.33s/it]  6%|▌         | 731/12375 [3:24:27<48:49:13, 15.09s/it]  6%|▌         | 732/12375 [3:24:50<56:35:06, 17.50s/it]  6%|▌         | 733/12375 [3:25:05<54:31:34, 16.86s/it]  6%|▌         | 734/12375 [3:25:21<52:55:13, 16.37s/it]  6%|▌         | 735/12375 [3:25:34<49:55:13, 15.44s/it]  6%|▌         | 736/12375 [3:25:52<52:42:59, 16.31s/it]  6%|▌         | 737/12375 [3:26:12<56:16:18, 17.41s/it]  6%|▌         | 738/12375 [3:26:27<53:31:41, 16.56s/it]  6%|▌         | 739/12375 [3:26:47<57:24:33, 17.76s/it]  6%|▌         | 740/12375 [3:27:10<62:13:12, 19.25s/it]                                                          6%|▌         | 740/12375 [3:27:10<62:13:12, 19.25s/it]  6%|▌         | 741/12375 [3:27:27<60:10:02, 18.62s/it]  6%|▌         | 742/12375 [3:27:49<63:14:03, 19.57s/it]  6%|▌         | 743/12375 [3:28:06<60:44:42, 18.80s/it]  6%|▌         | 744/12375 [3:28:23<58:58:02, 18.25s/it]  6%|▌         | 745/12375 [3:28:38<55:34:23, 17.20s/it]  6%|▌         | 746/12375 [3:28:51<52:04:02, 16.12s/it]  6%|▌         | 747/12375 [3:29:12<56:29:11, 17.49s/it]  6%|▌         | 748/12375 [3:29:26<53:15:57, 16.49s/it]  6%|▌         | 749/12375 [3:29:42<52:24:14, 16.23s/it]  6%|▌         | 750/12375 [3:29:57<51:03:57, 15.81s/it]                                                          6%|▌         | 750/12375 [3:29:57<51:03:57, 15.81s/it]  6%|▌         | 751/12375 [3:30:11<49:49:35, 15.43s/it]  6%|▌         | 752/12375 [3:30:23<46:12:27, 14.31s/it]  6%|▌         | 753/12375 [3:30:40<48:25:09, 15.00s/it]  6%|▌         | 754/12375 [3:30:54<47:30:16, 14.72s/it]  6%|▌         | 755/12375 [3:31:12<50:52:05, 15.76s/it]  6%|▌         | 756/12375 [3:31:23<46:30:04, 14.41s/it]  6%|▌         | 757/12375 [3:31:40<48:59:13, 15.18s/it]  6%|▌         | 758/12375 [3:32:02<55:53:12, 17.32s/it]  6%|▌         | 759/12375 [3:32:18<53:56:04, 16.72s/it]  6%|▌         | 760/12375 [3:32:30<49:32:35, 15.36s/it]                                                          6%|▌         | 760/12375 [3:32:30<49:32:35, 15.36s/it]  6%|▌         | 761/12375 [3:32:50<54:01:33, 16.75s/it]  6%|▌         | 762/12375 [3:33:06<53:33:42, 16.60s/it]  6%|▌         | 763/12375 [3:33:22<52:58:03, 16.42s/it]  6%|▌         | 764/12375 [3:33:34<48:21:17, 14.99s/it]  6%|▌         | 765/12375 [3:33:49<48:52:43, 15.16s/it]  6%|▌         | 766/12375 [3:34:03<47:36:36, 14.76s/it]  6%|▌         | 767/12375 [3:34:28<56:54:59, 17.65s/it]  6%|▌         | 768/12375 [3:34:44<55:57:26, 17.36s/it]  6%|▌         | 769/12375 [3:35:01<55:17:33, 17.15s/it]  6%|▌         | 770/12375 [3:35:16<53:05:48, 16.47s/it]                                                          6%|▌         | 770/12375 [3:35:16<53:05:48, 16.47s/it]  6%|▌         | 771/12375 [3:35:30<51:14:31, 15.90s/it]  6%|▌         | 772/12375 [3:35:43<47:46:14, 14.82s/it]  6%|▌         | 773/12375 [3:36:01<50:46:34, 15.76s/it]  6%|▋         | 774/12375 [3:36:16<50:34:02, 15.69s/it]  6%|▋         | 775/12375 [3:36:29<47:25:02, 14.72s/it]  6%|▋         | 776/12375 [3:36:42<46:26:34, 14.41s/it]  6%|▋         | 777/12375 [3:37:00<49:51:25, 15.48s/it]  6%|▋         | 778/12375 [3:37:15<48:54:59, 15.18s/it]  6%|▋         | 779/12375 [3:37:27<46:06:46, 14.32s/it]  6%|▋         | 780/12375 [3:37:46<50:59:19, 15.83s/it]                                                          6%|▋         | 780/12375 [3:37:46<50:59:19, 15.83s/it]  6%|▋         | 781/12375 [3:38:03<51:56:44, 16.13s/it]  6%|▋         | 782/12375 [3:38:22<54:26:53, 16.91s/it]  6%|▋         | 783/12375 [3:38:38<53:41:52, 16.68s/it]  6%|▋         | 784/12375 [3:38:58<56:24:13, 17.52s/it]  6%|▋         | 785/12375 [3:39:09<50:57:23, 15.83s/it]  6%|▋         | 786/12375 [3:39:28<53:25:03, 16.59s/it]  6%|▋         | 787/12375 [3:39:42<51:23:07, 15.96s/it]  6%|▋         | 788/12375 [3:39:55<48:43:11, 15.14s/it]  6%|▋         | 789/12375 [3:40:13<51:14:34, 15.92s/it]  6%|▋         | 790/12375 [3:40:28<49:49:54, 15.49s/it]                                                          6%|▋         | 790/12375 [3:40:28<49:49:54, 15.49s/it]  6%|▋         | 791/12375 [3:40:44<50:48:58, 15.79s/it]  6%|▋         | 792/12375 [3:41:03<53:14:14, 16.55s/it]  6%|▋         | 793/12375 [3:41:14<48:31:33, 15.08s/it]  6%|▋         | 794/12375 [3:41:27<46:21:58, 14.41s/it]  6%|▋         | 795/12375 [3:41:42<46:56:13, 14.59s/it]  6%|▋         | 796/12375 [3:41:58<48:11:53, 14.99s/it]  6%|▋         | 797/12375 [3:42:17<52:08:49, 16.21s/it]  6%|▋         | 798/12375 [3:42:30<49:05:20, 15.26s/it]  6%|▋         | 799/12375 [3:42:44<47:23:48, 14.74s/it]  6%|▋         | 800/12375 [3:42:58<46:54:04, 14.59s/it]                                                          6%|▋         | 800/12375 [3:42:58<46:54:04, 14.59s/it][INFO|trainer.py:3410] 2024-05-27 13:34:32,393 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-800
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 13:34:32,557 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 13:34:32,557 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-800/special_tokens_map.json
  6%|▋         | 801/12375 [3:43:13<46:59:57, 14.62s/it]  6%|▋         | 802/12375 [3:43:28<47:53:05, 14.90s/it]  6%|▋         | 803/12375 [3:43:44<48:45:39, 15.17s/it]  6%|▋         | 804/12375 [3:44:02<51:47:46, 16.12s/it]  7%|▋         | 805/12375 [3:44:17<50:20:32, 15.66s/it]  7%|▋         | 806/12375 [3:44:34<51:41:44, 16.09s/it]  7%|▋         | 807/12375 [3:44:51<52:13:51, 16.25s/it]  7%|▋         | 808/12375 [3:45:03<48:14:39, 15.02s/it]  7%|▋         | 809/12375 [3:45:19<49:36:08, 15.44s/it]  7%|▋         | 810/12375 [3:45:35<49:37:19, 15.45s/it]                                                          7%|▋         | 810/12375 [3:45:35<49:37:19, 15.45s/it]  7%|▋         | 811/12375 [3:45:49<48:38:04, 15.14s/it]  7%|▋         | 812/12375 [3:46:03<47:35:39, 14.82s/it]  7%|▋         | 813/12375 [3:46:19<48:46:28, 15.19s/it]  7%|▋         | 814/12375 [3:46:32<46:11:20, 14.38s/it]  7%|▋         | 815/12375 [3:46:47<47:01:19, 14.64s/it]  7%|▋         | 816/12375 [3:47:01<46:33:31, 14.50s/it]  7%|▋         | 817/12375 [3:47:16<47:09:14, 14.69s/it]  7%|▋         | 818/12375 [3:47:29<45:34:03, 14.19s/it]  7%|▋         | 819/12375 [3:47:45<46:53:41, 14.61s/it]  7%|▋         | 820/12375 [3:48:03<50:44:32, 15.81s/it]                                                          7%|▋         | 820/12375 [3:48:03<50:44:32, 15.81s/it]  7%|▋         | 821/12375 [3:48:16<47:15:51, 14.73s/it]  7%|▋         | 822/12375 [3:48:28<45:19:46, 14.13s/it]  7%|▋         | 823/12375 [3:48:44<46:59:06, 14.64s/it]  7%|▋         | 824/12375 [3:48:57<45:16:52, 14.11s/it]  7%|▋         | 825/12375 [3:49:15<49:00:19, 15.27s/it]  7%|▋         | 826/12375 [3:49:29<47:56:21, 14.94s/it]  7%|▋         | 827/12375 [3:49:47<50:34:57, 15.77s/it]  7%|▋         | 828/12375 [3:50:04<52:08:22, 16.26s/it]  7%|▋         | 829/12375 [3:50:17<48:19:39, 15.07s/it]  7%|▋         | 830/12375 [3:50:30<47:01:09, 14.66s/it]                                                          7%|▋         | 830/12375 [3:50:30<47:01:09, 14.66s/it]  7%|▋         | 831/12375 [3:50:48<50:09:33, 15.64s/it]  7%|▋         | 832/12375 [3:51:01<47:11:16, 14.72s/it]  7%|▋         | 833/12375 [3:51:17<48:12:10, 15.03s/it]  7%|▋         | 834/12375 [3:51:32<48:40:21, 15.18s/it]  7%|▋         | 835/12375 [3:51:53<54:14:54, 16.92s/it]  7%|▋         | 836/12375 [3:52:06<50:41:56, 15.82s/it]  7%|▋         | 837/12375 [3:52:24<52:59:11, 16.53s/it]  7%|▋         | 838/12375 [3:52:47<58:50:17, 18.36s/it]  7%|▋         | 839/12375 [3:53:07<60:40:44, 18.94s/it]  7%|▋         | 840/12375 [3:53:26<60:48:58, 18.98s/it]                                                          7%|▋         | 840/12375 [3:53:26<60:48:58, 18.98s/it]  7%|▋         | 841/12375 [3:53:41<56:07:09, 17.52s/it]  7%|▋         | 842/12375 [3:54:00<57:44:04, 18.02s/it]  7%|▋         | 843/12375 [3:54:15<55:31:50, 17.34s/it]  7%|▋         | 844/12375 [3:54:31<53:27:34, 16.69s/it]  7%|▋         | 845/12375 [3:54:46<52:09:54, 16.29s/it]  7%|▋         | 846/12375 [3:55:03<52:54:13, 16.52s/it]  7%|▋         | 847/12375 [3:55:23<56:35:03, 17.67s/it]  7%|▋         | 848/12375 [3:55:39<54:29:47, 17.02s/it]  7%|▋         | 849/12375 [3:55:50<48:51:38, 15.26s/it]  7%|▋         | 850/12375 [3:56:06<49:43:22, 15.53s/it]                                                          7%|▋         | 850/12375 [3:56:06<49:43:22, 15.53s/it]  7%|▋         | 851/12375 [3:56:27<54:29:36, 17.02s/it]  7%|▋         | 852/12375 [3:56:48<58:13:08, 18.19s/it]  7%|▋         | 853/12375 [3:57:09<60:48:15, 19.00s/it]  7%|▋         | 854/12375 [3:57:28<61:39:26, 19.27s/it]  7%|▋         | 855/12375 [3:57:46<60:10:49, 18.81s/it]  7%|▋         | 856/12375 [3:58:00<55:47:23, 17.44s/it]  7%|▋         | 857/12375 [3:58:15<52:34:38, 16.43s/it]  7%|▋         | 858/12375 [3:58:27<48:36:04, 15.19s/it]  7%|▋         | 859/12375 [3:58:45<51:13:38, 16.01s/it]  7%|▋         | 860/12375 [3:59:03<53:03:17, 16.59s/it]                                                          7%|▋         | 860/12375 [3:59:03<53:03:17, 16.59s/it]  7%|▋         | 861/12375 [3:59:22<55:52:36, 17.47s/it]  7%|▋         | 862/12375 [3:59:40<56:32:21, 17.68s/it]  7%|▋         | 863/12375 [3:59:54<52:59:35, 16.57s/it]  7%|▋         | 864/12375 [4:00:11<53:25:12, 16.71s/it]  7%|▋         | 865/12375 [4:00:27<52:27:56, 16.41s/it]  7%|▋         | 866/12375 [4:00:45<54:01:02, 16.90s/it]  7%|▋         | 867/12375 [4:00:59<51:07:31, 15.99s/it]  7%|▋         | 868/12375 [4:01:13<49:40:41, 15.54s/it]  7%|▋         | 869/12375 [4:01:32<52:49:54, 16.53s/it]  7%|▋         | 870/12375 [4:01:47<50:38:44, 15.85s/it]                                                          7%|▋         | 870/12375 [4:01:47<50:38:44, 15.85s/it]  7%|▋         | 871/12375 [4:02:03<51:36:51, 16.15s/it]  7%|▋         | 872/12375 [4:02:16<47:41:45, 14.93s/it]  7%|▋         | 873/12375 [4:02:31<48:19:01, 15.12s/it]  7%|▋         | 874/12375 [4:02:52<53:25:47, 16.72s/it]  7%|▋         | 875/12375 [4:03:16<60:26:38, 18.92s/it]  7%|▋         | 876/12375 [4:03:33<58:32:41, 18.33s/it]  7%|▋         | 877/12375 [4:03:48<55:49:45, 17.48s/it]  7%|▋         | 878/12375 [4:04:03<53:08:04, 16.64s/it]  7%|▋         | 879/12375 [4:04:21<55:03:36, 17.24s/it]  7%|▋         | 880/12375 [4:04:38<54:41:42, 17.13s/it]                                                          7%|▋         | 880/12375 [4:04:38<54:41:42, 17.13s/it]  7%|▋         | 881/12375 [4:04:52<51:44:28, 16.21s/it]  7%|▋         | 882/12375 [4:05:10<53:35:32, 16.79s/it]  7%|▋         | 883/12375 [4:05:29<55:29:34, 17.38s/it]  7%|▋         | 884/12375 [4:05:45<54:02:04, 16.93s/it]  7%|▋         | 885/12375 [4:05:59<50:40:39, 15.88s/it]  7%|▋         | 886/12375 [4:06:11<47:30:08, 14.88s/it]  7%|▋         | 887/12375 [4:06:26<47:27:35, 14.87s/it]  7%|▋         | 888/12375 [4:06:38<44:31:47, 13.96s/it]  7%|▋         | 889/12375 [4:06:54<47:02:05, 14.74s/it]  7%|▋         | 890/12375 [4:07:11<48:50:32, 15.31s/it]                                                          7%|▋         | 890/12375 [4:07:11<48:50:32, 15.31s/it]  7%|▋         | 891/12375 [4:07:31<53:20:41, 16.72s/it]  7%|▋         | 892/12375 [4:07:46<51:46:02, 16.23s/it]  7%|▋         | 893/12375 [4:08:00<49:21:21, 15.47s/it]  7%|▋         | 894/12375 [4:08:16<49:57:39, 15.67s/it]  7%|▋         | 895/12375 [4:08:33<51:14:23, 16.07s/it]  7%|▋         | 896/12375 [4:08:47<49:27:15, 15.51s/it]  7%|▋         | 897/12375 [4:09:05<51:52:20, 16.27s/it]  7%|▋         | 898/12375 [4:09:21<51:41:42, 16.22s/it]  7%|▋         | 899/12375 [4:09:36<50:02:40, 15.70s/it]  7%|▋         | 900/12375 [4:09:53<51:25:48, 16.13s/it]                                                          7%|▋         | 900/12375 [4:09:53<51:25:48, 16.13s/it][INFO|trainer.py:3410] 2024-05-27 14:01:27,432 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-900
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 14:01:27,600 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 14:01:27,601 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-900/special_tokens_map.json
  7%|▋         | 901/12375 [4:10:07<49:49:33, 15.63s/it]  7%|▋         | 902/12375 [4:10:26<52:49:35, 16.58s/it]  7%|▋         | 903/12375 [4:10:38<48:33:16, 15.24s/it]  7%|▋         | 904/12375 [4:10:53<48:33:11, 15.24s/it]  7%|▋         | 905/12375 [4:11:13<52:36:55, 16.51s/it]  7%|▋         | 906/12375 [4:11:25<47:58:58, 15.06s/it]  7%|▋         | 907/12375 [4:11:43<51:25:42, 16.14s/it]  7%|▋         | 908/12375 [4:12:01<52:34:57, 16.51s/it]  7%|▋         | 909/12375 [4:12:18<53:31:05, 16.80s/it]  7%|▋         | 910/12375 [4:12:33<51:59:01, 16.32s/it]                                                          7%|▋         | 910/12375 [4:12:33<51:59:01, 16.32s/it]  7%|▋         | 911/12375 [4:12:50<52:34:59, 16.51s/it]  7%|▋         | 912/12375 [4:13:03<48:58:06, 15.38s/it]  7%|▋         | 913/12375 [4:13:19<49:54:32, 15.68s/it]  7%|▋         | 914/12375 [4:13:32<46:41:43, 14.67s/it]  7%|▋         | 915/12375 [4:13:46<46:25:10, 14.58s/it]  7%|▋         | 916/12375 [4:14:01<46:54:37, 14.74s/it]  7%|▋         | 917/12375 [4:14:18<49:14:39, 15.47s/it]  7%|▋         | 918/12375 [4:14:31<46:06:49, 14.49s/it]  7%|▋         | 919/12375 [4:14:45<46:16:51, 14.54s/it]  7%|▋         | 920/12375 [4:15:04<50:40:22, 15.93s/it]                                                          7%|▋         | 920/12375 [4:15:04<50:40:22, 15.93s/it]  7%|▋         | 921/12375 [4:15:23<53:41:16, 16.87s/it]  7%|▋         | 922/12375 [4:15:41<54:20:40, 17.08s/it]  7%|▋         | 923/12375 [4:15:57<53:35:57, 16.85s/it]  7%|▋         | 924/12375 [4:16:14<53:39:04, 16.87s/it]  7%|▋         | 925/12375 [4:16:31<53:33:06, 16.84s/it]  7%|▋         | 926/12375 [4:16:50<55:30:45, 17.46s/it]  7%|▋         | 927/12375 [4:17:04<52:29:36, 16.51s/it]  7%|▋         | 928/12375 [4:17:18<49:25:31, 15.54s/it]  8%|▊         | 929/12375 [4:17:35<51:09:59, 16.09s/it]  8%|▊         | 930/12375 [4:17:52<52:21:20, 16.47s/it]                                                          8%|▊         | 930/12375 [4:17:52<52:21:20, 16.47s/it]  8%|▊         | 931/12375 [4:18:10<53:16:54, 16.76s/it]  8%|▊         | 932/12375 [4:18:24<51:01:39, 16.05s/it]  8%|▊         | 933/12375 [4:18:40<51:16:36, 16.13s/it]  8%|▊         | 934/12375 [4:18:56<50:27:56, 15.88s/it]  8%|▊         | 935/12375 [4:19:14<52:19:44, 16.47s/it]  8%|▊         | 936/12375 [4:19:30<52:44:22, 16.60s/it]  8%|▊         | 937/12375 [4:19:42<47:44:27, 15.03s/it]  8%|▊         | 938/12375 [4:19:58<48:33:31, 15.28s/it]  8%|▊         | 939/12375 [4:20:13<48:25:57, 15.25s/it]  8%|▊         | 940/12375 [4:20:28<48:30:44, 15.27s/it]                                                          8%|▊         | 940/12375 [4:20:28<48:30:44, 15.27s/it]  8%|▊         | 941/12375 [4:20:41<46:39:22, 14.69s/it]  8%|▊         | 942/12375 [4:20:53<43:51:43, 13.81s/it]  8%|▊         | 943/12375 [4:21:10<46:16:56, 14.57s/it]  8%|▊         | 944/12375 [4:21:30<51:35:05, 16.25s/it]  8%|▊         | 945/12375 [4:21:49<54:01:29, 17.02s/it]  8%|▊         | 946/12375 [4:21:59<48:08:42, 15.17s/it]  8%|▊         | 947/12375 [4:22:11<44:52:17, 14.14s/it]  8%|▊         | 948/12375 [4:22:25<44:39:02, 14.07s/it]  8%|▊         | 949/12375 [4:22:37<42:28:50, 13.38s/it]  8%|▊         | 950/12375 [4:22:51<43:01:24, 13.56s/it]                                                          8%|▊         | 950/12375 [4:22:51<43:01:24, 13.56s/it]  8%|▊         | 951/12375 [4:23:12<50:06:55, 15.79s/it]  8%|▊         | 952/12375 [4:23:31<53:01:01, 16.71s/it]  8%|▊         | 953/12375 [4:23:46<51:26:34, 16.21s/it]  8%|▊         | 954/12375 [4:24:00<49:18:21, 15.54s/it]  8%|▊         | 955/12375 [4:24:17<50:46:23, 16.01s/it]  8%|▊         | 956/12375 [4:24:34<52:10:25, 16.45s/it]  8%|▊         | 957/12375 [4:24:47<48:25:48, 15.27s/it]  8%|▊         | 958/12375 [4:25:03<49:14:28, 15.53s/it]  8%|▊         | 959/12375 [4:25:19<49:28:18, 15.60s/it]  8%|▊         | 960/12375 [4:25:34<48:57:11, 15.44s/it]                                                          8%|▊         | 960/12375 [4:25:34<48:57:11, 15.44s/it]  8%|▊         | 961/12375 [4:25:46<45:41:11, 14.41s/it]  8%|▊         | 962/12375 [4:26:02<47:02:01, 14.84s/it]  8%|▊         | 963/12375 [4:26:13<43:21:27, 13.68s/it]  8%|▊         | 964/12375 [4:26:27<44:30:45, 14.04s/it]  8%|▊         | 965/12375 [4:26:46<48:46:13, 15.39s/it]  8%|▊         | 966/12375 [4:27:10<57:06:50, 18.02s/it]  8%|▊         | 967/12375 [4:27:25<53:43:58, 16.96s/it]  8%|▊         | 968/12375 [4:27:43<54:37:45, 17.24s/it]  8%|▊         | 969/12375 [4:27:59<53:49:45, 16.99s/it]  8%|▊         | 970/12375 [4:28:17<54:55:06, 17.34s/it]                                                          8%|▊         | 970/12375 [4:28:17<54:55:06, 17.34s/it]  8%|▊         | 971/12375 [4:28:33<53:46:37, 16.98s/it]  8%|▊         | 972/12375 [4:28:48<51:38:22, 16.30s/it]  8%|▊         | 973/12375 [4:29:01<48:35:07, 15.34s/it]  8%|▊         | 974/12375 [4:29:14<46:34:38, 14.71s/it]  8%|▊         | 975/12375 [4:29:27<44:31:33, 14.06s/it]  8%|▊         | 976/12375 [4:29:42<45:35:53, 14.40s/it]  8%|▊         | 977/12375 [4:29:56<45:40:33, 14.43s/it]  8%|▊         | 978/12375 [4:30:11<45:52:53, 14.49s/it]  8%|▊         | 979/12375 [4:30:28<48:29:46, 15.32s/it]  8%|▊         | 980/12375 [4:30:44<48:36:51, 15.36s/it]                                                          8%|▊         | 980/12375 [4:30:44<48:36:51, 15.36s/it]  8%|▊         | 981/12375 [4:31:01<50:32:53, 15.97s/it]  8%|▊         | 982/12375 [4:31:15<48:43:17, 15.40s/it]  8%|▊         | 983/12375 [4:31:34<51:33:40, 16.29s/it]  8%|▊         | 984/12375 [4:31:48<50:08:16, 15.85s/it]  8%|▊         | 985/12375 [4:32:01<47:22:55, 14.98s/it]  8%|▊         | 986/12375 [4:32:18<49:18:05, 15.58s/it]  8%|▊         | 987/12375 [4:32:35<49:57:42, 15.79s/it]  8%|▊         | 988/12375 [4:32:51<50:23:21, 15.93s/it]  8%|▊         | 989/12375 [4:33:09<52:21:08, 16.55s/it]  8%|▊         | 990/12375 [4:33:27<54:03:45, 17.09s/it]                                                          8%|▊         | 990/12375 [4:33:27<54:03:45, 17.09s/it]  8%|▊         | 991/12375 [4:33:43<52:49:14, 16.70s/it]  8%|▊         | 992/12375 [4:33:59<52:24:42, 16.58s/it]  8%|▊         | 993/12375 [4:34:14<50:40:29, 16.03s/it]  8%|▊         | 994/12375 [4:34:33<53:02:50, 16.78s/it]  8%|▊         | 995/12375 [4:34:48<52:02:46, 16.46s/it]  8%|▊         | 996/12375 [4:35:04<50:51:48, 16.09s/it]  8%|▊         | 997/12375 [4:35:20<51:17:22, 16.23s/it]  8%|▊         | 998/12375 [4:35:37<52:03:01, 16.47s/it]  8%|▊         | 999/12375 [4:35:55<52:53:31, 16.74s/it]  8%|▊         | 1000/12375 [4:36:06<47:56:07, 15.17s/it]                                                           8%|▊         | 1000/12375 [4:36:06<47:56:07, 15.17s/it][INFO|trainer.py:3719] 2024-05-27 14:27:40,672 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-27 14:27:40,672 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-27 14:27:40,672 >>   Batch size = 32
{'eval_loss': 1.1737321615219116, 'eval_runtime': 559.8709, 'eval_samples_per_second': 8.931, 'eval_steps_per_second': 0.28, 'epoch': 0.04}
{'loss': 0.8618, 'grad_norm': 1.8911311626434326, 'learning_rate': 9.958330613191241e-05, 'epoch': 0.04}
{'loss': 0.8748, 'grad_norm': 1.7304362058639526, 'learning_rate': 9.95667928967258e-05, 'epoch': 0.04}
{'loss': 0.8808, 'grad_norm': 1.8087760210037231, 'learning_rate': 9.954996020856517e-05, 'epoch': 0.04}
{'loss': 0.824, 'grad_norm': 1.6186450719833374, 'learning_rate': 9.95328081759155e-05, 'epoch': 0.04}
{'loss': 0.901, 'grad_norm': 1.6510604619979858, 'learning_rate': 9.951533690931987e-05, 'epoch': 0.04}
{'loss': 0.855, 'grad_norm': 1.706717848777771, 'learning_rate': 9.949754652137887e-05, 'epoch': 0.05}
{'loss': 0.8722, 'grad_norm': 1.7657052278518677, 'learning_rate': 9.947943712674971e-05, 'epoch': 0.05}
{'loss': 0.8509, 'grad_norm': 1.840775489807129, 'learning_rate': 9.946100884214566e-05, 'epoch': 0.05}
{'loss': 0.8373, 'grad_norm': 1.7274997234344482, 'learning_rate': 9.944226178633512e-05, 'epoch': 0.05}
{'loss': 0.8552, 'grad_norm': 2.1214473247528076, 'learning_rate': 9.942319608014097e-05, 'epoch': 0.05}
{'loss': 0.8621, 'grad_norm': 1.6885900497436523, 'learning_rate': 9.940381184643979e-05, 'epoch': 0.05}
{'loss': 0.8446, 'grad_norm': 1.8929314613342285, 'learning_rate': 9.938410921016097e-05, 'epoch': 0.05}
{'loss': 0.864, 'grad_norm': 2.063311815261841, 'learning_rate': 9.936408829828603e-05, 'epoch': 0.05}
{'loss': 0.8387, 'grad_norm': 1.5192960500717163, 'learning_rate': 9.934374923984772e-05, 'epoch': 0.05}
{'loss': 0.8739, 'grad_norm': 1.9444904327392578, 'learning_rate': 9.932309216592924e-05, 'epoch': 0.05}
{'loss': 0.839, 'grad_norm': 1.9593764543533325, 'learning_rate': 9.930211720966331e-05, 'epoch': 0.05}
{'loss': 0.8223, 'grad_norm': 1.8894928693771362, 'learning_rate': 9.928082450623144e-05, 'epoch': 0.05}
{'loss': 0.8266, 'grad_norm': 1.8066941499710083, 'learning_rate': 9.925921419286292e-05, 'epoch': 0.05}
{'loss': 0.8864, 'grad_norm': 1.5620591640472412, 'learning_rate': 9.923728640883405e-05, 'epoch': 0.06}
{'loss': 0.8499, 'grad_norm': 1.6742274761199951, 'learning_rate': 9.921504129546719e-05, 'epoch': 0.06}
{'loss': 0.8513, 'grad_norm': 1.9991472959518433, 'learning_rate': 9.919247899612982e-05, 'epoch': 0.06}
{'loss': 0.8813, 'grad_norm': 1.7379847764968872, 'learning_rate': 9.916959965623374e-05, 'epoch': 0.06}
{'loss': 0.8675, 'grad_norm': 1.8751550912857056, 'learning_rate': 9.914640342323392e-05, 'epoch': 0.06}
{'loss': 0.8258, 'grad_norm': 1.7627965211868286, 'learning_rate': 9.912289044662779e-05, 'epoch': 0.06}
{'loss': 0.8393, 'grad_norm': 1.966755986213684, 'learning_rate': 9.909906087795407e-05, 'epoch': 0.06}
{'loss': 0.8681, 'grad_norm': 2.266010284423828, 'learning_rate': 9.907491487079195e-05, 'epoch': 0.06}
{'loss': 0.8835, 'grad_norm': 2.066370725631714, 'learning_rate': 9.905045258076e-05, 'epoch': 0.06}
{'loss': 0.8444, 'grad_norm': 1.992030382156372, 'learning_rate': 9.90256741655152e-05, 'epoch': 0.06}
{'loss': 0.8963, 'grad_norm': 2.0336015224456787, 'learning_rate': 9.900057978475194e-05, 'epoch': 0.06}
{'loss': 0.8499, 'grad_norm': 2.0694479942321777, 'learning_rate': 9.897516960020097e-05, 'epoch': 0.06}
{'loss': 0.8525, 'grad_norm': 1.8716762065887451, 'learning_rate': 9.894944377562836e-05, 'epoch': 0.07}
{'loss': 0.8679, 'grad_norm': 2.184175729751587, 'learning_rate': 9.892340247683445e-05, 'epoch': 0.07}
{'loss': 0.8752, 'grad_norm': 1.8421741724014282, 'learning_rate': 9.88970458716528e-05, 'epoch': 0.07}
{'loss': 0.8626, 'grad_norm': 1.9791321754455566, 'learning_rate': 9.887037412994903e-05, 'epoch': 0.07}
{'loss': 0.8303, 'grad_norm': 1.6562602519989014, 'learning_rate': 9.884338742361987e-05, 'epoch': 0.07}
{'loss': 0.8267, 'grad_norm': 1.5457271337509155, 'learning_rate': 9.881608592659189e-05, 'epoch': 0.07}
{'loss': 0.8326, 'grad_norm': 2.2901625633239746, 'learning_rate': 9.878846981482046e-05, 'epoch': 0.07}
{'loss': 0.8441, 'grad_norm': 1.967993974685669, 'learning_rate': 9.876053926628867e-05, 'epoch': 0.07}
{'loss': 0.8641, 'grad_norm': 1.9278199672698975, 'learning_rate': 9.873229446100606e-05, 'epoch': 0.07}
{'loss': 0.8638, 'grad_norm': 1.8942639827728271, 'learning_rate': 9.870373558100756e-05, 'epoch': 0.07}
{'loss': 0.8194, 'grad_norm': 2.07486891746521, 'learning_rate': 9.867486281035226e-05, 'epoch': 0.07}
{'loss': 0.8084, 'grad_norm': 1.8475067615509033, 'learning_rate': 9.864567633512224e-05, 'epoch': 0.07}
{'loss': 0.8608, 'grad_norm': 1.9211124181747437, 'learning_rate': 9.861617634342141e-05, 'epoch': 0.08}
{'loss': 0.814, 'grad_norm': 2.135390520095825, 'learning_rate': 9.858636302537423e-05, 'epoch': 0.08}
{'loss': 0.8524, 'grad_norm': 1.952754020690918, 'learning_rate': 9.855623657312449e-05, 'epoch': 0.08}
{'loss': 0.8679, 'grad_norm': 1.811217188835144, 'learning_rate': 9.852579718083419e-05, 'epoch': 0.08}
{'loss': 0.8194, 'grad_norm': 1.8251819610595703, 'learning_rate': 9.84950450446821e-05, 'epoch': 0.08}
{'loss': 0.8663, 'grad_norm': 1.801300048828125, 'learning_rate': 9.846398036286264e-05, 'epoch': 0.08}
{'loss': 0.8513, 'grad_norm': 1.8654505014419556, 'learning_rate': 9.843260333558455e-05, 'epoch': 0.08}
{'loss': 0.8335, 'grad_norm': 1.6392589807510376, 'learning_rate': 9.84009141650696e-05, 'epoch': 0.08}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:50,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:08,  2.00s/it][A
  3%|▎         | 4/157 [00:09<06:44,  2.64s/it][A
  3%|▎         | 5/157 [00:14<08:25,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:45,  3.48s/it][A
  4%|▍         | 7/157 [00:21<08:40,  3.47s/it][A
  5%|▌         | 8/157 [00:25<09:14,  3.72s/it][A
  6%|▌         | 9/157 [00:28<08:18,  3.37s/it][A
  6%|▋         | 10/157 [00:31<08:18,  3.39s/it][A
  7%|▋         | 11/157 [00:33<07:29,  3.08s/it][A
  8%|▊         | 12/157 [00:36<07:10,  2.97s/it][A
  8%|▊         | 13/157 [00:39<07:06,  2.96s/it][A
  9%|▉         | 14/157 [00:43<07:32,  3.16s/it][A
 10%|▉         | 15/157 [00:46<07:50,  3.31s/it][A
 10%|█         | 16/157 [00:50<08:19,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:45,  3.33s/it][A
 11%|█▏        | 18/157 [00:56<07:13,  3.12s/it][A
 12%|█▏        | 19/157 [01:00<07:52,  3.43s/it][A
 13%|█▎        | 20/157 [01:04<07:53,  3.46s/it][A
 13%|█▎        | 21/157 [01:07<07:48,  3.44s/it][A
 14%|█▍        | 22/157 [01:10<07:26,  3.31s/it][A
 15%|█▍        | 23/157 [01:13<07:11,  3.22s/it][A
 15%|█▌        | 24/157 [01:17<07:34,  3.42s/it][A
 16%|█▌        | 25/157 [01:20<07:31,  3.42s/it][A
 17%|█▋        | 26/157 [01:24<07:27,  3.42s/it][A
 17%|█▋        | 27/157 [01:29<08:33,  3.95s/it][A
 18%|█▊        | 28/157 [01:33<08:28,  3.94s/it][A
 18%|█▊        | 29/157 [01:36<07:43,  3.62s/it][A
 19%|█▉        | 30/157 [01:39<07:12,  3.40s/it][A
 20%|█▉        | 31/157 [01:42<07:20,  3.50s/it][A
 20%|██        | 32/157 [01:46<07:19,  3.52s/it][A
 21%|██        | 33/157 [01:50<07:39,  3.71s/it][A
 22%|██▏       | 34/157 [01:54<07:48,  3.81s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.72s/it][A
 23%|██▎       | 36/157 [02:02<08:00,  3.97s/it][A
 24%|██▎       | 37/157 [02:06<07:47,  3.90s/it][A
 24%|██▍       | 38/157 [02:10<07:34,  3.82s/it][A
 25%|██▍       | 39/157 [02:13<07:14,  3.68s/it][A
 25%|██▌       | 40/157 [02:16<06:36,  3.39s/it][A
 26%|██▌       | 41/157 [02:19<06:49,  3.53s/it][A
 27%|██▋       | 42/157 [02:25<07:45,  4.04s/it][A
 27%|██▋       | 43/157 [02:27<06:56,  3.65s/it][A
 28%|██▊       | 44/157 [02:31<06:59,  3.72s/it][A
 29%|██▊       | 45/157 [02:34<06:36,  3.54s/it][A
 29%|██▉       | 46/157 [02:37<06:07,  3.31s/it][A
 30%|██▉       | 47/157 [02:40<05:59,  3.27s/it][A
 31%|███       | 48/157 [02:47<07:45,  4.27s/it][A
 31%|███       | 49/157 [02:50<06:50,  3.80s/it][A
 32%|███▏      | 50/157 [02:53<06:23,  3.59s/it][A
 32%|███▏      | 51/157 [02:57<06:28,  3.67s/it][A
 33%|███▎      | 52/157 [03:01<06:33,  3.75s/it][A
 34%|███▍      | 53/157 [03:05<06:57,  4.02s/it][A
 34%|███▍      | 54/157 [03:09<06:34,  3.83s/it][A
 35%|███▌      | 55/157 [03:13<06:47,  3.99s/it][A
 36%|███▌      | 56/157 [03:17<06:49,  4.06s/it][A
 36%|███▋      | 57/157 [03:21<06:45,  4.06s/it][A
 37%|███▋      | 58/157 [03:25<06:25,  3.89s/it][A
 38%|███▊      | 59/157 [03:30<06:48,  4.17s/it][A
 38%|███▊      | 60/157 [03:34<06:40,  4.12s/it][A
 39%|███▉      | 61/157 [03:37<06:19,  3.95s/it][A
 39%|███▉      | 62/157 [03:42<06:37,  4.18s/it][A
 40%|████      | 63/157 [03:45<06:11,  3.95s/it][A
 41%|████      | 64/157 [03:50<06:19,  4.08s/it][A
 41%|████▏     | 65/157 [03:54<06:31,  4.25s/it][A
 42%|████▏     | 66/157 [03:57<05:40,  3.74s/it][A
 43%|████▎     | 67/157 [04:02<06:10,  4.12s/it][A
 43%|████▎     | 68/157 [04:04<05:25,  3.66s/it][A
 44%|████▍     | 69/157 [04:07<05:01,  3.42s/it][A
 45%|████▍     | 70/157 [04:12<05:22,  3.70s/it][A
 45%|████▌     | 71/157 [04:15<05:09,  3.60s/it][A
 46%|████▌     | 72/157 [04:18<04:47,  3.38s/it][A
 46%|████▋     | 73/157 [04:20<04:21,  3.11s/it][A
 47%|████▋     | 74/157 [04:24<04:41,  3.39s/it][A
 48%|████▊     | 75/157 [04:28<04:54,  3.59s/it][A
 48%|████▊     | 76/157 [04:33<05:02,  3.73s/it][A
 49%|████▉     | 77/157 [04:36<04:55,  3.70s/it][A
 50%|████▉     | 78/157 [04:39<04:30,  3.42s/it][A
 50%|█████     | 79/157 [04:44<04:58,  3.82s/it][A
 51%|█████     | 80/157 [04:46<04:29,  3.50s/it][A
 52%|█████▏    | 81/157 [04:49<04:04,  3.22s/it][A
 52%|█████▏    | 82/157 [04:52<04:00,  3.20s/it][A
 53%|█████▎    | 83/157 [04:56<04:15,  3.45s/it][A
 54%|█████▎    | 84/157 [05:00<04:27,  3.66s/it][A
 54%|█████▍    | 85/157 [05:04<04:30,  3.75s/it][A
 55%|█████▍    | 86/157 [05:09<04:44,  4.01s/it][A
 55%|█████▌    | 87/157 [05:13<04:34,  3.92s/it][A
 56%|█████▌    | 88/157 [05:16<04:23,  3.81s/it][A
 57%|█████▋    | 89/157 [05:20<04:09,  3.67s/it][A
 57%|█████▋    | 90/157 [05:24<04:13,  3.78s/it][A
 58%|█████▊    | 91/157 [05:27<04:06,  3.73s/it][A
 59%|█████▊    | 92/157 [05:30<03:47,  3.50s/it][A
 59%|█████▉    | 93/157 [05:35<04:14,  3.98s/it][A
 60%|█████▉    | 94/157 [05:38<03:54,  3.71s/it][A
 61%|██████    | 95/157 [05:42<03:43,  3.61s/it][A
 61%|██████    | 96/157 [05:45<03:32,  3.48s/it][A
 62%|██████▏   | 97/157 [05:48<03:22,  3.38s/it][A
 62%|██████▏   | 98/157 [05:50<03:02,  3.10s/it][A
 63%|██████▎   | 99/157 [05:55<03:16,  3.39s/it][A
 64%|██████▎   | 100/157 [05:58<03:06,  3.28s/it][A
 64%|██████▍   | 101/157 [06:00<02:55,  3.13s/it][A
 65%|██████▍   | 102/157 [06:03<02:49,  3.07s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.90s/it][A
 66%|██████▌   | 104/157 [06:10<02:55,  3.31s/it][A
 67%|██████▋   | 105/157 [06:14<03:03,  3.54s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.86s/it][A
 68%|██████▊   | 107/157 [06:23<03:21,  4.03s/it][A
 69%|██████▉   | 108/157 [06:27<03:14,  3.98s/it][A
 69%|██████▉   | 109/157 [06:31<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:34<03:02,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.48s/it][A
 72%|███████▏  | 113/157 [06:44<02:29,  3.40s/it][A
 73%|███████▎  | 114/157 [06:48<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:57<02:51,  4.18s/it][A
 75%|███████▍  | 117/157 [07:00<02:31,  3.79s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.50s/it][A
 76%|███████▌  | 119/157 [07:06<02:14,  3.54s/it][A
 76%|███████▋  | 120/157 [07:09<02:01,  3.29s/it][A
 77%|███████▋  | 121/157 [07:12<01:54,  3.19s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.33s/it][A
 78%|███████▊  | 123/157 [07:20<01:57,  3.46s/it][A
 79%|███████▉  | 124/157 [07:23<01:55,  3.49s/it][A
 80%|███████▉  | 125/157 [07:26<01:45,  3.29s/it][A
 80%|████████  | 126/157 [07:30<01:47,  3.46s/it][A
 81%|████████  | 127/157 [07:33<01:37,  3.25s/it][A
 82%|████████▏ | 128/157 [07:35<01:29,  3.09s/it][A
 82%|████████▏ | 129/157 [07:38<01:22,  2.94s/it][A
 83%|████████▎ | 130/157 [07:42<01:27,  3.23s/it][A
 83%|████████▎ | 131/157 [07:45<01:25,  3.30s/it][A
 84%|████████▍ | 132/157 [07:49<01:29,  3.59s/it][A
 85%|████████▍ | 133/157 [07:52<01:21,  3.41s/it][A
 85%|████████▌ | 134/157 [07:56<01:17,  3.38s/it][A
 86%|████████▌ | 135/157 [08:00<01:16,  3.50s/it][A
 87%|████████▋ | 136/157 [08:02<01:09,  3.31s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.58s/it][A
 88%|████████▊ | 138/157 [08:10<01:05,  3.44s/it][A
 89%|████████▊ | 139/157 [08:14<01:05,  3.63s/it][A
 89%|████████▉ | 140/157 [08:17<01:00,  3.58s/it][A
 90%|████████▉ | 141/157 [08:20<00:55,  3.44s/it][A
 90%|█████████ | 142/157 [08:24<00:54,  3.63s/it][A
 91%|█████████ | 143/157 [08:29<00:55,  3.96s/it][A
 92%|█████████▏| 144/157 [08:33<00:49,  3.84s/it][A
 92%|█████████▏| 145/157 [08:37<00:48,  4.01s/it][A
 93%|█████████▎| 146/157 [08:41<00:43,  3.92s/it][A
 94%|█████████▎| 147/157 [08:46<00:42,  4.26s/it][A
 94%|█████████▍| 148/157 [08:49<00:35,  3.91s/it][A
 95%|█████████▍| 149/157 [08:53<00:31,  3.94s/it][A
 96%|█████████▌| 150/157 [08:56<00:25,  3.70s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.63s/it][A
 97%|█████████▋| 152/157 [09:03<00:17,  3.48s/it][A
 97%|█████████▋| 153/157 [09:05<00:12,  3.18s/it][A
 98%|█████████▊| 154/157 [09:09<00:09,  3.28s/it][A
 99%|█████████▊| 155/157 [09:11<00:06,  3.01s/it][A
 99%|█████████▉| 156/157 [09:15<00:03,  3.32s/it][A
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A                                                         
                                                 [A  8%|▊         | 1000/12375 [4:45:26<47:56:07, 15.17s/it]
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-27 14:37:00,299 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1000
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 14:37:00,461 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 14:37:00,461 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1000/special_tokens_map.json
  8%|▊         | 1001/12375 [4:45:44<581:16:58, 183.98s/it]  8%|▊         | 1002/12375 [4:45:57<419:04:16, 132.65s/it]  8%|▊         | 1003/12375 [4:46:11<306:48:08, 97.12s/it]   8%|▊         | 1004/12375 [4:46:24<226:31:52, 71.72s/it]  8%|▊         | 1005/12375 [4:46:39<173:00:35, 54.78s/it]  8%|▊         | 1006/12375 [4:46:51<132:20:51, 41.91s/it]  8%|▊         | 1007/12375 [4:47:03<104:36:38, 33.13s/it]  8%|▊         | 1008/12375 [4:47:21<90:26:58, 28.65s/it]   8%|▊         | 1009/12375 [4:47:38<79:20:50, 25.13s/it]  8%|▊         | 1010/12375 [4:47:56<72:09:14, 22.86s/it]                                                           8%|▊         | 1010/12375 [4:47:56<72:09:14, 22.86s/it]  8%|▊         | 1011/12375 [4:48:14<67:19:05, 21.33s/it]  8%|▊         | 1012/12375 [4:48:29<61:20:24, 19.43s/it]  8%|▊         | 1013/12375 [4:48:47<60:10:35, 19.07s/it]  8%|▊         | 1014/12375 [4:49:03<57:27:06, 18.20s/it]  8%|▊         | 1015/12375 [4:49:20<55:54:16, 17.72s/it]  8%|▊         | 1016/12375 [4:49:34<52:20:47, 16.59s/it]  8%|▊         | 1017/12375 [4:49:54<55:53:46, 17.72s/it]  8%|▊         | 1018/12375 [4:50:14<58:19:23, 18.49s/it]  8%|▊         | 1019/12375 [4:50:32<57:28:41, 18.22s/it]  8%|▊         | 1020/12375 [4:50:46<53:34:20, 16.98s/it]                                                           8%|▊         | 1020/12375 [4:50:46<53:34:20, 16.98s/it]  8%|▊         | 1021/12375 [4:51:02<52:39:21, 16.70s/it]  8%|▊         | 1022/12375 [4:51:18<52:21:47, 16.60s/it]  8%|▊         | 1023/12375 [4:51:40<56:47:17, 18.01s/it]  8%|▊         | 1024/12375 [4:51:56<54:44:47, 17.36s/it]  8%|▊         | 1025/12375 [4:52:09<51:06:07, 16.21s/it]  8%|▊         | 1026/12375 [4:52:24<49:41:15, 15.76s/it]  8%|▊         | 1027/12375 [4:52:43<52:46:51, 16.74s/it]  8%|▊         | 1028/12375 [4:53:00<53:33:43, 16.99s/it]  8%|▊         | 1029/12375 [4:53:15<50:56:23, 16.16s/it]  8%|▊         | 1030/12375 [4:53:30<50:00:04, 15.87s/it]                                                           8%|▊         | 1030/12375 [4:53:30<50:00:04, 15.87s/it]  8%|▊         | 1031/12375 [4:53:45<49:49:45, 15.81s/it]  8%|▊         | 1032/12375 [4:54:03<51:31:13, 16.35s/it]  8%|▊         | 1033/12375 [4:54:17<49:16:07, 15.64s/it]  8%|▊         | 1034/12375 [4:54:29<46:06:52, 14.64s/it]  8%|▊         | 1035/12375 [4:54:41<43:35:57, 13.84s/it]  8%|▊         | 1036/12375 [4:54:56<44:38:27, 14.17s/it]  8%|▊         | 1037/12375 [4:55:12<45:45:42, 14.53s/it]  8%|▊         | 1038/12375 [4:55:30<49:20:40, 15.67s/it]  8%|▊         | 1039/12375 [4:55:46<49:23:14, 15.68s/it]  8%|▊         | 1040/12375 [4:56:03<50:56:38, 16.18s/it]                                                           8%|▊         | 1040/12375 [4:56:03<50:56:38, 16.18s/it]  8%|▊         | 1041/12375 [4:56:15<47:07:25, 14.97s/it]  8%|▊         | 1042/12375 [4:56:35<52:06:20, 16.55s/it]  8%|▊         | 1043/12375 [4:56:49<49:18:40, 15.67s/it]  8%|▊         | 1044/12375 [4:57:01<45:47:58, 14.55s/it]  8%|▊         | 1045/12375 [4:57:13<43:40:42, 13.88s/it]  8%|▊         | 1046/12375 [4:57:33<49:31:29, 15.74s/it]  8%|▊         | 1047/12375 [4:57:50<49:55:42, 15.87s/it]  8%|▊         | 1048/12375 [4:58:08<52:22:20, 16.65s/it]  8%|▊         | 1049/12375 [4:58:24<51:19:24, 16.31s/it]  8%|▊         | 1050/12375 [4:58:43<54:25:28, 17.30s/it]                                                           8%|▊         | 1050/12375 [4:58:43<54:25:28, 17.30s/it]  8%|▊         | 1051/12375 [4:59:01<55:15:26, 17.57s/it]  9%|▊         | 1052/12375 [4:59:19<55:17:11, 17.58s/it]  9%|▊         | 1053/12375 [4:59:32<51:24:47, 16.35s/it]  9%|▊         | 1054/12375 [4:59:44<46:48:07, 14.88s/it]  9%|▊         | 1055/12375 [5:00:04<51:29:12, 16.37s/it]  9%|▊         | 1056/12375 [5:00:18<49:41:45, 15.81s/it]  9%|▊         | 1057/12375 [5:00:31<47:12:56, 15.02s/it]  9%|▊         | 1058/12375 [5:00:44<44:57:14, 14.30s/it]  9%|▊         | 1059/12375 [5:00:57<43:23:05, 13.80s/it]  9%|▊         | 1060/12375 [5:01:10<43:04:23, 13.70s/it]                                                           9%|▊         | 1060/12375 [5:01:10<43:04:23, 13.70s/it]  9%|▊         | 1061/12375 [5:01:30<49:04:34, 15.62s/it]  9%|▊         | 1062/12375 [5:01:43<46:51:48, 14.91s/it]  9%|▊         | 1063/12375 [5:01:58<46:30:21, 14.80s/it]  9%|▊         | 1064/12375 [5:02:13<46:32:50, 14.81s/it]  9%|▊         | 1065/12375 [5:02:28<46:53:48, 14.93s/it]  9%|▊         | 1066/12375 [5:02:42<46:07:52, 14.68s/it]  9%|▊         | 1067/12375 [5:02:53<42:41:41, 13.59s/it]  9%|▊         | 1068/12375 [5:03:08<43:44:35, 13.93s/it]  9%|▊         | 1069/12375 [5:03:21<43:22:11, 13.81s/it]  9%|▊         | 1070/12375 [5:03:34<41:56:48, 13.36s/it]                                                           9%|▊         | 1070/12375 [5:03:34<41:56:48, 13.36s/it]  9%|▊         | 1071/12375 [5:03:48<42:33:34, 13.55s/it]  9%|▊         | 1072/12375 [5:04:05<46:11:49, 14.71s/it]  9%|▊         | 1073/12375 [5:04:21<47:19:51, 15.08s/it]  9%|▊         | 1074/12375 [5:04:39<49:40:24, 15.82s/it]  9%|▊         | 1075/12375 [5:04:53<47:55:54, 15.27s/it]  9%|▊         | 1076/12375 [5:05:11<51:06:52, 16.29s/it]  9%|▊         | 1077/12375 [5:05:29<52:00:06, 16.57s/it]  9%|▊         | 1078/12375 [5:05:44<50:29:08, 16.09s/it]  9%|▊         | 1079/12375 [5:06:01<52:06:31, 16.61s/it]  9%|▊         | 1080/12375 [5:06:15<49:18:51, 15.72s/it]                                                           9%|▊         | 1080/12375 [5:06:15<49:18:51, 15.72s/it]  9%|▊         | 1081/12375 [5:06:32<50:05:49, 15.97s/it]  9%|▊         | 1082/12375 [5:06:51<53:34:39, 17.08s/it]  9%|▉         | 1083/12375 [5:07:10<55:05:32, 17.56s/it]  9%|▉         | 1084/12375 [5:07:21<49:21:08, 15.74s/it]  9%|▉         | 1085/12375 [5:07:42<54:12:29, 17.29s/it]  9%|▉         | 1086/12375 [5:08:04<58:34:37, 18.68s/it]  9%|▉         | 1087/12375 [5:08:21<57:14:22, 18.26s/it]  9%|▉         | 1088/12375 [5:08:40<57:56:46, 18.48s/it]  9%|▉         | 1089/12375 [5:08:52<51:47:17, 16.52s/it]  9%|▉         | 1090/12375 [5:09:06<49:21:09, 15.74s/it]                                                           9%|▉         | 1090/12375 [5:09:06<49:21:09, 15.74s/it]  9%|▉         | 1091/12375 [5:09:22<49:38:27, 15.84s/it]  9%|▉         | 1092/12375 [5:09:49<59:53:31, 19.11s/it]  9%|▉         | 1093/12375 [5:10:03<54:42:44, 17.46s/it]  9%|▉         | 1094/12375 [5:10:16<51:04:09, 16.30s/it]  9%|▉         | 1095/12375 [5:10:31<49:41:53, 15.86s/it]  9%|▉         | 1096/12375 [5:10:42<45:09:05, 14.41s/it]  9%|▉         | 1097/12375 [5:10:53<41:42:41, 13.31s/it]  9%|▉         | 1098/12375 [5:11:08<43:15:54, 13.81s/it]  9%|▉         | 1099/12375 [5:11:25<46:38:12, 14.89s/it]  9%|▉         | 1100/12375 [5:11:40<46:21:12, 14.80s/it]                                                           9%|▉         | 1100/12375 [5:11:40<46:21:12, 14.80s/it][INFO|trainer.py:3410] 2024-05-27 15:03:14,513 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1100
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 15:03:14,675 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 15:03:14,675 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1100/special_tokens_map.json
  9%|▉         | 1101/12375 [5:11:51<43:08:14, 13.77s/it]  9%|▉         | 1102/12375 [5:12:04<42:24:17, 13.54s/it]  9%|▉         | 1103/12375 [5:12:23<47:38:50, 15.22s/it]  9%|▉         | 1104/12375 [5:12:39<48:00:37, 15.33s/it]  9%|▉         | 1105/12375 [5:13:03<55:43:14, 17.80s/it]  9%|▉         | 1106/12375 [5:13:24<58:50:07, 18.80s/it]  9%|▉         | 1107/12375 [5:13:40<56:31:37, 18.06s/it]  9%|▉         | 1108/12375 [5:13:54<52:46:30, 16.86s/it]  9%|▉         | 1109/12375 [5:14:15<56:38:22, 18.10s/it]  9%|▉         | 1110/12375 [5:14:27<50:28:47, 16.13s/it]                                                           9%|▉         | 1110/12375 [5:14:27<50:28:47, 16.13s/it]  9%|▉         | 1111/12375 [5:14:44<51:35:45, 16.49s/it]  9%|▉         | 1112/12375 [5:14:55<46:49:31, 14.97s/it]  9%|▉         | 1113/12375 [5:15:10<46:09:31, 14.76s/it]  9%|▉         | 1114/12375 [5:15:27<48:31:16, 15.51s/it]  9%|▉         | 1115/12375 [5:15:43<49:03:15, 15.68s/it]  9%|▉         | 1116/12375 [5:16:00<50:28:53, 16.14s/it]  9%|▉         | 1117/12375 [5:16:13<46:57:14, 15.01s/it]  9%|▉         | 1118/12375 [5:16:31<50:07:24, 16.03s/it]  9%|▉         | 1119/12375 [5:16:47<49:57:40, 15.98s/it]  9%|▉         | 1120/12375 [5:17:06<53:15:47, 17.04s/it]                                                           9%|▉         | 1120/12375 [5:17:06<53:15:47, 17.04s/it]  9%|▉         | 1121/12375 [5:17:22<52:08:29, 16.68s/it]  9%|▉         | 1122/12375 [5:17:37<50:34:07, 16.18s/it]  9%|▉         | 1123/12375 [5:17:48<45:50:20, 14.67s/it]  9%|▉         | 1124/12375 [5:18:08<50:07:46, 16.04s/it]  9%|▉         | 1125/12375 [5:18:26<52:32:58, 16.82s/it]  9%|▉         | 1126/12375 [5:18:45<54:04:18, 17.30s/it]  9%|▉         | 1127/12375 [5:19:00<52:02:57, 16.66s/it]  9%|▉         | 1128/12375 [5:19:15<50:32:28, 16.18s/it]  9%|▉         | 1129/12375 [5:19:33<52:23:04, 16.77s/it]  9%|▉         | 1130/12375 [5:19:49<51:54:58, 16.62s/it]                                                           9%|▉         | 1130/12375 [5:19:49<51:54:58, 16.62s/it]  9%|▉         | 1131/12375 [5:20:03<49:16:15, 15.78s/it]  9%|▉         | 1132/12375 [5:20:20<50:21:36, 16.13s/it]  9%|▉         | 1133/12375 [5:20:40<54:21:13, 17.41s/it]  9%|▉         | 1134/12375 [5:20:59<55:45:49, 17.86s/it]  9%|▉         | 1135/12375 [5:21:17<55:25:07, 17.75s/it]  9%|▉         | 1136/12375 [5:21:29<50:35:19, 16.20s/it]  9%|▉         | 1137/12375 [5:21:45<50:21:58, 16.13s/it]  9%|▉         | 1138/12375 [5:22:00<48:33:03, 15.55s/it]  9%|▉         | 1139/12375 [5:22:15<48:39:58, 15.59s/it]  9%|▉         | 1140/12375 [5:22:37<54:14:33, 17.38s/it]                                                           9%|▉         | 1140/12375 [5:22:37<54:14:33, 17.38s/it]  9%|▉         | 1141/12375 [5:22:49<49:34:07, 15.88s/it]  9%|▉         | 1142/12375 [5:23:03<47:23:03, 15.19s/it]  9%|▉         | 1143/12375 [5:23:15<44:43:29, 14.33s/it]  9%|▉         | 1144/12375 [5:23:32<46:50:02, 15.01s/it]  9%|▉         | 1145/12375 [5:23:51<51:11:50, 16.41s/it]  9%|▉         | 1146/12375 [5:24:07<50:15:16, 16.11s/it]  9%|▉         | 1147/12375 [5:24:23<50:22:04, 16.15s/it]  9%|▉         | 1148/12375 [5:24:35<46:34:53, 14.94s/it]  9%|▉         | 1149/12375 [5:24:50<46:14:26, 14.83s/it]  9%|▉         | 1150/12375 [5:25:08<49:49:11, 15.98s/it]                                                           9%|▉         | 1150/12375 [5:25:08<49:49:11, 15.98s/it]  9%|▉         | 1151/12375 [5:25:22<47:09:26, 15.13s/it]  9%|▉         | 1152/12375 [5:25:37<47:08:12, 15.12s/it]  9%|▉         | 1153/12375 [5:25:51<46:19:55, 14.86s/it]  9%|▉         | 1154/12375 [5:26:03<43:18:27, 13.89s/it]  9%|▉         | 1155/12375 [5:26:18<44:51:40, 14.39s/it]  9%|▉         | 1156/12375 [5:26:32<43:58:48, 14.11s/it]  9%|▉         | 1157/12375 [5:26:50<48:04:57, 15.43s/it]  9%|▉         | 1158/12375 [5:27:04<46:29:42, 14.92s/it]  9%|▉         | 1159/12375 [5:27:16<43:55:23, 14.10s/it]  9%|▉         | 1160/12375 [5:27:29<42:56:28, 13.78s/it]                                                           9%|▉         | 1160/12375 [5:27:29<42:56:28, 13.78s/it]  9%|▉         | 1161/12375 [5:27:45<44:40:02, 14.34s/it]  9%|▉         | 1162/12375 [5:28:04<49:43:24, 15.96s/it]  9%|▉         | 1163/12375 [5:28:17<46:41:51, 14.99s/it]  9%|▉         | 1164/12375 [5:28:33<47:52:06, 15.37s/it]  9%|▉         | 1165/12375 [5:28:49<48:24:21, 15.55s/it]  9%|▉         | 1166/12375 [5:29:06<49:07:46, 15.78s/it]  9%|▉         | 1167/12375 [5:29:21<48:28:49, 15.57s/it]  9%|▉         | 1168/12375 [5:29:38<50:21:50, 16.18s/it]  9%|▉         | 1169/12375 [5:29:51<46:58:11, 15.09s/it]  9%|▉         | 1170/12375 [5:30:05<46:16:02, 14.86s/it]                                                           9%|▉         | 1170/12375 [5:30:05<46:16:02, 14.86s/it]  9%|▉         | 1171/12375 [5:30:20<46:15:21, 14.86s/it]  9%|▉         | 1172/12375 [5:30:34<45:32:34, 14.63s/it]  9%|▉         | 1173/12375 [5:30:47<43:32:42, 13.99s/it]  9%|▉         | 1174/12375 [5:31:04<46:38:00, 14.99s/it]  9%|▉         | 1175/12375 [5:31:17<44:26:53, 14.29s/it] 10%|▉         | 1176/12375 [5:31:33<46:07:12, 14.83s/it] 10%|▉         | 1177/12375 [5:31:47<45:52:59, 14.75s/it] 10%|▉         | 1178/12375 [5:32:05<48:47:13, 15.69s/it] 10%|▉         | 1179/12375 [5:32:20<48:20:29, 15.54s/it] 10%|▉         | 1180/12375 [5:32:33<45:31:34, 14.64s/it]                                                          10%|▉         | 1180/12375 [5:32:33<45:31:34, 14.64s/it] 10%|▉         | 1181/12375 [5:32:50<47:58:50, 15.43s/it] 10%|▉         | 1182/12375 [5:33:08<50:26:47, 16.23s/it] 10%|▉         | 1183/12375 [5:33:24<50:22:47, 16.21s/it] 10%|▉         | 1184/12375 [5:33:39<49:14:27, 15.84s/it] 10%|▉         | 1185/12375 [5:33:52<45:53:29, 14.76s/it] 10%|▉         | 1186/12375 [5:34:13<51:52:29, 16.69s/it] 10%|▉         | 1187/12375 [5:34:31<52:43:08, 16.96s/it] 10%|▉         | 1188/12375 [5:34:45<50:29:13, 16.25s/it] 10%|▉         | 1189/12375 [5:35:04<53:12:18, 17.12s/it] 10%|▉         | 1190/12375 [5:35:21<52:45:55, 16.98s/it]                                                          10%|▉         | 1190/12375 [5:35:21<52:45:55, 16.98s/it] 10%|▉         | 1191/12375 [5:35:38<53:09:09, 17.11s/it] 10%|▉         | 1192/12375 [5:35:58<55:18:39, 17.81s/it] 10%|▉         | 1193/12375 [5:36:14<53:48:44, 17.32s/it] 10%|▉         | 1194/12375 [5:36:34<56:27:51, 18.18s/it] 10%|▉         | 1195/12375 [5:36:51<55:03:10, 17.73s/it] 10%|▉         | 1196/12375 [5:37:08<54:44:13, 17.63s/it] 10%|▉         | 1197/12375 [5:37:26<55:14:24, 17.79s/it] 10%|▉         | 1198/12375 [5:37:46<56:39:34, 18.25s/it] 10%|▉         | 1199/12375 [5:38:02<54:29:21, 17.55s/it] 10%|▉         | 1200/12375 [5:38:14<49:36:06, 15.98s/it]                                                          10%|▉         | 1200/12375 [5:38:14<49:36:06, 15.98s/it][INFO|trainer.py:3410] 2024-05-27 15:29:48,484 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1200
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 15:29:48,643 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 15:29:48,643 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1200/special_tokens_map.json
 10%|▉         | 1201/12375 [5:38:27<47:13:10, 15.21s/it] 10%|▉         | 1202/12375 [5:38:48<51:51:06, 16.71s/it] 10%|▉         | 1203/12375 [5:39:05<52:28:18, 16.91s/it] 10%|▉         | 1204/12375 [5:39:30<60:05:14, 19.36s/it] 10%|▉         | 1205/12375 [5:39:45<55:54:37, 18.02s/it] 10%|▉         | 1206/12375 [5:40:03<55:35:53, 17.92s/it] 10%|▉         | 1207/12375 [5:40:18<53:18:52, 17.19s/it] 10%|▉         | 1208/12375 [5:40:36<54:02:24, 17.42s/it] 10%|▉         | 1209/12375 [5:40:50<50:54:15, 16.41s/it] 10%|▉         | 1210/12375 [5:41:01<46:02:48, 14.85s/it]                                                          10%|▉         | 1210/12375 [5:41:01<46:02:48, 14.85s/it] 10%|▉         | 1211/12375 [5:41:23<52:12:38, 16.84s/it] 10%|▉         | 1212/12375 [5:41:39<51:15:25, 16.53s/it] 10%|▉         | 1213/12375 [5:41:59<54:41:49, 17.64s/it] 10%|▉         | 1214/12375 [5:42:12<50:22:21, 16.25s/it] 10%|▉         | 1215/12375 [5:42:25<47:23:58, 15.29s/it] 10%|▉         | 1216/12375 [5:42:40<47:28:16, 15.31s/it] 10%|▉         | 1217/12375 [5:42:55<47:04:48, 15.19s/it] 10%|▉         | 1218/12375 [5:43:08<45:12:22, 14.59s/it] 10%|▉         | 1219/12375 [5:43:23<45:36:45, 14.72s/it] 10%|▉         | 1220/12375 [5:43:45<52:09:19, 16.83s/it]                                                          10%|▉         | 1220/12375 [5:43:45<52:09:19, 16.83s/it] 10%|▉         | 1221/12375 [5:44:02<52:11:49, 16.85s/it] 10%|▉         | 1222/12375 [5:44:21<53:49:11, 17.37s/it] 10%|▉         | 1223/12375 [5:44:39<54:31:45, 17.60s/it] 10%|▉         | 1224/12375 [5:44:53<51:39:33, 16.68s/it] 10%|▉         | 1225/12375 [5:45:11<52:44:39, 17.03s/it] 10%|▉         | 1226/12375 [5:45:28<52:17:54, 16.89s/it] 10%|▉         | 1227/12375 [5:45:43<50:50:06, 16.42s/it] 10%|▉         | 1228/12375 [5:45:59<50:50:44, 16.42s/it] 10%|▉         | 1229/12375 [5:46:17<51:49:01, 16.74s/it] 10%|▉         | 1230/12375 [5:46:34<52:35:08, 16.99s/it]                                                          10%|▉         | 1230/12375 [5:46:34<52:35:08, 16.99s/it] 10%|▉         | 1231/12375 [5:46:50<51:40:52, 16.70s/it] 10%|▉         | 1232/12375 [5:47:05<49:17:46, 15.93s/it] 10%|▉         | 1233/12375 [5:47:20<48:52:00, 15.79s/it] 10%|▉         | 1234/12375 [5:47:37<50:17:35, 16.25s/it] 10%|▉         | 1235/12375 [5:47:54<50:12:12, 16.22s/it] 10%|▉         | 1236/12375 [5:48:11<51:21:41, 16.60s/it] 10%|▉         | 1237/12375 [5:48:30<53:30:35, 17.30s/it] 10%|█         | 1238/12375 [5:48:45<51:29:43, 16.65s/it] 10%|█         | 1239/12375 [5:49:00<50:15:06, 16.25s/it] 10%|█         | 1240/12375 [5:49:19<52:00:20, 16.81s/it]                                                          10%|█         | 1240/12375 [5:49:19<52:00:20, 16.81s/it] 10%|█         | 1241/12375 [5:49:34<50:25:47, 16.31s/it] 10%|█         | 1242/12375 [5:49:49<49:39:55, 16.06s/it] 10%|█         | 1243/12375 [5:50:05<49:47:47, 16.10s/it] 10%|█         | 1244/12375 [5:50:24<51:57:14, 16.80s/it] 10%|█         | 1245/12375 [5:50:44<55:07:24, 17.83s/it] 10%|█         | 1246/12375 [5:51:03<55:52:54, 18.08s/it] 10%|█         | 1247/12375 [5:51:21<56:11:12, 18.18s/it] 10%|█         | 1248/12375 [5:51:32<49:37:09, 16.05s/it] 10%|█         | 1249/12375 [5:51:47<48:31:01, 15.70s/it] 10%|█         | 1250/12375 [5:52:04<49:30:43, 16.02s/it]                                                          10%|█         | 1250/12375 [5:52:04<49:30:43, 16.02s/it] 10%|█         | 1251/12375 [5:52:22<51:07:11, 16.54s/it] 10%|█         | 1252/12375 [5:52:42<54:44:05, 17.72s/it] 10%|█         | 1253/12375 [5:53:01<55:58:32, 18.12s/it] 10%|█         | 1254/12375 [5:53:15<52:31:01, 17.00s/it] 10%|█         | 1255/12375 [5:53:29<49:41:31, 16.09s/it] 10%|█         | 1256/12375 [5:53:42<46:15:40, 14.98s/it] 10%|█         | 1257/12375 [5:53:55<44:51:17, 14.52s/it] 10%|█         | 1258/12375 [5:54:12<46:43:39, 15.13s/it] 10%|█         | 1259/12375 [5:54:28<47:37:39, 15.42s/it] 10%|█         | 1260/12375 [5:54:45<49:12:22, 15.94s/it]                                                          10%|█         | 1260/12375 [5:54:45<49:12:22, 15.94s/it] 10%|█         | 1261/12375 [5:55:06<54:02:50, 17.51s/it] 10%|█         | 1262/12375 [5:55:25<54:51:16, 17.77s/it] 10%|█         | 1263/12375 [5:55:40<52:19:54, 16.95s/it] 10%|█         | 1264/12375 [5:55:53<49:13:23, 15.95s/it] 10%|█         | 1265/12375 [5:56:09<49:05:27, 15.91s/it] 10%|█         | 1266/12375 [5:56:23<46:48:51, 15.17s/it] 10%|█         | 1267/12375 [5:56:38<46:45:02, 15.15s/it] 10%|█         | 1268/12375 [5:57:04<56:48:08, 18.41s/it] 10%|█         | 1269/12375 [5:57:22<56:19:34, 18.26s/it] 10%|█         | 1270/12375 [5:57:38<54:12:28, 17.57s/it]                                                          10%|█         | 1270/12375 [5:57:38<54:12:28, 17.57s/it] 10%|█         | 1271/12375 [5:57:54<52:51:00, 17.13s/it] 10%|█         | 1272/12375 [5:58:11<53:30:26, 17.35s/it] 10%|█         | 1273/12375 [5:58:28<52:32:25, 17.04s/it] 10%|█         | 1274/12375 [5:58:44<51:31:50, 16.71s/it] 10%|█         | 1275/12375 [5:58:58<49:42:17, 16.12s/it] 10%|█         | 1276/12375 [5:59:12<47:27:38, 15.39s/it] 10%|█         | 1277/12375 [5:59:33<52:55:56, 17.17s/it] 10%|█         | 1278/12375 [5:59:52<53:52:48, 17.48s/it] 10%|█         | 1279/12375 [6:00:06<50:46:42, 16.47s/it] 10%|█         | 1280/12375 [6:00:22<50:10:55, 16.28s/it]                                                          10%|█         | 1280/12375 [6:00:22<50:10:55, 16.28s/it] 10%|█         | 1281/12375 [6:00:35<47:41:24, 15.48s/it] 10%|█         | 1282/12375 [6:00:51<47:42:34, 15.48s/it] 10%|█         | 1283/12375 [6:01:07<48:11:36, 15.64s/it] 10%|█         | 1284/12375 [6:01:19<44:46:44, 14.53s/it] 10%|█         | 1285/12375 [6:01:37<48:21:39, 15.70s/it] 10%|█         | 1286/12375 [6:01:56<51:09:22, 16.61s/it] 10%|█         | 1287/12375 [6:02:11<49:35:55, 16.10s/it] 10%|█         | 1288/12375 [6:02:27<49:47:26, 16.17s/it] 10%|█         | 1289/12375 [6:02:43<49:39:11, 16.12s/it] 10%|█         | 1290/12375 [6:03:00<50:16:11, 16.33s/it]                                                          10%|█         | 1290/12375 [6:03:00<50:16:11, 16.33s/it] 10%|█         | 1291/12375 [6:03:16<50:12:06, 16.31s/it] 10%|█         | 1292/12375 [6:03:31<48:51:00, 15.87s/it] 10%|█         | 1293/12375 [6:03:49<51:14:57, 16.65s/it] 10%|█         | 1294/12375 [6:04:05<50:11:52, 16.31s/it] 10%|█         | 1295/12375 [6:04:19<47:41:38, 15.50s/it] 10%|█         | 1296/12375 [6:04:35<48:32:13, 15.77s/it] 10%|█         | 1297/12375 [6:04:53<50:17:10, 16.34s/it] 10%|█         | 1298/12375 [6:05:09<50:06:55, 16.29s/it] 10%|█         | 1299/12375 [6:05:27<51:42:54, 16.81s/it] 11%|█         | 1300/12375 [6:05:40<48:42:20, 15.83s/it]                                                          11%|█         | 1300/12375 [6:05:40<48:42:20, 15.83s/it][INFO|trainer.py:3410] 2024-05-27 15:57:15,009 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1300
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 15:57:15,172 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 15:57:15,172 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1300/special_tokens_map.json
 11%|█         | 1301/12375 [6:05:58<50:35:37, 16.45s/it] 11%|█         | 1302/12375 [6:06:14<49:27:29, 16.08s/it] 11%|█         | 1303/12375 [6:06:28<48:23:39, 15.74s/it] 11%|█         | 1304/12375 [6:06:41<45:28:30, 14.79s/it] 11%|█         | 1305/12375 [6:07:05<54:09:27, 17.61s/it] 11%|█         | 1306/12375 [6:07:24<54:48:54, 17.83s/it] 11%|█         | 1307/12375 [6:07:41<54:02:29, 17.58s/it] 11%|█         | 1308/12375 [6:07:56<51:52:53, 16.88s/it] 11%|█         | 1309/12375 [6:08:15<53:53:20, 17.53s/it] 11%|█         | 1310/12375 [6:08:32<53:32:58, 17.42s/it]                                                          11%|█         | 1310/12375 [6:08:32<53:32:58, 17.42s/it] 11%|█         | 1311/12375 [6:08:49<53:19:52, 17.35s/it] 11%|█         | 1312/12375 [6:09:04<50:48:20, 16.53s/it] 11%|█         | 1313/12375 [6:09:24<54:16:31, 17.66s/it] 11%|█         | 1314/12375 [6:09:47<59:12:36, 19.27s/it] 11%|█         | 1315/12375 [6:09:59<51:57:42, 16.91s/it] 11%|█         | 1316/12375 [6:10:15<51:43:56, 16.84s/it] 11%|█         | 1317/12375 [6:10:33<52:52:38, 17.21s/it] 11%|█         | 1318/12375 [6:10:52<54:23:24, 17.71s/it] 11%|█         | 1319/12375 [6:11:13<57:20:59, 18.67s/it] 11%|█         | 1320/12375 [6:11:31<56:52:52, 18.52s/it]                                                          11%|█         | 1320/12375 [6:11:31<56:52:52, 18.52s/it] 11%|█         | 1321/12375 [6:11:50<57:07:23, 18.60s/it] 11%|█         | 1322/12375 [6:12:04<52:30:59, 17.10s/it] 11%|█         | 1323/12375 [6:12:22<53:48:09, 17.53s/it] 11%|█         | 1324/12375 [6:12:36<50:33:38, 16.47s/it] 11%|█         | 1325/12375 [6:12:54<51:23:05, 16.74s/it] 11%|█         | 1326/12375 [6:13:20<60:12:57, 19.62s/it] 11%|█         | 1327/12375 [6:13:33<54:35:46, 17.79s/it] 11%|█         | 1328/12375 [6:13:53<56:39:07, 18.46s/it] 11%|█         | 1329/12375 [6:14:10<55:07:30, 17.97s/it] 11%|█         | 1330/12375 [6:14:26<52:40:07, 17.17s/it]                                                          11%|█         | 1330/12375 [6:14:26<52:40:07, 17.17s/it] 11%|█         | 1331/12375 [6:14:40<49:53:57, 16.27s/it] 11%|█         | 1332/12375 [6:14:59<52:18:06, 17.05s/it] 11%|█         | 1333/12375 [6:15:11<48:25:59, 15.79s/it] 11%|█         | 1334/12375 [6:15:26<47:34:59, 15.51s/it] 11%|█         | 1335/12375 [6:15:39<45:18:31, 14.77s/it] 11%|█         | 1336/12375 [6:15:56<46:31:35, 15.17s/it] 11%|█         | 1337/12375 [6:16:12<47:23:21, 15.46s/it] 11%|█         | 1338/12375 [6:16:23<43:36:38, 14.22s/it] 11%|█         | 1339/12375 [6:16:36<42:16:21, 13.79s/it] 11%|█         | 1340/12375 [6:16:53<45:13:14, 14.75s/it]                                                          11%|█         | 1340/12375 [6:16:53<45:13:14, 14.75s/it] 11%|█         | 1341/12375 [6:17:05<43:04:52, 14.06s/it] 11%|█         | 1342/12375 [6:17:20<43:34:46, 14.22s/it] 11%|█         | 1343/12375 [6:17:35<44:45:50, 14.61s/it] 11%|█         | 1344/12375 [6:17:50<44:24:06, 14.49s/it] 11%|█         | 1345/12375 [6:18:06<46:34:58, 15.20s/it] 11%|█         | 1346/12375 [6:18:21<45:59:26, 15.01s/it] 11%|█         | 1347/12375 [6:18:34<44:01:08, 14.37s/it] 11%|█         | 1348/12375 [6:18:47<42:50:19, 13.99s/it] 11%|█         | 1349/12375 [6:18:59<41:14:10, 13.46s/it] 11%|█         | 1350/12375 [6:19:20<47:39:22, 15.56s/it]                                                          11%|█         | 1350/12375 [6:19:20<47:39:22, 15.56s/it] 11%|█         | 1351/12375 [6:19:36<48:44:39, 15.92s/it] 11%|█         | 1352/12375 [6:19:56<51:43:53, 16.89s/it] 11%|█         | 1353/12375 [6:20:09<48:44:57, 15.92s/it] 11%|█         | 1354/12375 [6:20:30<52:59:43, 17.31s/it] 11%|█         | 1355/12375 [6:20:44<49:44:13, 16.25s/it] 11%|█         | 1356/12375 [6:21:08<57:15:35, 18.71s/it] 11%|█         | 1357/12375 [6:21:22<53:22:47, 17.44s/it] 11%|█         | 1358/12375 [6:21:42<54:54:36, 17.94s/it] 11%|█         | 1359/12375 [6:21:59<54:29:31, 17.81s/it] 11%|█         | 1360/12375 [6:22:20<57:10:55, 18.69s/it]                                                          11%|█         | 1360/12375 [6:22:20<57:10:55, 18.69s/it] 11%|█         | 1361/12375 [6:22:36<55:02:35, 17.99s/it] 11%|█         | 1362/12375 [6:22:51<51:45:31, 16.92s/it] 11%|█         | 1363/12375 [6:23:09<52:44:24, 17.24s/it] 11%|█         | 1364/12375 [6:23:21<48:00:37, 15.70s/it] 11%|█         | 1365/12375 [6:23:37<48:10:08, 15.75s/it] 11%|█         | 1366/12375 [6:23:51<47:23:24, 15.50s/it] 11%|█         | 1367/12375 [6:24:09<49:33:11, 16.21s/it] 11%|█         | 1368/12375 [6:24:25<48:47:32, 15.96s/it] 11%|█         | 1369/12375 [6:24:44<52:02:12, 17.02s/it] 11%|█         | 1370/12375 [6:25:01<52:16:42, 17.10s/it]                                                          11%|█         | 1370/12375 [6:25:01<52:16:42, 17.10s/it] 11%|█         | 1371/12375 [6:25:16<50:04:27, 16.38s/it] 11%|█         | 1372/12375 [6:25:28<45:37:53, 14.93s/it] 11%|█         | 1373/12375 [6:25:43<45:43:46, 14.96s/it] 11%|█         | 1374/12375 [6:25:55<43:35:48, 14.27s/it] 11%|█         | 1375/12375 [6:26:11<44:27:47, 14.55s/it] 11%|█         | 1376/12375 [6:26:24<43:38:46, 14.29s/it] 11%|█         | 1377/12375 [6:26:41<45:37:39, 14.94s/it] 11%|█         | 1378/12375 [6:26:59<48:43:58, 15.95s/it] 11%|█         | 1379/12375 [6:27:12<46:04:55, 15.09s/it] 11%|█         | 1380/12375 [6:27:28<46:55:52, 15.37s/it]                                                          11%|█         | 1380/12375 [6:27:28<46:55:52, 15.37s/it] 11%|█         | 1381/12375 [6:27:45<48:26:17, 15.86s/it] 11%|█         | 1382/12375 [6:28:01<48:45:50, 15.97s/it] 11%|█         | 1383/12375 [6:28:20<50:53:13, 16.67s/it] 11%|█         | 1384/12375 [6:28:35<49:43:31, 16.29s/it] 11%|█         | 1385/12375 [6:28:56<53:33:50, 17.55s/it] 11%|█         | 1386/12375 [6:29:08<49:16:02, 16.14s/it] 11%|█         | 1387/12375 [6:29:31<55:13:36, 18.09s/it] 11%|█         | 1388/12375 [6:29:47<53:40:44, 17.59s/it] 11%|█         | 1389/12375 [6:30:03<51:59:15, 17.04s/it] 11%|█         | 1390/12375 [6:30:17<49:25:56, 16.20s/it]                                                          11%|█         | 1390/12375 [6:30:17<49:25:56, 16.20s/it] 11%|█         | 1391/12375 [6:30:33<48:53:38, 16.02s/it] 11%|█         | 1392/12375 [6:30:50<49:56:35, 16.37s/it] 11%|█▏        | 1393/12375 [6:31:08<50:57:28, 16.70s/it] 11%|█▏        | 1394/12375 [6:31:25<51:21:32, 16.84s/it] 11%|█▏        | 1395/12375 [6:31:41<50:44:10, 16.63s/it] 11%|█▏        | 1396/12375 [6:32:00<52:35:04, 17.24s/it] 11%|█▏        | 1397/12375 [6:32:18<53:21:26, 17.50s/it] 11%|█▏        | 1398/12375 [6:32:32<50:34:20, 16.59s/it] 11%|█▏        | 1399/12375 [6:32:53<54:16:49, 17.80s/it] 11%|█▏        | 1400/12375 [6:33:09<52:55:18, 17.36s/it]                                                          11%|█▏        | 1400/12375 [6:33:09<52:55:18, 17.36s/it][INFO|trainer.py:3410] 2024-05-27 16:24:43,808 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1400
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 16:24:43,969 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 16:24:43,969 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1400/special_tokens_map.json
 11%|█▏        | 1401/12375 [6:33:24<50:20:54, 16.52s/it] 11%|█▏        | 1402/12375 [6:33:40<50:28:33, 16.56s/it] 11%|█▏        | 1403/12375 [6:33:55<48:11:20, 15.81s/it] 11%|█▏        | 1404/12375 [6:34:16<53:40:40, 17.61s/it] 11%|█▏        | 1405/12375 [6:34:33<52:37:21, 17.27s/it] 11%|█▏        | 1406/12375 [6:34:48<50:58:51, 16.73s/it] 11%|█▏        | 1407/12375 [6:35:06<51:44:47, 16.98s/it] 11%|█▏        | 1408/12375 [6:35:23<52:16:56, 17.16s/it] 11%|█▏        | 1409/12375 [6:35:40<51:18:51, 16.85s/it] 11%|█▏        | 1410/12375 [6:35:54<49:25:48, 16.23s/it]                                                          11%|█▏        | 1410/12375 [6:35:54<49:25:48, 16.23s/it] 11%|█▏        | 1411/12375 [6:36:10<48:33:19, 15.94s/it] 11%|█▏        | 1412/12375 [6:36:30<52:42:24, 17.31s/it] 11%|█▏        | 1413/12375 [6:36:48<52:54:09, 17.37s/it] 11%|█▏        | 1414/12375 [6:37:03<51:04:54, 16.78s/it] 11%|█▏        | 1415/12375 [6:37:16<47:48:08, 15.70s/it] 11%|█▏        | 1416/12375 [6:37:28<44:33:58, 14.64s/it] 11%|█▏        | 1417/12375 [6:37:41<43:05:41, 14.16s/it] 11%|█▏        | 1418/12375 [6:38:01<48:04:06, 15.79s/it] 11%|█▏        | 1419/12375 [6:38:18<49:26:58, 16.25s/it] 11%|█▏        | 1420/12375 [6:38:31<45:55:09, 15.09s/it]                                                          11%|█▏        | 1420/12375 [6:38:31<45:55:09, 15.09s/it] 11%|█▏        | 1421/12375 [6:38:50<50:06:14, 16.47s/it] 11%|█▏        | 1422/12375 [6:39:12<54:49:33, 18.02s/it] 11%|█▏        | 1423/12375 [6:39:29<54:12:50, 17.82s/it] 12%|█▏        | 1424/12375 [6:39:43<50:33:23, 16.62s/it] 12%|█▏        | 1425/12375 [6:39:58<48:40:47, 16.00s/it] 12%|█▏        | 1426/12375 [6:40:13<48:17:45, 15.88s/it] 12%|█▏        | 1427/12375 [6:40:31<50:20:19, 16.55s/it] 12%|█▏        | 1428/12375 [6:40:45<47:39:33, 15.67s/it] 12%|█▏        | 1429/12375 [6:41:01<47:58:32, 15.78s/it] 12%|█▏        | 1430/12375 [6:41:24<54:12:17, 17.83s/it]                                                          12%|█▏        | 1430/12375 [6:41:24<54:12:17, 17.83s/it] 12%|█▏        | 1431/12375 [6:41:36<49:11:02, 16.18s/it] 12%|█▏        | 1432/12375 [6:41:54<51:01:11, 16.78s/it] 12%|█▏        | 1433/12375 [6:42:08<48:37:21, 16.00s/it] 12%|█▏        | 1434/12375 [6:42:28<51:42:58, 17.02s/it] 12%|█▏        | 1435/12375 [6:42:42<49:10:47, 16.18s/it] 12%|█▏        | 1436/12375 [6:42:55<45:50:07, 15.08s/it] 12%|█▏        | 1437/12375 [6:43:08<44:17:35, 14.58s/it] 12%|█▏        | 1438/12375 [6:43:21<42:31:44, 14.00s/it] 12%|█▏        | 1439/12375 [6:43:37<44:31:58, 14.66s/it] 12%|█▏        | 1440/12375 [6:43:51<43:44:47, 14.40s/it]                                                          12%|█▏        | 1440/12375 [6:43:51<43:44:47, 14.40s/it] 12%|█▏        | 1441/12375 [6:44:08<46:46:21, 15.40s/it] 12%|█▏        | 1442/12375 [6:44:27<49:38:55, 16.35s/it] 12%|█▏        | 1443/12375 [6:44:44<50:29:57, 16.63s/it] 12%|█▏        | 1444/12375 [6:44:56<45:40:01, 15.04s/it] 12%|█▏        | 1445/12375 [6:45:07<42:16:49, 13.93s/it] 12%|█▏        | 1446/12375 [6:45:24<44:47:48, 14.76s/it] 12%|█▏        | 1447/12375 [6:45:38<44:56:52, 14.81s/it] 12%|█▏        | 1448/12375 [6:45:55<46:33:58, 15.34s/it] 12%|█▏        | 1449/12375 [6:46:15<50:42:11, 16.71s/it] 12%|█▏        | 1450/12375 [6:46:32<51:13:21, 16.88s/it]                                                          12%|█▏        | 1450/12375 [6:46:32<51:13:21, 16.88s/it] 12%|█▏        | 1451/12375 [6:46:51<52:30:09, 17.30s/it] 12%|█▏        | 1452/12375 [6:47:06<50:55:08, 16.78s/it] 12%|█▏        | 1453/12375 [6:47:18<46:23:00, 15.29s/it] 12%|█▏        | 1454/12375 [6:47:38<50:27:41, 16.63s/it] 12%|█▏        | 1455/12375 [6:47:54<50:28:04, 16.64s/it] 12%|█▏        | 1456/12375 [6:48:13<52:15:17, 17.23s/it] 12%|█▏        | 1457/12375 [6:48:30<51:54:06, 17.11s/it] 12%|█▏        | 1458/12375 [6:48:44<49:29:21, 16.32s/it] 12%|█▏        | 1459/12375 [6:48:56<45:30:21, 15.01s/it] 12%|█▏        | 1460/12375 [6:49:13<47:22:06, 15.62s/it]                                                          12%|█▏        | 1460/12375 [6:49:13<47:22:06, 15.62s/it] 12%|█▏        | 1461/12375 [6:49:31<49:07:27, 16.20s/it] 12%|█▏        | 1462/12375 [6:49:54<55:33:15, 18.33s/it] 12%|█▏        | 1463/12375 [6:50:06<49:55:14, 16.47s/it] 12%|█▏        | 1464/12375 [6:50:18<45:14:33, 14.93s/it] 12%|█▏        | 1465/12375 [6:50:36<48:25:36, 15.98s/it] 12%|█▏        | 1466/12375 [6:50:51<47:31:18, 15.68s/it] 12%|█▏        | 1467/12375 [6:51:09<49:20:05, 16.28s/it] 12%|█▏        | 1468/12375 [6:51:32<55:25:13, 18.29s/it] 12%|█▏        | 1469/12375 [6:51:47<52:53:47, 17.46s/it] 12%|█▏        | 1470/12375 [6:52:03<51:15:24, 16.92s/it]                                                          12%|█▏        | 1470/12375 [6:52:03<51:15:24, 16.92s/it] 12%|█▏        | 1471/12375 [6:52:17<48:25:40, 15.99s/it] 12%|█▏        | 1472/12375 [6:52:32<47:42:40, 15.75s/it] 12%|█▏        | 1473/12375 [6:52:47<47:25:50, 15.66s/it] 12%|█▏        | 1474/12375 [6:52:59<43:41:30, 14.43s/it] 12%|█▏        | 1475/12375 [6:53:15<44:58:02, 14.85s/it] 12%|█▏        | 1476/12375 [6:53:28<43:55:59, 14.51s/it] 12%|█▏        | 1477/12375 [6:53:45<46:15:50, 15.28s/it] 12%|█▏        | 1478/12375 [6:53:59<44:20:58, 14.65s/it] 12%|█▏        | 1479/12375 [6:54:18<48:12:38, 15.93s/it] 12%|█▏        | 1480/12375 [6:54:35<49:17:51, 16.29s/it]                                                          12%|█▏        | 1480/12375 [6:54:35<49:17:51, 16.29s/it] 12%|█▏        | 1481/12375 [6:54:49<47:03:19, 15.55s/it] 12%|█▏        | 1482/12375 [6:55:03<46:06:47, 15.24s/it] 12%|█▏        | 1483/12375 [6:55:17<45:23:28, 15.00s/it] 12%|█▏        | 1484/12375 [6:55:39<51:18:10, 16.96s/it] 12%|█▏        | 1485/12375 [6:55:54<49:18:22, 16.30s/it] 12%|█▏        | 1486/12375 [6:56:06<45:41:22, 15.11s/it] 12%|█▏        | 1487/12375 [6:56:23<47:33:00, 15.72s/it] 12%|█▏        | 1488/12375 [6:56:36<44:53:27, 14.84s/it] 12%|█▏        | 1489/12375 [6:56:52<46:06:50, 15.25s/it] 12%|█▏        | 1490/12375 [6:57:08<46:20:12, 15.33s/it]                                                          12%|█▏        | 1490/12375 [6:57:08<46:20:12, 15.33s/it] 12%|█▏        | 1491/12375 [6:57:22<45:25:00, 15.02s/it] 12%|█▏        | 1492/12375 [6:57:40<48:04:21, 15.90s/it] 12%|█▏        | 1493/12375 [6:58:02<53:11:17, 17.60s/it] 12%|█▏        | 1494/12375 [6:58:14<48:09:30, 15.93s/it] 12%|█▏        | 1495/12375 [6:58:28<46:51:53, 15.51s/it] 12%|█▏        | 1496/12375 [6:58:42<45:19:30, 15.00s/it] 12%|█▏        | 1497/12375 [6:58:55<43:32:54, 14.41s/it] 12%|█▏        | 1498/12375 [6:59:08<42:14:48, 13.98s/it] 12%|█▏        | 1499/12375 [6:59:24<43:54:43, 14.54s/it] 12%|█▏        | 1500/12375 [6:59:42<47:23:40, 15.69s/it]                                                          12%|█▏        | 1500/12375 [6:59:42<47:23:40, 15.69s/it][INFO|trainer.py:3719] 2024-05-27 16:51:16,739 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-27 16:51:16,739 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-27 16:51:16,739 >>   Batch size = 32
{'eval_loss': 1.1782910823822021, 'eval_runtime': 559.6265, 'eval_samples_per_second': 8.935, 'eval_steps_per_second': 0.281, 'epoch': 0.08}
{'loss': 0.8417, 'grad_norm': 2.0406086444854736, 'learning_rate': 9.83689130555513e-05, 'epoch': 0.08}
{'loss': 0.8239, 'grad_norm': 1.7043156623840332, 'learning_rate': 9.833660021327356e-05, 'epoch': 0.08}
{'loss': 0.8085, 'grad_norm': 1.6321630477905273, 'learning_rate': 9.830397584648936e-05, 'epoch': 0.08}
{'loss': 0.8764, 'grad_norm': 1.8518633842468262, 'learning_rate': 9.82710401654595e-05, 'epoch': 0.08}
{'loss': 0.8198, 'grad_norm': 1.8723279237747192, 'learning_rate': 9.823779338245109e-05, 'epoch': 0.08}
{'loss': 0.844, 'grad_norm': 2.0004262924194336, 'learning_rate': 9.820423571173629e-05, 'epoch': 0.09}
{'loss': 0.8585, 'grad_norm': 1.9666574001312256, 'learning_rate': 9.817036736959091e-05, 'epoch': 0.09}
{'loss': 0.9068, 'grad_norm': 1.9179257154464722, 'learning_rate': 9.813618857429296e-05, 'epoch': 0.09}
{'loss': 0.8737, 'grad_norm': 1.781967043876648, 'learning_rate': 9.810169954612138e-05, 'epoch': 0.09}
{'loss': 0.9989, 'grad_norm': 2.1748592853546143, 'learning_rate': 9.806690050735441e-05, 'epoch': 0.09}
{'loss': 1.1164, 'grad_norm': 1.9607831239700317, 'learning_rate': 9.803179168226839e-05, 'epoch': 0.09}
{'loss': 1.1415, 'grad_norm': 1.604435682296753, 'learning_rate': 9.799637329713614e-05, 'epoch': 0.09}
{'loss': 1.1045, 'grad_norm': 1.5707076787948608, 'learning_rate': 9.796064558022555e-05, 'epoch': 0.09}
{'loss': 1.1005, 'grad_norm': 1.8299624919891357, 'learning_rate': 9.792460876179819e-05, 'epoch': 0.09}
{'loss': 1.1348, 'grad_norm': 1.7995504140853882, 'learning_rate': 9.788826307410767e-05, 'epoch': 0.09}
{'loss': 1.1061, 'grad_norm': 1.6169909238815308, 'learning_rate': 9.78516087513983e-05, 'epoch': 0.09}
{'loss': 1.1332, 'grad_norm': 1.8187748193740845, 'learning_rate': 9.781464602990349e-05, 'epoch': 0.09}
{'loss': 1.1132, 'grad_norm': 1.4349209070205688, 'learning_rate': 9.777737514784424e-05, 'epoch': 0.1}
{'loss': 1.1087, 'grad_norm': 1.9795163869857788, 'learning_rate': 9.773979634542762e-05, 'epoch': 0.1}
{'loss': 1.1563, 'grad_norm': 1.592546820640564, 'learning_rate': 9.770190986484522e-05, 'epoch': 0.1}
{'loss': 1.1198, 'grad_norm': 2.1586689949035645, 'learning_rate': 9.766371595027158e-05, 'epoch': 0.1}
{'loss': 1.182, 'grad_norm': 1.78475022315979, 'learning_rate': 9.762521484786262e-05, 'epoch': 0.1}
{'loss': 1.0906, 'grad_norm': 1.814029335975647, 'learning_rate': 9.758640680575406e-05, 'epoch': 0.1}
{'loss': 1.1841, 'grad_norm': 1.8377021551132202, 'learning_rate': 9.754729207405981e-05, 'epoch': 0.1}
{'loss': 1.1041, 'grad_norm': 1.6172444820404053, 'learning_rate': 9.750787090487036e-05, 'epoch': 0.1}
{'loss': 1.1326, 'grad_norm': 1.7322157621383667, 'learning_rate': 9.746814355225116e-05, 'epoch': 0.1}
{'loss': 1.1559, 'grad_norm': 1.8310415744781494, 'learning_rate': 9.742811027224101e-05, 'epoch': 0.1}
{'loss': 1.1955, 'grad_norm': 1.5808732509613037, 'learning_rate': 9.738777132285032e-05, 'epoch': 0.1}
{'loss': 1.1573, 'grad_norm': 1.493100643157959, 'learning_rate': 9.734712696405959e-05, 'epoch': 0.1}
{'loss': 1.1293, 'grad_norm': 1.6421756744384766, 'learning_rate': 9.730617745781759e-05, 'epoch': 0.11}
{'loss': 1.133, 'grad_norm': 1.6172820329666138, 'learning_rate': 9.726492306803971e-05, 'epoch': 0.11}
{'loss': 1.1089, 'grad_norm': 1.9786204099655151, 'learning_rate': 9.722336406060637e-05, 'epoch': 0.11}
{'loss': 1.1261, 'grad_norm': 1.560086965560913, 'learning_rate': 9.718150070336118e-05, 'epoch': 0.11}
{'loss': 1.0494, 'grad_norm': 1.6637191772460938, 'learning_rate': 9.713933326610923e-05, 'epoch': 0.11}
{'loss': 1.1138, 'grad_norm': 1.8258562088012695, 'learning_rate': 9.709686202061539e-05, 'epoch': 0.11}
{'loss': 1.1154, 'grad_norm': 1.5903971195220947, 'learning_rate': 9.705408724060256e-05, 'epoch': 0.11}
{'loss': 1.1021, 'grad_norm': 1.888058066368103, 'learning_rate': 9.701100920174986e-05, 'epoch': 0.11}
{'loss': 1.1087, 'grad_norm': 1.7325080633163452, 'learning_rate': 9.696762818169093e-05, 'epoch': 0.11}
{'loss': 1.1298, 'grad_norm': 1.7106530666351318, 'learning_rate': 9.692394446001204e-05, 'epoch': 0.11}
{'loss': 1.1311, 'grad_norm': 1.5418713092803955, 'learning_rate': 9.687995831825036e-05, 'epoch': 0.11}
{'loss': 1.1039, 'grad_norm': 1.6469130516052246, 'learning_rate': 9.683567003989216e-05, 'epoch': 0.11}
{'loss': 1.0737, 'grad_norm': 1.7120914459228516, 'learning_rate': 9.679107991037088e-05, 'epoch': 0.11}
{'loss': 1.0752, 'grad_norm': 1.5275065898895264, 'learning_rate': 9.674618821706545e-05, 'epoch': 0.12}
{'loss': 1.0924, 'grad_norm': 1.9706791639328003, 'learning_rate': 9.670099524929825e-05, 'epoch': 0.12}
{'loss': 1.1561, 'grad_norm': 1.6052333116531372, 'learning_rate': 9.665550129833343e-05, 'epoch': 0.12}
{'loss': 1.118, 'grad_norm': 1.5869200229644775, 'learning_rate': 9.660970665737488e-05, 'epoch': 0.12}
{'loss': 1.1658, 'grad_norm': 1.9747703075408936, 'learning_rate': 9.656361162156446e-05, 'epoch': 0.12}
{'loss': 1.0915, 'grad_norm': 1.8267889022827148, 'learning_rate': 9.651721648798e-05, 'epoch': 0.12}
{'loss': 1.1434, 'grad_norm': 1.9825397729873657, 'learning_rate': 9.647052155563347e-05, 'epoch': 0.12}
{'loss': 1.1182, 'grad_norm': 1.5417091846466064, 'learning_rate': 9.642352712546899e-05, 'epoch': 0.12}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:51,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:09,  2.01s/it][A
  3%|▎         | 4/157 [00:09<06:44,  2.64s/it][A
  3%|▎         | 5/157 [00:14<08:26,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:45,  3.48s/it][A
  4%|▍         | 7/157 [00:21<08:40,  3.47s/it][A
  5%|▌         | 8/157 [00:25<09:15,  3.73s/it][A
  6%|▌         | 9/157 [00:28<08:19,  3.37s/it][A
  6%|▋         | 10/157 [00:31<08:19,  3.40s/it][A
  7%|▋         | 11/157 [00:33<07:30,  3.08s/it][A
  8%|▊         | 12/157 [00:36<07:10,  2.97s/it][A
  8%|▊         | 13/157 [00:39<07:06,  2.97s/it][A
  9%|▉         | 14/157 [00:43<07:32,  3.16s/it][A
 10%|▉         | 15/157 [00:46<07:50,  3.31s/it][A
 10%|█         | 16/157 [00:50<08:19,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:46,  3.33s/it][A
 11%|█▏        | 18/157 [00:56<07:13,  3.12s/it][A
 12%|█▏        | 19/157 [01:00<07:53,  3.43s/it][A
 13%|█▎        | 20/157 [01:04<07:53,  3.46s/it][A
 13%|█▎        | 21/157 [01:07<07:48,  3.45s/it][A
 14%|█▍        | 22/157 [01:10<07:26,  3.31s/it][A
 15%|█▍        | 23/157 [01:13<07:12,  3.23s/it][A
 15%|█▌        | 24/157 [01:17<07:34,  3.42s/it][A
 16%|█▌        | 25/157 [01:20<07:31,  3.42s/it][A
 17%|█▋        | 26/157 [01:24<07:27,  3.42s/it][A
 17%|█▋        | 27/157 [01:29<08:33,  3.95s/it][A
 18%|█▊        | 28/157 [01:33<08:28,  3.94s/it][A
 18%|█▊        | 29/157 [01:36<07:43,  3.62s/it][A
 19%|█▉        | 30/157 [01:39<07:11,  3.40s/it][A
 20%|█▉        | 31/157 [01:42<07:20,  3.49s/it][A
 20%|██        | 32/157 [01:46<07:19,  3.51s/it][A
 21%|██        | 33/157 [01:50<07:39,  3.71s/it][A
 22%|██▏       | 34/157 [01:54<07:48,  3.81s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.72s/it][A
 23%|██▎       | 36/157 [02:02<08:00,  3.97s/it][A
 24%|██▎       | 37/157 [02:06<07:47,  3.89s/it][A
 24%|██▍       | 38/157 [02:10<07:33,  3.81s/it][A
 25%|██▍       | 39/157 [02:13<07:14,  3.68s/it][A
 25%|██▌       | 40/157 [02:16<06:36,  3.39s/it][A
 26%|██▌       | 41/157 [02:19<06:49,  3.53s/it][A
 27%|██▋       | 42/157 [02:25<07:44,  4.04s/it][A
 27%|██▋       | 43/157 [02:27<06:55,  3.65s/it][A
 28%|██▊       | 44/157 [02:31<06:59,  3.71s/it][A
 29%|██▊       | 45/157 [02:34<06:35,  3.53s/it][A
 29%|██▉       | 46/157 [02:37<06:06,  3.30s/it][A
 30%|██▉       | 47/157 [02:40<05:58,  3.26s/it][A
 31%|███       | 48/157 [02:47<07:44,  4.26s/it][A
 31%|███       | 49/157 [02:50<06:49,  3.79s/it][A
 32%|███▏      | 50/157 [02:53<06:23,  3.58s/it][A
 32%|███▏      | 51/157 [02:57<06:28,  3.66s/it][A
 33%|███▎      | 52/157 [03:01<06:32,  3.74s/it][A
 34%|███▍      | 53/157 [03:05<06:57,  4.01s/it][A
 34%|███▍      | 54/157 [03:09<06:34,  3.83s/it][A
 35%|███▌      | 55/157 [03:13<06:47,  3.99s/it][A
 36%|███▌      | 56/157 [03:17<06:49,  4.06s/it][A
 36%|███▋      | 57/157 [03:21<06:45,  4.06s/it][A
 37%|███▋      | 58/157 [03:25<06:25,  3.89s/it][A
 38%|███▊      | 59/157 [03:30<06:48,  4.17s/it][A
 38%|███▊      | 60/157 [03:34<06:40,  4.12s/it][A
 39%|███▉      | 61/157 [03:37<06:19,  3.95s/it][A
 39%|███▉      | 62/157 [03:42<06:37,  4.18s/it][A
 40%|████      | 63/157 [03:45<06:11,  3.95s/it][A
 41%|████      | 64/157 [03:50<06:19,  4.08s/it][A
 41%|████▏     | 65/157 [03:54<06:31,  4.25s/it][A
 42%|████▏     | 66/157 [03:57<05:40,  3.74s/it][A
 43%|████▎     | 67/157 [04:02<06:10,  4.12s/it][A
 43%|████▎     | 68/157 [04:04<05:25,  3.66s/it][A
 44%|████▍     | 69/157 [04:07<05:01,  3.42s/it][A
 45%|████▍     | 70/157 [04:12<05:22,  3.70s/it][A
 45%|████▌     | 71/157 [04:15<05:09,  3.60s/it][A
 46%|████▌     | 72/157 [04:18<04:47,  3.39s/it][A
 46%|████▋     | 73/157 [04:20<04:21,  3.11s/it][A
 47%|████▋     | 74/157 [04:24<04:41,  3.39s/it][A
 48%|████▊     | 75/157 [04:28<04:54,  3.59s/it][A
 48%|████▊     | 76/157 [04:33<05:02,  3.74s/it][A
 49%|████▉     | 77/157 [04:36<04:56,  3.70s/it][A
 50%|████▉     | 78/157 [04:39<04:30,  3.42s/it][A
 50%|█████     | 79/157 [04:44<04:58,  3.83s/it][A
 51%|█████     | 80/157 [04:46<04:29,  3.50s/it][A
 52%|█████▏    | 81/157 [04:49<04:05,  3.23s/it][A
 52%|█████▏    | 82/157 [04:52<04:00,  3.21s/it][A
 53%|█████▎    | 83/157 [04:56<04:15,  3.46s/it][A
 54%|█████▎    | 84/157 [05:00<04:27,  3.66s/it][A
 54%|█████▍    | 85/157 [05:04<04:30,  3.75s/it][A
 55%|█████▍    | 86/157 [05:09<04:45,  4.02s/it][A
 55%|█████▌    | 87/157 [05:13<04:35,  3.93s/it][A
 56%|█████▌    | 88/157 [05:16<04:23,  3.82s/it][A
 57%|█████▋    | 89/157 [05:20<04:09,  3.67s/it][A
 57%|█████▋    | 90/157 [05:24<04:13,  3.78s/it][A
 58%|█████▊    | 91/157 [05:27<04:06,  3.73s/it][A
 59%|█████▊    | 92/157 [05:30<03:47,  3.50s/it][A
 59%|█████▉    | 93/157 [05:35<04:14,  3.98s/it][A
 60%|█████▉    | 94/157 [05:38<03:54,  3.71s/it][A
 61%|██████    | 95/157 [05:42<03:44,  3.61s/it][A
 61%|██████    | 96/157 [05:45<03:32,  3.48s/it][A
 62%|██████▏   | 97/157 [05:48<03:23,  3.38s/it][A
 62%|██████▏   | 98/157 [05:51<03:02,  3.10s/it][A
 63%|██████▎   | 99/157 [05:55<03:16,  3.39s/it][A
 64%|██████▎   | 100/157 [05:58<03:06,  3.28s/it][A
 64%|██████▍   | 101/157 [06:00<02:55,  3.13s/it][A
 65%|██████▍   | 102/157 [06:03<02:49,  3.07s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.90s/it][A
 66%|██████▌   | 104/157 [06:10<02:55,  3.30s/it][A
 67%|██████▋   | 105/157 [06:14<03:03,  3.53s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.86s/it][A
 68%|██████▊   | 107/157 [06:23<03:20,  4.02s/it][A
 69%|██████▉   | 108/157 [06:27<03:14,  3.97s/it][A
 69%|██████▉   | 109/157 [06:31<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:35<03:02,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.48s/it][A
 72%|███████▏  | 113/157 [06:44<02:29,  3.40s/it][A
 73%|███████▎  | 114/157 [06:48<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:57<02:51,  4.18s/it][A
 75%|███████▍  | 117/157 [07:00<02:31,  3.79s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.50s/it][A
 76%|███████▌  | 119/157 [07:06<02:14,  3.54s/it][A
 76%|███████▋  | 120/157 [07:09<02:01,  3.29s/it][A
 77%|███████▋  | 121/157 [07:12<01:54,  3.19s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.33s/it][A
 78%|███████▊  | 123/157 [07:20<01:57,  3.46s/it][A
 79%|███████▉  | 124/157 [07:23<01:55,  3.49s/it][A
 80%|███████▉  | 125/157 [07:26<01:45,  3.29s/it][A
 80%|████████  | 126/157 [07:30<01:47,  3.46s/it][A
 81%|████████  | 127/157 [07:33<01:37,  3.25s/it][A
 82%|████████▏ | 128/157 [07:35<01:29,  3.09s/it][A
 82%|████████▏ | 129/157 [07:38<01:22,  2.93s/it][A
 83%|████████▎ | 130/157 [07:42<01:27,  3.23s/it][A
 83%|████████▎ | 131/157 [07:45<01:25,  3.30s/it][A
 84%|████████▍ | 132/157 [07:49<01:29,  3.59s/it][A
 85%|████████▍ | 133/157 [07:52<01:21,  3.41s/it][A
 85%|████████▌ | 134/157 [07:56<01:17,  3.38s/it][A
 86%|████████▌ | 135/157 [08:00<01:16,  3.50s/it][A
 87%|████████▋ | 136/157 [08:02<01:09,  3.31s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.58s/it][A
 88%|████████▊ | 138/157 [08:10<01:05,  3.45s/it][A
 89%|████████▊ | 139/157 [08:14<01:05,  3.64s/it][A
 89%|████████▉ | 140/157 [08:17<01:00,  3.58s/it][A
 90%|████████▉ | 141/157 [08:20<00:55,  3.44s/it][A
 90%|█████████ | 142/157 [08:24<00:54,  3.63s/it][A
 91%|█████████ | 143/157 [08:29<00:55,  3.96s/it][A
 92%|█████████▏| 144/157 [08:33<00:49,  3.84s/it][A
 92%|█████████▏| 145/157 [08:37<00:48,  4.00s/it][A
 93%|█████████▎| 146/157 [08:41<00:43,  3.92s/it][A
 94%|█████████▎| 147/157 [08:46<00:42,  4.26s/it][A
 94%|█████████▍| 148/157 [08:49<00:35,  3.91s/it][A
 95%|█████████▍| 149/157 [08:53<00:31,  3.95s/it][A
 96%|█████████▌| 150/157 [08:56<00:25,  3.70s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.63s/it][A
 97%|█████████▋| 152/157 [09:03<00:17,  3.48s/it][A
 97%|█████████▋| 153/157 [09:05<00:12,  3.18s/it][A
 98%|█████████▊| 154/157 [09:09<00:09,  3.28s/it][A
 99%|█████████▊| 155/157 [09:11<00:06,  3.01s/it][A
 99%|█████████▉| 156/157 [09:15<00:03,  3.33s/it][A
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A                                                         
                                                 [A 12%|█▏        | 1500/12375 [7:09:02<47:23:40, 15.69s/it]
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-27 17:00:36,433 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1500
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 17:00:36,596 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 17:00:36,596 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1500/special_tokens_map.json
 12%|█▏        | 1501/12375 [7:09:15<552:00:22, 182.75s/it] 12%|█▏        | 1502/12375 [7:09:29<398:54:57, 132.08s/it] 12%|█▏        | 1503/12375 [7:09:45<294:29:26, 97.51s/it]  12%|█▏        | 1504/12375 [7:09:57<216:34:29, 71.72s/it] 12%|█▏        | 1505/12375 [7:10:10<162:58:56, 53.98s/it] 12%|█▏        | 1506/12375 [7:10:22<125:37:29, 41.61s/it] 12%|█▏        | 1507/12375 [7:10:41<104:40:55, 34.68s/it] 12%|█▏        | 1508/12375 [7:11:01<91:38:01, 30.36s/it]  12%|█▏        | 1509/12375 [7:11:20<80:56:05, 26.81s/it] 12%|█▏        | 1510/12375 [7:11:38<73:31:35, 24.36s/it]                                                          12%|█▏        | 1510/12375 [7:11:38<73:31:35, 24.36s/it] 12%|█▏        | 1511/12375 [7:11:52<63:40:33, 21.10s/it] 12%|█▏        | 1512/12375 [7:12:03<54:30:37, 18.06s/it] 12%|█▏        | 1513/12375 [7:12:21<54:21:24, 18.02s/it] 12%|█▏        | 1514/12375 [7:12:40<55:33:32, 18.42s/it] 12%|█▏        | 1515/12375 [7:12:59<56:18:02, 18.66s/it] 12%|█▏        | 1516/12375 [7:13:14<52:51:06, 17.52s/it] 12%|█▏        | 1517/12375 [7:13:25<47:09:54, 15.64s/it] 12%|█▏        | 1518/12375 [7:13:45<50:44:52, 16.83s/it] 12%|█▏        | 1519/12375 [7:14:05<53:33:31, 17.76s/it] 12%|█▏        | 1520/12375 [7:14:21<52:29:32, 17.41s/it]                                                          12%|█▏        | 1520/12375 [7:14:21<52:29:32, 17.41s/it] 12%|█▏        | 1521/12375 [7:14:36<49:58:58, 16.58s/it] 12%|█▏        | 1522/12375 [7:14:52<49:36:17, 16.45s/it] 12%|█▏        | 1523/12375 [7:15:09<49:54:05, 16.55s/it] 12%|█▏        | 1524/12375 [7:15:26<50:22:50, 16.71s/it] 12%|█▏        | 1525/12375 [7:15:40<47:59:35, 15.92s/it] 12%|█▏        | 1526/12375 [7:15:56<47:53:57, 15.89s/it] 12%|█▏        | 1527/12375 [7:16:12<48:22:02, 16.05s/it] 12%|█▏        | 1528/12375 [7:16:27<46:58:01, 15.59s/it] 12%|█▏        | 1529/12375 [7:16:44<47:58:03, 15.92s/it] 12%|█▏        | 1530/12375 [7:17:01<49:07:28, 16.31s/it]                                                          12%|█▏        | 1530/12375 [7:17:01<49:07:28, 16.31s/it] 12%|█▏        | 1531/12375 [7:17:16<47:47:10, 15.86s/it] 12%|█▏        | 1532/12375 [7:17:34<50:15:25, 16.69s/it] 12%|█▏        | 1533/12375 [7:17:48<47:09:17, 15.66s/it] 12%|█▏        | 1534/12375 [7:18:03<47:03:28, 15.63s/it] 12%|█▏        | 1535/12375 [7:18:18<45:56:29, 15.26s/it] 12%|█▏        | 1536/12375 [7:18:29<42:58:20, 14.27s/it] 12%|█▏        | 1537/12375 [7:18:46<45:19:25, 15.05s/it] 12%|█▏        | 1538/12375 [7:19:07<50:45:04, 16.86s/it] 12%|█▏        | 1539/12375 [7:19:22<49:03:55, 16.30s/it] 12%|█▏        | 1540/12375 [7:19:34<44:33:07, 14.80s/it]                                                          12%|█▏        | 1540/12375 [7:19:34<44:33:07, 14.80s/it] 12%|█▏        | 1541/12375 [7:19:51<46:45:52, 15.54s/it] 12%|█▏        | 1542/12375 [7:20:10<50:03:23, 16.63s/it] 12%|█▏        | 1543/12375 [7:20:28<50:42:19, 16.85s/it] 12%|█▏        | 1544/12375 [7:20:45<51:07:21, 16.99s/it] 12%|█▏        | 1545/12375 [7:21:01<50:04:09, 16.64s/it] 12%|█▏        | 1546/12375 [7:21:15<48:13:28, 16.03s/it] 13%|█▎        | 1547/12375 [7:21:33<49:42:56, 16.53s/it] 13%|█▎        | 1548/12375 [7:21:48<47:58:36, 15.95s/it] 13%|█▎        | 1549/12375 [7:22:03<47:27:41, 15.78s/it] 13%|█▎        | 1550/12375 [7:22:20<48:38:09, 16.17s/it]                                                          13%|█▎        | 1550/12375 [7:22:20<48:38:09, 16.17s/it] 13%|█▎        | 1551/12375 [7:22:38<50:28:39, 16.79s/it] 13%|█▎        | 1552/12375 [7:22:52<48:06:18, 16.00s/it] 13%|█▎        | 1553/12375 [7:23:11<50:28:05, 16.79s/it] 13%|█▎        | 1554/12375 [7:23:34<55:45:04, 18.55s/it] 13%|█▎        | 1555/12375 [7:23:52<55:03:19, 18.32s/it] 13%|█▎        | 1556/12375 [7:24:03<49:05:55, 16.34s/it] 13%|█▎        | 1557/12375 [7:24:15<45:04:20, 15.00s/it] 13%|█▎        | 1558/12375 [7:24:33<47:17:49, 15.74s/it] 13%|█▎        | 1559/12375 [7:24:47<45:50:13, 15.26s/it] 13%|█▎        | 1560/12375 [7:25:03<46:50:13, 15.59s/it]                                                          13%|█▎        | 1560/12375 [7:25:03<46:50:13, 15.59s/it] 13%|█▎        | 1561/12375 [7:25:19<46:59:29, 15.64s/it] 13%|█▎        | 1562/12375 [7:25:33<45:52:34, 15.27s/it] 13%|█▎        | 1563/12375 [7:25:46<43:54:26, 14.62s/it] 13%|█▎        | 1564/12375 [7:26:01<44:05:54, 14.68s/it] 13%|█▎        | 1565/12375 [7:26:15<43:17:05, 14.41s/it] 13%|█▎        | 1566/12375 [7:26:33<46:38:47, 15.54s/it] 13%|█▎        | 1567/12375 [7:26:44<42:51:35, 14.28s/it] 13%|█▎        | 1568/12375 [7:27:00<44:03:52, 14.68s/it] 13%|█▎        | 1569/12375 [7:27:12<41:54:56, 13.96s/it] 13%|█▎        | 1570/12375 [7:27:27<42:46:44, 14.25s/it]                                                          13%|█▎        | 1570/12375 [7:27:27<42:46:44, 14.25s/it] 13%|█▎        | 1571/12375 [7:27:41<42:36:40, 14.20s/it] 13%|█▎        | 1572/12375 [7:27:58<44:56:51, 14.98s/it] 13%|█▎        | 1573/12375 [7:28:12<44:16:53, 14.76s/it] 13%|█▎        | 1574/12375 [7:28:25<42:04:18, 14.02s/it] 13%|█▎        | 1575/12375 [7:28:41<43:55:45, 14.64s/it] 13%|█▎        | 1576/12375 [7:28:53<41:22:27, 13.79s/it] 13%|█▎        | 1577/12375 [7:29:10<45:00:03, 15.00s/it] 13%|█▎        | 1578/12375 [7:29:26<45:29:01, 15.17s/it] 13%|█▎        | 1579/12375 [7:29:40<44:12:25, 14.74s/it] 13%|█▎        | 1580/12375 [7:30:03<51:48:20, 17.28s/it]                                                          13%|█▎        | 1580/12375 [7:30:03<51:48:20, 17.28s/it] 13%|█▎        | 1581/12375 [7:30:17<48:50:35, 16.29s/it] 13%|█▎        | 1582/12375 [7:30:33<48:22:45, 16.14s/it] 13%|█▎        | 1583/12375 [7:30:52<51:13:04, 17.09s/it] 13%|█▎        | 1584/12375 [7:31:12<54:10:53, 18.08s/it] 13%|█▎        | 1585/12375 [7:31:25<49:13:51, 16.43s/it] 13%|█▎        | 1586/12375 [7:31:42<49:26:43, 16.50s/it] 13%|█▎        | 1587/12375 [7:31:53<44:52:15, 14.97s/it] 13%|█▎        | 1588/12375 [7:32:14<50:16:03, 16.78s/it] 13%|█▎        | 1589/12375 [7:32:29<48:50:57, 16.30s/it] 13%|█▎        | 1590/12375 [7:32:43<46:50:21, 15.63s/it]                                                          13%|█▎        | 1590/12375 [7:32:43<46:50:21, 15.63s/it] 13%|█▎        | 1591/12375 [7:32:57<45:15:15, 15.11s/it] 13%|█▎        | 1592/12375 [7:33:14<47:08:14, 15.74s/it] 13%|█▎        | 1593/12375 [7:33:33<49:34:55, 16.55s/it] 13%|█▎        | 1594/12375 [7:33:53<52:53:29, 17.66s/it] 13%|█▎        | 1595/12375 [7:34:11<53:13:41, 17.78s/it] 13%|█▎        | 1596/12375 [7:34:27<51:11:53, 17.10s/it] 13%|█▎        | 1597/12375 [7:34:47<54:02:49, 18.05s/it] 13%|█▎        | 1598/12375 [7:35:02<51:12:05, 17.10s/it] 13%|█▎        | 1599/12375 [7:35:18<49:58:08, 16.69s/it] 13%|█▎        | 1600/12375 [7:35:38<52:53:22, 17.67s/it]                                                          13%|█▎        | 1600/12375 [7:35:38<52:53:22, 17.67s/it][INFO|trainer.py:3410] 2024-05-27 17:27:12,080 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1600
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 17:27:12,247 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 17:27:12,248 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1600/special_tokens_map.json
 13%|█▎        | 1601/12375 [7:35:56<53:20:03, 17.82s/it] 13%|█▎        | 1602/12375 [7:36:10<50:09:30, 16.76s/it] 13%|█▎        | 1603/12375 [7:36:23<47:03:03, 15.72s/it] 13%|█▎        | 1604/12375 [7:36:40<48:20:14, 16.16s/it] 13%|█▎        | 1605/12375 [7:37:06<57:07:40, 19.10s/it] 13%|█▎        | 1606/12375 [7:37:22<53:55:40, 18.03s/it] 13%|█▎        | 1607/12375 [7:37:37<51:40:05, 17.27s/it] 13%|█▎        | 1608/12375 [7:37:54<50:40:57, 16.95s/it] 13%|█▎        | 1609/12375 [7:38:05<46:04:56, 15.41s/it] 13%|█▎        | 1610/12375 [7:38:19<44:44:38, 14.96s/it]                                                          13%|█▎        | 1610/12375 [7:38:19<44:44:38, 14.96s/it] 13%|█▎        | 1611/12375 [7:38:31<42:02:52, 14.06s/it] 13%|█▎        | 1612/12375 [7:38:47<43:38:55, 14.60s/it] 13%|█▎        | 1613/12375 [7:39:02<43:43:27, 14.63s/it] 13%|█▎        | 1614/12375 [7:39:13<40:46:03, 13.64s/it] 13%|█▎        | 1615/12375 [7:39:30<43:31:54, 14.56s/it] 13%|█▎        | 1616/12375 [7:39:46<44:49:24, 15.00s/it] 13%|█▎        | 1617/12375 [7:40:01<44:38:08, 14.94s/it] 13%|█▎        | 1618/12375 [7:40:17<45:51:46, 15.35s/it] 13%|█▎        | 1619/12375 [7:40:32<45:24:44, 15.20s/it] 13%|█▎        | 1620/12375 [7:40:49<47:23:03, 15.86s/it]                                                          13%|█▎        | 1620/12375 [7:40:49<47:23:03, 15.86s/it] 13%|█▎        | 1621/12375 [7:41:09<51:13:38, 17.15s/it] 13%|█▎        | 1622/12375 [7:41:24<48:51:14, 16.36s/it] 13%|█▎        | 1623/12375 [7:41:41<49:25:36, 16.55s/it] 13%|█▎        | 1624/12375 [7:41:58<50:13:46, 16.82s/it] 13%|█▎        | 1625/12375 [7:42:18<52:32:56, 17.60s/it] 13%|█▎        | 1626/12375 [7:42:36<52:54:48, 17.72s/it] 13%|█▎        | 1627/12375 [7:42:53<52:44:53, 17.67s/it] 13%|█▎        | 1628/12375 [7:43:13<54:17:15, 18.19s/it] 13%|█▎        | 1629/12375 [7:43:26<49:25:02, 16.56s/it] 13%|█▎        | 1630/12375 [7:43:38<45:55:51, 15.39s/it]                                                          13%|█▎        | 1630/12375 [7:43:38<45:55:51, 15.39s/it] 13%|█▎        | 1631/12375 [7:43:53<44:59:03, 15.07s/it] 13%|█▎        | 1632/12375 [7:44:14<50:47:06, 17.02s/it] 13%|█▎        | 1633/12375 [7:44:30<49:57:36, 16.74s/it] 13%|█▎        | 1634/12375 [7:44:45<48:02:12, 16.10s/it] 13%|█▎        | 1635/12375 [7:45:01<48:11:51, 16.16s/it] 13%|█▎        | 1636/12375 [7:45:19<49:34:44, 16.62s/it] 13%|█▎        | 1637/12375 [7:45:34<48:37:29, 16.30s/it] 13%|█▎        | 1638/12375 [7:45:50<47:59:08, 16.09s/it] 13%|█▎        | 1639/12375 [7:46:07<49:08:20, 16.48s/it] 13%|█▎        | 1640/12375 [7:46:23<48:19:59, 16.21s/it]                                                          13%|█▎        | 1640/12375 [7:46:23<48:19:59, 16.21s/it] 13%|█▎        | 1641/12375 [7:46:38<47:07:30, 15.81s/it] 13%|█▎        | 1642/12375 [7:46:50<44:22:47, 14.89s/it] 13%|█▎        | 1643/12375 [7:47:03<42:17:22, 14.19s/it] 13%|█▎        | 1644/12375 [7:47:20<44:39:20, 14.98s/it] 13%|█▎        | 1645/12375 [7:47:37<46:57:14, 15.75s/it] 13%|█▎        | 1646/12375 [7:47:56<49:35:24, 16.64s/it] 13%|█▎        | 1647/12375 [7:48:21<57:14:09, 19.21s/it] 13%|█▎        | 1648/12375 [7:48:38<55:22:43, 18.59s/it] 13%|█▎        | 1649/12375 [7:48:51<49:34:59, 16.64s/it] 13%|█▎        | 1650/12375 [7:49:11<53:02:07, 17.80s/it]                                                          13%|█▎        | 1650/12375 [7:49:11<53:02:07, 17.80s/it] 13%|█▎        | 1651/12375 [7:49:26<50:32:01, 16.96s/it] 13%|█▎        | 1652/12375 [7:49:42<49:49:34, 16.73s/it] 13%|█▎        | 1653/12375 [7:50:01<51:50:43, 17.41s/it] 13%|█▎        | 1654/12375 [7:50:21<53:33:28, 17.98s/it] 13%|█▎        | 1655/12375 [7:50:41<55:39:03, 18.69s/it] 13%|█▎        | 1656/12375 [7:50:56<52:46:16, 17.72s/it] 13%|█▎        | 1657/12375 [7:51:15<53:18:04, 17.90s/it] 13%|█▎        | 1658/12375 [7:51:30<50:57:43, 17.12s/it] 13%|█▎        | 1659/12375 [7:51:49<52:14:37, 17.55s/it] 13%|█▎        | 1660/12375 [7:52:08<53:44:37, 18.06s/it]                                                          13%|█▎        | 1660/12375 [7:52:08<53:44:37, 18.06s/it] 13%|█▎        | 1661/12375 [7:52:20<48:22:52, 16.26s/it] 13%|█▎        | 1662/12375 [7:52:30<43:05:27, 14.48s/it] 13%|█▎        | 1663/12375 [7:52:46<43:52:25, 14.74s/it] 13%|█▎        | 1664/12375 [7:53:02<44:56:18, 15.10s/it] 13%|█▎        | 1665/12375 [7:53:18<45:44:43, 15.38s/it] 13%|█▎        | 1666/12375 [7:53:32<44:38:17, 15.01s/it] 13%|█▎        | 1667/12375 [7:53:50<47:51:00, 16.09s/it] 13%|█▎        | 1668/12375 [7:54:12<52:32:16, 17.66s/it] 13%|█▎        | 1669/12375 [7:54:28<51:13:04, 17.22s/it] 13%|█▎        | 1670/12375 [7:54:47<52:43:45, 17.73s/it]                                                          13%|█▎        | 1670/12375 [7:54:47<52:43:45, 17.73s/it] 14%|█▎        | 1671/12375 [7:55:04<52:24:46, 17.63s/it] 14%|█▎        | 1672/12375 [7:55:17<48:35:53, 16.35s/it] 14%|█▎        | 1673/12375 [7:55:31<45:40:56, 15.37s/it] 14%|█▎        | 1674/12375 [7:55:47<46:44:40, 15.73s/it] 14%|█▎        | 1675/12375 [7:55:59<43:21:43, 14.59s/it] 14%|█▎        | 1676/12375 [7:56:17<46:23:25, 15.61s/it] 14%|█▎        | 1677/12375 [7:56:30<44:26:39, 14.96s/it] 14%|█▎        | 1678/12375 [7:56:45<44:06:02, 14.84s/it] 14%|█▎        | 1679/12375 [7:57:01<45:10:42, 15.21s/it] 14%|█▎        | 1680/12375 [7:57:14<43:19:36, 14.58s/it]                                                          14%|█▎        | 1680/12375 [7:57:14<43:19:36, 14.58s/it] 14%|█▎        | 1681/12375 [7:57:26<40:43:47, 13.71s/it] 14%|█▎        | 1682/12375 [7:57:44<44:19:36, 14.92s/it] 14%|█▎        | 1683/12375 [7:57:58<43:45:29, 14.73s/it] 14%|█▎        | 1684/12375 [7:58:17<47:22:38, 15.95s/it] 14%|█▎        | 1685/12375 [7:58:32<46:49:23, 15.77s/it] 14%|█▎        | 1686/12375 [7:58:44<43:13:33, 14.56s/it] 14%|█▎        | 1687/12375 [7:59:02<46:04:18, 15.52s/it] 14%|█▎        | 1688/12375 [7:59:14<43:29:58, 14.65s/it] 14%|█▎        | 1689/12375 [7:59:27<41:37:10, 14.02s/it] 14%|█▎        | 1690/12375 [7:59:39<40:26:59, 13.63s/it]                                                          14%|█▎        | 1690/12375 [7:59:39<40:26:59, 13.63s/it] 14%|█▎        | 1691/12375 [7:59:56<43:03:56, 14.51s/it] 14%|█▎        | 1692/12375 [8:00:09<41:58:03, 14.14s/it] 14%|█▎        | 1693/12375 [8:00:29<47:08:09, 15.89s/it] 14%|█▎        | 1694/12375 [8:00:46<47:45:48, 16.10s/it] 14%|█▎        | 1695/12375 [8:01:00<45:40:05, 15.39s/it] 14%|█▎        | 1696/12375 [8:01:12<42:39:19, 14.38s/it] 14%|█▎        | 1697/12375 [8:01:28<44:30:01, 15.00s/it] 14%|█▎        | 1698/12375 [8:01:50<51:00:20, 17.20s/it] 14%|█▎        | 1699/12375 [8:02:02<45:51:18, 15.46s/it] 14%|█▎        | 1700/12375 [8:02:14<42:29:39, 14.33s/it]                                                          14%|█▎        | 1700/12375 [8:02:14<42:29:39, 14.33s/it][INFO|trainer.py:3410] 2024-05-27 17:53:48,090 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1700
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 17:53:48,251 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 17:53:48,252 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1700/special_tokens_map.json
 14%|█▎        | 1701/12375 [8:02:29<43:05:42, 14.53s/it] 14%|█▍        | 1702/12375 [8:02:46<45:45:21, 15.43s/it] 14%|█▍        | 1703/12375 [8:03:04<48:11:53, 16.26s/it] 14%|█▍        | 1704/12375 [8:03:19<47:12:03, 15.92s/it] 14%|█▍        | 1705/12375 [8:03:36<47:43:53, 16.10s/it] 14%|█▍        | 1706/12375 [8:03:51<46:52:43, 15.82s/it] 14%|█▍        | 1707/12375 [8:04:04<43:58:22, 14.84s/it] 14%|█▍        | 1708/12375 [8:04:16<41:35:59, 14.04s/it] 14%|█▍        | 1709/12375 [8:04:28<40:14:35, 13.58s/it] 14%|█▍        | 1710/12375 [8:04:44<41:47:01, 14.10s/it]                                                          14%|█▍        | 1710/12375 [8:04:44<41:47:01, 14.10s/it] 14%|█▍        | 1711/12375 [8:05:01<44:52:14, 15.15s/it] 14%|█▍        | 1712/12375 [8:05:16<44:39:41, 15.08s/it] 14%|█▍        | 1713/12375 [8:05:33<45:56:11, 15.51s/it] 14%|█▍        | 1714/12375 [8:05:53<50:35:59, 17.09s/it] 14%|█▍        | 1715/12375 [8:06:10<50:34:24, 17.08s/it] 14%|█▍        | 1716/12375 [8:06:29<52:09:07, 17.61s/it] 14%|█▍        | 1717/12375 [8:06:43<49:02:37, 16.57s/it] 14%|█▍        | 1718/12375 [8:06:57<46:38:55, 15.76s/it] 14%|█▍        | 1719/12375 [8:07:10<44:00:28, 14.87s/it] 14%|█▍        | 1720/12375 [8:07:22<41:01:49, 13.86s/it]                                                          14%|█▍        | 1720/12375 [8:07:22<41:01:49, 13.86s/it] 14%|█▍        | 1721/12375 [8:07:35<40:29:49, 13.68s/it] 14%|█▍        | 1722/12375 [8:07:51<42:44:51, 14.45s/it] 14%|█▍        | 1723/12375 [8:08:05<42:16:01, 14.28s/it] 14%|█▍        | 1724/12375 [8:08:17<40:15:33, 13.61s/it] 14%|█▍        | 1725/12375 [8:08:36<44:42:01, 15.11s/it] 14%|█▍        | 1726/12375 [8:08:57<50:17:18, 17.00s/it] 14%|█▍        | 1727/12375 [8:09:11<47:37:24, 16.10s/it] 14%|█▍        | 1728/12375 [8:09:30<50:32:27, 17.09s/it] 14%|█▍        | 1729/12375 [8:09:46<49:18:16, 16.67s/it] 14%|█▍        | 1730/12375 [8:10:04<49:52:47, 16.87s/it]                                                          14%|█▍        | 1730/12375 [8:10:04<49:52:47, 16.87s/it] 14%|█▍        | 1731/12375 [8:10:20<49:46:35, 16.84s/it] 14%|█▍        | 1732/12375 [8:10:33<46:07:52, 15.60s/it] 14%|█▍        | 1733/12375 [8:10:47<44:48:25, 15.16s/it] 14%|█▍        | 1734/12375 [8:11:02<44:33:38, 15.08s/it] 14%|█▍        | 1735/12375 [8:11:17<44:43:01, 15.13s/it] 14%|█▍        | 1736/12375 [8:11:35<47:25:38, 16.05s/it] 14%|█▍        | 1737/12375 [8:11:50<46:31:37, 15.75s/it] 14%|█▍        | 1738/12375 [8:12:10<49:28:51, 16.75s/it] 14%|█▍        | 1739/12375 [8:12:21<44:50:32, 15.18s/it] 14%|█▍        | 1740/12375 [8:12:44<51:53:37, 17.57s/it]                                                          14%|█▍        | 1740/12375 [8:12:44<51:53:37, 17.57s/it] 14%|█▍        | 1741/12375 [8:12:57<47:48:37, 16.19s/it] 14%|█▍        | 1742/12375 [8:13:15<49:35:55, 16.79s/it] 14%|█▍        | 1743/12375 [8:13:27<45:05:26, 15.27s/it] 14%|█▍        | 1744/12375 [8:13:43<45:18:31, 15.34s/it] 14%|█▍        | 1745/12375 [8:13:59<46:10:52, 15.64s/it] 14%|█▍        | 1746/12375 [8:14:16<47:40:14, 16.15s/it] 14%|█▍        | 1747/12375 [8:14:29<44:57:01, 15.23s/it] 14%|█▍        | 1748/12375 [8:14:43<43:22:04, 14.69s/it] 14%|█▍        | 1749/12375 [8:15:04<49:22:55, 16.73s/it] 14%|█▍        | 1750/12375 [8:15:23<51:10:53, 17.34s/it]                                                          14%|█▍        | 1750/12375 [8:15:23<51:10:53, 17.34s/it] 14%|█▍        | 1751/12375 [8:15:38<48:36:50, 16.47s/it] 14%|█▍        | 1752/12375 [8:15:53<47:44:11, 16.18s/it] 14%|█▍        | 1753/12375 [8:16:07<45:28:39, 15.41s/it] 14%|█▍        | 1754/12375 [8:16:23<46:41:44, 15.83s/it] 14%|█▍        | 1755/12375 [8:16:39<46:17:24, 15.69s/it] 14%|█▍        | 1756/12375 [8:17:00<50:47:15, 17.22s/it] 14%|█▍        | 1757/12375 [8:17:16<50:11:51, 17.02s/it] 14%|█▍        | 1758/12375 [8:17:29<46:56:01, 15.91s/it] 14%|█▍        | 1759/12375 [8:17:43<44:42:24, 15.16s/it] 14%|█▍        | 1760/12375 [8:17:56<43:14:20, 14.66s/it]                                                          14%|█▍        | 1760/12375 [8:17:56<43:14:20, 14.66s/it] 14%|█▍        | 1761/12375 [8:18:13<44:34:18, 15.12s/it] 14%|█▍        | 1762/12375 [8:18:30<46:49:01, 15.88s/it] 14%|█▍        | 1763/12375 [8:18:48<48:45:53, 16.54s/it] 14%|█▍        | 1764/12375 [8:19:00<44:34:30, 15.12s/it] 14%|█▍        | 1765/12375 [8:19:18<46:56:29, 15.93s/it] 14%|█▍        | 1766/12375 [8:19:35<47:57:15, 16.27s/it] 14%|█▍        | 1767/12375 [8:19:48<44:46:32, 15.20s/it] 14%|█▍        | 1768/12375 [8:20:05<46:47:33, 15.88s/it] 14%|█▍        | 1769/12375 [8:20:20<45:42:11, 15.51s/it] 14%|█▍        | 1770/12375 [8:20:33<43:54:59, 14.91s/it]                                                          14%|█▍        | 1770/12375 [8:20:33<43:54:59, 14.91s/it] 14%|█▍        | 1771/12375 [8:20:49<44:17:11, 15.04s/it] 14%|█▍        | 1772/12375 [8:21:01<42:05:05, 14.29s/it] 14%|█▍        | 1773/12375 [8:21:22<47:31:18, 16.14s/it] 14%|█▍        | 1774/12375 [8:21:35<44:59:22, 15.28s/it] 14%|█▍        | 1775/12375 [8:21:53<47:15:12, 16.05s/it] 14%|█▍        | 1776/12375 [8:22:13<50:49:22, 17.26s/it] 14%|█▍        | 1777/12375 [8:22:31<51:32:00, 17.51s/it] 14%|█▍        | 1778/12375 [8:22:45<48:12:18, 16.38s/it] 14%|█▍        | 1779/12375 [8:22:58<45:26:23, 15.44s/it] 14%|█▍        | 1780/12375 [8:23:13<44:59:23, 15.29s/it]                                                          14%|█▍        | 1780/12375 [8:23:13<44:59:23, 15.29s/it] 14%|█▍        | 1781/12375 [8:23:27<43:57:22, 14.94s/it] 14%|█▍        | 1782/12375 [8:23:46<47:30:40, 16.15s/it] 14%|█▍        | 1783/12375 [8:23:59<44:36:16, 15.16s/it] 14%|█▍        | 1784/12375 [8:24:20<50:08:28, 17.04s/it] 14%|█▍        | 1785/12375 [8:24:40<52:29:59, 17.85s/it] 14%|█▍        | 1786/12375 [8:24:58<53:01:16, 18.03s/it] 14%|█▍        | 1787/12375 [8:25:15<51:47:24, 17.61s/it] 14%|█▍        | 1788/12375 [8:25:33<51:47:19, 17.61s/it] 14%|█▍        | 1789/12375 [8:25:52<52:56:54, 18.01s/it] 14%|█▍        | 1790/12375 [8:26:11<53:54:42, 18.34s/it]                                                          14%|█▍        | 1790/12375 [8:26:11<53:54:42, 18.34s/it] 14%|█▍        | 1791/12375 [8:26:24<49:53:56, 16.97s/it] 14%|█▍        | 1792/12375 [8:26:38<46:39:48, 15.87s/it] 14%|█▍        | 1793/12375 [8:26:55<47:31:04, 16.17s/it] 14%|█▍        | 1794/12375 [8:27:07<44:23:43, 15.10s/it] 15%|█▍        | 1795/12375 [8:27:26<47:49:32, 16.27s/it] 15%|█▍        | 1796/12375 [8:27:42<47:40:32, 16.22s/it] 15%|█▍        | 1797/12375 [8:27:59<47:51:03, 16.29s/it] 15%|█▍        | 1798/12375 [8:28:19<51:16:48, 17.45s/it] 15%|█▍        | 1799/12375 [8:28:35<50:06:04, 17.05s/it] 15%|█▍        | 1800/12375 [8:28:51<48:46:32, 16.60s/it]                                                          15%|█▍        | 1800/12375 [8:28:51<48:46:32, 16.60s/it][INFO|trainer.py:3410] 2024-05-27 18:20:25,229 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1800
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 18:20:25,390 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 18:20:25,391 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1800/special_tokens_map.json
 15%|█▍        | 1801/12375 [8:29:05<46:45:21, 15.92s/it] 15%|█▍        | 1802/12375 [8:29:21<46:37:52, 15.88s/it] 15%|█▍        | 1803/12375 [8:29:38<48:01:17, 16.35s/it] 15%|█▍        | 1804/12375 [8:29:55<48:39:44, 16.57s/it] 15%|█▍        | 1805/12375 [8:30:07<44:14:41, 15.07s/it] 15%|█▍        | 1806/12375 [8:30:30<51:04:32, 17.40s/it] 15%|█▍        | 1807/12375 [8:30:49<52:33:00, 17.90s/it] 15%|█▍        | 1808/12375 [8:31:02<48:00:00, 16.35s/it] 15%|█▍        | 1809/12375 [8:31:19<49:07:22, 16.74s/it] 15%|█▍        | 1810/12375 [8:31:32<46:04:00, 15.70s/it]                                                          15%|█▍        | 1810/12375 [8:31:32<46:04:00, 15.70s/it] 15%|█▍        | 1811/12375 [8:31:52<49:19:33, 16.81s/it] 15%|█▍        | 1812/12375 [8:32:11<51:16:26, 17.47s/it] 15%|█▍        | 1813/12375 [8:32:24<47:33:45, 16.21s/it] 15%|█▍        | 1814/12375 [8:32:41<48:03:47, 16.38s/it] 15%|█▍        | 1815/12375 [8:32:58<48:21:41, 16.49s/it] 15%|█▍        | 1816/12375 [8:33:11<45:30:37, 15.52s/it] 15%|█▍        | 1817/12375 [8:33:27<46:02:03, 15.70s/it] 15%|█▍        | 1818/12375 [8:33:41<44:41:31, 15.24s/it] 15%|█▍        | 1819/12375 [8:33:57<45:27:16, 15.50s/it] 15%|█▍        | 1820/12375 [8:34:10<42:46:31, 14.59s/it]                                                          15%|█▍        | 1820/12375 [8:34:10<42:46:31, 14.59s/it] 15%|█▍        | 1821/12375 [8:34:27<44:50:34, 15.30s/it] 15%|█▍        | 1822/12375 [8:34:44<46:28:13, 15.85s/it] 15%|█▍        | 1823/12375 [8:34:58<44:58:53, 15.35s/it] 15%|█▍        | 1824/12375 [8:35:16<47:23:04, 16.17s/it] 15%|█▍        | 1825/12375 [8:35:37<51:27:59, 17.56s/it] 15%|█▍        | 1826/12375 [8:35:58<54:45:09, 18.69s/it] 15%|█▍        | 1827/12375 [8:36:16<54:09:36, 18.48s/it] 15%|█▍        | 1828/12375 [8:36:29<48:49:22, 16.66s/it] 15%|█▍        | 1829/12375 [8:36:43<46:41:54, 15.94s/it] 15%|█▍        | 1830/12375 [8:37:03<50:41:40, 17.31s/it]                                                          15%|█▍        | 1830/12375 [8:37:03<50:41:40, 17.31s/it] 15%|█▍        | 1831/12375 [8:37:15<45:21:48, 15.49s/it] 15%|█▍        | 1832/12375 [8:37:31<46:32:14, 15.89s/it] 15%|█▍        | 1833/12375 [8:37:50<48:33:14, 16.58s/it] 15%|█▍        | 1834/12375 [8:38:07<49:31:40, 16.91s/it] 15%|█▍        | 1835/12375 [8:38:21<46:25:15, 15.86s/it] 15%|█▍        | 1836/12375 [8:38:34<43:57:28, 15.02s/it] 15%|█▍        | 1837/12375 [8:38:59<52:42:20, 18.01s/it] 15%|█▍        | 1838/12375 [8:39:17<52:44:49, 18.02s/it] 15%|█▍        | 1839/12375 [8:39:32<50:08:21, 17.13s/it] 15%|█▍        | 1840/12375 [8:39:48<48:59:11, 16.74s/it]                                                          15%|█▍        | 1840/12375 [8:39:48<48:59:11, 16.74s/it] 15%|█▍        | 1841/12375 [8:40:03<47:54:27, 16.37s/it] 15%|█▍        | 1842/12375 [8:40:21<48:54:42, 16.72s/it] 15%|█▍        | 1843/12375 [8:40:38<49:42:04, 16.99s/it] 15%|█▍        | 1844/12375 [8:40:50<45:10:06, 15.44s/it] 15%|█▍        | 1845/12375 [8:41:01<41:25:44, 14.16s/it] 15%|█▍        | 1846/12375 [8:41:19<44:27:58, 15.20s/it] 15%|█▍        | 1847/12375 [8:41:32<42:27:17, 14.52s/it] 15%|█▍        | 1848/12375 [8:41:44<40:14:42, 13.76s/it] 15%|█▍        | 1849/12375 [8:42:01<43:23:57, 14.84s/it] 15%|█▍        | 1850/12375 [8:42:17<44:07:31, 15.09s/it]                                                          15%|█▍        | 1850/12375 [8:42:17<44:07:31, 15.09s/it] 15%|█▍        | 1851/12375 [8:42:29<41:52:29, 14.32s/it] 15%|█▍        | 1852/12375 [8:42:44<42:02:29, 14.38s/it] 15%|█▍        | 1853/12375 [8:42:55<38:56:14, 13.32s/it] 15%|█▍        | 1854/12375 [8:43:12<42:20:01, 14.49s/it] 15%|█▍        | 1855/12375 [8:43:31<46:09:06, 15.79s/it] 15%|█▍        | 1856/12375 [8:43:50<49:01:54, 16.78s/it] 15%|█▌        | 1857/12375 [8:44:09<51:07:54, 17.50s/it] 15%|█▌        | 1858/12375 [8:44:25<50:04:20, 17.14s/it] 15%|█▌        | 1859/12375 [8:44:40<47:45:35, 16.35s/it] 15%|█▌        | 1860/12375 [8:44:56<47:36:31, 16.30s/it]                                                          15%|█▌        | 1860/12375 [8:44:56<47:36:31, 16.30s/it] 15%|█▌        | 1861/12375 [8:45:10<45:02:52, 15.42s/it] 15%|█▌        | 1862/12375 [8:45:25<45:00:04, 15.41s/it] 15%|█▌        | 1863/12375 [8:45:46<50:11:23, 17.19s/it] 15%|█▌        | 1864/12375 [8:45:59<46:42:19, 16.00s/it] 15%|█▌        | 1865/12375 [8:46:13<44:30:12, 15.24s/it] 15%|█▌        | 1866/12375 [8:46:34<49:42:22, 17.03s/it] 15%|█▌        | 1867/12375 [8:46:46<44:43:50, 15.32s/it] 15%|█▌        | 1868/12375 [8:47:00<43:39:29, 14.96s/it] 15%|█▌        | 1869/12375 [8:47:19<47:33:29, 16.30s/it] 15%|█▌        | 1870/12375 [8:47:40<51:38:54, 17.70s/it]                                                          15%|█▌        | 1870/12375 [8:47:40<51:38:54, 17.70s/it] 15%|█▌        | 1871/12375 [8:47:58<52:03:17, 17.84s/it] 15%|█▌        | 1872/12375 [8:48:16<52:10:39, 17.88s/it] 15%|█▌        | 1873/12375 [8:48:35<53:15:34, 18.26s/it] 15%|█▌        | 1874/12375 [8:48:51<50:38:04, 17.36s/it] 15%|█▌        | 1875/12375 [8:49:03<46:12:32, 15.84s/it] 15%|█▌        | 1876/12375 [8:49:18<45:28:38, 15.59s/it] 15%|█▌        | 1877/12375 [8:49:40<51:13:46, 17.57s/it] 15%|█▌        | 1878/12375 [8:49:53<47:31:46, 16.30s/it] 15%|█▌        | 1879/12375 [8:50:08<46:05:36, 15.81s/it] 15%|█▌        | 1880/12375 [8:50:26<47:32:54, 16.31s/it]                                                          15%|█▌        | 1880/12375 [8:50:26<47:32:54, 16.31s/it] 15%|█▌        | 1881/12375 [8:50:45<49:53:13, 17.11s/it] 15%|█▌        | 1882/12375 [8:50:59<47:18:27, 16.23s/it] 15%|█▌        | 1883/12375 [8:51:12<44:33:41, 15.29s/it] 15%|█▌        | 1884/12375 [8:51:31<47:36:10, 16.33s/it] 15%|█▌        | 1885/12375 [8:51:50<50:11:25, 17.22s/it] 15%|█▌        | 1886/12375 [8:52:03<46:46:09, 16.05s/it] 15%|█▌        | 1887/12375 [8:52:15<43:26:56, 14.91s/it] 15%|█▌        | 1888/12375 [8:52:26<40:03:47, 13.75s/it] 15%|█▌        | 1889/12375 [8:52:39<38:57:39, 13.38s/it] 15%|█▌        | 1890/12375 [8:53:00<45:12:54, 15.52s/it]                                                          15%|█▌        | 1890/12375 [8:53:00<45:12:54, 15.52s/it] 15%|█▌        | 1891/12375 [8:53:13<43:30:16, 14.94s/it] 15%|█▌        | 1892/12375 [8:53:26<41:23:08, 14.21s/it] 15%|█▌        | 1893/12375 [8:53:41<42:01:24, 14.43s/it] 15%|█▌        | 1894/12375 [8:53:54<41:25:19, 14.23s/it] 15%|█▌        | 1895/12375 [8:54:08<40:32:51, 13.93s/it] 15%|█▌        | 1896/12375 [8:54:26<44:05:51, 15.15s/it] 15%|█▌        | 1897/12375 [8:54:40<43:46:40, 15.04s/it] 15%|█▌        | 1898/12375 [8:54:55<43:21:47, 14.90s/it] 15%|█▌        | 1899/12375 [8:55:09<42:47:21, 14.70s/it] 15%|█▌        | 1900/12375 [8:55:25<44:05:01, 15.15s/it]                                                          15%|█▌        | 1900/12375 [8:55:25<44:05:01, 15.15s/it][INFO|trainer.py:3410] 2024-05-27 18:46:59,887 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1900
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 18:47:00,047 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 18:47:00,047 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-1900/special_tokens_map.json
 15%|█▌        | 1901/12375 [8:55:38<41:30:59, 14.27s/it] 15%|█▌        | 1902/12375 [8:55:55<44:25:39, 15.27s/it] 15%|█▌        | 1903/12375 [8:56:16<49:39:11, 17.07s/it] 15%|█▌        | 1904/12375 [8:56:32<48:00:37, 16.51s/it] 15%|█▌        | 1905/12375 [8:56:50<49:55:29, 17.17s/it] 15%|█▌        | 1906/12375 [8:57:08<50:24:34, 17.33s/it] 15%|█▌        | 1907/12375 [8:57:21<46:12:32, 15.89s/it] 15%|█▌        | 1908/12375 [8:57:38<47:37:44, 16.38s/it] 15%|█▌        | 1909/12375 [8:57:53<46:25:28, 15.97s/it] 15%|█▌        | 1910/12375 [8:58:10<47:09:03, 16.22s/it]                                                          15%|█▌        | 1910/12375 [8:58:10<47:09:03, 16.22s/it] 15%|█▌        | 1911/12375 [8:58:23<44:05:40, 15.17s/it] 15%|█▌        | 1912/12375 [8:58:38<44:10:47, 15.20s/it] 15%|█▌        | 1913/12375 [8:58:53<43:54:20, 15.11s/it] 15%|█▌        | 1914/12375 [8:59:17<51:36:04, 17.76s/it] 15%|█▌        | 1915/12375 [8:59:33<50:31:03, 17.39s/it] 15%|█▌        | 1916/12375 [8:59:53<52:35:47, 18.10s/it] 15%|█▌        | 1917/12375 [9:00:05<46:58:46, 16.17s/it] 15%|█▌        | 1918/12375 [9:00:18<44:32:23, 15.33s/it] 16%|█▌        | 1919/12375 [9:00:34<45:11:42, 15.56s/it] 16%|█▌        | 1920/12375 [9:00:50<45:21:38, 15.62s/it]                                                          16%|█▌        | 1920/12375 [9:00:50<45:21:38, 15.62s/it] 16%|█▌        | 1921/12375 [9:01:07<46:32:24, 16.03s/it] 16%|█▌        | 1922/12375 [9:01:23<47:00:43, 16.19s/it] 16%|█▌        | 1923/12375 [9:01:40<46:55:49, 16.16s/it] 16%|█▌        | 1924/12375 [9:01:57<47:50:28, 16.48s/it] 16%|█▌        | 1925/12375 [9:02:11<45:35:16, 15.70s/it] 16%|█▌        | 1926/12375 [9:02:24<43:28:22, 14.98s/it] 16%|█▌        | 1927/12375 [9:02:41<45:15:20, 15.59s/it] 16%|█▌        | 1928/12375 [9:02:56<44:25:31, 15.31s/it] 16%|█▌        | 1929/12375 [9:03:09<42:34:40, 14.67s/it] 16%|█▌        | 1930/12375 [9:03:29<47:45:31, 16.46s/it]                                                          16%|█▌        | 1930/12375 [9:03:29<47:45:31, 16.46s/it] 16%|█▌        | 1931/12375 [9:03:45<47:02:50, 16.22s/it] 16%|█▌        | 1932/12375 [9:04:10<54:44:21, 18.87s/it] 16%|█▌        | 1933/12375 [9:04:26<51:48:45, 17.86s/it] 16%|█▌        | 1934/12375 [9:04:46<53:42:46, 18.52s/it] 16%|█▌        | 1935/12375 [9:05:03<52:53:27, 18.24s/it] 16%|█▌        | 1936/12375 [9:05:18<49:52:31, 17.20s/it] 16%|█▌        | 1937/12375 [9:05:33<48:07:26, 16.60s/it] 16%|█▌        | 1938/12375 [9:05:47<45:41:04, 15.76s/it] 16%|█▌        | 1939/12375 [9:06:01<44:11:04, 15.24s/it] 16%|█▌        | 1940/12375 [9:06:17<45:07:44, 15.57s/it]                                                          16%|█▌        | 1940/12375 [9:06:17<45:07:44, 15.57s/it] 16%|█▌        | 1941/12375 [9:06:37<48:38:09, 16.78s/it] 16%|█▌        | 1942/12375 [9:06:52<47:07:30, 16.26s/it] 16%|█▌        | 1943/12375 [9:07:07<45:31:06, 15.71s/it] 16%|█▌        | 1944/12375 [9:07:20<43:46:04, 15.11s/it] 16%|█▌        | 1945/12375 [9:07:36<44:41:11, 15.42s/it] 16%|█▌        | 1946/12375 [9:07:54<46:53:31, 16.19s/it] 16%|█▌        | 1947/12375 [9:08:11<47:29:52, 16.40s/it] 16%|█▌        | 1948/12375 [9:08:28<47:29:36, 16.40s/it] 16%|█▌        | 1949/12375 [9:08:47<49:54:46, 17.23s/it] 16%|█▌        | 1950/12375 [9:09:03<48:36:31, 16.79s/it]                                                          16%|█▌        | 1950/12375 [9:09:03<48:36:31, 16.79s/it] 16%|█▌        | 1951/12375 [9:09:17<46:23:32, 16.02s/it] 16%|█▌        | 1952/12375 [9:09:29<43:00:29, 14.85s/it] 16%|█▌        | 1953/12375 [9:09:44<43:29:20, 15.02s/it] 16%|█▌        | 1954/12375 [9:10:01<44:29:25, 15.37s/it] 16%|█▌        | 1955/12375 [9:10:22<50:05:27, 17.31s/it] 16%|█▌        | 1956/12375 [9:10:39<49:29:26, 17.10s/it] 16%|█▌        | 1957/12375 [9:11:02<54:33:38, 18.85s/it] 16%|█▌        | 1958/12375 [9:11:15<49:47:09, 17.21s/it] 16%|█▌        | 1959/12375 [9:11:33<49:53:55, 17.25s/it] 16%|█▌        | 1960/12375 [9:11:46<46:13:17, 15.98s/it]                                                          16%|█▌        | 1960/12375 [9:11:46<46:13:17, 15.98s/it] 16%|█▌        | 1961/12375 [9:12:01<45:43:48, 15.81s/it] 16%|█▌        | 1962/12375 [9:12:23<51:00:11, 17.63s/it] 16%|█▌        | 1963/12375 [9:12:39<49:51:11, 17.24s/it] 16%|█▌        | 1964/12375 [9:12:54<47:35:05, 16.45s/it] 16%|█▌        | 1965/12375 [9:13:06<43:47:27, 15.14s/it] 16%|█▌        | 1966/12375 [9:13:23<45:31:33, 15.75s/it] 16%|█▌        | 1967/12375 [9:13:35<42:30:50, 14.71s/it] 16%|█▌        | 1968/12375 [9:13:53<44:36:58, 15.43s/it] 16%|█▌        | 1969/12375 [9:14:08<44:22:45, 15.35s/it] 16%|█▌        | 1970/12375 [9:14:23<44:16:24, 15.32s/it]                                                          16%|█▌        | 1970/12375 [9:14:23<44:16:24, 15.32s/it] 16%|█▌        | 1971/12375 [9:14:35<41:21:16, 14.31s/it] 16%|█▌        | 1972/12375 [9:14:54<45:07:28, 15.62s/it] 16%|█▌        | 1973/12375 [9:15:08<44:05:16, 15.26s/it] 16%|█▌        | 1974/12375 [9:15:32<51:34:47, 17.85s/it] 16%|█▌        | 1975/12375 [9:15:49<50:31:30, 17.49s/it] 16%|█▌        | 1976/12375 [9:16:05<49:47:50, 17.24s/it] 16%|█▌        | 1977/12375 [9:16:20<47:40:18, 16.50s/it] 16%|█▌        | 1978/12375 [9:16:36<47:41:04, 16.51s/it] 16%|█▌        | 1979/12375 [9:16:55<49:01:48, 16.98s/it] 16%|█▌        | 1980/12375 [9:17:15<52:09:00, 18.06s/it]                                                          16%|█▌        | 1980/12375 [9:17:15<52:09:00, 18.06s/it] 16%|█▌        | 1981/12375 [9:17:39<57:15:29, 19.83s/it] 16%|█▌        | 1982/12375 [9:17:52<51:30:49, 17.84s/it] 16%|█▌        | 1983/12375 [9:18:04<46:09:14, 15.99s/it] 16%|█▌        | 1984/12375 [9:18:22<47:38:48, 16.51s/it] 16%|█▌        | 1985/12375 [9:18:34<43:38:48, 15.12s/it] 16%|█▌        | 1986/12375 [9:18:52<46:20:57, 16.06s/it] 16%|█▌        | 1987/12375 [9:19:04<43:06:19, 14.94s/it] 16%|█▌        | 1988/12375 [9:19:17<41:13:27, 14.29s/it] 16%|█▌        | 1989/12375 [9:19:38<47:16:31, 16.39s/it] 16%|█▌        | 1990/12375 [9:19:53<46:07:06, 15.99s/it]                                                          16%|█▌        | 1990/12375 [9:19:53<46:07:06, 15.99s/it] 16%|█▌        | 1991/12375 [9:20:08<44:50:16, 15.54s/it] 16%|█▌        | 1992/12375 [9:20:31<51:16:33, 17.78s/it] 16%|█▌        | 1993/12375 [9:20:49<51:32:13, 17.87s/it] 16%|█▌        | 1994/12375 [9:21:05<50:22:07, 17.47s/it] 16%|█▌        | 1995/12375 [9:21:25<52:13:16, 18.11s/it] 16%|█▌        | 1996/12375 [9:21:42<51:12:43, 17.76s/it] 16%|█▌        | 1997/12375 [9:22:03<54:05:01, 18.76s/it] 16%|█▌        | 1998/12375 [9:22:18<50:43:44, 17.60s/it] 16%|█▌        | 1999/12375 [9:22:39<53:28:09, 18.55s/it] 16%|█▌        | 2000/12375 [9:22:56<52:01:21, 18.05s/it]                                                          16%|█▌        | 2000/12375 [9:22:56<52:01:21, 18.05s/it][INFO|trainer.py:3719] 2024-05-27 19:14:30,154 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-27 19:14:30,154 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-27 19:14:30,154 >>   Batch size = 32
{'eval_loss': 1.1227251291275024, 'eval_runtime': 559.694, 'eval_samples_per_second': 8.933, 'eval_steps_per_second': 0.281, 'epoch': 0.12}
{'loss': 1.0726, 'grad_norm': 1.4858428239822388, 'learning_rate': 9.637623350036089e-05, 'epoch': 0.12}
{'loss': 1.0901, 'grad_norm': 1.8340435028076172, 'learning_rate': 9.632864098511185e-05, 'epoch': 0.12}
{'loss': 1.1393, 'grad_norm': 1.7240792512893677, 'learning_rate': 9.628074988645078e-05, 'epoch': 0.12}
{'loss': 1.1201, 'grad_norm': 1.7965861558914185, 'learning_rate': 9.6232560513031e-05, 'epoch': 0.12}
{'loss': 1.1444, 'grad_norm': 1.8072148561477661, 'learning_rate': 9.618407317542816e-05, 'epoch': 0.13}
{'loss': 1.1119, 'grad_norm': 1.7013425827026367, 'learning_rate': 9.613528818613823e-05, 'epoch': 0.13}
{'loss': 1.0916, 'grad_norm': 1.577269196510315, 'learning_rate': 9.608620585957555e-05, 'epoch': 0.13}
{'loss': 1.0859, 'grad_norm': 1.7373685836791992, 'learning_rate': 9.603682651207078e-05, 'epoch': 0.13}
{'loss': 1.1011, 'grad_norm': 1.731083631515503, 'learning_rate': 9.598715046186878e-05, 'epoch': 0.13}
{'loss': 1.0714, 'grad_norm': 1.8845500946044922, 'learning_rate': 9.593717802912672e-05, 'epoch': 0.13}
{'loss': 1.1135, 'grad_norm': 2.2618155479431152, 'learning_rate': 9.588690953591185e-05, 'epoch': 0.13}
{'loss': 1.0937, 'grad_norm': 2.3228886127471924, 'learning_rate': 9.583634530619956e-05, 'epoch': 0.13}
{'loss': 1.1225, 'grad_norm': 1.5936002731323242, 'learning_rate': 9.578548566587117e-05, 'epoch': 0.13}
{'loss': 1.1016, 'grad_norm': 1.9064726829528809, 'learning_rate': 9.573433094271197e-05, 'epoch': 0.13}
{'loss': 1.118, 'grad_norm': 1.6122384071350098, 'learning_rate': 9.568288146640895e-05, 'epoch': 0.13}
{'loss': 1.0702, 'grad_norm': 1.8253360986709595, 'learning_rate': 9.56311375685488e-05, 'epoch': 0.13}
{'loss': 1.0491, 'grad_norm': 1.678558349609375, 'learning_rate': 9.55790995826157e-05, 'epoch': 0.13}
{'loss': 1.1249, 'grad_norm': 1.6148629188537598, 'learning_rate': 9.552676784398924e-05, 'epoch': 0.14}
{'loss': 1.1209, 'grad_norm': 1.657285451889038, 'learning_rate': 9.547414268994217e-05, 'epoch': 0.14}
{'loss': 1.0827, 'grad_norm': 1.7045783996582031, 'learning_rate': 9.54212244596383e-05, 'epoch': 0.14}
{'loss': 1.0992, 'grad_norm': 1.8507622480392456, 'learning_rate': 9.536801349413028e-05, 'epoch': 0.14}
{'loss': 1.1002, 'grad_norm': 1.888840913772583, 'learning_rate': 9.531451013635742e-05, 'epoch': 0.14}
{'loss': 1.0583, 'grad_norm': 1.53317129611969, 'learning_rate': 9.526071473114342e-05, 'epoch': 0.14}
{'loss': 1.1082, 'grad_norm': 1.8680036067962646, 'learning_rate': 9.520662762519428e-05, 'epoch': 0.14}
{'loss': 1.0754, 'grad_norm': 1.6591535806655884, 'learning_rate': 9.51522491670959e-05, 'epoch': 0.14}
{'loss': 1.0669, 'grad_norm': 1.4123426675796509, 'learning_rate': 9.509757970731197e-05, 'epoch': 0.14}
{'loss': 1.0466, 'grad_norm': 1.6151710748672485, 'learning_rate': 9.504261959818164e-05, 'epoch': 0.14}
{'loss': 1.1036, 'grad_norm': 1.5939488410949707, 'learning_rate': 9.498736919391724e-05, 'epoch': 0.14}
{'loss': 1.0627, 'grad_norm': 1.7470756769180298, 'learning_rate': 9.493182885060206e-05, 'epoch': 0.14}
{'loss': 1.076, 'grad_norm': 1.735027551651001, 'learning_rate': 9.4875998926188e-05, 'epoch': 0.15}
{'loss': 1.1186, 'grad_norm': 1.7153762578964233, 'learning_rate': 9.481987978049328e-05, 'epoch': 0.15}
{'loss': 1.1208, 'grad_norm': 1.416479468345642, 'learning_rate': 9.476347177520012e-05, 'epoch': 0.15}
{'loss': 1.1466, 'grad_norm': 1.8211615085601807, 'learning_rate': 9.470677527385245e-05, 'epoch': 0.15}
{'loss': 1.0902, 'grad_norm': 1.7678247690200806, 'learning_rate': 9.464979064185347e-05, 'epoch': 0.15}
{'loss': 1.049, 'grad_norm': 1.7688663005828857, 'learning_rate': 9.459251824646338e-05, 'epoch': 0.15}
{'loss': 1.0797, 'grad_norm': 1.6310315132141113, 'learning_rate': 9.453495845679699e-05, 'epoch': 0.15}
{'loss': 1.0938, 'grad_norm': 1.9084450006484985, 'learning_rate': 9.447711164382131e-05, 'epoch': 0.15}
{'loss': 1.0477, 'grad_norm': 1.4943523406982422, 'learning_rate': 9.441897818035323e-05, 'epoch': 0.15}
{'loss': 1.0921, 'grad_norm': 1.705777645111084, 'learning_rate': 9.436055844105704e-05, 'epoch': 0.15}
{'loss': 1.1085, 'grad_norm': 2.0119502544403076, 'learning_rate': 9.430185280244207e-05, 'epoch': 0.15}
{'loss': 1.1072, 'grad_norm': 1.559662103652954, 'learning_rate': 9.424286164286022e-05, 'epoch': 0.15}
{'loss': 1.1069, 'grad_norm': 1.6873869895935059, 'learning_rate': 9.418358534250357e-05, 'epoch': 0.16}
{'loss': 1.1179, 'grad_norm': 1.888900637626648, 'learning_rate': 9.412402428340186e-05, 'epoch': 0.16}
{'loss': 1.0687, 'grad_norm': 1.7612438201904297, 'learning_rate': 9.406417884942014e-05, 'epoch': 0.16}
{'loss': 1.1023, 'grad_norm': 1.4602534770965576, 'learning_rate': 9.400404942625615e-05, 'epoch': 0.16}
{'loss': 1.0694, 'grad_norm': 1.8937090635299683, 'learning_rate': 9.394363640143797e-05, 'epoch': 0.16}
{'loss': 1.1231, 'grad_norm': 1.6106750965118408, 'learning_rate': 9.388294016432144e-05, 'epoch': 0.16}
{'loss': 1.0578, 'grad_norm': 1.398422360420227, 'learning_rate': 9.38219611060877e-05, 'epoch': 0.16}
{'loss': 1.1042, 'grad_norm': 1.7784249782562256, 'learning_rate': 9.376069961974057e-05, 'epoch': 0.16}
{'loss': 1.1046, 'grad_norm': 1.6964458227157593, 'learning_rate': 9.369915610010418e-05, 'epoch': 0.16}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:51,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:08,  2.01s/it][A
  3%|▎         | 4/157 [00:09<06:44,  2.64s/it][A
  3%|▎         | 5/157 [00:14<08:25,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:44,  3.48s/it][A
  4%|▍         | 7/157 [00:21<08:40,  3.47s/it][A
  5%|▌         | 8/157 [00:25<09:14,  3.72s/it][A
  6%|▌         | 9/157 [00:28<08:18,  3.37s/it][A
  6%|▋         | 10/157 [00:31<08:18,  3.39s/it][A
  7%|▋         | 11/157 [00:33<07:29,  3.08s/it][A
  8%|▊         | 12/157 [00:36<07:09,  2.97s/it][A
  8%|▊         | 13/157 [00:39<07:06,  2.96s/it][A
  9%|▉         | 14/157 [00:43<07:32,  3.16s/it][A
 10%|▉         | 15/157 [00:46<07:50,  3.31s/it][A
 10%|█         | 16/157 [00:50<08:18,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:45,  3.32s/it][A
 11%|█▏        | 18/157 [00:56<07:12,  3.11s/it][A
 12%|█▏        | 19/157 [01:00<07:52,  3.42s/it][A
 13%|█▎        | 20/157 [01:04<07:53,  3.45s/it][A
 13%|█▎        | 21/157 [01:07<07:48,  3.44s/it][A
 14%|█▍        | 22/157 [01:10<07:26,  3.30s/it][A
 15%|█▍        | 23/157 [01:13<07:11,  3.22s/it][A
 15%|█▌        | 24/157 [01:17<07:33,  3.41s/it][A
 16%|█▌        | 25/157 [01:20<07:30,  3.41s/it][A
 17%|█▋        | 26/157 [01:24<07:27,  3.41s/it][A
 17%|█▋        | 27/157 [01:29<08:33,  3.95s/it][A
 18%|█▊        | 28/157 [01:33<08:28,  3.94s/it][A
 18%|█▊        | 29/157 [01:36<07:43,  3.62s/it][A
 19%|█▉        | 30/157 [01:39<07:11,  3.40s/it][A
 20%|█▉        | 31/157 [01:42<07:19,  3.49s/it][A
 20%|██        | 32/157 [01:46<07:19,  3.51s/it][A
 21%|██        | 33/157 [01:50<07:39,  3.71s/it][A
 22%|██▏       | 34/157 [01:54<07:47,  3.80s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.72s/it][A
 23%|██▎       | 36/157 [02:02<08:00,  3.97s/it][A
 24%|██▎       | 37/157 [02:06<07:47,  3.89s/it][A
 24%|██▍       | 38/157 [02:09<07:33,  3.81s/it][A
 25%|██▍       | 39/157 [02:13<07:14,  3.68s/it][A
 25%|██▌       | 40/157 [02:15<06:36,  3.39s/it][A
 26%|██▌       | 41/157 [02:19<06:50,  3.53s/it][A
 27%|██▋       | 42/157 [02:25<07:45,  4.05s/it][A
 27%|██▋       | 43/157 [02:27<06:56,  3.65s/it][A
 28%|██▊       | 44/157 [02:31<06:59,  3.72s/it][A
 29%|██▊       | 45/157 [02:34<06:36,  3.54s/it][A
 29%|██▉       | 46/157 [02:37<06:07,  3.31s/it][A
 30%|██▉       | 47/157 [02:40<05:59,  3.27s/it][A
 31%|███       | 48/157 [02:47<07:45,  4.27s/it][A
 31%|███       | 49/157 [02:50<06:50,  3.80s/it][A
 32%|███▏      | 50/157 [02:53<06:23,  3.59s/it][A
 32%|███▏      | 51/157 [02:57<06:29,  3.67s/it][A
 33%|███▎      | 52/157 [03:00<06:33,  3.75s/it][A
 34%|███▍      | 53/157 [03:05<06:58,  4.02s/it][A
 34%|███▍      | 54/157 [03:09<06:35,  3.84s/it][A
 35%|███▌      | 55/157 [03:13<06:47,  4.00s/it][A
 36%|███▌      | 56/157 [03:17<06:50,  4.06s/it][A
 36%|███▋      | 57/157 [03:21<06:46,  4.06s/it][A
 37%|███▋      | 58/157 [03:25<06:25,  3.90s/it][A
 38%|███▊      | 59/157 [03:30<06:49,  4.17s/it][A
 38%|███▊      | 60/157 [03:34<06:40,  4.13s/it][A
 39%|███▉      | 61/157 [03:37<06:19,  3.96s/it][A
 39%|███▉      | 62/157 [03:42<06:37,  4.18s/it][A
 40%|████      | 63/157 [03:45<06:11,  3.95s/it][A
 41%|████      | 64/157 [03:50<06:19,  4.08s/it][A
 41%|████▏     | 65/157 [03:54<06:31,  4.25s/it][A
 42%|████▏     | 66/157 [03:57<05:40,  3.74s/it][A
 43%|████▎     | 67/157 [04:02<06:10,  4.11s/it][A
 43%|████▎     | 68/157 [04:04<05:24,  3.65s/it][A
 44%|████▍     | 69/157 [04:07<05:00,  3.42s/it][A
 45%|████▍     | 70/157 [04:12<05:21,  3.70s/it][A
 45%|████▌     | 71/157 [04:15<05:09,  3.60s/it][A
 46%|████▌     | 72/157 [04:18<04:47,  3.38s/it][A
 46%|████▋     | 73/157 [04:20<04:21,  3.11s/it][A
 47%|████▋     | 74/157 [04:24<04:41,  3.39s/it][A
 48%|████▊     | 75/157 [04:28<04:54,  3.59s/it][A
 48%|████▊     | 76/157 [04:32<05:02,  3.73s/it][A
 49%|████▉     | 77/157 [04:36<04:55,  3.70s/it][A
 50%|████▉     | 78/157 [04:39<04:30,  3.42s/it][A
 50%|█████     | 79/157 [04:44<04:58,  3.82s/it][A
 51%|█████     | 80/157 [04:46<04:29,  3.49s/it][A
 52%|█████▏    | 81/157 [04:49<04:04,  3.22s/it][A
 52%|█████▏    | 82/157 [04:52<04:00,  3.21s/it][A
 53%|█████▎    | 83/157 [04:56<04:15,  3.45s/it][A
 54%|█████▎    | 84/157 [05:00<04:27,  3.66s/it][A
 54%|█████▍    | 85/157 [05:04<04:30,  3.75s/it][A
 55%|█████▍    | 86/157 [05:09<04:44,  4.01s/it][A
 55%|█████▌    | 87/157 [05:13<04:34,  3.92s/it][A
 56%|█████▌    | 88/157 [05:16<04:23,  3.81s/it][A
 57%|█████▋    | 89/157 [05:19<04:09,  3.66s/it][A
 57%|█████▋    | 90/157 [05:23<04:13,  3.78s/it][A
 58%|█████▊    | 91/157 [05:27<04:06,  3.73s/it][A
 59%|█████▊    | 92/157 [05:30<03:47,  3.50s/it][A
 59%|█████▉    | 93/157 [05:35<04:14,  3.98s/it][A
 60%|█████▉    | 94/157 [05:38<03:54,  3.72s/it][A
 61%|██████    | 95/157 [05:42<03:44,  3.61s/it][A
 61%|██████    | 96/157 [05:45<03:32,  3.48s/it][A
 62%|██████▏   | 97/157 [05:48<03:23,  3.39s/it][A
 62%|██████▏   | 98/157 [05:50<03:02,  3.10s/it][A
 63%|██████▎   | 99/157 [05:54<03:16,  3.39s/it][A
 64%|██████▎   | 100/157 [05:57<03:07,  3.28s/it][A
 64%|██████▍   | 101/157 [06:00<02:55,  3.13s/it][A
 65%|██████▍   | 102/157 [06:03<02:49,  3.08s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.90s/it][A
 66%|██████▌   | 104/157 [06:10<02:55,  3.31s/it][A
 67%|██████▋   | 105/157 [06:14<03:03,  3.54s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.86s/it][A
 68%|██████▊   | 107/157 [06:23<03:21,  4.02s/it][A
 69%|██████▉   | 108/157 [06:27<03:14,  3.97s/it][A
 69%|██████▉   | 109/157 [06:30<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:34<03:02,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.48s/it][A
 72%|███████▏  | 113/157 [06:44<02:29,  3.41s/it][A
 73%|███████▎  | 114/157 [06:47<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:57<02:51,  4.18s/it][A
 75%|███████▍  | 117/157 [07:00<02:31,  3.79s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.50s/it][A
 76%|███████▌  | 119/157 [07:06<02:14,  3.55s/it][A
 76%|███████▋  | 120/157 [07:09<02:01,  3.29s/it][A
 77%|███████▋  | 121/157 [07:12<01:54,  3.19s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.33s/it][A
 78%|███████▊  | 123/157 [07:19<01:57,  3.46s/it][A
 79%|███████▉  | 124/157 [07:23<01:55,  3.49s/it][A
 80%|███████▉  | 125/157 [07:26<01:45,  3.29s/it][A
 80%|████████  | 126/157 [07:30<01:47,  3.46s/it][A
 81%|████████  | 127/157 [07:32<01:37,  3.25s/it][A
 82%|████████▏ | 128/157 [07:35<01:29,  3.09s/it][A
 82%|████████▏ | 129/157 [07:38<01:22,  2.94s/it][A
 83%|████████▎ | 130/157 [07:42<01:27,  3.24s/it][A
 83%|████████▎ | 131/157 [07:45<01:25,  3.30s/it][A
 84%|████████▍ | 132/157 [07:49<01:29,  3.59s/it][A
 85%|████████▍ | 133/157 [07:52<01:21,  3.41s/it][A
 85%|████████▌ | 134/157 [07:56<01:17,  3.38s/it][A
 86%|████████▌ | 135/157 [07:59<01:17,  3.50s/it][A
 87%|████████▋ | 136/157 [08:02<01:09,  3.32s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.58s/it][A
 88%|████████▊ | 138/157 [08:10<01:05,  3.45s/it][A
 89%|████████▊ | 139/157 [08:14<01:05,  3.63s/it][A
 89%|████████▉ | 140/157 [08:17<01:00,  3.58s/it][A
 90%|████████▉ | 141/157 [08:20<00:55,  3.44s/it][A
 90%|█████████ | 142/157 [08:24<00:54,  3.63s/it][A
 91%|█████████ | 143/157 [08:29<00:55,  3.95s/it][A
 92%|█████████▏| 144/157 [08:33<00:49,  3.83s/it][A
 92%|█████████▏| 145/157 [08:37<00:48,  4.00s/it][A
 93%|█████████▎| 146/157 [08:41<00:43,  3.91s/it][A
 94%|█████████▎| 147/157 [08:46<00:42,  4.26s/it][A
 94%|█████████▍| 148/157 [08:49<00:35,  3.91s/it][A
 95%|█████████▍| 149/157 [08:53<00:31,  3.94s/it][A
 96%|█████████▌| 150/157 [08:56<00:25,  3.70s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.62s/it][A
 97%|█████████▋| 152/157 [09:03<00:17,  3.47s/it][A
 97%|█████████▋| 153/157 [09:05<00:12,  3.18s/it][A
 98%|█████████▊| 154/157 [09:09<00:09,  3.28s/it][A
 99%|█████████▊| 155/157 [09:11<00:06,  3.01s/it][A
 99%|█████████▉| 156/157 [09:15<00:03,  3.32s/it][A
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A                                                         
                                                 [A 16%|█▌        | 2000/12375 [9:32:15<52:01:21, 18.05s/it]
100%|██████████| 157/157 [09:16<00:00,  2.52s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-27 19:23:49,708 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2000
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 19:23:49,871 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 19:23:49,871 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2000/special_tokens_map.json
 16%|█▌        | 2001/12375 [9:32:33<535:22:42, 185.79s/it] 16%|█▌        | 2002/12375 [9:32:49<388:33:04, 134.85s/it] 16%|█▌        | 2003/12375 [9:33:02<283:45:37, 98.49s/it]  16%|█▌        | 2004/12375 [9:33:16<210:34:39, 73.10s/it] 16%|█▌        | 2005/12375 [9:33:33<161:59:47, 56.24s/it] 16%|█▌        | 2006/12375 [9:33:46<124:19:04, 43.16s/it] 16%|█▌        | 2007/12375 [9:34:03<102:02:47, 35.43s/it] 16%|█▌        | 2008/12375 [9:34:16<82:21:00, 28.60s/it]  16%|█▌        | 2009/12375 [9:34:32<71:52:12, 24.96s/it] 16%|█▌        | 2010/12375 [9:34:45<61:37:00, 21.40s/it]                                                          16%|█▌        | 2010/12375 [9:34:45<61:37:00, 21.40s/it] 16%|█▋        | 2011/12375 [9:35:04<59:19:54, 20.61s/it] 16%|█▋        | 2012/12375 [9:35:23<57:30:47, 19.98s/it] 16%|█▋        | 2013/12375 [9:35:41<55:49:39, 19.40s/it] 16%|█▋        | 2014/12375 [9:35:54<50:55:14, 17.69s/it] 16%|█▋        | 2015/12375 [9:36:16<54:00:27, 18.77s/it] 16%|█▋        | 2016/12375 [9:36:28<48:45:00, 16.94s/it] 16%|█▋        | 2017/12375 [9:36:44<47:56:17, 16.66s/it] 16%|█▋        | 2018/12375 [9:37:00<46:56:40, 16.32s/it] 16%|█▋        | 2019/12375 [9:37:17<47:52:36, 16.64s/it] 16%|█▋        | 2020/12375 [9:37:32<45:58:32, 15.98s/it]                                                          16%|█▋        | 2020/12375 [9:37:32<45:58:32, 15.98s/it] 16%|█▋        | 2021/12375 [9:37:47<45:09:27, 15.70s/it] 16%|█▋        | 2022/12375 [9:38:02<44:28:41, 15.47s/it] 16%|█▋        | 2023/12375 [9:38:17<43:55:42, 15.28s/it] 16%|█▋        | 2024/12375 [9:38:33<45:12:48, 15.72s/it] 16%|█▋        | 2025/12375 [9:38:54<49:12:30, 17.12s/it] 16%|█▋        | 2026/12375 [9:39:08<47:03:57, 16.37s/it] 16%|█▋        | 2027/12375 [9:39:21<43:46:31, 15.23s/it] 16%|█▋        | 2028/12375 [9:39:40<46:57:18, 16.34s/it] 16%|█▋        | 2029/12375 [9:39:58<48:13:38, 16.78s/it] 16%|█▋        | 2030/12375 [9:40:13<47:09:32, 16.41s/it]                                                          16%|█▋        | 2030/12375 [9:40:13<47:09:32, 16.41s/it] 16%|█▋        | 2031/12375 [9:40:28<46:03:17, 16.03s/it] 16%|█▋        | 2032/12375 [9:40:42<44:12:21, 15.39s/it] 16%|█▋        | 2033/12375 [9:41:02<47:36:32, 16.57s/it] 16%|█▋        | 2034/12375 [9:41:23<51:39:06, 17.98s/it] 16%|█▋        | 2035/12375 [9:41:40<51:13:09, 17.83s/it] 16%|█▋        | 2036/12375 [9:41:54<48:02:18, 16.73s/it] 16%|█▋        | 2037/12375 [9:42:08<45:28:05, 15.83s/it] 16%|█▋        | 2038/12375 [9:42:20<41:53:22, 14.59s/it] 16%|█▋        | 2039/12375 [9:42:35<42:10:54, 14.69s/it] 16%|█▋        | 2040/12375 [9:42:46<39:29:33, 13.76s/it]                                                          16%|█▋        | 2040/12375 [9:42:46<39:29:33, 13.76s/it] 16%|█▋        | 2041/12375 [9:43:09<47:13:47, 16.45s/it] 17%|█▋        | 2042/12375 [9:43:31<51:42:50, 18.02s/it] 17%|█▋        | 2043/12375 [9:43:53<55:16:32, 19.26s/it] 17%|█▋        | 2044/12375 [9:44:07<50:42:43, 17.67s/it] 17%|█▋        | 2045/12375 [9:44:21<47:44:52, 16.64s/it] 17%|█▋        | 2046/12375 [9:44:33<44:02:18, 15.35s/it] 17%|█▋        | 2047/12375 [9:44:49<44:23:59, 15.48s/it] 17%|█▋        | 2048/12375 [9:45:00<40:08:05, 13.99s/it] 17%|█▋        | 2049/12375 [9:45:22<46:57:59, 16.37s/it] 17%|█▋        | 2050/12375 [9:45:38<47:09:34, 16.44s/it]                                                          17%|█▋        | 2050/12375 [9:45:38<47:09:34, 16.44s/it] 17%|█▋        | 2051/12375 [9:45:52<44:35:39, 15.55s/it] 17%|█▋        | 2052/12375 [9:46:10<46:54:37, 16.36s/it] 17%|█▋        | 2053/12375 [9:46:26<46:39:43, 16.27s/it] 17%|█▋        | 2054/12375 [9:46:43<47:17:35, 16.50s/it] 17%|█▋        | 2055/12375 [9:46:58<45:39:33, 15.93s/it] 17%|█▋        | 2056/12375 [9:47:10<42:21:06, 14.78s/it] 17%|█▋        | 2057/12375 [9:47:28<45:00:56, 15.71s/it] 17%|█▋        | 2058/12375 [9:47:40<42:08:27, 14.70s/it] 17%|█▋        | 2059/12375 [9:47:52<40:07:51, 14.00s/it] 17%|█▋        | 2060/12375 [9:48:14<46:22:23, 16.18s/it]                                                          17%|█▋        | 2060/12375 [9:48:14<46:22:23, 16.18s/it] 17%|█▋        | 2061/12375 [9:48:27<43:37:55, 15.23s/it] 17%|█▋        | 2062/12375 [9:48:42<43:58:19, 15.35s/it] 17%|█▋        | 2063/12375 [9:49:03<48:27:30, 16.92s/it] 17%|█▋        | 2064/12375 [9:49:20<48:50:21, 17.05s/it] 17%|█▋        | 2065/12375 [9:49:40<51:33:34, 18.00s/it] 17%|█▋        | 2066/12375 [9:49:57<50:03:10, 17.48s/it] 17%|█▋        | 2067/12375 [9:50:11<47:14:53, 16.50s/it] 17%|█▋        | 2068/12375 [9:50:31<50:36:59, 17.68s/it] 17%|█▋        | 2069/12375 [9:50:49<50:44:39, 17.73s/it] 17%|█▋        | 2070/12375 [9:51:10<53:15:38, 18.61s/it]                                                          17%|█▋        | 2070/12375 [9:51:10<53:15:38, 18.61s/it] 17%|█▋        | 2071/12375 [9:51:26<50:42:08, 17.71s/it] 17%|█▋        | 2072/12375 [9:51:39<47:21:54, 16.55s/it] 17%|█▋        | 2073/12375 [9:51:58<48:44:49, 17.03s/it] 17%|█▋        | 2074/12375 [9:52:12<46:19:53, 16.19s/it] 17%|█▋        | 2075/12375 [9:52:26<45:00:23, 15.73s/it] 17%|█▋        | 2076/12375 [9:52:45<47:12:13, 16.50s/it] 17%|█▋        | 2077/12375 [9:53:04<49:20:31, 17.25s/it] 17%|█▋        | 2078/12375 [9:53:16<45:17:47, 15.84s/it] 17%|█▋        | 2079/12375 [9:53:35<47:46:47, 16.71s/it] 17%|█▋        | 2080/12375 [9:53:48<45:02:09, 15.75s/it]                                                          17%|█▋        | 2080/12375 [9:53:48<45:02:09, 15.75s/it] 17%|█▋        | 2081/12375 [9:54:07<47:02:07, 16.45s/it] 17%|█▋        | 2082/12375 [9:54:28<51:03:19, 17.86s/it] 17%|█▋        | 2083/12375 [9:54:45<50:37:22, 17.71s/it] 17%|█▋        | 2084/12375 [9:54:59<47:36:10, 16.65s/it] 17%|█▋        | 2085/12375 [9:55:13<44:55:59, 15.72s/it] 17%|█▋        | 2086/12375 [9:55:27<43:34:32, 15.25s/it] 17%|█▋        | 2087/12375 [9:55:39<41:13:47, 14.43s/it] 17%|█▋        | 2088/12375 [9:55:59<45:30:27, 15.93s/it] 17%|█▋        | 2089/12375 [9:56:11<42:34:13, 14.90s/it] 17%|█▋        | 2090/12375 [9:56:25<41:18:53, 14.46s/it]                                                          17%|█▋        | 2090/12375 [9:56:25<41:18:53, 14.46s/it] 17%|█▋        | 2091/12375 [9:56:38<39:55:30, 13.98s/it] 17%|█▋        | 2092/12375 [9:56:50<38:48:04, 13.58s/it] 17%|█▋        | 2093/12375 [9:57:07<41:41:04, 14.59s/it] 17%|█▋        | 2094/12375 [9:57:20<39:53:11, 13.97s/it] 17%|█▋        | 2095/12375 [9:57:36<42:06:12, 14.74s/it] 17%|█▋        | 2096/12375 [9:57:50<41:10:13, 14.42s/it] 17%|█▋        | 2097/12375 [9:58:07<43:01:19, 15.07s/it] 17%|█▋        | 2098/12375 [9:58:25<46:15:22, 16.20s/it] 17%|█▋        | 2099/12375 [9:58:44<48:18:10, 16.92s/it] 17%|█▋        | 2100/12375 [9:59:01<48:04:25, 16.84s/it]                                                          17%|█▋        | 2100/12375 [9:59:01<48:04:25, 16.84s/it][INFO|trainer.py:3410] 2024-05-27 19:50:35,276 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2100
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 19:50:35,439 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 19:50:35,439 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2100/special_tokens_map.json
 17%|█▋        | 2101/12375 [9:59:18<48:08:00, 16.87s/it] 17%|█▋        | 2102/12375 [9:59:33<46:38:39, 16.35s/it] 17%|█▋        | 2103/12375 [9:59:49<46:58:18, 16.46s/it] 17%|█▋        | 2104/12375 [10:00:05<46:05:46, 16.16s/it] 17%|█▋        | 2105/12375 [10:00:22<46:37:21, 16.34s/it] 17%|█▋        | 2106/12375 [10:00:40<48:02:33, 16.84s/it] 17%|█▋        | 2107/12375 [10:00:54<45:55:03, 16.10s/it] 17%|█▋        | 2108/12375 [10:01:07<42:47:00, 15.00s/it] 17%|█▋        | 2109/12375 [10:01:19<40:28:06, 14.19s/it] 17%|█▋        | 2110/12375 [10:01:37<43:43:32, 15.33s/it]                                                           17%|█▋        | 2110/12375 [10:01:37<43:43:32, 15.33s/it] 17%|█▋        | 2111/12375 [10:01:56<46:47:28, 16.41s/it] 17%|█▋        | 2112/12375 [10:02:10<45:13:47, 15.87s/it] 17%|█▋        | 2113/12375 [10:02:25<44:02:58, 15.45s/it] 17%|█▋        | 2114/12375 [10:02:39<42:49:16, 15.02s/it] 17%|█▋        | 2115/12375 [10:02:54<43:15:33, 15.18s/it] 17%|█▋        | 2116/12375 [10:03:09<42:43:08, 14.99s/it] 17%|█▋        | 2117/12375 [10:03:24<42:55:59, 15.07s/it] 17%|█▋        | 2118/12375 [10:03:39<42:59:01, 15.09s/it] 17%|█▋        | 2119/12375 [10:03:55<43:50:51, 15.39s/it] 17%|█▋        | 2120/12375 [10:04:08<41:41:46, 14.64s/it]                                                           17%|█▋        | 2120/12375 [10:04:08<41:41:46, 14.64s/it] 17%|█▋        | 2121/12375 [10:04:27<44:52:58, 15.76s/it] 17%|█▋        | 2122/12375 [10:04:41<43:22:25, 15.23s/it] 17%|█▋        | 2123/12375 [10:04:58<44:54:50, 15.77s/it] 17%|█▋        | 2124/12375 [10:05:12<44:02:06, 15.46s/it] 17%|█▋        | 2125/12375 [10:05:28<44:26:46, 15.61s/it] 17%|█▋        | 2126/12375 [10:05:44<44:22:52, 15.59s/it] 17%|█▋        | 2127/12375 [10:05:55<40:12:28, 14.12s/it] 17%|█▋        | 2128/12375 [10:06:06<37:38:45, 13.23s/it] 17%|█▋        | 2129/12375 [10:06:23<41:00:28, 14.41s/it] 17%|█▋        | 2130/12375 [10:06:41<44:25:53, 15.61s/it]                                                           17%|█▋        | 2130/12375 [10:06:41<44:25:53, 15.61s/it] 17%|█▋        | 2131/12375 [10:06:59<46:00:15, 16.17s/it] 17%|█▋        | 2132/12375 [10:07:20<50:04:30, 17.60s/it] 17%|█▋        | 2133/12375 [10:07:39<51:06:58, 17.97s/it] 17%|█▋        | 2134/12375 [10:07:57<51:47:47, 18.21s/it] 17%|█▋        | 2135/12375 [10:08:09<46:34:26, 16.37s/it] 17%|█▋        | 2136/12375 [10:08:26<46:22:35, 16.31s/it] 17%|█▋        | 2137/12375 [10:08:42<46:24:55, 16.32s/it] 17%|█▋        | 2138/12375 [10:08:55<43:13:14, 15.20s/it] 17%|█▋        | 2139/12375 [10:09:11<44:28:19, 15.64s/it] 17%|█▋        | 2140/12375 [10:09:27<44:17:22, 15.58s/it]                                                           17%|█▋        | 2140/12375 [10:09:27<44:17:22, 15.58s/it] 17%|█▋        | 2141/12375 [10:09:44<45:27:52, 15.99s/it] 17%|█▋        | 2142/12375 [10:10:00<45:40:40, 16.07s/it] 17%|█▋        | 2143/12375 [10:10:20<48:56:52, 17.22s/it] 17%|█▋        | 2144/12375 [10:10:32<44:47:33, 15.76s/it] 17%|█▋        | 2145/12375 [10:10:46<42:48:11, 15.06s/it] 17%|█▋        | 2146/12375 [10:10:57<39:32:34, 13.92s/it] 17%|█▋        | 2147/12375 [10:11:12<40:34:29, 14.28s/it] 17%|█▋        | 2148/12375 [10:11:24<38:53:56, 13.69s/it] 17%|█▋        | 2149/12375 [10:11:39<40:06:40, 14.12s/it] 17%|█▋        | 2150/12375 [10:11:58<43:48:35, 15.42s/it]                                                           17%|█▋        | 2150/12375 [10:11:58<43:48:35, 15.42s/it] 17%|█▋        | 2151/12375 [10:12:18<47:57:48, 16.89s/it] 17%|█▋        | 2152/12375 [10:12:38<50:32:28, 17.80s/it] 17%|█▋        | 2153/12375 [10:12:52<47:26:59, 16.71s/it] 17%|█▋        | 2154/12375 [10:13:08<46:32:53, 16.40s/it] 17%|█▋        | 2155/12375 [10:13:26<48:13:39, 16.99s/it] 17%|█▋        | 2156/12375 [10:13:43<47:53:22, 16.87s/it] 17%|█▋        | 2157/12375 [10:14:00<48:02:15, 16.92s/it] 17%|█▋        | 2158/12375 [10:14:14<45:51:49, 16.16s/it] 17%|█▋        | 2159/12375 [10:14:26<41:48:02, 14.73s/it] 17%|█▋        | 2160/12375 [10:14:43<43:59:30, 15.50s/it]                                                           17%|█▋        | 2160/12375 [10:14:43<43:59:30, 15.50s/it] 17%|█▋        | 2161/12375 [10:14:57<42:50:15, 15.10s/it] 17%|█▋        | 2162/12375 [10:15:10<41:01:33, 14.46s/it] 17%|█▋        | 2163/12375 [10:15:25<41:34:31, 14.66s/it] 17%|█▋        | 2164/12375 [10:15:40<41:59:05, 14.80s/it] 17%|█▋        | 2165/12375 [10:15:55<41:34:48, 14.66s/it] 18%|█▊        | 2166/12375 [10:16:10<42:19:21, 14.92s/it] 18%|█▊        | 2167/12375 [10:16:26<42:48:43, 15.10s/it] 18%|█▊        | 2168/12375 [10:16:39<41:16:18, 14.56s/it] 18%|█▊        | 2169/12375 [10:16:56<43:35:28, 15.38s/it] 18%|█▊        | 2170/12375 [10:17:14<45:52:22, 16.18s/it]                                                           18%|█▊        | 2170/12375 [10:17:14<45:52:22, 16.18s/it] 18%|█▊        | 2171/12375 [10:17:34<48:38:38, 17.16s/it] 18%|█▊        | 2172/12375 [10:17:49<46:46:15, 16.50s/it] 18%|█▊        | 2173/12375 [10:18:01<43:21:56, 15.30s/it] 18%|█▊        | 2174/12375 [10:18:23<49:10:18, 17.35s/it] 18%|█▊        | 2175/12375 [10:18:39<47:22:27, 16.72s/it] 18%|█▊        | 2176/12375 [10:18:57<48:34:08, 17.14s/it] 18%|█▊        | 2177/12375 [10:19:11<45:56:53, 16.22s/it] 18%|█▊        | 2178/12375 [10:19:28<46:24:41, 16.39s/it] 18%|█▊        | 2179/12375 [10:19:48<49:34:37, 17.50s/it] 18%|█▊        | 2180/12375 [10:20:04<48:47:41, 17.23s/it]                                                           18%|█▊        | 2180/12375 [10:20:04<48:47:41, 17.23s/it] 18%|█▊        | 2181/12375 [10:20:23<50:02:20, 17.67s/it] 18%|█▊        | 2182/12375 [10:20:41<50:13:44, 17.74s/it] 18%|█▊        | 2183/12375 [10:20:58<49:51:39, 17.61s/it] 18%|█▊        | 2184/12375 [10:21:14<48:18:25, 17.06s/it] 18%|█▊        | 2185/12375 [10:21:33<49:28:05, 17.48s/it] 18%|█▊        | 2186/12375 [10:21:45<45:13:54, 15.98s/it] 18%|█▊        | 2187/12375 [10:22:02<46:08:02, 16.30s/it] 18%|█▊        | 2188/12375 [10:22:18<45:50:24, 16.20s/it] 18%|█▊        | 2189/12375 [10:22:32<44:01:52, 15.56s/it] 18%|█▊        | 2190/12375 [10:22:46<42:22:54, 14.98s/it]                                                           18%|█▊        | 2190/12375 [10:22:46<42:22:54, 14.98s/it] 18%|█▊        | 2191/12375 [10:23:06<46:33:25, 16.46s/it] 18%|█▊        | 2192/12375 [10:23:20<44:36:54, 15.77s/it] 18%|█▊        | 2193/12375 [10:23:40<48:01:39, 16.98s/it] 18%|█▊        | 2194/12375 [10:23:57<48:43:32, 17.23s/it] 18%|█▊        | 2195/12375 [10:24:16<49:58:34, 17.67s/it] 18%|█▊        | 2196/12375 [10:24:35<51:06:36, 18.08s/it] 18%|█▊        | 2197/12375 [10:24:48<46:59:21, 16.62s/it] 18%|█▊        | 2198/12375 [10:25:07<48:30:22, 17.16s/it] 18%|█▊        | 2199/12375 [10:25:27<51:10:52, 18.11s/it] 18%|█▊        | 2200/12375 [10:25:46<51:59:29, 18.40s/it]                                                           18%|█▊        | 2200/12375 [10:25:46<51:59:29, 18.40s/it][INFO|trainer.py:3410] 2024-05-27 20:17:20,714 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2200
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 20:17:20,874 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 20:17:20,874 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2200/special_tokens_map.json
 18%|█▊        | 2201/12375 [10:26:02<50:04:33, 17.72s/it] 18%|█▊        | 2202/12375 [10:26:16<46:38:03, 16.50s/it] 18%|█▊        | 2203/12375 [10:26:32<46:00:45, 16.28s/it] 18%|█▊        | 2204/12375 [10:26:47<44:49:54, 15.87s/it] 18%|█▊        | 2205/12375 [10:27:02<44:17:27, 15.68s/it] 18%|█▊        | 2206/12375 [10:27:16<43:10:27, 15.28s/it] 18%|█▊        | 2207/12375 [10:27:35<46:04:02, 16.31s/it] 18%|█▊        | 2208/12375 [10:27:49<43:45:57, 15.50s/it] 18%|█▊        | 2209/12375 [10:28:06<45:07:07, 15.98s/it] 18%|█▊        | 2210/12375 [10:28:21<44:41:51, 15.83s/it]                                                           18%|█▊        | 2210/12375 [10:28:21<44:41:51, 15.83s/it] 18%|█▊        | 2211/12375 [10:28:32<40:47:01, 14.45s/it] 18%|█▊        | 2212/12375 [10:28:48<41:26:45, 14.68s/it] 18%|█▊        | 2213/12375 [10:29:03<42:02:28, 14.89s/it] 18%|█▊        | 2214/12375 [10:29:19<43:04:30, 15.26s/it] 18%|█▊        | 2215/12375 [10:29:34<43:06:04, 15.27s/it] 18%|█▊        | 2216/12375 [10:29:52<45:01:19, 15.95s/it] 18%|█▊        | 2217/12375 [10:30:10<46:45:06, 16.57s/it] 18%|█▊        | 2218/12375 [10:30:23<43:31:54, 15.43s/it] 18%|█▊        | 2219/12375 [10:30:37<42:14:56, 14.98s/it] 18%|█▊        | 2220/12375 [10:30:52<42:41:18, 15.13s/it]                                                           18%|█▊        | 2220/12375 [10:30:52<42:41:18, 15.13s/it] 18%|█▊        | 2221/12375 [10:31:08<43:00:36, 15.25s/it] 18%|█▊        | 2222/12375 [10:31:20<40:25:46, 14.34s/it] 18%|█▊        | 2223/12375 [10:31:35<40:54:30, 14.51s/it] 18%|█▊        | 2224/12375 [10:31:46<38:21:28, 13.60s/it] 18%|█▊        | 2225/12375 [10:32:01<39:39:08, 14.06s/it] 18%|█▊        | 2226/12375 [10:32:17<40:49:16, 14.48s/it] 18%|█▊        | 2227/12375 [10:32:35<43:38:30, 15.48s/it] 18%|█▊        | 2228/12375 [10:32:50<43:41:49, 15.50s/it] 18%|█▊        | 2229/12375 [10:33:08<45:48:25, 16.25s/it] 18%|█▊        | 2230/12375 [10:33:26<47:23:08, 16.82s/it]                                                           18%|█▊        | 2230/12375 [10:33:26<47:23:08, 16.82s/it] 18%|█▊        | 2231/12375 [10:33:41<45:45:30, 16.24s/it] 18%|█▊        | 2232/12375 [10:33:57<44:58:06, 15.96s/it] 18%|█▊        | 2233/12375 [10:34:16<47:44:16, 16.95s/it] 18%|█▊        | 2234/12375 [10:34:32<46:51:07, 16.63s/it] 18%|█▊        | 2235/12375 [10:34:44<43:16:48, 15.37s/it] 18%|█▊        | 2236/12375 [10:35:01<44:16:24, 15.72s/it] 18%|█▊        | 2237/12375 [10:35:23<49:49:56, 17.70s/it] 18%|█▊        | 2238/12375 [10:35:39<48:43:01, 17.30s/it] 18%|█▊        | 2239/12375 [10:35:52<45:09:58, 16.04s/it] 18%|█▊        | 2240/12375 [10:36:06<43:17:49, 15.38s/it]                                                           18%|█▊        | 2240/12375 [10:36:06<43:17:49, 15.38s/it] 18%|█▊        | 2241/12375 [10:36:19<41:19:14, 14.68s/it] 18%|█▊        | 2242/12375 [10:36:38<44:20:45, 15.76s/it] 18%|█▊        | 2243/12375 [10:36:53<43:41:43, 15.53s/it] 18%|█▊        | 2244/12375 [10:37:09<44:20:29, 15.76s/it] 18%|█▊        | 2245/12375 [10:37:30<48:58:33, 17.41s/it] 18%|█▊        | 2246/12375 [10:37:51<52:10:05, 18.54s/it] 18%|█▊        | 2247/12375 [10:38:13<54:28:36, 19.36s/it] 18%|█▊        | 2248/12375 [10:38:25<48:25:35, 17.21s/it] 18%|█▊        | 2249/12375 [10:38:37<44:36:49, 15.86s/it] 18%|█▊        | 2250/12375 [10:38:50<41:38:40, 14.81s/it]                                                           18%|█▊        | 2250/12375 [10:38:50<41:38:40, 14.81s/it] 18%|█▊        | 2251/12375 [10:39:09<45:08:49, 16.05s/it] 18%|█▊        | 2252/12375 [10:39:25<45:20:35, 16.13s/it] 18%|█▊        | 2253/12375 [10:39:39<43:22:24, 15.43s/it] 18%|█▊        | 2254/12375 [10:39:51<40:36:24, 14.44s/it] 18%|█▊        | 2255/12375 [10:40:06<40:59:57, 14.58s/it] 18%|█▊        | 2256/12375 [10:40:22<42:23:43, 15.08s/it] 18%|█▊        | 2257/12375 [10:40:45<48:32:55, 17.27s/it] 18%|█▊        | 2258/12375 [10:41:00<46:56:02, 16.70s/it] 18%|█▊        | 2259/12375 [10:41:17<47:39:36, 16.96s/it] 18%|█▊        | 2260/12375 [10:41:31<44:54:43, 15.98s/it]                                                           18%|█▊        | 2260/12375 [10:41:31<44:54:43, 15.98s/it] 18%|█▊        | 2261/12375 [10:41:44<42:12:36, 15.02s/it] 18%|█▊        | 2262/12375 [10:42:03<45:36:33, 16.24s/it] 18%|█▊        | 2263/12375 [10:42:15<42:24:48, 15.10s/it] 18%|█▊        | 2264/12375 [10:42:31<43:08:30, 15.36s/it] 18%|█▊        | 2265/12375 [10:42:43<39:34:51, 14.09s/it] 18%|█▊        | 2266/12375 [10:43:00<42:20:35, 15.08s/it] 18%|█▊        | 2267/12375 [10:43:21<47:34:37, 16.94s/it] 18%|█▊        | 2268/12375 [10:43:34<43:39:06, 15.55s/it] 18%|█▊        | 2269/12375 [10:43:48<42:34:55, 15.17s/it] 18%|█▊        | 2270/12375 [10:44:07<46:10:39, 16.45s/it]                                                           18%|█▊        | 2270/12375 [10:44:07<46:10:39, 16.45s/it] 18%|█▊        | 2271/12375 [10:44:18<41:44:16, 14.87s/it] 18%|█▊        | 2272/12375 [10:44:35<42:59:03, 15.32s/it] 18%|█▊        | 2273/12375 [10:44:47<40:18:36, 14.37s/it] 18%|█▊        | 2274/12375 [10:45:05<43:04:24, 15.35s/it] 18%|█▊        | 2275/12375 [10:45:20<42:47:42, 15.25s/it] 18%|█▊        | 2276/12375 [10:45:37<44:13:41, 15.77s/it] 18%|█▊        | 2277/12375 [10:45:53<44:21:03, 15.81s/it] 18%|█▊        | 2278/12375 [10:46:10<45:56:13, 16.38s/it] 18%|█▊        | 2279/12375 [10:46:22<41:42:30, 14.87s/it] 18%|█▊        | 2280/12375 [10:46:38<42:40:05, 15.22s/it]                                                           18%|█▊        | 2280/12375 [10:46:38<42:40:05, 15.22s/it] 18%|█▊        | 2281/12375 [10:46:54<43:46:05, 15.61s/it] 18%|█▊        | 2282/12375 [10:47:11<44:39:23, 15.93s/it] 18%|█▊        | 2283/12375 [10:47:22<40:50:48, 14.57s/it] 18%|█▊        | 2284/12375 [10:47:40<43:22:05, 15.47s/it] 18%|█▊        | 2285/12375 [10:47:58<45:58:06, 16.40s/it] 18%|█▊        | 2286/12375 [10:48:22<51:56:02, 18.53s/it] 18%|█▊        | 2287/12375 [10:48:35<47:44:18, 17.04s/it] 18%|█▊        | 2288/12375 [10:48:52<47:35:49, 16.99s/it] 18%|█▊        | 2289/12375 [10:49:07<45:45:55, 16.34s/it] 19%|█▊        | 2290/12375 [10:49:21<43:34:38, 15.56s/it]                                                           19%|█▊        | 2290/12375 [10:49:21<43:34:38, 15.56s/it] 19%|█▊        | 2291/12375 [10:49:36<42:51:51, 15.30s/it] 19%|█▊        | 2292/12375 [10:49:52<44:07:48, 15.76s/it] 19%|█▊        | 2293/12375 [10:50:10<45:45:48, 16.34s/it] 19%|█▊        | 2294/12375 [10:50:22<42:18:24, 15.11s/it] 19%|█▊        | 2295/12375 [10:50:39<43:51:11, 15.66s/it] 19%|█▊        | 2296/12375 [10:50:53<42:22:02, 15.13s/it] 19%|█▊        | 2297/12375 [10:51:12<45:11:21, 16.14s/it] 19%|█▊        | 2298/12375 [10:51:27<44:26:07, 15.87s/it] 19%|█▊        | 2299/12375 [10:51:40<42:09:35, 15.06s/it] 19%|█▊        | 2300/12375 [10:51:52<39:40:42, 14.18s/it]                                                           19%|█▊        | 2300/12375 [10:51:52<39:40:42, 14.18s/it][INFO|trainer.py:3410] 2024-05-27 20:43:26,754 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2300
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 20:43:26,915 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 20:43:26,915 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2300/special_tokens_map.json
 19%|█▊        | 2301/12375 [10:52:08<40:51:48, 14.60s/it] 19%|█▊        | 2302/12375 [10:52:25<42:49:04, 15.30s/it] 19%|█▊        | 2303/12375 [10:52:44<45:58:17, 16.43s/it] 19%|█▊        | 2304/12375 [10:53:01<46:47:30, 16.73s/it] 19%|█▊        | 2305/12375 [10:53:15<44:20:08, 15.85s/it] 19%|█▊        | 2306/12375 [10:53:30<43:53:24, 15.69s/it] 19%|█▊        | 2307/12375 [10:53:51<47:41:37, 17.05s/it] 19%|█▊        | 2308/12375 [10:54:08<48:25:31, 17.32s/it] 19%|█▊        | 2309/12375 [10:54:25<47:36:20, 17.03s/it] 19%|█▊        | 2310/12375 [10:54:40<46:24:01, 16.60s/it]                                                           19%|█▊        | 2310/12375 [10:54:40<46:24:01, 16.60s/it] 19%|█▊        | 2311/12375 [10:54:55<44:33:52, 15.94s/it] 19%|█▊        | 2312/12375 [10:55:12<45:12:21, 16.17s/it] 19%|█▊        | 2313/12375 [10:55:27<44:53:54, 16.06s/it] 19%|█▊        | 2314/12375 [10:55:41<43:14:54, 15.48s/it] 19%|█▊        | 2315/12375 [10:56:01<46:23:05, 16.60s/it] 19%|█▊        | 2316/12375 [10:56:15<44:20:53, 15.87s/it] 19%|█▊        | 2317/12375 [10:56:36<48:26:04, 17.34s/it] 19%|█▊        | 2318/12375 [10:56:56<51:11:55, 18.33s/it] 19%|█▊        | 2319/12375 [10:57:13<49:27:42, 17.71s/it] 19%|█▊        | 2320/12375 [10:57:25<44:45:29, 16.02s/it]                                                           19%|█▊        | 2320/12375 [10:57:25<44:45:29, 16.02s/it] 19%|█▉        | 2321/12375 [10:57:42<45:34:43, 16.32s/it] 19%|█▉        | 2322/12375 [10:57:55<42:53:33, 15.36s/it] 19%|█▉        | 2323/12375 [10:58:08<41:19:45, 14.80s/it] 19%|█▉        | 2324/12375 [10:58:21<39:31:50, 14.16s/it] 19%|█▉        | 2325/12375 [10:58:34<38:47:14, 13.89s/it] 19%|█▉        | 2326/12375 [10:58:46<36:55:53, 13.23s/it] 19%|█▉        | 2327/12375 [10:58:57<35:14:20, 12.63s/it] 19%|█▉        | 2328/12375 [10:59:11<36:05:12, 12.93s/it] 19%|█▉        | 2329/12375 [10:59:27<38:29:55, 13.80s/it] 19%|█▉        | 2330/12375 [10:59:40<38:03:34, 13.64s/it]                                                           19%|█▉        | 2330/12375 [10:59:40<38:03:34, 13.64s/it] 19%|█▉        | 2331/12375 [11:00:03<46:26:24, 16.65s/it] 19%|█▉        | 2332/12375 [11:00:16<42:47:42, 15.34s/it] 19%|█▉        | 2333/12375 [11:00:41<50:47:16, 18.21s/it] 19%|█▉        | 2334/12375 [11:00:56<48:47:26, 17.49s/it] 19%|█▉        | 2335/12375 [11:01:11<46:02:40, 16.51s/it] 19%|█▉        | 2336/12375 [11:01:23<42:15:54, 15.16s/it] 19%|█▉        | 2337/12375 [11:01:41<44:37:45, 16.01s/it] 19%|█▉        | 2338/12375 [11:01:56<44:11:10, 15.85s/it] 19%|█▉        | 2339/12375 [11:02:15<46:22:03, 16.63s/it] 19%|█▉        | 2340/12375 [11:02:28<43:44:14, 15.69s/it]                                                           19%|█▉        | 2340/12375 [11:02:28<43:44:14, 15.69s/it] 19%|█▉        | 2341/12375 [11:02:45<44:54:42, 16.11s/it] 19%|█▉        | 2342/12375 [11:03:01<45:02:00, 16.16s/it] 19%|█▉        | 2343/12375 [11:03:18<45:20:51, 16.27s/it] 19%|█▉        | 2344/12375 [11:03:35<46:02:50, 16.53s/it] 19%|█▉        | 2345/12375 [11:03:56<49:33:33, 17.79s/it] 19%|█▉        | 2346/12375 [11:04:09<45:22:23, 16.29s/it] 19%|█▉        | 2347/12375 [11:04:22<43:01:38, 15.45s/it] 19%|█▉        | 2348/12375 [11:04:37<42:40:43, 15.32s/it] 19%|█▉        | 2349/12375 [11:04:53<42:54:37, 15.41s/it] 19%|█▉        | 2350/12375 [11:05:11<45:11:45, 16.23s/it]                                                           19%|█▉        | 2350/12375 [11:05:11<45:11:45, 16.23s/it] 19%|█▉        | 2351/12375 [11:05:28<45:43:00, 16.42s/it] 19%|█▉        | 2352/12375 [11:05:42<44:11:07, 15.87s/it] 19%|█▉        | 2353/12375 [11:05:55<41:08:25, 14.78s/it] 19%|█▉        | 2354/12375 [11:06:09<41:00:04, 14.73s/it] 19%|█▉        | 2355/12375 [11:06:24<40:44:06, 14.64s/it] 19%|█▉        | 2356/12375 [11:06:40<42:33:34, 15.29s/it] 19%|█▉        | 2357/12375 [11:06:53<40:10:57, 14.44s/it] 19%|█▉        | 2358/12375 [11:07:11<43:30:16, 15.64s/it] 19%|█▉        | 2359/12375 [11:07:26<42:43:29, 15.36s/it] 19%|█▉        | 2360/12375 [11:07:37<39:15:18, 14.11s/it]                                                           19%|█▉        | 2360/12375 [11:07:37<39:15:18, 14.11s/it] 19%|█▉        | 2361/12375 [11:07:49<37:27:41, 13.47s/it] 19%|█▉        | 2362/12375 [11:08:08<42:08:16, 15.15s/it] 19%|█▉        | 2363/12375 [11:08:24<42:59:13, 15.46s/it] 19%|█▉        | 2364/12375 [11:08:39<42:02:09, 15.12s/it] 19%|█▉        | 2365/12375 [11:08:52<40:16:08, 14.48s/it] 19%|█▉        | 2366/12375 [11:09:10<43:28:19, 15.64s/it] 19%|█▉        | 2367/12375 [11:09:26<43:54:19, 15.79s/it] 19%|█▉        | 2368/12375 [11:09:40<41:47:50, 15.04s/it] 19%|█▉        | 2369/12375 [11:09:59<45:18:22, 16.30s/it] 19%|█▉        | 2370/12375 [11:10:15<44:50:57, 16.14s/it]                                                           19%|█▉        | 2370/12375 [11:10:15<44:50:57, 16.14s/it] 19%|█▉        | 2371/12375 [11:10:28<42:58:23, 15.46s/it] 19%|█▉        | 2372/12375 [11:10:44<43:08:41, 15.53s/it] 19%|█▉        | 2373/12375 [11:10:58<41:42:53, 15.01s/it] 19%|█▉        | 2374/12375 [11:11:18<45:47:24, 16.48s/it] 19%|█▉        | 2375/12375 [11:11:29<41:02:50, 14.78s/it] 19%|█▉        | 2376/12375 [11:11:41<39:25:55, 14.20s/it] 19%|█▉        | 2377/12375 [11:11:58<41:24:29, 14.91s/it] 19%|█▉        | 2378/12375 [11:12:14<42:24:58, 15.27s/it] 19%|█▉        | 2379/12375 [11:12:32<44:21:59, 15.98s/it] 19%|█▉        | 2380/12375 [11:12:45<41:46:34, 15.05s/it]                                                           19%|█▉        | 2380/12375 [11:12:45<41:46:34, 15.05s/it] 19%|█▉        | 2381/12375 [11:12:59<41:06:25, 14.81s/it] 19%|█▉        | 2382/12375 [11:13:14<41:06:48, 14.81s/it] 19%|█▉        | 2383/12375 [11:13:25<38:10:12, 13.75s/it] 19%|█▉        | 2384/12375 [11:13:53<49:43:41, 17.92s/it] 19%|█▉        | 2385/12375 [11:14:04<43:49:25, 15.79s/it] 19%|█▉        | 2386/12375 [11:14:21<45:10:26, 16.28s/it] 19%|█▉        | 2387/12375 [11:14:37<45:12:51, 16.30s/it] 19%|█▉        | 2388/12375 [11:14:55<46:12:45, 16.66s/it] 19%|█▉        | 2389/12375 [11:15:13<47:46:49, 17.23s/it] 19%|█▉        | 2390/12375 [11:15:27<44:59:52, 16.22s/it]                                                           19%|█▉        | 2390/12375 [11:15:27<44:59:52, 16.22s/it] 19%|█▉        | 2391/12375 [11:15:42<44:08:09, 15.91s/it] 19%|█▉        | 2392/12375 [11:15:58<43:47:35, 15.79s/it] 19%|█▉        | 2393/12375 [11:16:20<49:19:07, 17.79s/it] 19%|█▉        | 2394/12375 [11:16:47<56:18:58, 20.31s/it] 19%|█▉        | 2395/12375 [11:17:06<55:34:01, 20.04s/it] 19%|█▉        | 2396/12375 [11:17:22<51:54:56, 18.73s/it] 19%|█▉        | 2397/12375 [11:17:35<47:39:51, 17.20s/it] 19%|█▉        | 2398/12375 [11:17:53<47:53:15, 17.28s/it] 19%|█▉        | 2399/12375 [11:18:12<49:50:30, 17.99s/it] 19%|█▉        | 2400/12375 [11:18:26<46:23:05, 16.74s/it]                                                           19%|█▉        | 2400/12375 [11:18:26<46:23:05, 16.74s/it][INFO|trainer.py:3410] 2024-05-27 21:10:00,754 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2400
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 21:10:00,917 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 21:10:00,918 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2400/special_tokens_map.json
 19%|█▉        | 2401/12375 [11:18:39<43:30:20, 15.70s/it] 19%|█▉        | 2402/12375 [11:19:02<48:50:32, 17.63s/it] 19%|█▉        | 2403/12375 [11:19:18<47:57:52, 17.32s/it] 19%|█▉        | 2404/12375 [11:19:30<43:41:11, 15.77s/it] 19%|█▉        | 2405/12375 [11:19:50<46:58:43, 16.96s/it] 19%|█▉        | 2406/12375 [11:20:06<45:51:55, 16.56s/it] 19%|█▉        | 2407/12375 [11:20:24<47:08:22, 17.02s/it] 19%|█▉        | 2408/12375 [11:20:41<47:27:59, 17.14s/it] 19%|█▉        | 2409/12375 [11:20:54<43:59:47, 15.89s/it] 19%|█▉        | 2410/12375 [11:21:08<42:03:01, 15.19s/it]                                                           19%|█▉        | 2410/12375 [11:21:08<42:03:01, 15.19s/it] 19%|█▉        | 2411/12375 [11:21:24<42:41:48, 15.43s/it] 19%|█▉        | 2412/12375 [11:21:39<42:21:22, 15.30s/it] 19%|█▉        | 2413/12375 [11:21:55<42:52:32, 15.49s/it] 20%|█▉        | 2414/12375 [11:22:06<39:00:34, 14.10s/it] 20%|█▉        | 2415/12375 [11:22:23<41:36:07, 15.04s/it] 20%|█▉        | 2416/12375 [11:22:43<45:42:49, 16.52s/it] 20%|█▉        | 2417/12375 [11:23:01<46:54:32, 16.96s/it] 20%|█▉        | 2418/12375 [11:23:22<50:40:04, 18.32s/it] 20%|█▉        | 2419/12375 [11:23:39<49:16:47, 17.82s/it] 20%|█▉        | 2420/12375 [11:23:55<47:38:29, 17.23s/it]                                                           20%|█▉        | 2420/12375 [11:23:55<47:38:29, 17.23s/it] 20%|█▉        | 2421/12375 [11:24:10<45:38:31, 16.51s/it] 20%|█▉        | 2422/12375 [11:24:22<41:58:09, 15.18s/it] 20%|█▉        | 2423/12375 [11:24:37<41:45:14, 15.10s/it] 20%|█▉        | 2424/12375 [11:24:49<39:42:22, 14.36s/it] 20%|█▉        | 2425/12375 [11:25:01<37:49:24, 13.68s/it] 20%|█▉        | 2426/12375 [11:25:18<40:35:28, 14.69s/it] 20%|█▉        | 2427/12375 [11:25:39<45:50:27, 16.59s/it] 20%|█▉        | 2428/12375 [11:25:59<48:09:06, 17.43s/it] 20%|█▉        | 2429/12375 [11:26:17<48:57:05, 17.72s/it] 20%|█▉        | 2430/12375 [11:26:35<49:01:33, 17.75s/it]                                                           20%|█▉        | 2430/12375 [11:26:35<49:01:33, 17.75s/it] 20%|█▉        | 2431/12375 [11:26:48<45:19:14, 16.41s/it] 20%|█▉        | 2432/12375 [11:27:03<44:14:03, 16.02s/it] 20%|█▉        | 2433/12375 [11:27:21<45:14:35, 16.38s/it] 20%|█▉        | 2434/12375 [11:27:38<45:47:10, 16.58s/it] 20%|█▉        | 2435/12375 [11:27:50<42:40:41, 15.46s/it] 20%|█▉        | 2436/12375 [11:28:04<41:19:50, 14.97s/it] 20%|█▉        | 2437/12375 [11:28:21<42:26:19, 15.37s/it] 20%|█▉        | 2438/12375 [11:28:34<40:44:27, 14.76s/it] 20%|█▉        | 2439/12375 [11:28:48<40:18:17, 14.60s/it] 20%|█▉        | 2440/12375 [11:29:08<44:17:58, 16.05s/it]                                                           20%|█▉        | 2440/12375 [11:29:08<44:17:58, 16.05s/it] 20%|█▉        | 2441/12375 [11:29:26<46:09:56, 16.73s/it] 20%|█▉        | 2442/12375 [11:29:43<46:07:11, 16.72s/it] 20%|█▉        | 2443/12375 [11:29:57<44:36:24, 16.17s/it] 20%|█▉        | 2444/12375 [11:30:16<46:12:59, 16.75s/it] 20%|█▉        | 2445/12375 [11:30:33<46:39:02, 16.91s/it] 20%|█▉        | 2446/12375 [11:30:49<46:21:29, 16.81s/it] 20%|█▉        | 2447/12375 [11:31:04<44:39:50, 16.20s/it] 20%|█▉        | 2448/12375 [11:31:21<45:03:20, 16.34s/it] 20%|█▉        | 2449/12375 [11:31:39<46:12:10, 16.76s/it] 20%|█▉        | 2450/12375 [11:31:53<43:58:47, 15.95s/it]                                                           20%|█▉        | 2450/12375 [11:31:53<43:58:47, 15.95s/it] 20%|█▉        | 2451/12375 [11:32:10<45:25:37, 16.48s/it] 20%|█▉        | 2452/12375 [11:32:23<42:08:54, 15.29s/it] 20%|█▉        | 2453/12375 [11:32:41<44:10:08, 16.03s/it] 20%|█▉        | 2454/12375 [11:32:58<45:05:21, 16.36s/it] 20%|█▉        | 2455/12375 [11:33:11<42:35:08, 15.45s/it] 20%|█▉        | 2456/12375 [11:33:24<40:35:12, 14.73s/it] 20%|█▉        | 2457/12375 [11:33:37<38:39:03, 14.03s/it] 20%|█▉        | 2458/12375 [11:33:47<35:53:44, 13.03s/it] 20%|█▉        | 2459/12375 [11:34:02<37:12:03, 13.51s/it] 20%|█▉        | 2460/12375 [11:34:14<36:15:38, 13.17s/it]                                                           20%|█▉        | 2460/12375 [11:34:14<36:15:38, 13.17s/it] 20%|█▉        | 2461/12375 [11:34:31<39:33:09, 14.36s/it] 20%|█▉        | 2462/12375 [11:34:44<37:57:37, 13.79s/it] 20%|█▉        | 2463/12375 [11:35:01<40:53:39, 14.85s/it] 20%|█▉        | 2464/12375 [11:35:15<40:13:22, 14.61s/it] 20%|█▉        | 2465/12375 [11:35:27<38:03:23, 13.82s/it] 20%|█▉        | 2466/12375 [11:35:41<37:35:54, 13.66s/it] 20%|█▉        | 2467/12375 [11:35:56<39:10:40, 14.23s/it] 20%|█▉        | 2468/12375 [11:36:13<41:18:44, 15.01s/it] 20%|█▉        | 2469/12375 [11:36:29<42:11:24, 15.33s/it] 20%|█▉        | 2470/12375 [11:36:46<43:22:27, 15.76s/it]                                                           20%|█▉        | 2470/12375 [11:36:46<43:22:27, 15.76s/it] 20%|█▉        | 2471/12375 [11:37:06<46:44:49, 16.99s/it] 20%|█▉        | 2472/12375 [11:37:18<43:17:31, 15.74s/it] 20%|█▉        | 2473/12375 [11:37:33<41:55:22, 15.24s/it] 20%|█▉        | 2474/12375 [11:37:50<44:07:43, 16.05s/it] 20%|██        | 2475/12375 [11:38:07<44:12:59, 16.08s/it] 20%|██        | 2476/12375 [11:38:24<45:21:24, 16.50s/it] 20%|██        | 2477/12375 [11:38:41<45:25:34, 16.52s/it] 20%|██        | 2478/12375 [11:38:58<46:17:06, 16.84s/it] 20%|██        | 2479/12375 [11:39:18<48:48:09, 17.75s/it] 20%|██        | 2480/12375 [11:39:37<49:36:26, 18.05s/it]                                                           20%|██        | 2480/12375 [11:39:37<49:36:26, 18.05s/it] 20%|██        | 2481/12375 [11:39:53<48:02:09, 17.48s/it] 20%|██        | 2482/12375 [11:40:13<49:47:23, 18.12s/it] 20%|██        | 2483/12375 [11:40:29<48:29:32, 17.65s/it] 20%|██        | 2484/12375 [11:40:42<44:46:46, 16.30s/it] 20%|██        | 2485/12375 [11:41:03<48:31:35, 17.66s/it] 20%|██        | 2486/12375 [11:41:19<47:17:27, 17.22s/it] 20%|██        | 2487/12375 [11:41:37<48:03:16, 17.50s/it] 20%|██        | 2488/12375 [11:41:51<45:00:54, 16.39s/it] 20%|██        | 2489/12375 [11:42:04<41:52:16, 15.25s/it] 20%|██        | 2490/12375 [11:42:22<44:09:11, 16.08s/it]                                                           20%|██        | 2490/12375 [11:42:22<44:09:11, 16.08s/it] 20%|██        | 2491/12375 [11:42:41<46:17:40, 16.86s/it] 20%|██        | 2492/12375 [11:42:59<47:50:30, 17.43s/it] 20%|██        | 2493/12375 [11:43:16<47:00:55, 17.13s/it] 20%|██        | 2494/12375 [11:43:39<51:55:20, 18.92s/it] 20%|██        | 2495/12375 [11:43:55<49:51:39, 18.17s/it] 20%|██        | 2496/12375 [11:44:13<49:50:06, 18.16s/it] 20%|██        | 2497/12375 [11:44:33<50:39:30, 18.46s/it] 20%|██        | 2498/12375 [11:44:49<49:17:51, 17.97s/it] 20%|██        | 2499/12375 [11:45:09<50:32:54, 18.43s/it] 20%|██        | 2500/12375 [11:45:22<46:07:48, 16.82s/it]                                                           20%|██        | 2500/12375 [11:45:22<46:07:48, 16.82s/it][INFO|trainer.py:3719] 2024-05-27 21:36:56,528 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-27 21:36:56,528 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-27 21:36:56,528 >>   Batch size = 32
{'eval_loss': 1.1071332693099976, 'eval_runtime': 559.5548, 'eval_samples_per_second': 8.936, 'eval_steps_per_second': 0.281, 'epoch': 0.16}
{'loss': 1.1238, 'grad_norm': 1.5125621557235718, 'learning_rate': 9.363733094382029e-05, 'epoch': 0.16}
{'loss': 1.0964, 'grad_norm': 1.6169190406799316, 'learning_rate': 9.357522454934579e-05, 'epoch': 0.16}
{'loss': 1.0726, 'grad_norm': 1.7713686227798462, 'learning_rate': 9.35128373169501e-05, 'epoch': 0.16}
{'loss': 1.1009, 'grad_norm': 1.993675947189331, 'learning_rate': 9.345016964871268e-05, 'epoch': 0.16}
{'loss': 1.0518, 'grad_norm': 1.46645188331604, 'learning_rate': 9.338722194852028e-05, 'epoch': 0.17}
{'loss': 1.0913, 'grad_norm': 1.8242127895355225, 'learning_rate': 9.332399462206447e-05, 'epoch': 0.17}
{'loss': 1.0968, 'grad_norm': 1.722859263420105, 'learning_rate': 9.326048807683901e-05, 'epoch': 0.17}
{'loss': 1.0952, 'grad_norm': 1.663270115852356, 'learning_rate': 9.319670272213715e-05, 'epoch': 0.17}
{'loss': 1.0969, 'grad_norm': 1.9320547580718994, 'learning_rate': 9.313263896904905e-05, 'epoch': 0.17}
{'loss': 1.1402, 'grad_norm': 1.4602344036102295, 'learning_rate': 9.306829723045913e-05, 'epoch': 0.17}
{'loss': 1.0491, 'grad_norm': 1.8550666570663452, 'learning_rate': 9.300367792104344e-05, 'epoch': 0.17}
{'loss': 1.1018, 'grad_norm': 1.6901507377624512, 'learning_rate': 9.293878145726687e-05, 'epoch': 0.17}
{'loss': 1.1459, 'grad_norm': 1.5906869173049927, 'learning_rate': 9.287360825738056e-05, 'epoch': 0.17}
{'loss': 1.1188, 'grad_norm': 1.5596213340759277, 'learning_rate': 9.280815874141922e-05, 'epoch': 0.17}
{'loss': 1.0806, 'grad_norm': 2.128476858139038, 'learning_rate': 9.274243333119836e-05, 'epoch': 0.17}
{'loss': 1.1265, 'grad_norm': 1.76740562915802, 'learning_rate': 9.267643245031164e-05, 'epoch': 0.17}
{'loss': 1.0709, 'grad_norm': 1.6865431070327759, 'learning_rate': 9.261015652412802e-05, 'epoch': 0.18}
{'loss': 1.0458, 'grad_norm': 1.5099668502807617, 'learning_rate': 9.25436059797892e-05, 'epoch': 0.18}
{'loss': 1.0776, 'grad_norm': 2.1026203632354736, 'learning_rate': 9.247678124620668e-05, 'epoch': 0.18}
{'loss': 1.1133, 'grad_norm': 1.778968334197998, 'learning_rate': 9.240968275405914e-05, 'epoch': 0.18}
{'loss': 1.1384, 'grad_norm': 1.5058238506317139, 'learning_rate': 9.234231093578957e-05, 'epoch': 0.18}
{'loss': 1.0683, 'grad_norm': 1.8394432067871094, 'learning_rate': 9.227466622560256e-05, 'epoch': 0.18}
{'loss': 1.0679, 'grad_norm': 1.688439965248108, 'learning_rate': 9.220674905946142e-05, 'epoch': 0.18}
{'loss': 1.0846, 'grad_norm': 1.6188558340072632, 'learning_rate': 9.213855987508541e-05, 'epoch': 0.18}
{'loss': 1.0762, 'grad_norm': 1.5800455808639526, 'learning_rate': 9.207009911194697e-05, 'epoch': 0.18}
{'loss': 1.1119, 'grad_norm': 1.9218474626541138, 'learning_rate': 9.200136721126877e-05, 'epoch': 0.18}
{'loss': 1.0528, 'grad_norm': 1.8880013227462769, 'learning_rate': 9.1932364616021e-05, 'epoch': 0.18}
{'loss': 1.1056, 'grad_norm': 1.8075956106185913, 'learning_rate': 9.186309177091839e-05, 'epoch': 0.18}
{'loss': 1.0755, 'grad_norm': 1.6795653104782104, 'learning_rate': 9.179354912241744e-05, 'epoch': 0.19}
{'loss': 1.0986, 'grad_norm': 1.7314327955245972, 'learning_rate': 9.17237371187135e-05, 'epoch': 0.19}
{'loss': 1.104, 'grad_norm': 1.6653051376342773, 'learning_rate': 9.165365620973787e-05, 'epoch': 0.19}
{'loss': 1.1029, 'grad_norm': 1.6051169633865356, 'learning_rate': 9.158330684715495e-05, 'epoch': 0.19}
{'loss': 1.0633, 'grad_norm': 1.7578086853027344, 'learning_rate': 9.151268948435924e-05, 'epoch': 0.19}
{'loss': 1.0735, 'grad_norm': 1.634775996208191, 'learning_rate': 9.144180457647258e-05, 'epoch': 0.19}
{'loss': 1.076, 'grad_norm': 1.6373958587646484, 'learning_rate': 9.137065258034096e-05, 'epoch': 0.19}
{'loss': 1.1025, 'grad_norm': 1.7813878059387207, 'learning_rate': 9.129923395453188e-05, 'epoch': 0.19}
{'loss': 1.1004, 'grad_norm': 1.5182687044143677, 'learning_rate': 9.122754915933111e-05, 'epoch': 0.19}
{'loss': 1.1263, 'grad_norm': 1.510374903678894, 'learning_rate': 9.115559865673998e-05, 'epoch': 0.19}
{'loss': 1.0432, 'grad_norm': 1.6285066604614258, 'learning_rate': 9.108338291047215e-05, 'epoch': 0.19}
{'loss': 1.0398, 'grad_norm': 1.8260024785995483, 'learning_rate': 9.101090238595083e-05, 'epoch': 0.19}
{'loss': 1.1475, 'grad_norm': 2.031294345855713, 'learning_rate': 9.09381575503057e-05, 'epoch': 0.19}
{'loss': 1.1045, 'grad_norm': 1.6848968267440796, 'learning_rate': 9.086514887236987e-05, 'epoch': 0.2}
{'loss': 1.1204, 'grad_norm': 1.5629703998565674, 'learning_rate': 9.079187682267688e-05, 'epoch': 0.2}
{'loss': 1.0749, 'grad_norm': 1.7259454727172852, 'learning_rate': 9.071834187345769e-05, 'epoch': 0.2}
{'loss': 1.078, 'grad_norm': 1.7488332986831665, 'learning_rate': 9.064454449863766e-05, 'epoch': 0.2}
{'loss': 1.0811, 'grad_norm': 1.7044259309768677, 'learning_rate': 9.057048517383337e-05, 'epoch': 0.2}
{'loss': 1.0841, 'grad_norm': 1.6145846843719482, 'learning_rate': 9.049616437634971e-05, 'epoch': 0.2}
{'loss': 1.0667, 'grad_norm': 1.5784578323364258, 'learning_rate': 9.04215825851767e-05, 'epoch': 0.2}
{'loss': 1.1031, 'grad_norm': 1.6641192436218262, 'learning_rate': 9.034674028098649e-05, 'epoch': 0.2}
{'loss': 1.0858, 'grad_norm': 1.3704075813293457, 'learning_rate': 9.027163794613012e-05, 'epoch': 0.2}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:51,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:09,  2.01s/it][A
  3%|▎         | 4/157 [00:09<06:45,  2.65s/it][A
  3%|▎         | 5/157 [00:14<08:26,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:46,  3.48s/it][A
  4%|▍         | 7/157 [00:21<08:41,  3.48s/it][A
  5%|▌         | 8/157 [00:25<09:15,  3.73s/it][A
  6%|▌         | 9/157 [00:28<08:19,  3.37s/it][A
  6%|▋         | 10/157 [00:31<08:19,  3.40s/it][A
  7%|▋         | 11/157 [00:33<07:29,  3.08s/it][A
  8%|▊         | 12/157 [00:36<07:10,  2.97s/it][A
  8%|▊         | 13/157 [00:39<07:06,  2.96s/it][A
  9%|▉         | 14/157 [00:43<07:32,  3.16s/it][A
 10%|▉         | 15/157 [00:46<07:50,  3.31s/it][A
 10%|█         | 16/157 [00:51<08:19,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:45,  3.33s/it][A
 11%|█▏        | 18/157 [00:56<07:13,  3.12s/it][A
 12%|█▏        | 19/157 [01:00<07:53,  3.43s/it][A
 13%|█▎        | 20/157 [01:04<07:53,  3.46s/it][A
 13%|█▎        | 21/157 [01:07<07:48,  3.44s/it][A
 14%|█▍        | 22/157 [01:10<07:26,  3.31s/it][A
 15%|█▍        | 23/157 [01:13<07:11,  3.22s/it][A
 15%|█▌        | 24/157 [01:17<07:34,  3.41s/it][A
 16%|█▌        | 25/157 [01:20<07:30,  3.41s/it][A
 17%|█▋        | 26/157 [01:24<07:27,  3.41s/it][A
 17%|█▋        | 27/157 [01:29<08:33,  3.95s/it][A
 18%|█▊        | 28/157 [01:33<08:29,  3.95s/it][A
 18%|█▊        | 29/157 [01:36<07:44,  3.63s/it][A
 19%|█▉        | 30/157 [01:39<07:12,  3.40s/it][A
 20%|█▉        | 31/157 [01:42<07:20,  3.50s/it][A
 20%|██        | 32/157 [01:46<07:19,  3.51s/it][A
 21%|██        | 33/157 [01:50<07:39,  3.70s/it][A
 22%|██▏       | 34/157 [01:54<07:47,  3.80s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.72s/it][A
 23%|██▎       | 36/157 [02:02<08:00,  3.97s/it][A
 24%|██▎       | 37/157 [02:06<07:46,  3.89s/it][A
 24%|██▍       | 38/157 [02:09<07:33,  3.81s/it][A
 25%|██▍       | 39/157 [02:13<07:13,  3.68s/it][A
 25%|██▌       | 40/157 [02:16<06:36,  3.39s/it][A
 26%|██▌       | 41/157 [02:19<06:49,  3.53s/it][A
 27%|██▋       | 42/157 [02:25<07:54,  4.13s/it][A
 27%|██▋       | 43/157 [02:28<07:03,  3.71s/it][A
 28%|██▊       | 44/157 [02:32<07:04,  3.76s/it][A
 29%|██▊       | 45/157 [02:35<06:39,  3.57s/it][A
 29%|██▉       | 46/157 [02:37<06:09,  3.33s/it][A
 30%|██▉       | 47/157 [02:41<06:00,  3.28s/it][A
 31%|███       | 48/157 [02:47<07:46,  4.28s/it][A
 31%|███       | 49/157 [02:50<06:51,  3.81s/it][A
 32%|███▏      | 50/157 [02:53<06:24,  3.59s/it][A
 32%|███▏      | 51/157 [02:57<06:29,  3.67s/it][A
 33%|███▎      | 52/157 [03:01<06:33,  3.75s/it][A
 34%|███▍      | 53/157 [03:05<06:58,  4.02s/it][A
 34%|███▍      | 54/157 [03:09<06:35,  3.84s/it][A
 35%|███▌      | 55/157 [03:13<06:47,  4.00s/it][A
 36%|███▌      | 56/157 [03:17<06:50,  4.07s/it][A
 36%|███▋      | 57/157 [03:22<06:46,  4.07s/it][A
 37%|███▋      | 58/157 [03:25<06:26,  3.90s/it][A
 38%|███▊      | 59/157 [03:30<06:49,  4.18s/it][A
 38%|███▊      | 60/157 [03:34<06:41,  4.14s/it][A
 39%|███▉      | 61/157 [03:38<06:20,  3.96s/it][A
 39%|███▉      | 62/157 [03:42<06:38,  4.19s/it][A
 40%|████      | 63/157 [03:46<06:12,  3.96s/it][A
 41%|████      | 64/157 [03:50<06:21,  4.10s/it][A
 41%|████▏     | 65/157 [03:55<06:32,  4.27s/it][A
 42%|████▏     | 66/157 [03:57<05:41,  3.76s/it][A
 43%|████▎     | 67/157 [04:02<06:11,  4.13s/it][A
 43%|████▎     | 68/157 [04:05<05:26,  3.67s/it][A
 44%|████▍     | 69/157 [04:08<05:02,  3.43s/it][A
 45%|████▍     | 70/157 [04:12<05:23,  3.72s/it][A
 45%|████▌     | 71/157 [04:16<05:10,  3.61s/it][A
 46%|████▌     | 72/157 [04:18<04:48,  3.39s/it][A
 46%|████▋     | 73/157 [04:21<04:22,  3.12s/it][A
 47%|████▋     | 74/157 [04:25<04:42,  3.40s/it][A
 48%|████▊     | 75/157 [04:29<04:55,  3.61s/it][A
 48%|████▊     | 76/157 [04:33<05:03,  3.75s/it][A
 49%|████▉     | 77/157 [04:37<04:57,  3.71s/it][A
 50%|████▉     | 78/157 [04:40<04:31,  3.43s/it][A
 50%|█████     | 79/157 [04:44<04:59,  3.84s/it][A
 51%|█████     | 80/157 [04:47<04:29,  3.51s/it][A
 52%|█████▏    | 81/157 [04:50<04:05,  3.23s/it][A
 52%|█████▏    | 82/157 [04:53<04:00,  3.21s/it][A
 53%|█████▎    | 83/157 [04:57<04:16,  3.46s/it][A
 54%|█████▎    | 84/157 [05:01<04:27,  3.67s/it][A
 54%|█████▍    | 85/157 [05:05<04:30,  3.75s/it][A
 55%|█████▍    | 86/157 [05:10<04:45,  4.02s/it][A
 55%|█████▌    | 87/157 [05:13<04:34,  3.93s/it][A
 56%|█████▌    | 88/157 [05:17<04:23,  3.82s/it][A
 57%|█████▋    | 89/157 [05:20<04:09,  3.66s/it][A
 57%|█████▋    | 90/157 [05:24<04:12,  3.77s/it][A
 58%|█████▊    | 91/157 [05:28<04:06,  3.73s/it][A
 59%|█████▊    | 92/157 [05:31<03:47,  3.49s/it][A
 59%|█████▉    | 93/157 [05:36<04:14,  3.98s/it][A
 60%|█████▉    | 94/157 [05:39<03:53,  3.71s/it][A
 61%|██████    | 95/157 [05:42<03:43,  3.61s/it][A
 61%|██████    | 96/157 [05:45<03:31,  3.47s/it][A
 62%|██████▏   | 97/157 [05:49<03:22,  3.38s/it][A
 62%|██████▏   | 98/157 [05:51<03:02,  3.09s/it][A
 63%|██████▎   | 99/157 [05:55<03:16,  3.39s/it][A
 64%|██████▎   | 100/157 [05:58<03:06,  3.27s/it][A
 64%|██████▍   | 101/157 [06:01<02:54,  3.12s/it][A
 65%|██████▍   | 102/157 [06:04<02:48,  3.07s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.89s/it][A
 66%|██████▌   | 104/157 [06:11<02:55,  3.30s/it][A
 67%|██████▋   | 105/157 [06:15<03:03,  3.53s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.86s/it][A
 68%|██████▊   | 107/157 [06:24<03:20,  4.02s/it][A
 69%|██████▉   | 108/157 [06:28<03:14,  3.97s/it][A
 69%|██████▉   | 109/157 [06:31<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:35<03:01,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.47s/it][A
 72%|███████▏  | 113/157 [06:45<02:29,  3.40s/it][A
 73%|███████▎  | 114/157 [06:48<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:58<02:51,  4.18s/it][A
 75%|███████▍  | 117/157 [07:01<02:31,  3.79s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.50s/it][A
 76%|███████▌  | 119/157 [07:07<02:14,  3.55s/it][A
 76%|███████▋  | 120/157 [07:10<02:02,  3.30s/it][A
 77%|███████▋  | 121/157 [07:13<01:54,  3.19s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.33s/it][A
 78%|███████▊  | 123/157 [07:20<01:57,  3.47s/it][A
 79%|███████▉  | 124/157 [07:24<01:55,  3.50s/it][A
 80%|███████▉  | 125/157 [07:27<01:45,  3.30s/it][A
 80%|████████  | 126/157 [07:30<01:47,  3.47s/it][A
 81%|████████  | 127/157 [07:33<01:37,  3.26s/it][A
 82%|████████▏ | 128/157 [07:36<01:29,  3.10s/it][A
 82%|████████▏ | 129/157 [07:38<01:22,  2.94s/it][A
 83%|████████▎ | 130/157 [07:42<01:27,  3.24s/it][A
 83%|████████▎ | 131/157 [07:46<01:25,  3.31s/it][A
 84%|████████▍ | 132/157 [07:50<01:30,  3.60s/it][A
 85%|████████▍ | 133/157 [07:53<01:22,  3.42s/it][A
 85%|████████▌ | 134/157 [07:56<01:17,  3.39s/it][A
 86%|████████▌ | 135/157 [08:00<01:17,  3.51s/it][A
 87%|████████▋ | 136/157 [08:03<01:09,  3.32s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.59s/it][A
 88%|████████▊ | 138/157 [08:10<01:05,  3.45s/it][A
 89%|████████▊ | 139/157 [08:15<01:05,  3.64s/it][A
 89%|████████▉ | 140/157 [08:18<01:00,  3.58s/it][A
 90%|████████▉ | 141/157 [08:21<00:55,  3.45s/it][A
 90%|█████████ | 142/157 [08:25<00:54,  3.64s/it][A
 91%|█████████ | 143/157 [08:30<00:55,  3.96s/it][A
 92%|█████████▏| 144/157 [08:34<00:49,  3.85s/it][A
 92%|█████████▏| 145/157 [08:38<00:48,  4.01s/it][A
 93%|█████████▎| 146/157 [08:42<00:43,  3.93s/it][A
 94%|█████████▎| 147/157 [08:47<00:42,  4.27s/it][A
 94%|█████████▍| 148/157 [08:50<00:35,  3.92s/it][A
 95%|█████████▍| 149/157 [08:54<00:31,  3.95s/it][A
 96%|█████████▌| 150/157 [08:57<00:25,  3.70s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.63s/it][A
 97%|█████████▋| 152/157 [09:04<00:17,  3.48s/it][A
 97%|█████████▋| 153/157 [09:06<00:12,  3.18s/it][A
 98%|█████████▊| 154/157 [09:10<00:09,  3.28s/it][A
 99%|█████████▊| 155/157 [09:12<00:06,  3.00s/it][A
 99%|█████████▉| 156/157 [09:16<00:03,  3.32s/it][A
100%|██████████| 157/157 [09:17<00:00,  2.52s/it][A                                                          
                                                 [A 20%|██        | 2500/12375 [11:54:42<46:07:48, 16.82s/it]
100%|██████████| 157/157 [09:17<00:00,  2.52s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-27 21:46:16,953 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2500
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 21:46:17,113 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 21:46:17,114 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2500/special_tokens_map.json
 20%|██        | 2501/12375 [11:54:57<505:18:50, 184.23s/it] 20%|██        | 2502/12375 [11:55:10<364:18:45, 132.84s/it] 20%|██        | 2503/12375 [11:55:27<269:07:06, 98.14s/it]  20%|██        | 2504/12375 [11:55:44<202:13:36, 73.75s/it] 20%|██        | 2505/12375 [11:56:03<157:28:43, 57.44s/it] 20%|██        | 2506/12375 [11:56:19<122:52:42, 44.82s/it] 20%|██        | 2507/12375 [11:56:37<101:05:48, 36.88s/it] 20%|██        | 2508/12375 [11:56:52<83:13:54, 30.37s/it]  20%|██        | 2509/12375 [11:57:06<70:02:06, 25.56s/it] 20%|██        | 2510/12375 [11:57:21<61:12:51, 22.34s/it]                                                           20%|██        | 2510/12375 [11:57:21<61:12:51, 22.34s/it] 20%|██        | 2511/12375 [11:57:38<56:44:39, 20.71s/it] 20%|██        | 2512/12375 [11:57:52<50:56:24, 18.59s/it] 20%|██        | 2513/12375 [11:58:06<47:02:14, 17.17s/it] 20%|██        | 2514/12375 [11:58:25<49:12:27, 17.96s/it] 20%|██        | 2515/12375 [11:58:40<46:02:26, 16.81s/it] 20%|██        | 2516/12375 [11:58:57<46:46:49, 17.08s/it] 20%|██        | 2517/12375 [11:59:12<44:51:02, 16.38s/it] 20%|██        | 2518/12375 [11:59:27<43:54:39, 16.04s/it] 20%|██        | 2519/12375 [11:59:41<41:49:11, 15.28s/it] 20%|██        | 2520/12375 [12:00:06<50:24:38, 18.41s/it]                                                           20%|██        | 2520/12375 [12:00:06<50:24:38, 18.41s/it] 20%|██        | 2521/12375 [12:00:25<50:23:41, 18.41s/it] 20%|██        | 2522/12375 [12:00:40<48:01:59, 17.55s/it] 20%|██        | 2523/12375 [12:01:02<51:09:31, 18.69s/it] 20%|██        | 2524/12375 [12:01:21<51:29:09, 18.82s/it] 20%|██        | 2525/12375 [12:01:38<49:41:20, 18.16s/it] 20%|██        | 2526/12375 [12:01:50<45:16:22, 16.55s/it] 20%|██        | 2527/12375 [12:02:07<45:30:21, 16.64s/it] 20%|██        | 2528/12375 [12:02:25<46:37:59, 17.05s/it] 20%|██        | 2529/12375 [12:02:42<46:23:33, 16.96s/it] 20%|██        | 2530/12375 [12:02:58<45:23:46, 16.60s/it]                                                           20%|██        | 2530/12375 [12:02:58<45:23:46, 16.60s/it] 20%|██        | 2531/12375 [12:03:12<43:23:18, 15.87s/it] 20%|██        | 2532/12375 [12:03:23<39:25:30, 14.42s/it] 20%|██        | 2533/12375 [12:03:42<43:30:50, 15.92s/it] 20%|██        | 2534/12375 [12:03:55<40:33:04, 14.83s/it] 20%|██        | 2535/12375 [12:04:10<40:39:42, 14.88s/it] 20%|██        | 2536/12375 [12:04:24<40:08:15, 14.69s/it] 21%|██        | 2537/12375 [12:04:41<42:22:39, 15.51s/it] 21%|██        | 2538/12375 [12:04:59<44:00:01, 16.10s/it] 21%|██        | 2539/12375 [12:05:15<44:21:20, 16.23s/it] 21%|██        | 2540/12375 [12:05:31<44:19:31, 16.22s/it]                                                           21%|██        | 2540/12375 [12:05:31<44:19:31, 16.22s/it] 21%|██        | 2541/12375 [12:05:48<44:23:36, 16.25s/it] 21%|██        | 2542/12375 [12:06:00<41:26:27, 15.17s/it] 21%|██        | 2543/12375 [12:06:15<41:02:23, 15.03s/it] 21%|██        | 2544/12375 [12:06:33<43:33:43, 15.95s/it] 21%|██        | 2545/12375 [12:06:46<40:40:22, 14.90s/it] 21%|██        | 2546/12375 [12:06:59<39:13:00, 14.36s/it] 21%|██        | 2547/12375 [12:07:21<45:27:45, 16.65s/it] 21%|██        | 2548/12375 [12:07:35<43:40:24, 16.00s/it] 21%|██        | 2549/12375 [12:07:53<44:53:42, 16.45s/it] 21%|██        | 2550/12375 [12:08:11<46:06:12, 16.89s/it]                                                           21%|██        | 2550/12375 [12:08:11<46:06:12, 16.89s/it] 21%|██        | 2551/12375 [12:08:27<45:24:51, 16.64s/it] 21%|██        | 2552/12375 [12:08:45<46:58:23, 17.22s/it] 21%|██        | 2553/12375 [12:09:01<45:34:03, 16.70s/it] 21%|██        | 2554/12375 [12:09:21<48:20:09, 17.72s/it] 21%|██        | 2555/12375 [12:09:37<46:57:49, 17.22s/it] 21%|██        | 2556/12375 [12:09:51<44:44:25, 16.40s/it] 21%|██        | 2557/12375 [12:10:06<43:02:34, 15.78s/it] 21%|██        | 2558/12375 [12:10:20<41:46:28, 15.32s/it] 21%|██        | 2559/12375 [12:10:34<40:53:46, 15.00s/it] 21%|██        | 2560/12375 [12:10:50<41:41:58, 15.29s/it]                                                           21%|██        | 2560/12375 [12:10:50<41:41:58, 15.29s/it] 21%|██        | 2561/12375 [12:11:05<41:19:52, 15.16s/it] 21%|██        | 2562/12375 [12:11:20<41:09:12, 15.10s/it] 21%|██        | 2563/12375 [12:11:36<42:04:37, 15.44s/it] 21%|██        | 2564/12375 [12:11:49<39:58:06, 14.67s/it] 21%|██        | 2565/12375 [12:12:05<40:37:13, 14.91s/it] 21%|██        | 2566/12375 [12:12:22<42:58:35, 15.77s/it] 21%|██        | 2567/12375 [12:12:37<41:51:43, 15.37s/it] 21%|██        | 2568/12375 [12:12:53<42:36:42, 15.64s/it] 21%|██        | 2569/12375 [12:13:09<42:50:52, 15.73s/it] 21%|██        | 2570/12375 [12:13:22<40:10:22, 14.75s/it]                                                           21%|██        | 2570/12375 [12:13:22<40:10:22, 14.75s/it] 21%|██        | 2571/12375 [12:13:36<40:12:20, 14.76s/it] 21%|██        | 2572/12375 [12:13:51<40:00:00, 14.69s/it] 21%|██        | 2573/12375 [12:14:13<46:17:15, 17.00s/it] 21%|██        | 2574/12375 [12:14:27<43:49:31, 16.10s/it] 21%|██        | 2575/12375 [12:14:39<39:54:13, 14.66s/it] 21%|██        | 2576/12375 [12:14:56<42:14:27, 15.52s/it] 21%|██        | 2577/12375 [12:15:14<43:56:39, 16.15s/it] 21%|██        | 2578/12375 [12:15:29<43:21:54, 15.93s/it] 21%|██        | 2579/12375 [12:15:47<44:45:27, 16.45s/it] 21%|██        | 2580/12375 [12:16:05<46:29:44, 17.09s/it]                                                           21%|██        | 2580/12375 [12:16:05<46:29:44, 17.09s/it] 21%|██        | 2581/12375 [12:16:22<45:50:00, 16.85s/it] 21%|██        | 2582/12375 [12:16:40<47:21:58, 17.41s/it] 21%|██        | 2583/12375 [12:16:59<48:03:42, 17.67s/it] 21%|██        | 2584/12375 [12:17:17<48:46:04, 17.93s/it] 21%|██        | 2585/12375 [12:17:29<43:50:44, 16.12s/it] 21%|██        | 2586/12375 [12:17:52<49:01:39, 18.03s/it] 21%|██        | 2587/12375 [12:18:07<47:19:24, 17.41s/it] 21%|██        | 2588/12375 [12:18:21<44:11:27, 16.26s/it] 21%|██        | 2589/12375 [12:18:41<47:23:42, 17.44s/it] 21%|██        | 2590/12375 [12:18:54<43:31:26, 16.01s/it]                                                           21%|██        | 2590/12375 [12:18:54<43:31:26, 16.01s/it] 21%|██        | 2591/12375 [12:19:06<40:31:38, 14.91s/it] 21%|██        | 2592/12375 [12:19:22<41:23:13, 15.23s/it] 21%|██        | 2593/12375 [12:19:39<42:27:46, 15.63s/it] 21%|██        | 2594/12375 [12:20:00<47:19:15, 17.42s/it] 21%|██        | 2595/12375 [12:20:12<42:51:22, 15.78s/it] 21%|██        | 2596/12375 [12:20:33<46:29:33, 17.12s/it] 21%|██        | 2597/12375 [12:20:48<45:04:53, 16.60s/it] 21%|██        | 2598/12375 [12:21:10<49:18:21, 18.15s/it] 21%|██        | 2599/12375 [12:21:25<47:07:04, 17.35s/it] 21%|██        | 2600/12375 [12:21:43<47:30:01, 17.49s/it]                                                           21%|██        | 2600/12375 [12:21:43<47:30:01, 17.49s/it][INFO|trainer.py:3410] 2024-05-27 22:13:17,623 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2600
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 22:13:17,788 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 22:13:17,788 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2600/special_tokens_map.json
 21%|██        | 2601/12375 [12:22:02<48:36:52, 17.91s/it] 21%|██        | 2602/12375 [12:22:22<50:21:04, 18.55s/it] 21%|██        | 2603/12375 [12:22:36<46:37:23, 17.18s/it] 21%|██        | 2604/12375 [12:22:49<43:03:45, 15.87s/it] 21%|██        | 2605/12375 [12:23:03<41:23:04, 15.25s/it] 21%|██        | 2606/12375 [12:23:18<41:23:12, 15.25s/it] 21%|██        | 2607/12375 [12:23:38<45:25:54, 16.74s/it] 21%|██        | 2608/12375 [12:23:57<47:19:40, 17.44s/it] 21%|██        | 2609/12375 [12:24:13<45:39:53, 16.83s/it] 21%|██        | 2610/12375 [12:24:28<44:12:04, 16.30s/it]                                                           21%|██        | 2610/12375 [12:24:28<44:12:04, 16.30s/it] 21%|██        | 2611/12375 [12:24:44<43:54:22, 16.19s/it] 21%|██        | 2612/12375 [12:24:57<41:32:58, 15.32s/it] 21%|██        | 2613/12375 [12:25:16<44:37:26, 16.46s/it] 21%|██        | 2614/12375 [12:25:34<46:18:37, 17.08s/it] 21%|██        | 2615/12375 [12:25:52<46:43:42, 17.24s/it] 21%|██        | 2616/12375 [12:26:08<46:02:39, 16.99s/it] 21%|██        | 2617/12375 [12:26:23<43:47:24, 16.16s/it] 21%|██        | 2618/12375 [12:26:37<42:35:21, 15.71s/it] 21%|██        | 2619/12375 [12:26:50<40:27:38, 14.93s/it] 21%|██        | 2620/12375 [12:27:03<38:22:33, 14.16s/it]                                                           21%|██        | 2620/12375 [12:27:03<38:22:33, 14.16s/it] 21%|██        | 2621/12375 [12:27:18<39:08:53, 14.45s/it] 21%|██        | 2622/12375 [12:27:37<43:16:40, 15.97s/it] 21%|██        | 2623/12375 [12:27:54<43:29:00, 16.05s/it] 21%|██        | 2624/12375 [12:28:10<43:25:18, 16.03s/it] 21%|██        | 2625/12375 [12:28:25<42:35:21, 15.73s/it] 21%|██        | 2626/12375 [12:28:42<43:47:29, 16.17s/it] 21%|██        | 2627/12375 [12:28:54<40:39:57, 15.02s/it] 21%|██        | 2628/12375 [12:29:06<37:39:06, 13.91s/it] 21%|██        | 2629/12375 [12:29:20<38:03:43, 14.06s/it] 21%|██▏       | 2630/12375 [12:29:38<41:12:11, 15.22s/it]                                                           21%|██▏       | 2630/12375 [12:29:38<41:12:11, 15.22s/it] 21%|██▏       | 2631/12375 [12:29:53<41:02:56, 15.17s/it] 21%|██▏       | 2632/12375 [12:30:10<42:50:18, 15.83s/it] 21%|██▏       | 2633/12375 [12:30:24<41:21:19, 15.28s/it] 21%|██▏       | 2634/12375 [12:30:42<43:10:42, 15.96s/it] 21%|██▏       | 2635/12375 [12:30:57<42:39:02, 15.76s/it] 21%|██▏       | 2636/12375 [12:31:15<44:22:16, 16.40s/it] 21%|██▏       | 2637/12375 [12:31:31<43:55:15, 16.24s/it] 21%|██▏       | 2638/12375 [12:31:48<44:34:18, 16.48s/it] 21%|██▏       | 2639/12375 [12:32:04<44:05:26, 16.30s/it] 21%|██▏       | 2640/12375 [12:32:18<42:14:13, 15.62s/it]                                                           21%|██▏       | 2640/12375 [12:32:18<42:14:13, 15.62s/it] 21%|██▏       | 2641/12375 [12:32:35<43:18:45, 16.02s/it] 21%|██▏       | 2642/12375 [12:32:51<43:06:33, 15.95s/it] 21%|██▏       | 2643/12375 [12:33:04<40:49:40, 15.10s/it] 21%|██▏       | 2644/12375 [12:33:22<43:39:47, 16.15s/it] 21%|██▏       | 2645/12375 [12:33:40<45:16:15, 16.75s/it] 21%|██▏       | 2646/12375 [12:33:51<40:29:24, 14.98s/it] 21%|██▏       | 2647/12375 [12:34:08<42:03:49, 15.57s/it] 21%|██▏       | 2648/12375 [12:34:26<43:38:26, 16.15s/it] 21%|██▏       | 2649/12375 [12:34:45<45:47:19, 16.95s/it] 21%|██▏       | 2650/12375 [12:34:59<43:22:58, 16.06s/it]                                                           21%|██▏       | 2650/12375 [12:34:59<43:22:58, 16.06s/it] 21%|██▏       | 2651/12375 [12:35:13<41:54:22, 15.51s/it] 21%|██▏       | 2652/12375 [12:35:28<41:58:14, 15.54s/it] 21%|██▏       | 2653/12375 [12:35:43<40:48:44, 15.11s/it] 21%|██▏       | 2654/12375 [12:36:02<44:16:16, 16.40s/it] 21%|██▏       | 2655/12375 [12:36:19<44:46:30, 16.58s/it] 21%|██▏       | 2656/12375 [12:36:35<44:13:14, 16.38s/it] 21%|██▏       | 2657/12375 [12:36:53<45:28:53, 16.85s/it] 21%|██▏       | 2658/12375 [12:37:08<44:28:02, 16.47s/it] 21%|██▏       | 2659/12375 [12:37:21<41:22:57, 15.33s/it] 21%|██▏       | 2660/12375 [12:37:37<41:52:29, 15.52s/it]                                                           21%|██▏       | 2660/12375 [12:37:37<41:52:29, 15.52s/it] 22%|██▏       | 2661/12375 [12:37:53<42:18:08, 15.68s/it] 22%|██▏       | 2662/12375 [12:38:10<43:07:12, 15.98s/it] 22%|██▏       | 2663/12375 [12:38:25<42:10:27, 15.63s/it] 22%|██▏       | 2664/12375 [12:38:35<38:16:59, 14.19s/it] 22%|██▏       | 2665/12375 [12:38:50<38:40:52, 14.34s/it] 22%|██▏       | 2666/12375 [12:39:08<41:30:18, 15.39s/it] 22%|██▏       | 2667/12375 [12:39:25<43:00:40, 15.95s/it] 22%|██▏       | 2668/12375 [12:39:39<41:37:28, 15.44s/it] 22%|██▏       | 2669/12375 [12:39:55<41:38:01, 15.44s/it] 22%|██▏       | 2670/12375 [12:40:08<39:26:10, 14.63s/it]                                                           22%|██▏       | 2670/12375 [12:40:08<39:26:10, 14.63s/it] 22%|██▏       | 2671/12375 [12:40:23<40:19:01, 14.96s/it] 22%|██▏       | 2672/12375 [12:40:46<46:47:19, 17.36s/it] 22%|██▏       | 2673/12375 [12:41:03<46:37:34, 17.30s/it] 22%|██▏       | 2674/12375 [12:41:23<48:19:02, 17.93s/it] 22%|██▏       | 2675/12375 [12:41:38<46:14:30, 17.16s/it] 22%|██▏       | 2676/12375 [12:41:50<42:12:47, 15.67s/it] 22%|██▏       | 2677/12375 [12:42:09<44:34:24, 16.55s/it] 22%|██▏       | 2678/12375 [12:42:28<46:53:48, 17.41s/it] 22%|██▏       | 2679/12375 [12:42:46<46:59:50, 17.45s/it] 22%|██▏       | 2680/12375 [12:43:01<45:26:13, 16.87s/it]                                                           22%|██▏       | 2680/12375 [12:43:01<45:26:13, 16.87s/it] 22%|██▏       | 2681/12375 [12:43:13<40:48:06, 15.15s/it] 22%|██▏       | 2682/12375 [12:43:26<39:07:03, 14.53s/it] 22%|██▏       | 2683/12375 [12:43:42<40:30:19, 15.05s/it] 22%|██▏       | 2684/12375 [12:44:01<44:07:47, 16.39s/it] 22%|██▏       | 2685/12375 [12:44:17<43:12:22, 16.05s/it] 22%|██▏       | 2686/12375 [12:44:32<42:33:07, 15.81s/it] 22%|██▏       | 2687/12375 [12:44:49<43:54:31, 16.32s/it] 22%|██▏       | 2688/12375 [12:45:07<44:48:58, 16.66s/it] 22%|██▏       | 2689/12375 [12:45:22<43:41:14, 16.24s/it] 22%|██▏       | 2690/12375 [12:45:37<42:23:18, 15.76s/it]                                                           22%|██▏       | 2690/12375 [12:45:37<42:23:18, 15.76s/it] 22%|██▏       | 2691/12375 [12:45:51<41:13:19, 15.32s/it] 22%|██▏       | 2692/12375 [12:46:03<38:46:42, 14.42s/it] 22%|██▏       | 2693/12375 [12:46:21<41:01:40, 15.26s/it] 22%|██▏       | 2694/12375 [12:46:40<44:04:04, 16.39s/it] 22%|██▏       | 2695/12375 [12:46:58<45:14:06, 16.82s/it] 22%|██▏       | 2696/12375 [12:47:13<43:52:15, 16.32s/it] 22%|██▏       | 2697/12375 [12:47:37<50:02:01, 18.61s/it] 22%|██▏       | 2698/12375 [12:47:57<51:49:44, 19.28s/it] 22%|██▏       | 2699/12375 [12:48:15<50:07:38, 18.65s/it] 22%|██▏       | 2700/12375 [12:48:32<48:48:55, 18.16s/it]                                                           22%|██▏       | 2700/12375 [12:48:32<48:48:55, 18.16s/it][INFO|trainer.py:3410] 2024-05-27 22:40:06,259 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2700
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 22:40:06,422 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 22:40:06,423 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2700/special_tokens_map.json
 22%|██▏       | 2701/12375 [12:48:44<44:15:51, 16.47s/it] 22%|██▏       | 2702/12375 [12:49:02<45:37:36, 16.98s/it] 22%|██▏       | 2703/12375 [12:49:18<44:37:25, 16.61s/it] 22%|██▏       | 2704/12375 [12:49:33<43:28:20, 16.18s/it] 22%|██▏       | 2705/12375 [12:49:45<39:36:12, 14.74s/it] 22%|██▏       | 2706/12375 [12:50:05<43:52:58, 16.34s/it] 22%|██▏       | 2707/12375 [12:50:19<42:02:29, 15.65s/it] 22%|██▏       | 2708/12375 [12:50:38<44:33:13, 16.59s/it] 22%|██▏       | 2709/12375 [12:50:54<44:05:16, 16.42s/it] 22%|██▏       | 2710/12375 [12:51:09<43:26:44, 16.18s/it]                                                           22%|██▏       | 2710/12375 [12:51:09<43:26:44, 16.18s/it] 22%|██▏       | 2711/12375 [12:51:23<41:29:01, 15.45s/it] 22%|██▏       | 2712/12375 [12:51:44<45:35:24, 16.98s/it] 22%|██▏       | 2713/12375 [12:52:00<44:47:00, 16.69s/it] 22%|██▏       | 2714/12375 [12:52:17<45:01:33, 16.78s/it] 22%|██▏       | 2715/12375 [12:52:35<46:20:24, 17.27s/it] 22%|██▏       | 2716/12375 [12:52:52<46:17:19, 17.25s/it] 22%|██▏       | 2717/12375 [12:53:04<42:08:41, 15.71s/it] 22%|██▏       | 2718/12375 [12:53:22<43:29:04, 16.21s/it] 22%|██▏       | 2719/12375 [12:53:38<43:36:15, 16.26s/it] 22%|██▏       | 2720/12375 [12:53:58<46:55:07, 17.49s/it]                                                           22%|██▏       | 2720/12375 [12:53:58<46:55:07, 17.49s/it] 22%|██▏       | 2721/12375 [12:54:14<45:02:33, 16.80s/it] 22%|██▏       | 2722/12375 [12:54:26<41:16:21, 15.39s/it] 22%|██▏       | 2723/12375 [12:54:45<44:06:56, 16.45s/it] 22%|██▏       | 2724/12375 [12:55:03<45:19:23, 16.91s/it] 22%|██▏       | 2725/12375 [12:55:16<42:16:42, 15.77s/it] 22%|██▏       | 2726/12375 [12:55:31<41:46:23, 15.59s/it] 22%|██▏       | 2727/12375 [12:55:52<46:35:57, 17.39s/it] 22%|██▏       | 2728/12375 [12:56:09<45:46:12, 17.08s/it] 22%|██▏       | 2729/12375 [12:56:24<44:10:34, 16.49s/it] 22%|██▏       | 2730/12375 [12:56:40<43:36:01, 16.27s/it]                                                           22%|██▏       | 2730/12375 [12:56:40<43:36:01, 16.27s/it] 22%|██▏       | 2731/12375 [12:57:04<49:44:11, 18.57s/it] 22%|██▏       | 2732/12375 [12:57:26<52:40:50, 19.67s/it] 22%|██▏       | 2733/12375 [12:57:38<47:02:04, 17.56s/it] 22%|██▏       | 2734/12375 [12:57:52<44:02:45, 16.45s/it] 22%|██▏       | 2735/12375 [12:58:10<45:19:31, 16.93s/it] 22%|██▏       | 2736/12375 [12:58:29<46:36:23, 17.41s/it] 22%|██▏       | 2737/12375 [12:58:47<47:10:42, 17.62s/it] 22%|██▏       | 2738/12375 [12:59:07<48:43:06, 18.20s/it] 22%|██▏       | 2739/12375 [12:59:22<46:12:31, 17.26s/it] 22%|██▏       | 2740/12375 [12:59:38<45:10:09, 16.88s/it]                                                           22%|██▏       | 2740/12375 [12:59:38<45:10:09, 16.88s/it] 22%|██▏       | 2741/12375 [12:59:55<45:28:40, 16.99s/it] 22%|██▏       | 2742/12375 [13:00:10<44:00:49, 16.45s/it] 22%|██▏       | 2743/12375 [13:00:27<44:31:56, 16.64s/it] 22%|██▏       | 2744/12375 [13:00:42<43:24:06, 16.22s/it] 22%|██▏       | 2745/12375 [13:01:01<45:40:47, 17.08s/it] 22%|██▏       | 2746/12375 [13:01:23<49:19:42, 18.44s/it] 22%|██▏       | 2747/12375 [13:01:37<45:16:53, 16.93s/it] 22%|██▏       | 2748/12375 [13:01:54<45:49:16, 17.13s/it] 22%|██▏       | 2749/12375 [13:02:09<44:03:17, 16.48s/it] 22%|██▏       | 2750/12375 [13:02:22<41:35:07, 15.55s/it]                                                           22%|██▏       | 2750/12375 [13:02:22<41:35:07, 15.55s/it] 22%|██▏       | 2751/12375 [13:02:42<45:02:01, 16.85s/it] 22%|██▏       | 2752/12375 [13:02:58<43:45:26, 16.37s/it] 22%|██▏       | 2753/12375 [13:03:12<41:52:43, 15.67s/it] 22%|██▏       | 2754/12375 [13:03:27<41:15:49, 15.44s/it] 22%|██▏       | 2755/12375 [13:03:43<41:52:16, 15.67s/it] 22%|██▏       | 2756/12375 [13:03:57<41:03:31, 15.37s/it] 22%|██▏       | 2757/12375 [13:04:11<39:16:13, 14.70s/it] 22%|██▏       | 2758/12375 [13:04:27<40:37:56, 15.21s/it] 22%|██▏       | 2759/12375 [13:04:42<40:39:19, 15.22s/it] 22%|██▏       | 2760/12375 [13:05:00<42:56:13, 16.08s/it]                                                           22%|██▏       | 2760/12375 [13:05:00<42:56:13, 16.08s/it] 22%|██▏       | 2761/12375 [13:05:14<41:00:30, 15.36s/it] 22%|██▏       | 2762/12375 [13:05:29<40:55:04, 15.32s/it] 22%|██▏       | 2763/12375 [13:05:45<41:12:31, 15.43s/it] 22%|██▏       | 2764/12375 [13:06:03<43:31:51, 16.31s/it] 22%|██▏       | 2765/12375 [13:06:17<41:45:39, 15.64s/it] 22%|██▏       | 2766/12375 [13:06:35<43:28:10, 16.29s/it] 22%|██▏       | 2767/12375 [13:06:50<42:29:40, 15.92s/it] 22%|██▏       | 2768/12375 [13:07:03<39:50:52, 14.93s/it] 22%|██▏       | 2769/12375 [13:07:18<39:53:02, 14.95s/it] 22%|██▏       | 2770/12375 [13:07:33<40:05:01, 15.02s/it]                                                           22%|██▏       | 2770/12375 [13:07:33<40:05:01, 15.02s/it] 22%|██▏       | 2771/12375 [13:07:46<38:32:35, 14.45s/it] 22%|██▏       | 2772/12375 [13:08:10<45:57:05, 17.23s/it] 22%|██▏       | 2773/12375 [13:08:24<43:29:35, 16.31s/it] 22%|██▏       | 2774/12375 [13:08:40<43:00:56, 16.13s/it] 22%|██▏       | 2775/12375 [13:08:53<40:48:23, 15.30s/it] 22%|██▏       | 2776/12375 [13:09:08<40:41:54, 15.26s/it] 22%|██▏       | 2777/12375 [13:09:22<39:33:37, 14.84s/it] 22%|██▏       | 2778/12375 [13:09:39<41:12:00, 15.45s/it] 22%|██▏       | 2779/12375 [13:09:53<40:24:37, 15.16s/it] 22%|██▏       | 2780/12375 [13:10:13<43:48:47, 16.44s/it]                                                           22%|██▏       | 2780/12375 [13:10:13<43:48:47, 16.44s/it] 22%|██▏       | 2781/12375 [13:10:31<44:48:21, 16.81s/it] 22%|██▏       | 2782/12375 [13:10:47<44:36:44, 16.74s/it] 22%|██▏       | 2783/12375 [13:11:06<46:25:25, 17.42s/it] 22%|██▏       | 2784/12375 [13:11:25<47:20:16, 17.77s/it] 23%|██▎       | 2785/12375 [13:11:43<47:55:52, 17.99s/it] 23%|██▎       | 2786/12375 [13:11:59<46:16:58, 17.38s/it] 23%|██▎       | 2787/12375 [13:12:19<48:19:19, 18.14s/it] 23%|██▎       | 2788/12375 [13:12:33<45:18:59, 17.02s/it] 23%|██▎       | 2789/12375 [13:12:51<46:02:02, 17.29s/it] 23%|██▎       | 2790/12375 [13:13:05<43:16:54, 16.26s/it]                                                           23%|██▎       | 2790/12375 [13:13:05<43:16:54, 16.26s/it] 23%|██▎       | 2791/12375 [13:13:18<40:41:01, 15.28s/it] 23%|██▎       | 2792/12375 [13:13:33<40:11:25, 15.10s/it] 23%|██▎       | 2793/12375 [13:13:48<39:53:06, 14.98s/it] 23%|██▎       | 2794/12375 [13:14:00<37:44:48, 14.18s/it] 23%|██▎       | 2795/12375 [13:14:12<35:50:22, 13.47s/it] 23%|██▎       | 2796/12375 [13:14:26<36:45:42, 13.82s/it] 23%|██▎       | 2797/12375 [13:14:41<37:02:29, 13.92s/it] 23%|██▎       | 2798/12375 [13:14:53<35:53:16, 13.49s/it] 23%|██▎       | 2799/12375 [13:15:09<37:42:00, 14.17s/it] 23%|██▎       | 2800/12375 [13:15:26<40:25:19, 15.20s/it]                                                           23%|██▎       | 2800/12375 [13:15:26<40:25:19, 15.20s/it][INFO|trainer.py:3410] 2024-05-27 23:07:00,949 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2800
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 23:07:01,109 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 23:07:01,109 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2800/special_tokens_map.json
 23%|██▎       | 2801/12375 [13:15:46<43:45:55, 16.46s/it] 23%|██▎       | 2802/12375 [13:16:05<45:37:02, 17.15s/it] 23%|██▎       | 2803/12375 [13:16:26<48:54:03, 18.39s/it] 23%|██▎       | 2804/12375 [13:16:39<44:49:05, 16.86s/it] 23%|██▎       | 2805/12375 [13:16:52<41:15:15, 15.52s/it] 23%|██▎       | 2806/12375 [13:17:09<42:43:02, 16.07s/it] 23%|██▎       | 2807/12375 [13:17:22<40:27:04, 15.22s/it] 23%|██▎       | 2808/12375 [13:17:35<38:14:10, 14.39s/it] 23%|██▎       | 2809/12375 [13:17:49<38:18:19, 14.42s/it] 23%|██▎       | 2810/12375 [13:18:03<37:48:51, 14.23s/it]                                                           23%|██▎       | 2810/12375 [13:18:03<37:48:51, 14.23s/it] 23%|██▎       | 2811/12375 [13:18:19<39:34:55, 14.90s/it] 23%|██▎       | 2812/12375 [13:18:36<41:07:06, 15.48s/it] 23%|██▎       | 2813/12375 [13:18:55<43:47:13, 16.49s/it] 23%|██▎       | 2814/12375 [13:19:10<42:57:10, 16.17s/it] 23%|██▎       | 2815/12375 [13:19:27<43:12:18, 16.27s/it] 23%|██▎       | 2816/12375 [13:19:46<45:50:48, 17.27s/it] 23%|██▎       | 2817/12375 [13:19:59<42:03:10, 15.84s/it] 23%|██▎       | 2818/12375 [13:20:16<42:55:26, 16.17s/it] 23%|██▎       | 2819/12375 [13:20:33<43:26:18, 16.36s/it] 23%|██▎       | 2820/12375 [13:20:57<50:02:01, 18.85s/it]                                                           23%|██▎       | 2820/12375 [13:20:57<50:02:01, 18.85s/it] 23%|██▎       | 2821/12375 [13:21:09<44:29:31, 16.76s/it] 23%|██▎       | 2822/12375 [13:21:22<41:34:11, 15.67s/it] 23%|██▎       | 2823/12375 [13:21:40<43:09:44, 16.27s/it] 23%|██▎       | 2824/12375 [13:21:58<44:34:18, 16.80s/it] 23%|██▎       | 2825/12375 [13:22:15<44:41:21, 16.85s/it] 23%|██▎       | 2826/12375 [13:22:26<40:18:14, 15.19s/it] 23%|██▎       | 2827/12375 [13:22:42<40:53:56, 15.42s/it] 23%|██▎       | 2828/12375 [13:22:59<42:07:26, 15.88s/it] 23%|██▎       | 2829/12375 [13:23:16<43:08:40, 16.27s/it] 23%|██▎       | 2830/12375 [13:23:35<44:44:56, 16.88s/it]                                                           23%|██▎       | 2830/12375 [13:23:35<44:44:56, 16.88s/it] 23%|██▎       | 2831/12375 [13:23:48<41:27:00, 15.64s/it] 23%|██▎       | 2832/12375 [13:24:08<45:05:27, 17.01s/it] 23%|██▎       | 2833/12375 [13:24:18<40:04:19, 15.12s/it] 23%|██▎       | 2834/12375 [13:24:36<42:10:52, 15.92s/it] 23%|██▎       | 2835/12375 [13:24:53<42:55:28, 16.20s/it] 23%|██▎       | 2836/12375 [13:25:08<42:04:41, 15.88s/it] 23%|██▎       | 2837/12375 [13:25:32<48:10:56, 18.19s/it] 23%|██▎       | 2838/12375 [13:25:52<49:37:44, 18.73s/it] 23%|██▎       | 2839/12375 [13:26:07<46:48:44, 17.67s/it] 23%|██▎       | 2840/12375 [13:26:23<45:06:43, 17.03s/it]                                                           23%|██▎       | 2840/12375 [13:26:23<45:06:43, 17.03s/it] 23%|██▎       | 2841/12375 [13:26:39<44:19:29, 16.74s/it] 23%|██▎       | 2842/12375 [13:26:55<44:21:34, 16.75s/it] 23%|██▎       | 2843/12375 [13:27:14<45:49:40, 17.31s/it] 23%|██▎       | 2844/12375 [13:27:31<45:36:49, 17.23s/it] 23%|██▎       | 2845/12375 [13:27:46<43:31:03, 16.44s/it] 23%|██▎       | 2846/12375 [13:28:04<45:16:31, 17.10s/it] 23%|██▎       | 2847/12375 [13:28:19<43:42:22, 16.51s/it] 23%|██▎       | 2848/12375 [13:28:39<46:28:26, 17.56s/it] 23%|██▎       | 2849/12375 [13:28:56<45:46:16, 17.30s/it] 23%|██▎       | 2850/12375 [13:29:10<43:04:26, 16.28s/it]                                                           23%|██▎       | 2850/12375 [13:29:10<43:04:26, 16.28s/it] 23%|██▎       | 2851/12375 [13:29:26<43:08:17, 16.31s/it] 23%|██▎       | 2852/12375 [13:29:43<43:37:03, 16.49s/it] 23%|██▎       | 2853/12375 [13:30:00<43:55:10, 16.60s/it] 23%|██▎       | 2854/12375 [13:30:23<49:07:08, 18.57s/it] 23%|██▎       | 2855/12375 [13:30:38<46:03:32, 17.42s/it] 23%|██▎       | 2856/12375 [13:30:57<47:22:31, 17.92s/it] 23%|██▎       | 2857/12375 [13:31:13<45:36:31, 17.25s/it] 23%|██▎       | 2858/12375 [13:31:29<44:45:22, 16.93s/it] 23%|██▎       | 2859/12375 [13:31:47<45:46:46, 17.32s/it] 23%|██▎       | 2860/12375 [13:32:03<44:44:11, 16.93s/it]                                                           23%|██▎       | 2860/12375 [13:32:03<44:44:11, 16.93s/it] 23%|██▎       | 2861/12375 [13:32:15<40:59:32, 15.51s/it] 23%|██▎       | 2862/12375 [13:32:29<39:23:52, 14.91s/it] 23%|██▎       | 2863/12375 [13:32:45<40:38:59, 15.38s/it] 23%|██▎       | 2864/12375 [13:33:04<43:01:52, 16.29s/it] 23%|██▎       | 2865/12375 [13:33:19<42:08:28, 15.95s/it] 23%|██▎       | 2866/12375 [13:33:36<42:59:06, 16.27s/it] 23%|██▎       | 2867/12375 [13:33:56<45:54:09, 17.38s/it] 23%|██▎       | 2868/12375 [13:34:09<42:27:09, 16.08s/it] 23%|██▎       | 2869/12375 [13:34:26<43:01:25, 16.29s/it] 23%|██▎       | 2870/12375 [13:34:41<42:19:27, 16.03s/it]                                                           23%|██▎       | 2870/12375 [13:34:41<42:19:27, 16.03s/it] 23%|██▎       | 2871/12375 [13:34:55<40:46:32, 15.45s/it] 23%|██▎       | 2872/12375 [13:35:09<39:07:01, 14.82s/it] 23%|██▎       | 2873/12375 [13:35:20<36:15:02, 13.73s/it] 23%|██▎       | 2874/12375 [13:35:34<36:53:31, 13.98s/it] 23%|██▎       | 2875/12375 [13:35:50<37:47:32, 14.32s/it] 23%|██▎       | 2876/12375 [13:36:01<35:28:44, 13.45s/it] 23%|██▎       | 2877/12375 [13:36:14<35:11:29, 13.34s/it] 23%|██▎       | 2878/12375 [13:36:33<39:58:00, 15.15s/it] 23%|██▎       | 2879/12375 [13:36:48<39:49:37, 15.10s/it] 23%|██▎       | 2880/12375 [13:37:05<40:47:06, 15.46s/it]                                                           23%|██▎       | 2880/12375 [13:37:05<40:47:06, 15.46s/it] 23%|██▎       | 2881/12375 [13:37:17<38:13:18, 14.49s/it] 23%|██▎       | 2882/12375 [13:37:30<37:06:14, 14.07s/it] 23%|██▎       | 2883/12375 [13:37:43<36:20:24, 13.78s/it] 23%|██▎       | 2884/12375 [13:37:58<37:10:41, 14.10s/it] 23%|██▎       | 2885/12375 [13:38:20<43:32:52, 16.52s/it] 23%|██▎       | 2886/12375 [13:38:34<41:10:57, 15.62s/it] 23%|██▎       | 2887/12375 [13:38:50<41:26:53, 15.73s/it] 23%|██▎       | 2888/12375 [13:39:04<40:06:39, 15.22s/it] 23%|██▎       | 2889/12375 [13:39:16<37:46:53, 14.34s/it] 23%|██▎       | 2890/12375 [13:39:30<37:30:00, 14.23s/it]                                                           23%|██▎       | 2890/12375 [13:39:30<37:30:00, 14.23s/it] 23%|██▎       | 2891/12375 [13:39:43<36:22:49, 13.81s/it] 23%|██▎       | 2892/12375 [13:40:00<39:02:02, 14.82s/it] 23%|██▎       | 2893/12375 [13:40:17<40:31:50, 15.39s/it] 23%|██▎       | 2894/12375 [13:40:36<43:17:36, 16.44s/it] 23%|██▎       | 2895/12375 [13:40:50<41:58:32, 15.94s/it] 23%|██▎       | 2896/12375 [13:41:04<40:27:18, 15.36s/it] 23%|██▎       | 2897/12375 [13:41:20<40:37:03, 15.43s/it] 23%|██▎       | 2898/12375 [13:41:33<38:54:12, 14.78s/it] 23%|██▎       | 2899/12375 [13:41:48<39:02:31, 14.83s/it] 23%|██▎       | 2900/12375 [13:42:03<38:52:28, 14.77s/it]                                                           23%|██▎       | 2900/12375 [13:42:03<38:52:28, 14.77s/it][INFO|trainer.py:3410] 2024-05-27 23:33:37,354 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2900
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-27 23:33:37,675 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-27 23:33:37,675 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-2900/special_tokens_map.json
 23%|██▎       | 2901/12375 [13:42:16<37:43:54, 14.34s/it] 23%|██▎       | 2902/12375 [13:42:28<36:06:54, 13.72s/it] 23%|██▎       | 2903/12375 [13:42:45<38:35:46, 14.67s/it] 23%|██▎       | 2904/12375 [13:43:01<39:40:41, 15.08s/it] 23%|██▎       | 2905/12375 [13:43:20<42:33:59, 16.18s/it] 23%|██▎       | 2906/12375 [13:43:31<38:47:37, 14.75s/it] 23%|██▎       | 2907/12375 [13:43:47<39:32:34, 15.04s/it] 23%|██▎       | 2908/12375 [13:44:04<40:33:15, 15.42s/it] 24%|██▎       | 2909/12375 [13:44:16<37:55:27, 14.42s/it] 24%|██▎       | 2910/12375 [13:44:32<39:44:42, 15.12s/it]                                                           24%|██▎       | 2910/12375 [13:44:32<39:44:42, 15.12s/it] 24%|██▎       | 2911/12375 [13:44:45<38:06:40, 14.50s/it] 24%|██▎       | 2912/12375 [13:45:00<38:05:24, 14.49s/it] 24%|██▎       | 2913/12375 [13:45:16<39:40:35, 15.10s/it] 24%|██▎       | 2914/12375 [13:45:32<39:53:13, 15.18s/it] 24%|██▎       | 2915/12375 [13:45:48<41:03:09, 15.62s/it] 24%|██▎       | 2916/12375 [13:46:08<44:25:48, 16.91s/it] 24%|██▎       | 2917/12375 [13:46:24<43:30:53, 16.56s/it] 24%|██▎       | 2918/12375 [13:46:36<40:00:06, 15.23s/it] 24%|██▎       | 2919/12375 [13:46:50<38:57:03, 14.83s/it] 24%|██▎       | 2920/12375 [13:47:08<41:43:46, 15.89s/it]                                                           24%|██▎       | 2920/12375 [13:47:08<41:43:46, 15.89s/it] 24%|██▎       | 2921/12375 [13:47:24<41:40:18, 15.87s/it] 24%|██▎       | 2922/12375 [13:47:39<40:31:26, 15.43s/it] 24%|██▎       | 2923/12375 [13:47:55<41:03:09, 15.64s/it] 24%|██▎       | 2924/12375 [13:48:09<40:06:11, 15.28s/it] 24%|██▎       | 2925/12375 [13:48:23<38:49:43, 14.79s/it] 24%|██▎       | 2926/12375 [13:48:41<41:49:22, 15.93s/it] 24%|██▎       | 2927/12375 [13:49:02<45:24:14, 17.30s/it] 24%|██▎       | 2928/12375 [13:49:19<45:01:06, 17.16s/it] 24%|██▎       | 2929/12375 [13:49:33<43:02:39, 16.40s/it] 24%|██▎       | 2930/12375 [13:49:53<45:16:58, 17.26s/it]                                                           24%|██▎       | 2930/12375 [13:49:53<45:16:58, 17.26s/it] 24%|██▎       | 2931/12375 [13:50:12<46:36:27, 17.77s/it] 24%|██▎       | 2932/12375 [13:50:27<44:47:21, 17.08s/it] 24%|██▎       | 2933/12375 [13:50:39<40:58:10, 15.62s/it] 24%|██▎       | 2934/12375 [13:50:55<40:36:47, 15.49s/it] 24%|██▎       | 2935/12375 [13:51:12<41:57:02, 16.00s/it] 24%|██▎       | 2936/12375 [13:51:30<43:49:59, 16.72s/it] 24%|██▎       | 2937/12375 [13:51:47<44:12:02, 16.86s/it] 24%|██▎       | 2938/12375 [13:52:03<43:05:14, 16.44s/it] 24%|██▎       | 2939/12375 [13:52:18<41:47:15, 15.94s/it] 24%|██▍       | 2940/12375 [13:52:36<43:38:20, 16.65s/it]                                                           24%|██▍       | 2940/12375 [13:52:36<43:38:20, 16.65s/it] 24%|██▍       | 2941/12375 [13:52:53<44:17:32, 16.90s/it] 24%|██▍       | 2942/12375 [13:53:08<42:20:57, 16.16s/it] 24%|██▍       | 2943/12375 [13:53:18<37:44:36, 14.41s/it] 24%|██▍       | 2944/12375 [13:53:31<36:34:57, 13.96s/it] 24%|██▍       | 2945/12375 [13:53:50<40:50:08, 15.59s/it] 24%|██▍       | 2946/12375 [13:54:08<42:31:28, 16.24s/it] 24%|██▍       | 2947/12375 [13:54:21<40:01:49, 15.29s/it] 24%|██▍       | 2948/12375 [13:54:34<38:13:22, 14.60s/it] 24%|██▍       | 2949/12375 [13:54:51<39:35:46, 15.12s/it] 24%|██▍       | 2950/12375 [13:55:07<40:44:54, 15.56s/it]                                                           24%|██▍       | 2950/12375 [13:55:07<40:44:54, 15.56s/it] 24%|██▍       | 2951/12375 [13:55:24<41:52:57, 16.00s/it] 24%|██▍       | 2952/12375 [13:55:39<41:12:10, 15.74s/it] 24%|██▍       | 2953/12375 [13:55:51<37:54:15, 14.48s/it] 24%|██▍       | 2954/12375 [13:56:05<37:42:06, 14.41s/it] 24%|██▍       | 2955/12375 [13:56:18<36:35:33, 13.98s/it] 24%|██▍       | 2956/12375 [13:56:34<38:09:03, 14.58s/it] 24%|██▍       | 2957/12375 [13:56:50<39:13:50, 15.00s/it] 24%|██▍       | 2958/12375 [13:57:06<39:39:54, 15.16s/it] 24%|██▍       | 2959/12375 [13:57:28<45:16:48, 17.31s/it] 24%|██▍       | 2960/12375 [13:57:43<43:54:04, 16.79s/it]                                                           24%|██▍       | 2960/12375 [13:57:43<43:54:04, 16.79s/it] 24%|██▍       | 2961/12375 [13:57:58<41:48:42, 15.99s/it] 24%|██▍       | 2962/12375 [13:58:18<45:15:30, 17.31s/it] 24%|██▍       | 2963/12375 [13:58:36<46:02:39, 17.61s/it] 24%|██▍       | 2964/12375 [13:58:49<42:19:11, 16.19s/it] 24%|██▍       | 2965/12375 [13:59:10<46:19:51, 17.72s/it] 24%|██▍       | 2966/12375 [13:59:26<44:50:41, 17.16s/it] 24%|██▍       | 2967/12375 [13:59:41<43:15:31, 16.55s/it] 24%|██▍       | 2968/12375 [14:00:01<45:55:09, 17.57s/it] 24%|██▍       | 2969/12375 [14:00:18<45:01:57, 17.24s/it] 24%|██▍       | 2970/12375 [14:00:36<46:04:00, 17.63s/it]                                                           24%|██▍       | 2970/12375 [14:00:36<46:04:00, 17.63s/it] 24%|██▍       | 2971/12375 [14:00:47<40:45:07, 15.60s/it] 24%|██▍       | 2972/12375 [14:01:01<39:24:38, 15.09s/it] 24%|██▍       | 2973/12375 [14:01:14<37:29:12, 14.35s/it] 24%|██▍       | 2974/12375 [14:01:30<39:05:18, 14.97s/it] 24%|██▍       | 2975/12375 [14:01:45<38:46:03, 14.85s/it] 24%|██▍       | 2976/12375 [14:02:02<40:31:59, 15.53s/it] 24%|██▍       | 2977/12375 [14:02:17<39:56:54, 15.30s/it] 24%|██▍       | 2978/12375 [14:02:33<41:06:54, 15.75s/it] 24%|██▍       | 2979/12375 [14:02:46<38:58:31, 14.93s/it] 24%|██▍       | 2980/12375 [14:03:05<41:41:57, 15.98s/it]                                                           24%|██▍       | 2980/12375 [14:03:05<41:41:57, 15.98s/it] 24%|██▍       | 2981/12375 [14:03:19<40:33:28, 15.54s/it] 24%|██▍       | 2982/12375 [14:03:35<40:39:12, 15.58s/it] 24%|██▍       | 2983/12375 [14:03:52<41:57:27, 16.08s/it] 24%|██▍       | 2984/12375 [14:04:08<41:45:51, 16.01s/it] 24%|██▍       | 2985/12375 [14:04:25<42:38:04, 16.35s/it] 24%|██▍       | 2986/12375 [14:04:37<38:54:45, 14.92s/it] 24%|██▍       | 2987/12375 [14:04:50<37:49:49, 14.51s/it] 24%|██▍       | 2988/12375 [14:05:03<36:39:34, 14.06s/it] 24%|██▍       | 2989/12375 [14:05:17<36:19:50, 13.93s/it] 24%|██▍       | 2990/12375 [14:05:29<34:36:42, 13.28s/it]                                                           24%|██▍       | 2990/12375 [14:05:29<34:36:42, 13.28s/it] 24%|██▍       | 2991/12375 [14:05:47<38:04:23, 14.61s/it] 24%|██▍       | 2992/12375 [14:06:04<39:57:38, 15.33s/it] 24%|██▍       | 2993/12375 [14:06:17<38:12:16, 14.66s/it] 24%|██▍       | 2994/12375 [14:06:37<42:22:34, 16.26s/it] 24%|██▍       | 2995/12375 [14:06:49<39:16:56, 15.08s/it] 24%|██▍       | 2996/12375 [14:07:05<40:08:33, 15.41s/it] 24%|██▍       | 2997/12375 [14:07:20<39:35:41, 15.20s/it] 24%|██▍       | 2998/12375 [14:07:37<40:47:35, 15.66s/it] 24%|██▍       | 2999/12375 [14:07:49<38:32:28, 14.80s/it] 24%|██▍       | 3000/12375 [14:08:03<37:46:27, 14.51s/it]                                                           24%|██▍       | 3000/12375 [14:08:03<37:46:27, 14.51s/it][INFO|trainer.py:3719] 2024-05-27 23:59:37,773 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-27 23:59:37,773 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-27 23:59:37,773 >>   Batch size = 32
{'eval_loss': 1.092374324798584, 'eval_runtime': 560.4247, 'eval_samples_per_second': 8.922, 'eval_steps_per_second': 0.28, 'epoch': 0.2}
{'loss': 1.0291, 'grad_norm': 1.7456268072128296, 'learning_rate': 9.019627606463459e-05, 'epoch': 0.2}
{'loss': 1.0341, 'grad_norm': 1.7281090021133423, 'learning_rate': 9.012065512219958e-05, 'epoch': 0.2}
{'loss': 1.0778, 'grad_norm': 1.707235336303711, 'learning_rate': 9.004477560619447e-05, 'epoch': 0.2}
{'loss': 1.0663, 'grad_norm': 1.6386733055114746, 'learning_rate': 8.996863800565505e-05, 'epoch': 0.21}
{'loss': 1.1172, 'grad_norm': 1.7118096351623535, 'learning_rate': 8.989224281128045e-05, 'epoch': 0.21}
{'loss': 1.0948, 'grad_norm': 1.8372948169708252, 'learning_rate': 8.981559051543003e-05, 'epoch': 0.21}
{'loss': 1.085, 'grad_norm': 1.5147289037704468, 'learning_rate': 8.973868161212004e-05, 'epoch': 0.21}
{'loss': 1.141, 'grad_norm': 1.7362935543060303, 'learning_rate': 8.966151659702065e-05, 'epoch': 0.21}
{'loss': 1.093, 'grad_norm': 1.6920982599258423, 'learning_rate': 8.958409596745255e-05, 'epoch': 0.21}
{'loss': 1.074, 'grad_norm': 1.808386206626892, 'learning_rate': 8.950642022238387e-05, 'epoch': 0.21}
{'loss': 1.1143, 'grad_norm': 2.0524168014526367, 'learning_rate': 8.942848986242697e-05, 'epoch': 0.21}
{'loss': 1.0215, 'grad_norm': 1.653653860092163, 'learning_rate': 8.935030538983515e-05, 'epoch': 0.21}
{'loss': 1.0483, 'grad_norm': 1.8575201034545898, 'learning_rate': 8.927186730849943e-05, 'epoch': 0.21}
{'loss': 1.1095, 'grad_norm': 1.7816840410232544, 'learning_rate': 8.919317612394531e-05, 'epoch': 0.21}
{'loss': 1.0982, 'grad_norm': 1.6187102794647217, 'learning_rate': 8.911423234332954e-05, 'epoch': 0.21}
{'loss': 1.0543, 'grad_norm': 2.0467989444732666, 'learning_rate': 8.903503647543681e-05, 'epoch': 0.21}
{'loss': 1.0682, 'grad_norm': 1.9385844469070435, 'learning_rate': 8.895558903067648e-05, 'epoch': 0.22}
{'loss': 1.0757, 'grad_norm': 1.4942145347595215, 'learning_rate': 8.887589052107931e-05, 'epoch': 0.22}
{'loss': 1.0861, 'grad_norm': 1.3661854267120361, 'learning_rate': 8.879594146029417e-05, 'epoch': 0.22}
{'loss': 1.1126, 'grad_norm': 1.4138062000274658, 'learning_rate': 8.871574236358466e-05, 'epoch': 0.22}
{'loss': 1.1054, 'grad_norm': 1.8722354173660278, 'learning_rate': 8.863529374782588e-05, 'epoch': 0.22}
{'loss': 1.0498, 'grad_norm': 1.478202223777771, 'learning_rate': 8.8554596131501e-05, 'epoch': 0.22}
{'loss': 1.0071, 'grad_norm': 1.9113935232162476, 'learning_rate': 8.8473650034698e-05, 'epoch': 0.22}
{'loss': 1.1042, 'grad_norm': 1.6445432901382446, 'learning_rate': 8.839245597910635e-05, 'epoch': 0.22}
{'loss': 1.0201, 'grad_norm': 1.4426015615463257, 'learning_rate': 8.83110144880135e-05, 'epoch': 0.22}
{'loss': 1.0725, 'grad_norm': 2.0504610538482666, 'learning_rate': 8.822932608630165e-05, 'epoch': 0.22}
{'loss': 1.0746, 'grad_norm': 1.9239943027496338, 'learning_rate': 8.814739130044428e-05, 'epoch': 0.22}
{'loss': 1.0633, 'grad_norm': 1.6433976888656616, 'learning_rate': 8.806521065850283e-05, 'epoch': 0.22}
{'loss': 1.096, 'grad_norm': 1.6893823146820068, 'learning_rate': 8.798278469012322e-05, 'epoch': 0.23}
{'loss': 1.0901, 'grad_norm': 1.9330859184265137, 'learning_rate': 8.790011392653251e-05, 'epoch': 0.23}
{'loss': 1.094, 'grad_norm': 1.8497215509414673, 'learning_rate': 8.781719890053541e-05, 'epoch': 0.23}
{'loss': 1.1115, 'grad_norm': 1.4824963808059692, 'learning_rate': 8.773404014651088e-05, 'epoch': 0.23}
{'loss': 1.073, 'grad_norm': 1.7856569290161133, 'learning_rate': 8.76506382004087e-05, 'epoch': 0.23}
{'loss': 1.0453, 'grad_norm': 1.8121553659439087, 'learning_rate': 8.7566993599746e-05, 'epoch': 0.23}
{'loss': 1.0966, 'grad_norm': 1.8043179512023926, 'learning_rate': 8.748310688360378e-05, 'epoch': 0.23}
{'loss': 1.04, 'grad_norm': 1.6571909189224243, 'learning_rate': 8.739897859262343e-05, 'epoch': 0.23}
{'loss': 1.0018, 'grad_norm': 1.8000434637069702, 'learning_rate': 8.731460926900332e-05, 'epoch': 0.23}
{'loss': 1.1025, 'grad_norm': 1.801849126815796, 'learning_rate': 8.722999945649519e-05, 'epoch': 0.23}
{'loss': 1.1135, 'grad_norm': 1.7462316751480103, 'learning_rate': 8.714514970040075e-05, 'epoch': 0.23}
{'loss': 1.104, 'grad_norm': 1.6626893281936646, 'learning_rate': 8.706006054756811e-05, 'epoch': 0.23}
{'loss': 0.9718, 'grad_norm': 1.7685484886169434, 'learning_rate': 8.697473254638827e-05, 'epoch': 0.24}
{'loss': 1.0444, 'grad_norm': 1.6820857524871826, 'learning_rate': 8.688916624679156e-05, 'epoch': 0.24}
{'loss': 1.0858, 'grad_norm': 1.7277787923812866, 'learning_rate': 8.680336220024416e-05, 'epoch': 0.24}
{'loss': 1.069, 'grad_norm': 1.7002137899398804, 'learning_rate': 8.67173209597445e-05, 'epoch': 0.24}
{'loss': 1.0823, 'grad_norm': 1.5162179470062256, 'learning_rate': 8.663104307981964e-05, 'epoch': 0.24}
{'loss': 1.0828, 'grad_norm': 1.7985117435455322, 'learning_rate': 8.654452911652183e-05, 'epoch': 0.24}
{'loss': 1.0524, 'grad_norm': 1.7084500789642334, 'learning_rate': 8.645777962742481e-05, 'epoch': 0.24}
{'loss': 1.1421, 'grad_norm': 1.6119664907455444, 'learning_rate': 8.637079517162028e-05, 'epoch': 0.24}
{'loss': 1.1272, 'grad_norm': 1.979163646697998, 'learning_rate': 8.628357630971429e-05, 'epoch': 0.24}
{'loss': 1.0617, 'grad_norm': 1.3396098613739014, 'learning_rate': 8.619612360382359e-05, 'epoch': 0.24}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:51,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:09,  2.01s/it][A
  3%|▎         | 4/157 [00:09<06:44,  2.65s/it][A
  3%|▎         | 5/157 [00:14<08:26,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:46,  3.48s/it][A
  4%|▍         | 7/157 [00:21<08:44,  3.50s/it][A
  5%|▌         | 8/157 [00:25<09:18,  3.75s/it][A
  6%|▌         | 9/157 [00:28<08:21,  3.39s/it][A
  6%|▋         | 10/157 [00:31<08:22,  3.42s/it][A
  7%|▋         | 11/157 [00:34<07:31,  3.10s/it][A
  8%|▊         | 12/157 [00:36<07:11,  2.98s/it][A
  8%|▊         | 13/157 [00:39<07:07,  2.97s/it][A
  9%|▉         | 14/157 [00:43<07:33,  3.17s/it][A
 10%|▉         | 15/157 [00:47<07:50,  3.32s/it][A
 10%|█         | 16/157 [00:51<08:19,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:46,  3.33s/it][A
 11%|█▏        | 18/157 [00:56<07:13,  3.12s/it][A
 12%|█▏        | 19/157 [01:00<07:52,  3.43s/it][A
 13%|█▎        | 20/157 [01:04<07:53,  3.45s/it][A
 13%|█▎        | 21/157 [01:07<07:48,  3.44s/it][A
 14%|█▍        | 22/157 [01:10<07:26,  3.30s/it][A
 15%|█▍        | 23/157 [01:13<07:11,  3.22s/it][A
 15%|█▌        | 24/157 [01:17<07:34,  3.41s/it][A
 16%|█▌        | 25/157 [01:20<07:30,  3.41s/it][A
 17%|█▋        | 26/157 [01:24<07:27,  3.42s/it][A
 17%|█▋        | 27/157 [01:29<08:32,  3.94s/it][A
 18%|█▊        | 28/157 [01:33<08:27,  3.94s/it][A
 18%|█▊        | 29/157 [01:36<07:43,  3.62s/it][A
 19%|█▉        | 30/157 [01:39<07:11,  3.40s/it][A
 20%|█▉        | 31/157 [01:42<07:19,  3.49s/it][A
 20%|██        | 32/157 [01:46<07:18,  3.51s/it][A
 21%|██        | 33/157 [01:50<07:38,  3.70s/it][A
 22%|██▏       | 34/157 [01:54<07:47,  3.80s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.71s/it][A
 23%|██▎       | 36/157 [02:02<07:59,  3.97s/it][A
 24%|██▎       | 37/157 [02:06<07:46,  3.89s/it][A
 24%|██▍       | 38/157 [02:10<07:32,  3.81s/it][A
 25%|██▍       | 39/157 [02:13<07:13,  3.67s/it][A
 25%|██▌       | 40/157 [02:16<06:35,  3.38s/it][A
 26%|██▌       | 41/157 [02:19<06:49,  3.53s/it][A
 27%|██▋       | 42/157 [02:25<07:44,  4.04s/it][A
 27%|██▋       | 43/157 [02:27<06:55,  3.65s/it][A
 28%|██▊       | 44/157 [02:31<06:59,  3.71s/it][A
 29%|██▊       | 45/157 [02:34<06:35,  3.53s/it][A
 29%|██▉       | 46/157 [02:37<06:06,  3.31s/it][A
 30%|██▉       | 47/157 [02:40<05:58,  3.26s/it][A
 31%|███       | 48/157 [02:47<07:56,  4.38s/it][A
 31%|███       | 49/157 [02:50<06:59,  3.88s/it][A
 32%|███▏      | 50/157 [02:53<06:29,  3.64s/it][A
 32%|███▏      | 51/157 [02:57<06:33,  3.71s/it][A
 33%|███▎      | 52/157 [03:01<06:36,  3.78s/it][A
 34%|███▍      | 53/157 [03:06<07:00,  4.05s/it][A
 34%|███▍      | 54/157 [03:09<06:37,  3.86s/it][A
 35%|███▌      | 55/157 [03:13<06:48,  4.01s/it][A
 36%|███▌      | 56/157 [03:18<06:51,  4.08s/it][A
 36%|███▋      | 57/157 [03:22<06:47,  4.08s/it][A
 37%|███▋      | 58/157 [03:25<06:27,  3.91s/it][A
 38%|███▊      | 59/157 [03:30<06:50,  4.18s/it][A
 38%|███▊      | 60/157 [03:34<06:41,  4.14s/it][A
 39%|███▉      | 61/157 [03:38<06:20,  3.97s/it][A
 39%|███▉      | 62/157 [03:42<06:38,  4.20s/it][A
 40%|████      | 63/157 [03:46<06:12,  3.97s/it][A
 41%|████      | 64/157 [03:50<06:21,  4.10s/it][A
 41%|████▏     | 65/157 [03:55<06:32,  4.27s/it][A
 42%|████▏     | 66/157 [03:57<05:41,  3.75s/it][A
 43%|████▎     | 67/157 [04:02<06:11,  4.13s/it][A
 43%|████▎     | 68/157 [04:05<05:26,  3.67s/it][A
 44%|████▍     | 69/157 [04:08<05:02,  3.43s/it][A
 45%|████▍     | 70/157 [04:12<05:23,  3.71s/it][A
 45%|████▌     | 71/157 [04:16<05:10,  3.61s/it][A
 46%|████▌     | 72/157 [04:19<04:48,  3.39s/it][A
 46%|████▋     | 73/157 [04:21<04:22,  3.12s/it][A
 47%|████▋     | 74/157 [04:25<04:41,  3.40s/it][A
 48%|████▊     | 75/157 [04:29<04:55,  3.60s/it][A
 48%|████▊     | 76/157 [04:33<05:03,  3.74s/it][A
 49%|████▉     | 77/157 [04:37<04:56,  3.71s/it][A
 50%|████▉     | 78/157 [04:40<04:30,  3.43s/it][A
 50%|█████     | 79/157 [04:44<04:58,  3.83s/it][A
 51%|█████     | 80/157 [04:47<04:29,  3.50s/it][A
 52%|█████▏    | 81/157 [04:50<04:05,  3.23s/it][A
 52%|█████▏    | 82/157 [04:53<04:00,  3.21s/it][A
 53%|█████▎    | 83/157 [04:57<04:15,  3.46s/it][A
 54%|█████▎    | 84/157 [05:01<04:27,  3.67s/it][A
 54%|█████▍    | 85/157 [05:05<04:30,  3.76s/it][A
 55%|█████▍    | 86/157 [05:10<04:44,  4.01s/it][A
 55%|█████▌    | 87/157 [05:13<04:34,  3.92s/it][A
 56%|█████▌    | 88/157 [05:17<04:23,  3.81s/it][A
 57%|█████▋    | 89/157 [05:20<04:08,  3.66s/it][A
 57%|█████▋    | 90/157 [05:24<04:12,  3.77s/it][A
 58%|█████▊    | 91/157 [05:28<04:06,  3.73s/it][A
 59%|█████▊    | 92/157 [05:31<03:47,  3.50s/it][A
 59%|█████▉    | 93/157 [05:36<04:14,  3.98s/it][A
 60%|█████▉    | 94/157 [05:39<03:53,  3.71s/it][A
 61%|██████    | 95/157 [05:42<03:43,  3.61s/it][A
 61%|██████    | 96/157 [05:46<03:31,  3.47s/it][A
 62%|██████▏   | 97/157 [05:49<03:22,  3.38s/it][A
 62%|██████▏   | 98/157 [05:51<03:02,  3.09s/it][A
 63%|██████▎   | 99/157 [05:55<03:16,  3.38s/it][A
 64%|██████▎   | 100/157 [05:58<03:06,  3.27s/it][A
 64%|██████▍   | 101/157 [06:01<02:54,  3.12s/it][A
 65%|██████▍   | 102/157 [06:04<02:48,  3.07s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.89s/it][A
 66%|██████▌   | 104/157 [06:11<02:55,  3.30s/it][A
 67%|██████▋   | 105/157 [06:15<03:03,  3.53s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.86s/it][A
 68%|██████▊   | 107/157 [06:24<03:20,  4.02s/it][A
 69%|██████▉   | 108/157 [06:28<03:14,  3.97s/it][A
 69%|██████▉   | 109/157 [06:31<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:35<03:01,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.48s/it][A
 72%|███████▏  | 113/157 [06:45<02:29,  3.41s/it][A
 73%|███████▎  | 114/157 [06:48<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:58<02:51,  4.19s/it][A
 75%|███████▍  | 117/157 [07:01<02:31,  3.80s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.51s/it][A
 76%|███████▌  | 119/157 [07:07<02:15,  3.56s/it][A
 76%|███████▋  | 120/157 [07:10<02:02,  3.30s/it][A
 77%|███████▋  | 121/157 [07:13<01:55,  3.20s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.34s/it][A
 78%|███████▊  | 123/157 [07:20<01:58,  3.47s/it][A
 79%|███████▉  | 124/157 [07:24<01:55,  3.50s/it][A
 80%|███████▉  | 125/157 [07:27<01:45,  3.30s/it][A
 80%|████████  | 126/157 [07:31<01:47,  3.47s/it][A
 81%|████████  | 127/157 [07:33<01:37,  3.26s/it][A
 82%|████████▏ | 128/157 [07:36<01:29,  3.10s/it][A
 82%|████████▏ | 129/157 [07:39<01:22,  2.95s/it][A
 83%|████████▎ | 130/157 [07:43<01:27,  3.24s/it][A
 83%|████████▎ | 131/157 [07:46<01:25,  3.31s/it][A
 84%|████████▍ | 132/157 [07:50<01:30,  3.60s/it][A
 85%|████████▍ | 133/157 [07:53<01:21,  3.42s/it][A
 85%|████████▌ | 134/157 [07:57<01:17,  3.39s/it][A
 86%|████████▌ | 135/157 [08:00<01:17,  3.51s/it][A
 87%|████████▋ | 136/157 [08:03<01:09,  3.32s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.59s/it][A
 88%|████████▊ | 138/157 [08:11<01:05,  3.45s/it][A
 89%|████████▊ | 139/157 [08:15<01:05,  3.64s/it][A
 89%|████████▉ | 140/157 [08:18<01:00,  3.58s/it][A
 90%|████████▉ | 141/157 [08:21<00:55,  3.45s/it][A
 90%|█████████ | 142/157 [08:25<00:54,  3.64s/it][A
 91%|█████████ | 143/157 [08:30<00:55,  3.96s/it][A
 92%|█████████▏| 144/157 [08:34<00:49,  3.84s/it][A
 92%|█████████▏| 145/157 [08:38<00:48,  4.01s/it][A
 93%|█████████▎| 146/157 [08:42<00:43,  3.92s/it][A
 94%|█████████▎| 147/157 [08:47<00:42,  4.26s/it][A
 94%|█████████▍| 148/157 [08:50<00:35,  3.91s/it][A
 95%|█████████▍| 149/157 [08:54<00:31,  3.94s/it][A
 96%|█████████▌| 150/157 [08:57<00:25,  3.70s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.63s/it][A
 97%|█████████▋| 152/157 [09:04<00:17,  3.48s/it][A
 97%|█████████▋| 153/157 [09:06<00:12,  3.18s/it][A
 98%|█████████▊| 154/157 [09:10<00:09,  3.28s/it][A
 99%|█████████▊| 155/157 [09:12<00:06,  3.00s/it][A
 99%|█████████▉| 156/157 [09:16<00:03,  3.32s/it][A
100%|██████████| 157/157 [09:17<00:00,  2.52s/it][A                                                          
                                                 [A 24%|██▍       | 3000/12375 [14:17:24<37:46:27, 14.51s/it]
100%|██████████| 157/157 [09:17<00:00,  2.52s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-28 00:08:58,279 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3000
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-28 00:08:58,439 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-28 00:08:58,439 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3000/special_tokens_map.json
 24%|██▍       | 3001/12375 [14:17:41<477:31:46, 183.39s/it] 24%|██▍       | 3002/12375 [14:17:59<348:18:23, 133.78s/it] 24%|██▍       | 3003/12375 [14:18:17<257:59:35, 99.10s/it]  24%|██▍       | 3004/12375 [14:18:29<190:25:27, 73.15s/it] 24%|██▍       | 3005/12375 [14:18:44<144:42:40, 55.60s/it] 24%|██▍       | 3006/12375 [14:18:58<111:59:35, 43.03s/it] 24%|██▍       | 3007/12375 [14:19:18<94:16:16, 36.23s/it]  24%|██▍       | 3008/12375 [14:19:38<81:33:58, 31.35s/it] 24%|██▍       | 3009/12375 [14:19:49<65:51:38, 25.31s/it] 24%|██▍       | 3010/12375 [14:20:05<58:14:08, 22.39s/it]                                                           24%|██▍       | 3010/12375 [14:20:05<58:14:08, 22.39s/it] 24%|██▍       | 3011/12375 [14:20:16<49:24:47, 19.00s/it] 24%|██▍       | 3012/12375 [14:20:27<43:32:34, 16.74s/it] 24%|██▍       | 3013/12375 [14:20:39<39:46:09, 15.29s/it] 24%|██▍       | 3014/12375 [14:20:51<37:13:47, 14.32s/it] 24%|██▍       | 3015/12375 [14:21:07<38:03:24, 14.64s/it] 24%|██▍       | 3016/12375 [14:21:27<42:04:47, 16.19s/it] 24%|██▍       | 3017/12375 [14:21:40<39:50:57, 15.33s/it] 24%|██▍       | 3018/12375 [14:21:57<40:56:40, 15.75s/it] 24%|██▍       | 3019/12375 [14:22:16<43:39:00, 16.80s/it] 24%|██▍       | 3020/12375 [14:22:36<46:09:27, 17.76s/it]                                                           24%|██▍       | 3020/12375 [14:22:36<46:09:27, 17.76s/it] 24%|██▍       | 3021/12375 [14:22:49<42:22:50, 16.31s/it] 24%|██▍       | 3022/12375 [14:23:07<44:06:57, 16.98s/it] 24%|██▍       | 3023/12375 [14:23:26<45:42:16, 17.59s/it] 24%|██▍       | 3024/12375 [14:23:41<43:00:12, 16.56s/it] 24%|██▍       | 3025/12375 [14:23:56<42:09:36, 16.23s/it] 24%|██▍       | 3026/12375 [14:24:11<41:31:20, 15.99s/it] 24%|██▍       | 3027/12375 [14:24:25<39:31:27, 15.22s/it] 24%|██▍       | 3028/12375 [14:24:41<40:08:34, 15.46s/it] 24%|██▍       | 3029/12375 [14:24:56<39:53:55, 15.37s/it] 24%|██▍       | 3030/12375 [14:25:09<38:09:33, 14.70s/it]                                                           24%|██▍       | 3030/12375 [14:25:09<38:09:33, 14.70s/it] 24%|██▍       | 3031/12375 [14:25:23<37:12:42, 14.34s/it] 25%|██▍       | 3032/12375 [14:25:39<38:32:20, 14.85s/it] 25%|██▍       | 3033/12375 [14:25:53<38:00:30, 14.65s/it] 25%|██▍       | 3034/12375 [14:26:11<40:17:41, 15.53s/it] 25%|██▍       | 3035/12375 [14:26:28<41:30:18, 16.00s/it] 25%|██▍       | 3036/12375 [14:26:52<48:06:53, 18.55s/it] 25%|██▍       | 3037/12375 [14:27:08<45:53:39, 17.69s/it] 25%|██▍       | 3038/12375 [14:27:26<46:04:26, 17.76s/it] 25%|██▍       | 3039/12375 [14:27:40<43:15:11, 16.68s/it] 25%|██▍       | 3040/12375 [14:27:53<40:21:24, 15.56s/it]                                                           25%|██▍       | 3040/12375 [14:27:53<40:21:24, 15.56s/it] 25%|██▍       | 3041/12375 [14:28:13<43:50:54, 16.91s/it] 25%|██▍       | 3042/12375 [14:28:31<45:00:39, 17.36s/it] 25%|██▍       | 3043/12375 [14:28:47<43:23:56, 16.74s/it] 25%|██▍       | 3044/12375 [14:29:03<43:30:42, 16.79s/it] 25%|██▍       | 3045/12375 [14:29:27<48:46:48, 18.82s/it] 25%|██▍       | 3046/12375 [14:29:47<49:20:11, 19.04s/it] 25%|██▍       | 3047/12375 [14:30:00<44:49:04, 17.30s/it] 25%|██▍       | 3048/12375 [14:30:14<42:39:11, 16.46s/it] 25%|██▍       | 3049/12375 [14:30:27<39:41:22, 15.32s/it] 25%|██▍       | 3050/12375 [14:30:46<42:54:46, 16.57s/it]                                                           25%|██▍       | 3050/12375 [14:30:46<42:54:46, 16.57s/it] 25%|██▍       | 3051/12375 [14:30:59<39:40:07, 15.32s/it] 25%|██▍       | 3052/12375 [14:31:14<39:16:45, 15.17s/it] 25%|██▍       | 3053/12375 [14:31:28<38:54:55, 15.03s/it] 25%|██▍       | 3054/12375 [14:31:42<37:53:00, 14.63s/it] 25%|██▍       | 3055/12375 [14:31:57<37:56:44, 14.66s/it] 25%|██▍       | 3056/12375 [14:32:12<38:39:19, 14.93s/it] 25%|██▍       | 3057/12375 [14:32:31<41:06:49, 15.88s/it] 25%|██▍       | 3058/12375 [14:32:46<40:27:03, 15.63s/it] 25%|██▍       | 3059/12375 [14:33:02<41:10:22, 15.91s/it] 25%|██▍       | 3060/12375 [14:33:20<42:43:25, 16.51s/it]                                                           25%|██▍       | 3060/12375 [14:33:20<42:43:25, 16.51s/it] 25%|██▍       | 3061/12375 [14:33:41<46:09:34, 17.84s/it] 25%|██▍       | 3062/12375 [14:33:58<45:35:59, 17.63s/it] 25%|██▍       | 3063/12375 [14:34:16<45:55:58, 17.76s/it] 25%|██▍       | 3064/12375 [14:34:32<44:43:24, 17.29s/it] 25%|██▍       | 3065/12375 [14:34:45<40:45:37, 15.76s/it] 25%|██▍       | 3066/12375 [14:34:56<37:09:05, 14.37s/it] 25%|██▍       | 3067/12375 [14:35:14<40:07:26, 15.52s/it] 25%|██▍       | 3068/12375 [14:35:33<43:15:40, 16.73s/it] 25%|██▍       | 3069/12375 [14:35:48<41:32:20, 16.07s/it] 25%|██▍       | 3070/12375 [14:36:03<40:32:05, 15.68s/it]                                                           25%|██▍       | 3070/12375 [14:36:03<40:32:05, 15.68s/it] 25%|██▍       | 3071/12375 [14:36:18<39:56:50, 15.46s/it] 25%|██▍       | 3072/12375 [14:36:32<38:42:32, 14.98s/it] 25%|██▍       | 3073/12375 [14:36:43<35:52:45, 13.89s/it] 25%|██▍       | 3074/12375 [14:37:04<41:41:48, 16.14s/it] 25%|██▍       | 3075/12375 [14:37:23<43:39:04, 16.90s/it] 25%|██▍       | 3076/12375 [14:37:37<41:50:00, 16.20s/it] 25%|██▍       | 3077/12375 [14:37:57<44:46:20, 17.33s/it] 25%|██▍       | 3078/12375 [14:38:14<43:47:32, 16.96s/it] 25%|██▍       | 3079/12375 [14:38:30<43:13:25, 16.74s/it] 25%|██▍       | 3080/12375 [14:38:46<42:36:46, 16.50s/it]                                                           25%|██▍       | 3080/12375 [14:38:46<42:36:46, 16.50s/it] 25%|██▍       | 3081/12375 [14:38:58<39:30:45, 15.31s/it] 25%|██▍       | 3082/12375 [14:39:11<37:47:19, 14.64s/it] 25%|██▍       | 3083/12375 [14:39:28<39:22:33, 15.26s/it] 25%|██▍       | 3084/12375 [14:39:45<41:01:45, 15.90s/it] 25%|██▍       | 3085/12375 [14:39:58<38:04:56, 14.76s/it] 25%|██▍       | 3086/12375 [14:40:15<40:21:40, 15.64s/it] 25%|██▍       | 3087/12375 [14:40:35<43:23:28, 16.82s/it] 25%|██▍       | 3088/12375 [14:40:49<41:23:13, 16.04s/it] 25%|██▍       | 3089/12375 [14:41:06<42:26:06, 16.45s/it] 25%|██▍       | 3090/12375 [14:41:22<41:58:15, 16.27s/it]                                                           25%|██▍       | 3090/12375 [14:41:22<41:58:15, 16.27s/it] 25%|██▍       | 3091/12375 [14:41:38<41:48:24, 16.21s/it] 25%|██▍       | 3092/12375 [14:41:51<39:05:07, 15.16s/it] 25%|██▍       | 3093/12375 [14:42:06<38:32:42, 14.95s/it] 25%|██▌       | 3094/12375 [14:42:23<40:23:18, 15.67s/it] 25%|██▌       | 3095/12375 [14:42:43<43:50:37, 17.01s/it] 25%|██▌       | 3096/12375 [14:43:05<48:02:46, 18.64s/it] 25%|██▌       | 3097/12375 [14:43:19<44:11:24, 17.15s/it] 25%|██▌       | 3098/12375 [14:43:35<43:01:38, 16.70s/it] 25%|██▌       | 3099/12375 [14:43:51<42:35:02, 16.53s/it] 25%|██▌       | 3100/12375 [14:44:07<41:52:48, 16.26s/it]                                                           25%|██▌       | 3100/12375 [14:44:07<41:52:48, 16.26s/it][INFO|trainer.py:3410] 2024-05-28 00:35:41,081 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3100
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-28 00:35:41,240 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-28 00:35:41,240 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3100/special_tokens_map.json
 25%|██▌       | 3101/12375 [14:44:24<42:39:01, 16.56s/it] 25%|██▌       | 3102/12375 [14:44:41<43:24:54, 16.85s/it] 25%|██▌       | 3103/12375 [14:44:55<41:05:45, 15.96s/it] 25%|██▌       | 3104/12375 [14:45:12<41:58:51, 16.30s/it] 25%|██▌       | 3105/12375 [14:45:29<42:10:19, 16.38s/it] 25%|██▌       | 3106/12375 [14:45:48<44:31:49, 17.30s/it] 25%|██▌       | 3107/12375 [14:46:04<42:57:17, 16.69s/it] 25%|██▌       | 3108/12375 [14:46:23<45:09:27, 17.54s/it] 25%|██▌       | 3109/12375 [14:46:41<45:09:58, 17.55s/it] 25%|██▌       | 3110/12375 [14:46:56<43:28:18, 16.89s/it]                                                           25%|██▌       | 3110/12375 [14:46:56<43:28:18, 16.89s/it] 25%|██▌       | 3111/12375 [14:47:09<40:31:16, 15.75s/it] 25%|██▌       | 3112/12375 [14:47:25<40:49:04, 15.86s/it] 25%|██▌       | 3113/12375 [14:47:39<39:33:44, 15.38s/it] 25%|██▌       | 3114/12375 [14:47:57<41:25:38, 16.10s/it] 25%|██▌       | 3115/12375 [14:48:13<40:58:29, 15.93s/it] 25%|██▌       | 3116/12375 [14:48:27<39:42:01, 15.44s/it] 25%|██▌       | 3117/12375 [14:48:44<41:08:43, 16.00s/it] 25%|██▌       | 3118/12375 [14:48:59<40:14:16, 15.65s/it] 25%|██▌       | 3119/12375 [14:49:18<42:22:50, 16.48s/it] 25%|██▌       | 3120/12375 [14:49:34<42:33:43, 16.56s/it]                                                           25%|██▌       | 3120/12375 [14:49:34<42:33:43, 16.56s/it] 25%|██▌       | 3121/12375 [14:49:49<41:11:01, 16.02s/it] 25%|██▌       | 3122/12375 [14:50:06<41:48:52, 16.27s/it] 25%|██▌       | 3123/12375 [14:50:22<41:49:52, 16.28s/it] 25%|██▌       | 3124/12375 [14:50:38<41:26:30, 16.13s/it] 25%|██▌       | 3125/12375 [14:50:51<39:13:42, 15.27s/it] 25%|██▌       | 3126/12375 [14:51:11<42:28:20, 16.53s/it] 25%|██▌       | 3127/12375 [14:51:30<44:27:42, 17.31s/it] 25%|██▌       | 3128/12375 [14:51:46<43:50:23, 17.07s/it] 25%|██▌       | 3129/12375 [14:52:05<44:46:38, 17.43s/it] 25%|██▌       | 3130/12375 [14:52:24<46:07:05, 17.96s/it]                                                           25%|██▌       | 3130/12375 [14:52:24<46:07:05, 17.96s/it] 25%|██▌       | 3131/12375 [14:52:40<44:53:38, 17.48s/it] 25%|██▌       | 3132/12375 [14:52:56<43:38:50, 17.00s/it] 25%|██▌       | 3133/12375 [14:53:18<47:10:17, 18.37s/it] 25%|██▌       | 3134/12375 [14:53:35<46:31:12, 18.12s/it] 25%|██▌       | 3135/12375 [14:53:49<43:19:34, 16.88s/it] 25%|██▌       | 3136/12375 [14:54:04<41:44:31, 16.26s/it] 25%|██▌       | 3137/12375 [14:54:18<39:36:00, 15.43s/it] 25%|██▌       | 3138/12375 [14:54:33<39:51:57, 15.54s/it] 25%|██▌       | 3139/12375 [14:54:50<40:36:13, 15.83s/it] 25%|██▌       | 3140/12375 [14:55:04<39:18:39, 15.32s/it]                                                           25%|██▌       | 3140/12375 [14:55:04<39:18:39, 15.32s/it] 25%|██▌       | 3141/12375 [14:55:21<40:40:23, 15.86s/it] 25%|██▌       | 3142/12375 [14:55:36<40:10:02, 15.66s/it] 25%|██▌       | 3143/12375 [14:55:54<41:41:45, 16.26s/it] 25%|██▌       | 3144/12375 [14:56:17<46:36:46, 18.18s/it] 25%|██▌       | 3145/12375 [14:56:31<43:26:10, 16.94s/it] 25%|██▌       | 3146/12375 [14:56:45<41:14:17, 16.09s/it] 25%|██▌       | 3147/12375 [14:56:58<39:19:41, 15.34s/it] 25%|██▌       | 3148/12375 [14:57:16<41:02:52, 16.02s/it] 25%|██▌       | 3149/12375 [14:57:29<38:59:54, 15.22s/it] 25%|██▌       | 3150/12375 [14:57:47<40:52:52, 15.95s/it]                                                           25%|██▌       | 3150/12375 [14:57:47<40:52:52, 15.95s/it] 25%|██▌       | 3151/12375 [14:58:01<39:08:49, 15.28s/it] 25%|██▌       | 3152/12375 [14:58:16<39:01:32, 15.23s/it] 25%|██▌       | 3153/12375 [14:58:36<42:38:24, 16.65s/it] 25%|██▌       | 3154/12375 [14:58:53<42:48:27, 16.71s/it] 25%|██▌       | 3155/12375 [14:59:05<39:37:56, 15.47s/it] 26%|██▌       | 3156/12375 [14:59:18<37:15:40, 14.55s/it] 26%|██▌       | 3157/12375 [14:59:36<40:20:47, 15.76s/it] 26%|██▌       | 3158/12375 [14:59:51<39:17:09, 15.34s/it] 26%|██▌       | 3159/12375 [15:00:06<39:16:56, 15.34s/it] 26%|██▌       | 3160/12375 [15:00:25<41:47:09, 16.32s/it]                                                           26%|██▌       | 3160/12375 [15:00:25<41:47:09, 16.32s/it] 26%|██▌       | 3161/12375 [15:00:41<42:07:03, 16.46s/it] 26%|██▌       | 3162/12375 [15:00:55<40:24:18, 15.79s/it] 26%|██▌       | 3163/12375 [15:01:21<47:29:23, 18.56s/it] 26%|██▌       | 3164/12375 [15:01:39<47:05:37, 18.41s/it] 26%|██▌       | 3165/12375 [15:01:51<42:44:54, 16.71s/it] 26%|██▌       | 3166/12375 [15:02:06<41:30:56, 16.23s/it] 26%|██▌       | 3167/12375 [15:02:20<39:09:22, 15.31s/it] 26%|██▌       | 3168/12375 [15:02:36<40:20:23, 15.77s/it] 26%|██▌       | 3169/12375 [15:02:52<40:11:27, 15.72s/it] 26%|██▌       | 3170/12375 [15:03:06<38:28:40, 15.05s/it]                                                           26%|██▌       | 3170/12375 [15:03:06<38:28:40, 15.05s/it] 26%|██▌       | 3171/12375 [15:03:18<36:43:44, 14.37s/it] 26%|██▌       | 3172/12375 [15:03:35<38:50:58, 15.20s/it] 26%|██▌       | 3173/12375 [15:03:49<37:41:34, 14.75s/it] 26%|██▌       | 3174/12375 [15:04:05<38:34:39, 15.09s/it] 26%|██▌       | 3175/12375 [15:04:22<40:07:46, 15.70s/it] 26%|██▌       | 3176/12375 [15:04:39<40:59:44, 16.04s/it] 26%|██▌       | 3177/12375 [15:04:56<41:37:23, 16.29s/it] 26%|██▌       | 3178/12375 [15:05:10<39:58:19, 15.65s/it] 26%|██▌       | 3179/12375 [15:05:28<41:29:58, 16.25s/it] 26%|██▌       | 3180/12375 [15:05:42<40:06:45, 15.70s/it]                                                           26%|██▌       | 3180/12375 [15:05:42<40:06:45, 15.70s/it] 26%|██▌       | 3181/12375 [15:05:55<37:52:29, 14.83s/it] 26%|██▌       | 3182/12375 [15:06:10<38:15:38, 14.98s/it] 26%|██▌       | 3183/12375 [15:06:28<40:03:35, 15.69s/it] 26%|██▌       | 3184/12375 [15:06:47<43:04:14, 16.87s/it] 26%|██▌       | 3185/12375 [15:07:03<42:33:00, 16.67s/it] 26%|██▌       | 3186/12375 [15:07:18<40:40:31, 15.94s/it] 26%|██▌       | 3187/12375 [15:07:37<43:10:20, 16.92s/it] 26%|██▌       | 3188/12375 [15:07:52<41:32:50, 16.28s/it] 26%|██▌       | 3189/12375 [15:08:06<40:12:01, 15.75s/it] 26%|██▌       | 3190/12375 [15:08:23<41:15:32, 16.17s/it]                                                           26%|██▌       | 3190/12375 [15:08:23<41:15:32, 16.17s/it] 26%|██▌       | 3191/12375 [15:08:41<42:34:11, 16.69s/it] 26%|██▌       | 3192/12375 [15:09:00<44:15:12, 17.35s/it] 26%|██▌       | 3193/12375 [15:09:11<39:38:26, 15.54s/it] 26%|██▌       | 3194/12375 [15:09:29<41:12:59, 16.16s/it] 26%|██▌       | 3195/12375 [15:09:47<42:59:57, 16.86s/it] 26%|██▌       | 3196/12375 [15:10:01<40:06:20, 15.73s/it] 26%|██▌       | 3197/12375 [15:10:17<40:17:16, 15.80s/it] 26%|██▌       | 3198/12375 [15:10:32<39:51:47, 15.64s/it] 26%|██▌       | 3199/12375 [15:10:50<42:07:14, 16.53s/it] 26%|██▌       | 3200/12375 [15:11:07<42:20:32, 16.61s/it]                                                           26%|██▌       | 3200/12375 [15:11:07<42:20:32, 16.61s/it][INFO|trainer.py:3410] 2024-05-28 01:02:41,798 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3200
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-28 01:02:41,961 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-28 01:02:41,961 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3200/special_tokens_map.json
 26%|██▌       | 3201/12375 [15:11:24<42:44:39, 16.77s/it] 26%|██▌       | 3202/12375 [15:11:40<41:33:24, 16.31s/it] 26%|██▌       | 3203/12375 [15:11:54<39:44:29, 15.60s/it] 26%|██▌       | 3204/12375 [15:12:10<40:33:35, 15.92s/it] 26%|██▌       | 3205/12375 [15:12:28<42:15:10, 16.59s/it] 26%|██▌       | 3206/12375 [15:12:45<42:27:41, 16.67s/it] 26%|██▌       | 3207/12375 [15:13:00<41:01:04, 16.11s/it] 26%|██▌       | 3208/12375 [15:13:15<40:15:22, 15.81s/it] 26%|██▌       | 3209/12375 [15:13:29<38:55:45, 15.29s/it] 26%|██▌       | 3210/12375 [15:13:46<39:58:56, 15.71s/it]                                                           26%|██▌       | 3210/12375 [15:13:46<39:58:56, 15.71s/it] 26%|██▌       | 3211/12375 [15:14:02<40:03:19, 15.74s/it] 26%|██▌       | 3212/12375 [15:14:20<41:49:07, 16.43s/it] 26%|██▌       | 3213/12375 [15:14:39<43:47:03, 17.20s/it] 26%|██▌       | 3214/12375 [15:14:51<39:52:28, 15.67s/it] 26%|██▌       | 3215/12375 [15:15:06<39:45:14, 15.62s/it] 26%|██▌       | 3216/12375 [15:15:19<37:12:46, 14.63s/it] 26%|██▌       | 3217/12375 [15:15:36<39:16:52, 15.44s/it] 26%|██▌       | 3218/12375 [15:15:50<37:57:39, 14.92s/it] 26%|██▌       | 3219/12375 [15:16:02<35:50:08, 14.09s/it] 26%|██▌       | 3220/12375 [15:16:16<36:14:06, 14.25s/it]                                                           26%|██▌       | 3220/12375 [15:16:16<36:14:06, 14.25s/it] 26%|██▌       | 3221/12375 [15:16:29<34:57:13, 13.75s/it] 26%|██▌       | 3222/12375 [15:16:42<34:07:07, 13.42s/it] 26%|██▌       | 3223/12375 [15:16:59<37:15:55, 14.66s/it] 26%|██▌       | 3224/12375 [15:17:13<36:53:01, 14.51s/it] 26%|██▌       | 3225/12375 [15:17:28<36:39:51, 14.43s/it] 26%|██▌       | 3226/12375 [15:17:47<40:05:16, 15.77s/it] 26%|██▌       | 3227/12375 [15:18:09<45:32:35, 17.92s/it] 26%|██▌       | 3228/12375 [15:18:22<41:46:15, 16.44s/it] 26%|██▌       | 3229/12375 [15:18:37<40:32:03, 15.95s/it] 26%|██▌       | 3230/12375 [15:18:53<40:09:57, 15.81s/it]                                                           26%|██▌       | 3230/12375 [15:18:53<40:09:57, 15.81s/it] 26%|██▌       | 3231/12375 [15:19:10<41:17:45, 16.26s/it] 26%|██▌       | 3232/12375 [15:19:33<46:04:00, 18.14s/it] 26%|██▌       | 3233/12375 [15:19:48<43:54:25, 17.29s/it] 26%|██▌       | 3234/12375 [15:20:07<45:09:23, 17.78s/it] 26%|██▌       | 3235/12375 [15:20:24<44:34:02, 17.55s/it] 26%|██▌       | 3236/12375 [15:20:37<40:53:42, 16.11s/it] 26%|██▌       | 3237/12375 [15:20:57<43:53:24, 17.29s/it] 26%|██▌       | 3238/12375 [15:21:11<41:37:21, 16.40s/it] 26%|██▌       | 3239/12375 [15:21:22<37:47:20, 14.89s/it] 26%|██▌       | 3240/12375 [15:21:40<39:51:17, 15.71s/it]                                                           26%|██▌       | 3240/12375 [15:21:40<39:51:17, 15.71s/it] 26%|██▌       | 3241/12375 [15:21:55<39:32:21, 15.58s/it] 26%|██▌       | 3242/12375 [15:22:11<39:37:06, 15.62s/it] 26%|██▌       | 3243/12375 [15:22:23<37:15:27, 14.69s/it] 26%|██▌       | 3244/12375 [15:22:40<38:40:54, 15.25s/it] 26%|██▌       | 3245/12375 [15:22:51<35:35:15, 14.03s/it] 26%|██▌       | 3246/12375 [15:23:07<36:33:25, 14.42s/it] 26%|██▌       | 3247/12375 [15:23:27<40:48:41, 16.10s/it] 26%|██▌       | 3248/12375 [15:23:45<42:50:22, 16.90s/it] 26%|██▋       | 3249/12375 [15:23:59<40:44:43, 16.07s/it] 26%|██▋       | 3250/12375 [15:24:14<39:28:46, 15.58s/it]                                                           26%|██▋       | 3250/12375 [15:24:14<39:28:46, 15.58s/it] 26%|██▋       | 3251/12375 [15:24:27<37:53:31, 14.95s/it] 26%|██▋       | 3252/12375 [15:24:43<38:02:38, 15.01s/it] 26%|██▋       | 3253/12375 [15:24:59<38:50:04, 15.33s/it] 26%|██▋       | 3254/12375 [15:25:16<40:26:00, 15.96s/it] 26%|██▋       | 3255/12375 [15:25:30<38:54:27, 15.36s/it] 26%|██▋       | 3256/12375 [15:25:48<40:49:33, 16.12s/it] 26%|██▋       | 3257/12375 [15:26:05<41:43:20, 16.47s/it] 26%|██▋       | 3258/12375 [15:26:23<42:27:22, 16.76s/it] 26%|██▋       | 3259/12375 [15:26:41<43:31:49, 17.19s/it] 26%|██▋       | 3260/12375 [15:26:56<41:38:26, 16.45s/it]                                                           26%|██▋       | 3260/12375 [15:26:56<41:38:26, 16.45s/it] 26%|██▋       | 3261/12375 [15:27:16<44:26:32, 17.55s/it] 26%|██▋       | 3262/12375 [15:27:35<46:06:13, 18.21s/it] 26%|██▋       | 3263/12375 [15:27:49<42:15:12, 16.69s/it] 26%|██▋       | 3264/12375 [15:28:09<44:48:24, 17.70s/it] 26%|██▋       | 3265/12375 [15:28:24<43:00:43, 17.00s/it] 26%|██▋       | 3266/12375 [15:28:36<39:11:04, 15.49s/it] 26%|██▋       | 3267/12375 [15:28:50<38:04:38, 15.05s/it] 26%|██▋       | 3268/12375 [15:29:06<39:12:09, 15.50s/it] 26%|██▋       | 3269/12375 [15:29:22<39:08:49, 15.48s/it] 26%|██▋       | 3270/12375 [15:29:37<39:05:23, 15.46s/it]                                                           26%|██▋       | 3270/12375 [15:29:37<39:05:23, 15.46s/it] 26%|██▋       | 3271/12375 [15:29:56<41:23:37, 16.37s/it] 26%|██▋       | 3272/12375 [15:30:17<45:08:43, 17.85s/it] 26%|██▋       | 3273/12375 [15:30:34<44:25:21, 17.57s/it] 26%|██▋       | 3274/12375 [15:30:46<40:24:20, 15.98s/it] 26%|██▋       | 3275/12375 [15:31:01<39:46:17, 15.73s/it] 26%|██▋       | 3276/12375 [15:31:19<41:21:53, 16.37s/it] 26%|██▋       | 3277/12375 [15:31:31<38:07:13, 15.08s/it] 26%|██▋       | 3278/12375 [15:31:52<42:14:06, 16.71s/it] 26%|██▋       | 3279/12375 [15:32:08<41:43:25, 16.51s/it] 27%|██▋       | 3280/12375 [15:32:20<37:57:41, 15.03s/it]                                                           27%|██▋       | 3280/12375 [15:32:20<37:57:41, 15.03s/it] 27%|██▋       | 3281/12375 [15:32:33<37:00:21, 14.65s/it] 27%|██▋       | 3282/12375 [15:32:46<35:29:58, 14.05s/it] 27%|██▋       | 3283/12375 [15:33:01<36:21:50, 14.40s/it] 27%|██▋       | 3284/12375 [15:33:14<35:22:20, 14.01s/it] 27%|██▋       | 3285/12375 [15:33:32<37:49:21, 14.98s/it] 27%|██▋       | 3286/12375 [15:33:47<38:09:12, 15.11s/it] 27%|██▋       | 3287/12375 [15:34:02<38:10:24, 15.12s/it] 27%|██▋       | 3288/12375 [15:34:24<43:25:21, 17.20s/it] 27%|██▋       | 3289/12375 [15:34:40<42:46:42, 16.95s/it] 27%|██▋       | 3290/12375 [15:34:56<41:55:13, 16.61s/it]                                                           27%|██▋       | 3290/12375 [15:34:56<41:55:13, 16.61s/it] 27%|██▋       | 3291/12375 [15:35:12<41:06:51, 16.29s/it] 27%|██▋       | 3292/12375 [15:35:27<40:14:05, 15.95s/it] 27%|██▋       | 3293/12375 [15:35:46<42:28:27, 16.84s/it] 27%|██▋       | 3294/12375 [15:36:07<45:26:27, 18.01s/it] 27%|██▋       | 3295/12375 [15:36:18<40:42:30, 16.14s/it] 27%|██▋       | 3296/12375 [15:36:33<39:18:12, 15.58s/it] 27%|██▋       | 3297/12375 [15:36:47<37:58:50, 15.06s/it] 27%|██▋       | 3298/12375 [15:37:01<37:42:00, 14.95s/it] 27%|██▋       | 3299/12375 [15:37:16<37:50:26, 15.01s/it] 27%|██▋       | 3300/12375 [15:37:31<37:09:49, 14.74s/it]                                                           27%|██▋       | 3300/12375 [15:37:31<37:09:49, 14.74s/it][INFO|trainer.py:3410] 2024-05-28 01:29:05,114 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3300
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-28 01:29:05,279 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-28 01:29:05,279 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3300/special_tokens_map.json
 27%|██▋       | 3301/12375 [15:37:49<39:59:55, 15.87s/it] 27%|██▋       | 3302/12375 [15:38:04<39:07:15, 15.52s/it] 27%|██▋       | 3303/12375 [15:38:25<43:20:00, 17.20s/it] 27%|██▋       | 3304/12375 [15:38:40<41:58:39, 16.66s/it] 27%|██▋       | 3305/12375 [15:38:53<39:10:25, 15.55s/it] 27%|██▋       | 3306/12375 [15:39:10<39:49:26, 15.81s/it] 27%|██▋       | 3307/12375 [15:39:25<39:30:51, 15.69s/it] 27%|██▋       | 3308/12375 [15:39:43<41:03:06, 16.30s/it] 27%|██▋       | 3309/12375 [15:40:02<43:04:37, 17.11s/it] 27%|██▋       | 3310/12375 [15:40:13<38:48:17, 15.41s/it]                                                           27%|██▋       | 3310/12375 [15:40:13<38:48:17, 15.41s/it] 27%|██▋       | 3311/12375 [15:40:28<38:03:17, 15.11s/it] 27%|██▋       | 3312/12375 [15:40:43<38:03:51, 15.12s/it] 27%|██▋       | 3313/12375 [15:40:56<36:18:06, 14.42s/it] 27%|██▋       | 3314/12375 [15:41:13<38:17:53, 15.22s/it] 27%|██▋       | 3315/12375 [15:41:25<36:15:06, 14.40s/it] 27%|██▋       | 3316/12375 [15:41:43<39:04:41, 15.53s/it] 27%|██▋       | 3317/12375 [15:42:01<40:24:12, 16.06s/it] 27%|██▋       | 3318/12375 [15:42:14<38:41:33, 15.38s/it] 27%|██▋       | 3319/12375 [15:42:30<38:30:03, 15.31s/it] 27%|██▋       | 3320/12375 [15:42:49<41:29:26, 16.50s/it]                                                           27%|██▋       | 3320/12375 [15:42:49<41:29:26, 16.50s/it] 27%|██▋       | 3321/12375 [15:43:08<43:19:56, 17.23s/it] 27%|██▋       | 3322/12375 [15:43:26<44:06:48, 17.54s/it] 27%|██▋       | 3323/12375 [15:43:43<43:34:30, 17.33s/it] 27%|██▋       | 3324/12375 [15:44:01<43:49:55, 17.43s/it] 27%|██▋       | 3325/12375 [15:44:16<42:02:13, 16.72s/it] 27%|██▋       | 3326/12375 [15:44:32<41:40:14, 16.58s/it] 27%|██▋       | 3327/12375 [15:44:44<38:02:10, 15.13s/it] 27%|██▋       | 3328/12375 [15:45:00<38:46:42, 15.43s/it] 27%|██▋       | 3329/12375 [15:45:16<39:28:36, 15.71s/it] 27%|██▋       | 3330/12375 [15:45:29<37:14:46, 14.82s/it]                                                           27%|██▋       | 3330/12375 [15:45:29<37:14:46, 14.82s/it] 27%|██▋       | 3331/12375 [15:45:43<36:31:40, 14.54s/it] 27%|██▋       | 3332/12375 [15:46:04<41:52:55, 16.67s/it] 27%|██▋       | 3333/12375 [15:46:21<41:30:30, 16.53s/it] 27%|██▋       | 3334/12375 [15:46:38<42:21:02, 16.86s/it] 27%|██▋       | 3335/12375 [15:46:50<38:34:49, 15.36s/it] 27%|██▋       | 3336/12375 [15:47:06<38:41:07, 15.41s/it] 27%|██▋       | 3337/12375 [15:47:20<38:17:30, 15.25s/it] 27%|██▋       | 3338/12375 [15:47:36<38:49:48, 15.47s/it] 27%|██▋       | 3339/12375 [15:47:52<39:00:22, 15.54s/it] 27%|██▋       | 3340/12375 [15:48:06<37:25:57, 14.92s/it]                                                           27%|██▋       | 3340/12375 [15:48:06<37:25:57, 14.92s/it] 27%|██▋       | 3341/12375 [15:48:21<37:56:26, 15.12s/it] 27%|██▋       | 3342/12375 [15:48:37<38:34:00, 15.37s/it] 27%|██▋       | 3343/12375 [15:48:50<36:41:11, 14.62s/it] 27%|██▋       | 3344/12375 [15:49:03<35:28:51, 14.14s/it] 27%|██▋       | 3345/12375 [15:49:16<34:44:34, 13.85s/it] 27%|██▋       | 3346/12375 [15:49:29<33:38:33, 13.41s/it] 27%|██▋       | 3347/12375 [15:49:44<34:46:20, 13.87s/it] 27%|██▋       | 3348/12375 [15:49:59<35:53:07, 14.31s/it] 27%|██▋       | 3349/12375 [15:50:11<34:00:03, 13.56s/it] 27%|██▋       | 3350/12375 [15:50:25<34:20:46, 13.70s/it]                                                           27%|██▋       | 3350/12375 [15:50:25<34:20:46, 13.70s/it] 27%|██▋       | 3351/12375 [15:50:40<35:27:12, 14.14s/it] 27%|██▋       | 3352/12375 [15:51:03<42:25:51, 16.93s/it] 27%|██▋       | 3353/12375 [15:51:18<40:39:17, 16.22s/it] 27%|██▋       | 3354/12375 [15:51:34<40:44:36, 16.26s/it] 27%|██▋       | 3355/12375 [15:51:47<38:06:58, 15.21s/it] 27%|██▋       | 3356/12375 [15:52:11<44:34:24, 17.79s/it] 27%|██▋       | 3357/12375 [15:52:27<42:59:31, 17.16s/it] 27%|██▋       | 3358/12375 [15:52:40<40:24:35, 16.13s/it] 27%|██▋       | 3359/12375 [15:52:54<38:49:49, 15.50s/it] 27%|██▋       | 3360/12375 [15:53:07<36:50:26, 14.71s/it]                                                           27%|██▋       | 3360/12375 [15:53:07<36:50:26, 14.71s/it] 27%|██▋       | 3361/12375 [15:53:23<37:36:56, 15.02s/it] 27%|██▋       | 3362/12375 [15:53:41<39:55:52, 15.95s/it] 27%|██▋       | 3363/12375 [15:53:59<41:30:39, 16.58s/it] 27%|██▋       | 3364/12375 [15:54:13<39:13:29, 15.67s/it] 27%|██▋       | 3365/12375 [15:54:25<36:49:24, 14.71s/it] 27%|██▋       | 3366/12375 [15:54:40<36:43:19, 14.67s/it] 27%|██▋       | 3367/12375 [15:54:59<40:14:48, 16.08s/it] 27%|██▋       | 3368/12375 [15:55:14<39:44:09, 15.88s/it] 27%|██▋       | 3369/12375 [15:55:29<38:59:39, 15.59s/it] 27%|██▋       | 3370/12375 [15:55:51<43:14:07, 17.28s/it]                                                           27%|██▋       | 3370/12375 [15:55:51<43:14:07, 17.28s/it] 27%|██▋       | 3371/12375 [15:56:10<44:32:52, 17.81s/it] 27%|██▋       | 3372/12375 [15:56:28<44:50:48, 17.93s/it] 27%|██▋       | 3373/12375 [15:56:45<44:33:24, 17.82s/it] 27%|██▋       | 3374/12375 [15:56:57<39:59:05, 15.99s/it] 27%|██▋       | 3375/12375 [15:57:12<39:20:17, 15.74s/it] 27%|██▋       | 3376/12375 [15:57:30<40:50:13, 16.34s/it] 27%|██▋       | 3377/12375 [15:57:50<43:44:22, 17.50s/it] 27%|██▋       | 3378/12375 [15:58:03<40:05:54, 16.04s/it] 27%|██▋       | 3379/12375 [15:58:16<37:58:22, 15.20s/it] 27%|██▋       | 3380/12375 [15:58:28<35:33:54, 14.23s/it]                                                           27%|██▋       | 3380/12375 [15:58:28<35:33:54, 14.23s/it] 27%|██▋       | 3381/12375 [15:58:43<36:09:38, 14.47s/it] 27%|██▋       | 3382/12375 [15:59:09<44:57:49, 18.00s/it] 27%|██▋       | 3383/12375 [15:59:28<45:05:18, 18.05s/it] 27%|██▋       | 3384/12375 [15:59:41<41:52:23, 16.77s/it] 27%|██▋       | 3385/12375 [15:59:59<42:51:54, 17.17s/it] 27%|██▋       | 3386/12375 [16:00:16<42:08:06, 16.87s/it] 27%|██▋       | 3387/12375 [16:00:31<41:17:09, 16.54s/it] 27%|██▋       | 3388/12375 [16:00:50<42:32:50, 17.04s/it] 27%|██▋       | 3389/12375 [16:01:04<40:43:07, 16.31s/it] 27%|██▋       | 3390/12375 [16:01:26<44:43:17, 17.92s/it]                                                           27%|██▋       | 3390/12375 [16:01:26<44:43:17, 17.92s/it] 27%|██▋       | 3391/12375 [16:01:43<43:53:23, 17.59s/it] 27%|██▋       | 3392/12375 [16:02:05<47:41:49, 19.11s/it] 27%|██▋       | 3393/12375 [16:02:24<47:11:55, 18.92s/it] 27%|██▋       | 3394/12375 [16:02:38<43:29:58, 17.44s/it] 27%|██▋       | 3395/12375 [16:02:50<39:33:11, 15.86s/it] 27%|██▋       | 3396/12375 [16:03:06<39:31:59, 15.85s/it] 27%|██▋       | 3397/12375 [16:03:21<38:53:34, 15.60s/it] 27%|██▋       | 3398/12375 [16:03:37<39:18:55, 15.77s/it] 27%|██▋       | 3399/12375 [16:03:54<40:23:25, 16.20s/it] 27%|██▋       | 3400/12375 [16:04:06<37:13:17, 14.93s/it]                                                           27%|██▋       | 3400/12375 [16:04:06<37:13:17, 14.93s/it][INFO|trainer.py:3410] 2024-05-28 01:55:40,668 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3400
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-28 01:55:40,834 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-28 01:55:40,834 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3400/special_tokens_map.json
 27%|██▋       | 3401/12375 [16:04:20<36:25:55, 14.62s/it] 27%|██▋       | 3402/12375 [16:04:36<37:48:06, 15.17s/it] 27%|██▋       | 3403/12375 [16:04:52<38:09:11, 15.31s/it] 28%|██▊       | 3404/12375 [16:05:09<39:21:09, 15.79s/it] 28%|██▊       | 3405/12375 [16:05:26<40:02:07, 16.07s/it] 28%|██▊       | 3406/12375 [16:05:39<38:08:41, 15.31s/it] 28%|██▊       | 3407/12375 [16:05:57<40:01:06, 16.06s/it] 28%|██▊       | 3408/12375 [16:06:11<38:22:02, 15.40s/it] 28%|██▊       | 3409/12375 [16:06:27<38:49:46, 15.59s/it] 28%|██▊       | 3410/12375 [16:06:42<38:10:48, 15.33s/it]                                                           28%|██▊       | 3410/12375 [16:06:42<38:10:48, 15.33s/it] 28%|██▊       | 3411/12375 [16:06:58<38:38:50, 15.52s/it] 28%|██▊       | 3412/12375 [16:07:16<41:07:36, 16.52s/it] 28%|██▊       | 3413/12375 [16:07:30<38:41:19, 15.54s/it] 28%|██▊       | 3414/12375 [16:07:44<37:34:28, 15.10s/it] 28%|██▊       | 3415/12375 [16:07:57<36:17:55, 14.58s/it] 28%|██▊       | 3416/12375 [16:08:10<34:58:29, 14.05s/it] 28%|██▊       | 3417/12375 [16:08:25<35:46:34, 14.38s/it] 28%|██▊       | 3418/12375 [16:08:41<36:39:00, 14.73s/it] 28%|██▊       | 3419/12375 [16:08:54<35:14:16, 14.16s/it] 28%|██▊       | 3420/12375 [16:09:05<33:17:57, 13.39s/it]                                                           28%|██▊       | 3420/12375 [16:09:05<33:17:57, 13.39s/it] 28%|██▊       | 3421/12375 [16:09:21<34:48:39, 14.00s/it] 28%|██▊       | 3422/12375 [16:09:38<37:18:42, 15.00s/it] 28%|██▊       | 3423/12375 [16:09:51<35:53:09, 14.43s/it] 28%|██▊       | 3424/12375 [16:10:06<36:21:58, 14.63s/it] 28%|██▊       | 3425/12375 [16:10:19<35:24:33, 14.24s/it] 28%|██▊       | 3426/12375 [16:10:33<35:14:33, 14.18s/it] 28%|██▊       | 3427/12375 [16:10:49<36:16:46, 14.60s/it] 28%|██▊       | 3428/12375 [16:11:07<38:33:32, 15.51s/it] 28%|██▊       | 3429/12375 [16:11:22<38:06:09, 15.33s/it] 28%|██▊       | 3430/12375 [16:11:34<35:43:07, 14.38s/it]                                                           28%|██▊       | 3430/12375 [16:11:34<35:43:07, 14.38s/it] 28%|██▊       | 3431/12375 [16:11:52<38:55:30, 15.67s/it] 28%|██▊       | 3432/12375 [16:12:07<37:53:10, 15.25s/it] 28%|██▊       | 3433/12375 [16:12:26<41:14:00, 16.60s/it] 28%|██▊       | 3434/12375 [16:12:44<41:39:32, 16.77s/it] 28%|██▊       | 3435/12375 [16:12:57<39:21:25, 15.85s/it] 28%|██▊       | 3436/12375 [16:13:15<40:29:15, 16.31s/it] 28%|██▊       | 3437/12375 [16:13:28<37:56:36, 15.28s/it] 28%|██▊       | 3438/12375 [16:13:47<40:43:26, 16.40s/it] 28%|██▊       | 3439/12375 [16:14:01<39:08:10, 15.77s/it] 28%|██▊       | 3440/12375 [16:14:15<37:50:57, 15.25s/it]                                                           28%|██▊       | 3440/12375 [16:14:15<37:50:57, 15.25s/it] 28%|██▊       | 3441/12375 [16:14:30<37:23:13, 15.07s/it] 28%|██▊       | 3442/12375 [16:14:45<37:24:10, 15.07s/it] 28%|██▊       | 3443/12375 [16:15:05<41:29:49, 16.73s/it] 28%|██▊       | 3444/12375 [16:15:19<39:37:45, 15.97s/it] 28%|██▊       | 3445/12375 [16:15:36<39:54:41, 16.09s/it] 28%|██▊       | 3446/12375 [16:15:50<38:19:08, 15.45s/it] 28%|██▊       | 3447/12375 [16:16:08<40:07:55, 16.18s/it] 28%|██▊       | 3448/12375 [16:16:20<37:19:42, 15.05s/it] 28%|██▊       | 3449/12375 [16:16:33<35:49:11, 14.45s/it] 28%|██▊       | 3450/12375 [16:16:45<34:13:01, 13.80s/it]                                                           28%|██▊       | 3450/12375 [16:16:45<34:13:01, 13.80s/it] 28%|██▊       | 3451/12375 [16:17:01<35:43:20, 14.41s/it] 28%|██▊       | 3452/12375 [16:17:14<34:19:32, 13.85s/it] 28%|██▊       | 3453/12375 [16:17:33<38:28:42, 15.53s/it] 28%|██▊       | 3454/12375 [16:17:45<35:50:38, 14.46s/it] 28%|██▊       | 3455/12375 [16:18:03<38:31:29, 15.55s/it] 28%|██▊       | 3456/12375 [16:18:20<39:22:47, 15.90s/it] 28%|██▊       | 3457/12375 [16:18:34<38:20:51, 15.48s/it] 28%|██▊       | 3458/12375 [16:18:54<41:21:07, 16.69s/it] 28%|██▊       | 3459/12375 [16:19:07<38:20:26, 15.48s/it] 28%|██▊       | 3460/12375 [16:19:19<35:57:22, 14.52s/it]                                                           28%|██▊       | 3460/12375 [16:19:19<35:57:22, 14.52s/it] 28%|██▊       | 3461/12375 [16:19:39<39:47:02, 16.07s/it] 28%|██▊       | 3462/12375 [16:19:57<41:49:39, 16.89s/it] 28%|██▊       | 3463/12375 [16:20:12<40:05:55, 16.20s/it] 28%|██▊       | 3464/12375 [16:20:27<39:12:21, 15.84s/it] 28%|██▊       | 3465/12375 [16:20:40<37:18:13, 15.07s/it] 28%|██▊       | 3466/12375 [16:20:56<37:59:40, 15.35s/it] 28%|██▊       | 3467/12375 [16:21:15<40:09:08, 16.23s/it] 28%|██▊       | 3468/12375 [16:21:33<41:53:30, 16.93s/it] 28%|██▊       | 3469/12375 [16:21:51<42:27:28, 17.16s/it] 28%|██▊       | 3470/12375 [16:22:08<42:40:10, 17.25s/it]                                                           28%|██▊       | 3470/12375 [16:22:08<42:40:10, 17.25s/it] 28%|██▊       | 3471/12375 [16:22:31<46:26:19, 18.78s/it] 28%|██▊       | 3472/12375 [16:22:46<43:40:27, 17.66s/it] 28%|██▊       | 3473/12375 [16:23:00<41:13:52, 16.67s/it] 28%|██▊       | 3474/12375 [16:23:14<39:33:17, 16.00s/it] 28%|██▊       | 3475/12375 [16:23:30<39:24:07, 15.94s/it] 28%|██▊       | 3476/12375 [16:23:47<40:18:49, 16.31s/it] 28%|██▊       | 3477/12375 [16:24:03<39:46:41, 16.09s/it] 28%|██▊       | 3478/12375 [16:24:20<40:14:53, 16.29s/it] 28%|██▊       | 3479/12375 [16:24:33<37:50:15, 15.31s/it] 28%|██▊       | 3480/12375 [16:24:46<35:53:58, 14.53s/it]                                                           28%|██▊       | 3480/12375 [16:24:46<35:53:58, 14.53s/it] 28%|██▊       | 3481/12375 [16:25:02<37:15:03, 15.08s/it] 28%|██▊       | 3482/12375 [16:25:16<36:31:44, 14.79s/it] 28%|██▊       | 3483/12375 [16:25:36<40:33:15, 16.42s/it] 28%|██▊       | 3484/12375 [16:25:49<37:36:12, 15.23s/it] 28%|██▊       | 3485/12375 [16:26:02<35:58:06, 14.57s/it] 28%|██▊       | 3486/12375 [16:26:19<38:10:00, 15.46s/it] 28%|██▊       | 3487/12375 [16:26:32<36:30:31, 14.79s/it] 28%|██▊       | 3488/12375 [16:26:49<37:31:32, 15.20s/it] 28%|██▊       | 3489/12375 [16:27:09<41:40:58, 16.89s/it] 28%|██▊       | 3490/12375 [16:27:23<39:34:52, 16.04s/it]                                                           28%|██▊       | 3490/12375 [16:27:23<39:34:52, 16.04s/it] 28%|██▊       | 3491/12375 [16:27:40<39:55:52, 16.18s/it] 28%|██▊       | 3492/12375 [16:27:55<38:44:49, 15.70s/it] 28%|██▊       | 3493/12375 [16:28:10<38:21:59, 15.55s/it] 28%|██▊       | 3494/12375 [16:28:25<37:58:46, 15.40s/it] 28%|██▊       | 3495/12375 [16:28:47<42:46:24, 17.34s/it] 28%|██▊       | 3496/12375 [16:29:04<42:28:35, 17.22s/it] 28%|██▊       | 3497/12375 [16:29:23<43:45:58, 17.75s/it] 28%|██▊       | 3498/12375 [16:29:38<42:09:28, 17.10s/it] 28%|██▊       | 3499/12375 [16:29:55<41:43:39, 16.92s/it] 28%|██▊       | 3500/12375 [16:30:10<40:08:08, 16.28s/it]                                                           28%|██▊       | 3500/12375 [16:30:10<40:08:08, 16.28s/it][INFO|trainer.py:3719] 2024-05-28 02:21:44,080 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-28 02:21:44,080 >>   Num examples = 5000
[INFO|trainer.py:3724] 2024-05-28 02:21:44,080 >>   Batch size = 32
{'eval_loss': 1.0798273086547852, 'eval_runtime': 560.5058, 'eval_samples_per_second': 8.921, 'eval_steps_per_second': 0.28, 'epoch': 0.24}
{'loss': 1.0605, 'grad_norm': 1.8782775402069092, 'learning_rate': 8.610843761757202e-05, 'epoch': 0.24}
{'loss': 1.0892, 'grad_norm': 1.7250518798828125, 'learning_rate': 8.60205189160869e-05, 'epoch': 0.24}
{'loss': 1.0542, 'grad_norm': 1.7630610466003418, 'learning_rate': 8.593236806599542e-05, 'epoch': 0.24}
{'loss': 1.012, 'grad_norm': 1.9232866764068604, 'learning_rate': 8.58439856354209e-05, 'epoch': 0.25}
{'loss': 1.0316, 'grad_norm': 1.614912986755371, 'learning_rate': 8.575537219397914e-05, 'epoch': 0.25}
{'loss': 1.1021, 'grad_norm': 1.8985605239868164, 'learning_rate': 8.566652831277482e-05, 'epoch': 0.25}
{'loss': 1.088, 'grad_norm': 1.5579497814178467, 'learning_rate': 8.557745456439783e-05, 'epoch': 0.25}
{'loss': 1.0965, 'grad_norm': 1.6172343492507935, 'learning_rate': 8.548815152291945e-05, 'epoch': 0.25}
{'loss': 1.1241, 'grad_norm': 1.7815817594528198, 'learning_rate': 8.539861976388875e-05, 'epoch': 0.25}
{'loss': 1.0771, 'grad_norm': 1.6411656141281128, 'learning_rate': 8.53088598643289e-05, 'epoch': 0.25}
{'loss': 1.0352, 'grad_norm': 1.5718610286712646, 'learning_rate': 8.52188724027334e-05, 'epoch': 0.25}
{'loss': 1.0681, 'grad_norm': 1.6477357149124146, 'learning_rate': 8.51286579590623e-05, 'epoch': 0.25}
{'loss': 1.0135, 'grad_norm': 1.7385344505310059, 'learning_rate': 8.503821711473863e-05, 'epoch': 0.25}
{'loss': 1.0811, 'grad_norm': 1.8682187795639038, 'learning_rate': 8.494755045264447e-05, 'epoch': 0.25}
{'loss': 1.0382, 'grad_norm': 1.6158558130264282, 'learning_rate': 8.48566585571173e-05, 'epoch': 0.25}
{'loss': 1.1023, 'grad_norm': 1.6067578792572021, 'learning_rate': 8.476554201394622e-05, 'epoch': 0.26}
{'loss': 1.0607, 'grad_norm': 1.727827787399292, 'learning_rate': 8.467420141036813e-05, 'epoch': 0.26}
{'loss': 1.1075, 'grad_norm': 1.7643622159957886, 'learning_rate': 8.458263733506402e-05, 'epoch': 0.26}
{'loss': 1.0553, 'grad_norm': 1.8279489278793335, 'learning_rate': 8.449085037815507e-05, 'epoch': 0.26}
{'loss': 1.1052, 'grad_norm': 1.7357776165008545, 'learning_rate': 8.439884113119898e-05, 'epoch': 0.26}
{'loss': 1.0685, 'grad_norm': 1.765734076499939, 'learning_rate': 8.430661018718606e-05, 'epoch': 0.26}
{'loss': 1.0915, 'grad_norm': 2.1077964305877686, 'learning_rate': 8.421415814053539e-05, 'epoch': 0.26}
{'loss': 1.0805, 'grad_norm': 1.8655420541763306, 'learning_rate': 8.41214855870911e-05, 'epoch': 0.26}
{'loss': 1.1032, 'grad_norm': 1.6076101064682007, 'learning_rate': 8.402859312411843e-05, 'epoch': 0.26}
{'loss': 1.064, 'grad_norm': 1.5933839082717896, 'learning_rate': 8.393548135029991e-05, 'epoch': 0.26}
{'loss': 1.0343, 'grad_norm': 1.5790590047836304, 'learning_rate': 8.384215086573157e-05, 'epoch': 0.26}
{'loss': 1.0388, 'grad_norm': 2.4302902221679688, 'learning_rate': 8.374860227191889e-05, 'epoch': 0.26}
{'loss': 1.059, 'grad_norm': 1.5516060590744019, 'learning_rate': 8.365483617177315e-05, 'epoch': 0.27}
{'loss': 1.0876, 'grad_norm': 1.6459659337997437, 'learning_rate': 8.356085316960738e-05, 'epoch': 0.27}
{'loss': 1.039, 'grad_norm': 1.6146271228790283, 'learning_rate': 8.346665387113252e-05, 'epoch': 0.27}
{'loss': 1.1082, 'grad_norm': 1.924034595489502, 'learning_rate': 8.337223888345357e-05, 'epoch': 0.27}
{'loss': 1.0765, 'grad_norm': 1.7424129247665405, 'learning_rate': 8.327760881506559e-05, 'epoch': 0.27}
{'loss': 1.0143, 'grad_norm': 1.522999882698059, 'learning_rate': 8.318276427584978e-05, 'epoch': 0.27}
{'loss': 1.0897, 'grad_norm': 1.9220249652862549, 'learning_rate': 8.308770587706963e-05, 'epoch': 0.27}
{'loss': 1.0658, 'grad_norm': 1.676812767982483, 'learning_rate': 8.299243423136694e-05, 'epoch': 0.27}
{'loss': 1.0501, 'grad_norm': 1.6208724975585938, 'learning_rate': 8.289694995275781e-05, 'epoch': 0.27}
{'loss': 1.1166, 'grad_norm': 1.440873146057129, 'learning_rate': 8.280125365662879e-05, 'epoch': 0.27}
{'loss': 1.1085, 'grad_norm': 1.972933292388916, 'learning_rate': 8.270534595973285e-05, 'epoch': 0.27}
{'loss': 1.1018, 'grad_norm': 1.7933259010314941, 'learning_rate': 8.260922748018539e-05, 'epoch': 0.27}
{'loss': 1.0917, 'grad_norm': 1.5143190622329712, 'learning_rate': 8.251289883746031e-05, 'epoch': 0.27}
{'loss': 1.0211, 'grad_norm': 1.6439193487167358, 'learning_rate': 8.241636065238601e-05, 'epoch': 0.28}
{'loss': 1.0477, 'grad_norm': 1.7020020484924316, 'learning_rate': 8.231961354714131e-05, 'epoch': 0.28}
{'loss': 1.1001, 'grad_norm': 1.6615099906921387, 'learning_rate': 8.222265814525155e-05, 'epoch': 0.28}
{'loss': 0.9904, 'grad_norm': 2.0875542163848877, 'learning_rate': 8.21254950715845e-05, 'epoch': 0.28}
{'loss': 1.0354, 'grad_norm': 1.6655962467193604, 'learning_rate': 8.202812495234633e-05, 'epoch': 0.28}
{'loss': 1.0482, 'grad_norm': 1.9381484985351562, 'learning_rate': 8.193054841507766e-05, 'epoch': 0.28}
{'loss': 1.1085, 'grad_norm': 1.6695016622543335, 'learning_rate': 8.18327660886494e-05, 'epoch': 0.28}
{'loss': 1.0388, 'grad_norm': 1.8883671760559082, 'learning_rate': 8.173477860325876e-05, 'epoch': 0.28}
{'loss': 1.0723, 'grad_norm': 1.7935799360275269, 'learning_rate': 8.163658659042522e-05, 'epoch': 0.28}
{'loss': 1.0854, 'grad_norm': 1.5320918560028076, 'learning_rate': 8.153819068298635e-05, 'epoch': 0.28}

  0%|          | 0/157 [00:00<?, ?it/s][A
  1%|▏         | 2/157 [00:02<03:51,  1.49s/it][A
  2%|▏         | 3/157 [00:05<05:09,  2.01s/it][A
  3%|▎         | 4/157 [00:09<06:44,  2.64s/it][A
  3%|▎         | 5/157 [00:14<08:26,  3.33s/it][A
  4%|▍         | 6/157 [00:17<08:46,  3.49s/it][A
  4%|▍         | 7/157 [00:21<08:41,  3.48s/it][A
  5%|▌         | 8/157 [00:25<09:16,  3.73s/it][A
  6%|▌         | 9/157 [00:28<08:19,  3.38s/it][A
  6%|▋         | 10/157 [00:31<08:19,  3.40s/it][A
  7%|▋         | 11/157 [00:33<07:29,  3.08s/it][A
  8%|▊         | 12/157 [00:36<07:10,  2.97s/it][A
  8%|▊         | 13/157 [00:39<07:07,  2.97s/it][A
  9%|▉         | 14/157 [00:43<07:32,  3.17s/it][A
 10%|▉         | 15/157 [00:46<07:50,  3.31s/it][A
 10%|█         | 16/157 [00:51<08:19,  3.54s/it][A
 11%|█         | 17/157 [00:53<07:45,  3.33s/it][A
 11%|█▏        | 18/157 [00:56<07:12,  3.11s/it][A
 12%|█▏        | 19/157 [01:00<07:52,  3.42s/it][A
 13%|█▎        | 20/157 [01:04<07:52,  3.45s/it][A
 13%|█▎        | 21/157 [01:07<07:47,  3.44s/it][A
 14%|█▍        | 22/157 [01:10<07:25,  3.30s/it][A
 15%|█▍        | 23/157 [01:13<07:11,  3.22s/it][A
 15%|█▌        | 24/157 [01:17<07:33,  3.41s/it][A
 16%|█▌        | 25/157 [01:20<07:30,  3.41s/it][A
 17%|█▋        | 26/157 [01:24<07:26,  3.41s/it][A
 17%|█▋        | 27/157 [01:29<08:32,  3.94s/it][A
 18%|█▊        | 28/157 [01:33<08:27,  3.93s/it][A
 18%|█▊        | 29/157 [01:36<07:42,  3.62s/it][A
 19%|█▉        | 30/157 [01:39<07:11,  3.39s/it][A
 20%|█▉        | 31/157 [01:42<07:19,  3.49s/it][A
 20%|██        | 32/157 [01:46<07:18,  3.51s/it][A
 21%|██        | 33/157 [01:50<07:38,  3.70s/it][A
 22%|██▏       | 34/157 [01:54<07:47,  3.80s/it][A
 22%|██▏       | 35/157 [01:58<07:33,  3.71s/it][A
 23%|██▎       | 36/157 [02:02<07:59,  3.96s/it][A
 24%|██▎       | 37/157 [02:06<07:46,  3.89s/it][A
 24%|██▍       | 38/157 [02:09<07:33,  3.81s/it][A
 25%|██▍       | 39/157 [02:13<07:13,  3.67s/it][A
 25%|██▌       | 40/157 [02:15<06:36,  3.38s/it][A
 26%|██▌       | 41/157 [02:19<06:49,  3.53s/it][A
 27%|██▋       | 42/157 [02:25<07:44,  4.04s/it][A
 27%|██▋       | 43/157 [02:27<06:55,  3.65s/it][A
 28%|██▊       | 44/157 [02:31<06:59,  3.71s/it][A
 29%|██▊       | 45/157 [02:34<06:35,  3.53s/it][A
 29%|██▉       | 46/157 [02:37<06:06,  3.30s/it][A
 30%|██▉       | 47/157 [02:40<05:58,  3.26s/it][A
 31%|███       | 48/157 [02:47<07:53,  4.34s/it][A
 31%|███       | 49/157 [02:50<06:56,  3.86s/it][A
 32%|███▏      | 50/157 [02:53<06:27,  3.63s/it][A
 32%|███▏      | 51/157 [02:57<06:31,  3.70s/it][A
 33%|███▎      | 52/157 [03:01<06:35,  3.77s/it][A
 34%|███▍      | 53/157 [03:05<06:59,  4.04s/it][A
 34%|███▍      | 54/157 [03:09<06:36,  3.85s/it][A
 35%|███▌      | 55/157 [03:13<06:48,  4.00s/it][A
 36%|███▌      | 56/157 [03:17<06:50,  4.07s/it][A
 36%|███▋      | 57/157 [03:21<06:46,  4.07s/it][A
 37%|███▋      | 58/157 [03:25<06:26,  3.90s/it][A
 38%|███▊      | 59/157 [03:30<06:49,  4.18s/it][A
 38%|███▊      | 60/157 [03:34<06:40,  4.13s/it][A
 39%|███▉      | 61/157 [03:37<06:20,  3.96s/it][A
 39%|███▉      | 62/157 [03:42<06:38,  4.19s/it][A
 40%|████      | 63/157 [03:45<06:12,  3.96s/it][A
 41%|████      | 64/157 [03:50<06:20,  4.09s/it][A
 41%|████▏     | 65/157 [03:55<06:32,  4.26s/it][A
 42%|████▏     | 66/157 [03:57<05:41,  3.75s/it][A
 43%|████▎     | 67/157 [04:02<06:11,  4.13s/it][A
 43%|████▎     | 68/157 [04:05<05:26,  3.66s/it][A
 44%|████▍     | 69/157 [04:08<05:01,  3.43s/it][A
 45%|████▍     | 70/157 [04:12<05:22,  3.71s/it][A
 45%|████▌     | 71/157 [04:15<05:10,  3.61s/it][A
 46%|████▌     | 72/157 [04:18<04:48,  3.39s/it][A
 46%|████▋     | 73/157 [04:21<04:22,  3.12s/it][A
 47%|████▋     | 74/157 [04:25<04:41,  3.39s/it][A
 48%|████▊     | 75/157 [04:29<04:55,  3.60s/it][A
 48%|████▊     | 76/157 [04:33<05:02,  3.74s/it][A
 49%|████▉     | 77/157 [04:36<04:56,  3.70s/it][A
 50%|████▉     | 78/157 [04:39<04:30,  3.42s/it][A
 50%|█████     | 79/157 [04:44<04:58,  3.83s/it][A
 51%|█████     | 80/157 [04:47<04:29,  3.50s/it][A
 52%|█████▏    | 81/157 [04:49<04:04,  3.22s/it][A
 52%|█████▏    | 82/157 [04:52<04:00,  3.21s/it][A
 53%|█████▎    | 83/157 [04:56<04:15,  3.45s/it][A
 54%|█████▎    | 84/157 [05:01<04:27,  3.66s/it][A
 54%|█████▍    | 85/157 [05:05<04:29,  3.75s/it][A
 55%|█████▍    | 86/157 [05:09<04:44,  4.01s/it][A
 55%|█████▌    | 87/157 [05:13<04:34,  3.92s/it][A
 56%|█████▌    | 88/157 [05:16<04:22,  3.81s/it][A
 57%|█████▋    | 89/157 [05:20<04:08,  3.66s/it][A
 57%|█████▋    | 90/157 [05:24<04:12,  3.77s/it][A
 58%|█████▊    | 91/157 [05:27<04:05,  3.72s/it][A
 59%|█████▊    | 92/157 [05:30<03:46,  3.49s/it][A
 59%|█████▉    | 93/157 [05:35<04:14,  3.97s/it][A
 60%|█████▉    | 94/157 [05:39<03:53,  3.71s/it][A
 61%|██████    | 95/157 [05:42<03:43,  3.60s/it][A
 61%|██████    | 96/157 [05:45<03:31,  3.47s/it][A
 62%|██████▏   | 97/157 [05:48<03:22,  3.37s/it][A
 62%|██████▏   | 98/157 [05:51<03:02,  3.09s/it][A
 63%|██████▎   | 99/157 [05:55<03:16,  3.38s/it][A
 64%|██████▎   | 100/157 [05:58<03:06,  3.27s/it][A
 64%|██████▍   | 101/157 [06:00<02:54,  3.12s/it][A
 65%|██████▍   | 102/157 [06:03<02:48,  3.07s/it][A
 66%|██████▌   | 103/157 [06:06<02:36,  2.89s/it][A
 66%|██████▌   | 104/157 [06:10<02:54,  3.30s/it][A
 67%|██████▋   | 105/157 [06:14<03:03,  3.53s/it][A
 68%|██████▊   | 106/157 [06:19<03:16,  3.85s/it][A
 68%|██████▊   | 107/157 [06:23<03:20,  4.02s/it][A
 69%|██████▉   | 108/157 [06:27<03:14,  3.97s/it][A
 69%|██████▉   | 109/157 [06:31<03:04,  3.85s/it][A
 70%|███████   | 110/157 [06:35<03:01,  3.87s/it][A
 71%|███████   | 111/157 [06:38<02:50,  3.70s/it][A
 71%|███████▏  | 112/157 [06:41<02:36,  3.47s/it][A
 72%|███████▏  | 113/157 [06:44<02:29,  3.41s/it][A
 73%|███████▎  | 114/157 [06:48<02:28,  3.45s/it][A
 73%|███████▎  | 115/157 [06:52<02:34,  3.68s/it][A
 74%|███████▍  | 116/157 [06:57<02:51,  4.18s/it][A
 75%|███████▍  | 117/157 [07:00<02:31,  3.79s/it][A
 75%|███████▌  | 118/157 [07:03<02:16,  3.50s/it][A
 76%|███████▌  | 119/157 [07:07<02:14,  3.55s/it][A
 76%|███████▋  | 120/157 [07:09<02:02,  3.30s/it][A
 77%|███████▋  | 121/157 [07:12<01:54,  3.19s/it][A
 78%|███████▊  | 122/157 [07:16<01:56,  3.33s/it][A
 78%|███████▊  | 123/157 [07:20<01:57,  3.47s/it][A
 79%|███████▉  | 124/157 [07:23<01:55,  3.50s/it][A
 80%|███████▉  | 125/157 [07:26<01:45,  3.30s/it][A
 80%|████████  | 126/157 [07:30<01:47,  3.47s/it][A
 81%|████████  | 127/157 [07:33<01:37,  3.26s/it][A
 82%|████████▏ | 128/157 [07:35<01:29,  3.09s/it][A
 82%|████████▏ | 129/157 [07:38<01:22,  2.94s/it][A
 83%|████████▎ | 130/157 [07:42<01:27,  3.24s/it][A
 83%|████████▎ | 131/157 [07:45<01:25,  3.30s/it][A
 84%|████████▍ | 132/157 [07:50<01:29,  3.60s/it][A
 85%|████████▍ | 133/157 [07:53<01:21,  3.41s/it][A
 85%|████████▌ | 134/157 [07:56<01:17,  3.38s/it][A
 86%|████████▌ | 135/157 [08:00<01:17,  3.50s/it][A
 87%|████████▋ | 136/157 [08:03<01:09,  3.32s/it][A
 87%|████████▋ | 137/157 [08:07<01:11,  3.59s/it][A
 88%|████████▊ | 138/157 [08:10<01:05,  3.45s/it][A
 89%|████████▊ | 139/157 [08:14<01:05,  3.64s/it][A
 89%|████████▉ | 140/157 [08:18<01:00,  3.58s/it][A
 90%|████████▉ | 141/157 [08:21<00:55,  3.45s/it][A
 90%|█████████ | 142/157 [08:25<00:54,  3.63s/it][A
 91%|█████████ | 143/157 [08:29<00:55,  3.96s/it][A
 92%|█████████▏| 144/157 [08:33<00:49,  3.84s/it][A
 92%|█████████▏| 145/157 [08:37<00:48,  4.00s/it][A
 93%|█████████▎| 146/157 [08:41<00:43,  3.91s/it][A
 94%|█████████▎| 147/157 [08:46<00:42,  4.26s/it][A
 94%|█████████▍| 148/157 [08:49<00:35,  3.90s/it][A
 95%|█████████▍| 149/157 [08:53<00:31,  3.94s/it][A
 96%|█████████▌| 150/157 [08:56<00:25,  3.69s/it][A
 96%|█████████▌| 151/157 [09:00<00:21,  3.62s/it][A
 97%|█████████▋| 152/157 [09:03<00:17,  3.47s/it][A
 97%|█████████▋| 153/157 [09:05<00:12,  3.17s/it][A
 98%|█████████▊| 154/157 [09:09<00:09,  3.27s/it][A
 99%|█████████▊| 155/157 [09:11<00:05,  3.00s/it][A
 99%|█████████▉| 156/157 [09:15<00:03,  3.32s/it][A
100%|██████████| 157/157 [09:16<00:00,  2.51s/it][A                                                          
                                                 [A 28%|██▊       | 3500/12375 [16:39:29<40:08:08, 16.28s/it]
100%|██████████| 157/157 [09:16<00:00,  2.51s/it][A
                                                 [A[INFO|trainer.py:3410] 2024-05-28 02:31:03,879 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3500
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-28 02:31:04,049 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-28 02:31:04,049 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_continue/checkpoint-3500/special_tokens_map.json
 28%|██▊       | 3501/12375 [16:39:51<458:04:43, 185.83s/it] 28%|██▊       | 3502/12375 [16:40:03<329:28:46, 133.68s/it] 28%|██▊       | 3503/12375 [16:40:19<242:27:47, 98.38s/it]  28%|██▊       | 3504/12375 [16:40:36<182:11:07, 73.93s/it] 28%|██▊       | 3505/12375 [16:40:54<141:01:53, 57.24s/it] 28%|██▊       | 3506/12375 [16:41:09<109:54:18, 44.61s/it] 28%|██▊       | 3507/12375 [16:41:23<87:09:10, 35.38s/it]  28%|██▊       | 3508/12375 [16:41:38<71:41:20, 29.11s/it] 28%|██▊       | 3509/12375 [16:41:59<66:18:17, 26.92s/it] 28%|██▊       | 3510/12375 [16:42:17<59:32:25, 24.18s/it]                                                           28%|██▊       | 3510/12375 [16:42:17<59:32:25, 24.18s/it] 28%|██▊       | 3511/12375 [16:42:37<56:14:50, 22.84s/it] 28%|██▊       | 3512/12375 [16:43:04<59:25:19, 24.14s/it] 28%|██▊       | 3513/12375 [16:43:19<52:35:57, 21.37s/it] 28%|██▊       | 3514/12375 [16:43:33<47:14:40, 19.19s/it] 28%|██▊       | 3515/12375 [16:43:45<41:39:18, 16.93s/it] 28%|██▊       | 3516/12375 [16:43:59<39:36:23, 16.09s/it] 28%|██▊       | 3517/12375 [16:44:17<41:11:35, 16.74s/it] 28%|██▊       | 3518/12375 [16:44:33<40:52:47, 16.62s/it] 28%|██▊       | 3519/12375 [16:44:49<39:58:29, 16.25s/it] 28%|██▊       | 3520/12375 [16:45:01<36:41:23, 14.92s/it]                                                           28%|██▊       | 3520/12375 [16:45:01<36:41:23, 14.92s/it] 28%|██▊       | 3521/12375 [16:45:13<35:03:37, 14.26s/it] 28%|██▊       | 3522/12375 [16:45:28<34:57:53, 14.22s/it] 28%|██▊       | 3523/12375 [16:45:43<35:46:07, 14.55s/it] 28%|██▊       | 3524/12375 [16:45:58<36:10:28, 14.71s/it] 28%|██▊       | 3525/12375 [16:46:16<38:58:19, 15.85s/it] 28%|██▊       | 3526/12375 [16:46:36<42:03:13, 17.11s/it] 29%|██▊       | 3527/12375 [16:46:49<38:20:48, 15.60s/it] 29%|██▊       | 3528/12375 [16:47:05<38:43:51, 15.76s/it] 29%|██▊       | 3529/12375 [16:47:23<40:46:40, 16.60s/it] 29%|██▊       | 3530/12375 [16:47:45<44:24:46, 18.08s/it]                                                           29%|██▊       | 3530/12375 [16:47:45<44:24:46, 18.08s/it] 29%|██▊       | 3531/12375 [16:48:05<45:53:44, 18.68s/it] 29%|██▊       | 3532/12375 [16:48:25<47:11:04, 19.21s/it] 29%|██▊       | 3533/12375 [16:48:36<41:15:27, 16.80s/it] 29%|██▊       | 3534/12375 [16:48:52<40:04:07, 16.32s/it] 29%|██▊       | 3535/12375 [16:49:04<37:26:21, 15.25s/it] 29%|██▊       | 3536/12375 [16:49:19<37:15:12, 15.17s/it] 29%|██▊       | 3537/12375 [16:49:34<36:49:44, 15.00s/it] 29%|██▊       | 3538/12375 [16:49:47<34:59:19, 14.25s/it] 29%|██▊       | 3539/12375 [16:50:06<38:55:15, 15.86s/it] 29%|██▊       | 3540/12375 [16:50:22<38:42:07, 15.77s/it]                                                           29%|██▊       | 3540/12375 [16:50:22<38:42:07, 15.77s/it] 29%|██▊       | 3541/12375 [16:50:36<37:27:50, 15.27s/it] 29%|██▊       | 3542/12375 [16:50:54<39:47:14, 16.22s/it] 29%|██▊       | 3543/12375 [16:51:12<41:17:48, 16.83s/it] 29%|██▊       | 3544/12375 [16:51:31<42:39:55, 17.39s/it] 29%|██▊       | 3545/12375 [16:51:47<41:44:56, 17.02s/it] 29%|██▊       | 3546/12375 [16:52:04<41:08:22, 16.77s/it] 29%|██▊       | 3547/12375 [16:52:23<42:46:24, 17.44s/it] 29%|██▊       | 3548/12375 [16:52:35<38:59:01, 15.90s/it] 29%|██▊       | 3549/12375 [16:52:53<40:52:50, 16.67s/it] 29%|██▊       | 3550/12375 [16:53:11<41:48:56, 17.06s/it]                                                           29%|██▊       | 3550/12375 [16:53:11<41:48:56, 17.06s/it] 29%|██▊       | 3551/12375 [16:53:26<40:05:58, 16.36s/it] 29%|██▊       | 3552/12375 [16:53:38<37:10:40, 15.17s/it] 29%|██▊       | 3553/12375 [16:53:51<35:06:26, 14.33s/it] 29%|██▊       | 3554/12375 [16:54:08<37:04:53, 15.13s/it] 29%|██▊       | 3555/12375 [16:54:29<41:21:52, 16.88s/it] 29%|██▊       | 3556/12375 [16:54:45<40:41:42, 16.61s/it] 29%|██▊       | 3557/12375 [16:55:01<40:17:46, 16.45s/it] 29%|██▉       | 3558/12375 [16:55:14<38:08:10, 15.57s/it] 29%|██▉       | 3559/12375 [16:55:31<38:50:24, 15.86s/it] 29%|██▉       | 3560/12375 [16:55:49<40:32:17, 16.56s/it]                                                           29%|██▉       | 3560/12375 [16:55:49<40:32:17, 16.56s/it] 29%|██▉       | 3561/12375 [16:56:04<39:41:32, 16.21s/it] 29%|██▉       | 3562/12375 [16:56:28<44:52:15, 18.33s/it] 29%|██▉       | 3563/12375 [16:56:57<52:51:09, 21.59s/it]{'eval_loss': 1.0666911602020264, 'eval_runtime': 559.7988, 'eval_samples_per_second': 8.932, 'eval_steps_per_second': 0.28, 'epoch': 0.28}
{'loss': 1.0593, 'grad_norm': 1.7793872356414795, 'learning_rate': 8.143959151509385e-05, 'epoch': 0.28}
{'loss': 1.0576, 'grad_norm': 1.5910707712173462, 'learning_rate': 8.13407897222094e-05, 'epoch': 0.28}
{'loss': 1.0696, 'grad_norm': 1.5921361446380615, 'learning_rate': 8.124178594110056e-05, 'epoch': 0.29}
{'loss': 0.9897, 'grad_norm': 1.40016508102417, 'learning_rate': 8.114258080983674e-05, 'epoch': 0.29}
{'loss': 1.082, 'grad_norm': 1.5480087995529175, 'learning_rate': 8.104317496778495e-05, 'epoch': 0.29}
{'loss': 1.0615, 'grad_norm': 1.6646777391433716, 'learning_rate': 8.094356905560583e-05, 'epoch': 0.29}
Traceback (most recent call last):
  File "/home/xiaoyukou/anaconda3/envs/py3.10/bin/llamafactory-cli", line 8, in <module>
    sys.exit(main())
  File "/data/xiaoyukou/LLaMA-Factory/src/llamafactory/cli.py", line 65, in main
    run_exp()
  File "/data/xiaoyukou/LLaMA-Factory/src/llamafactory/train/tuner.py", line 34, in run_exp
    run_sft(model_args, data_args, training_args, finetuning_args, generating_args, callbacks)
  File "/data/xiaoyukou/LLaMA-Factory/src/llamafactory/train/sft/workflow.py", line 73, in run_sft
    train_result = trainer.train(resume_from_checkpoint=training_args.resume_from_checkpoint)
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/transformers/trainer.py", line 1885, in train
    return inner_training_loop(
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/transformers/trainer.py", line 2216, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/transformers/trainer.py", line 3250, in training_step
    self.accelerator.backward(loss)
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/accelerate/accelerator.py", line 2011, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/autograd/function.py", line 301, in apply
    return user_fn(self, *args)
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 320, in backward
    torch.autograd.backward(outputs_with_grad, args_with_grad)
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.93 GiB. GPU 
 29%|██▉       | 3563/12375 [16:57:04<41:55:24, 17.13s/it]
