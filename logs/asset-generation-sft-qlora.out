nohup: ignoring input
[2024-05-26 14:50:25,455] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
05/26/2024 14:50:26 - WARNING - llamafactory.hparams.parser - We recommend enable `upcast_layernorm` in quantized training.
05/26/2024 14:50:26 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: torch.float16
[INFO|tokenization_utils_base.py:2106] 2024-05-26 14:50:26,862 >> loading file tokenizer.model
[INFO|tokenization_utils_base.py:2106] 2024-05-26 14:50:26,862 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2106] 2024-05-26 14:50:26,862 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2106] 2024-05-26 14:50:26,862 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2106] 2024-05-26 14:50:26,862 >> loading file tokenizer_config.json
05/26/2024 14:50:26 - INFO - llamafactory.data.template - Add pad token: </s>
05/26/2024 14:50:26 - INFO - llamafactory.data.loader - Loading dataset AssetGeneration/train.json...
Converting format of dataset (num_proc=16):   0%|          | 0/50000 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  12%|█▎        | 6250/50000 [00:00<00:01, 35201.53 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 21875/50000 [00:00<00:00, 80299.46 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 50000/50000 [00:00<00:00, 122890.99 examples/s]
Running tokenizer on dataset (num_proc=16):   0%|          | 0/50000 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   2%|▏         | 1000/50000 [00:00<00:27, 1795.72 examples/s]Running tokenizer on dataset (num_proc=16):  14%|█▍        | 7000/50000 [00:00<00:03, 13450.80 examples/s]Running tokenizer on dataset (num_proc=16):  26%|██▌       | 13000/50000 [00:00<00:01, 23332.28 examples/s]Running tokenizer on dataset (num_proc=16):  36%|███▌      | 18000/50000 [00:01<00:01, 20476.61 examples/s]Running tokenizer on dataset (num_proc=16):  48%|████▊     | 24000/50000 [00:01<00:00, 27378.99 examples/s]Running tokenizer on dataset (num_proc=16):  60%|██████    | 30000/50000 [00:01<00:00, 33383.03 examples/s]Running tokenizer on dataset (num_proc=16):  70%|███████   | 35000/50000 [00:01<00:00, 26312.57 examples/s]Running tokenizer on dataset (num_proc=16):  81%|████████▏ | 40625/50000 [00:01<00:00, 30918.47 examples/s]Running tokenizer on dataset (num_proc=16):  96%|█████████▋| 48250/50000 [00:01<00:00, 39908.70 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 50000/50000 [00:02<00:00, 19841.71 examples/s]
[INFO|configuration_utils.py:731] 2024-05-26 14:50:30,659 >> loading configuration file /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2/config.json
[INFO|configuration_utils.py:796] 2024-05-26 14:50:30,661 >> Model config MistralConfig {
  "_name_or_path": "/data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2",
  "architectures": [
    "MistralForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 32768,
  "model_type": "mistral",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "rms_norm_eps": 1e-05,
  "rope_theta": 1000000.0,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.41.0.dev0",
  "use_cache": true,
  "vocab_size": 32000
}

input_ids:
[1, 28705, 733, 16289, 28793, 5919, 8270, 28705, 28750, 1964, 9655, 1081, 297, 8092, 3842, 28725, 2818, 356, 272, 2296, 1871, 28747, 13, 13, 17500, 5140, 28747, 4449, 1508, 2913, 383, 28709, 28723, 28768, 28720, 28748, 28169, 350, 380, 28748, 11178, 12141, 28748, 824, 28730, 1240, 1827, 28748, 28705, 13, 12075, 28747, 519, 383, 28709, 28723, 28768, 28720, 28705, 13, 9633, 28747, 7960, 22563, 1939, 4194, 973, 28705, 13, 15962, 13063, 28747, 1444, 28705, 28740, 28734, 298, 28705, 28750, 28734, 6128, 28723, 28705, 13, 17621, 454, 28747, 560, 4754, 2006, 380, 10616, 23247, 8561, 296, 298, 1038, 574, 616, 680, 8598, 298, 5709, 28723, 28705, 13, 733, 28748, 16289, 28793, 1964, 26856, 22345, 28747, 29506, 29056, 30163, 29535, 29011, 29078, 233, 178, 145, 236, 131, 180, 29250, 29056, 29494, 233, 139, 187, 29193, 29418, 30544, 28752, 13, 3261, 28747, 29506, 28751, 24318, 28747, 30913, 29209, 28993, 29056, 234, 178, 140, 28969, 233, 139, 187, 29193, 29257, 29270, 29572, 28752, 29494, 13, 2]
inputs:
<s>  [INST] Please generate 2 Ad Headline in Japanese language, based on the following information:

FinalUrl: https://suumo.jp/ikkodate/tokyo/sc_minato/ 
Domain: suumo.jp 
Category: Real Estate -- Portals 
CharacterLimit: between 10 to 20 characters. 
Insight: Incorporate dynamic keyword insertion to make your ad more relevant to query. 
 [/INST] Ad:{keyword:【新着物件を毎週更新】戸建情報}
Ad:【{Keyword:港区の新築一戸建てなら}】
</s>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 1964, 26856, 22345, 28747, 29506, 29056, 30163, 29535, 29011, 29078, 233, 178, 145, 236, 131, 180, 29250, 29056, 29494, 233, 139, 187, 29193, 29418, 30544, 28752, 13, 3261, 28747, 29506, 28751, 24318, 28747, 30913, 29209, 28993, 29056, 234, 178, 140, 28969, 233, 139, 187, 29193, 29257, 29270, 29572, 28752, 29494, 13, 2]
labels:
Ad:{keyword:【新着物件を毎週更新】戸建情報}
Ad:【{Keyword:港区の新築一戸建てなら}】
</s>
05/26/2024 14:50:30 - INFO - llamafactory.model.utils.quantization - Quantizing model to 4 bit.
[INFO|modeling_utils.py:3460] 2024-05-26 14:50:30,679 >> loading weights file /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2/model.safetensors.index.json
[INFO|modeling_utils.py:1508] 2024-05-26 14:50:30,679 >> Instantiating MistralForCausalLM model under default dtype torch.float16.
[INFO|configuration_utils.py:962] 2024-05-26 14:50:30,680 >> Generate config GenerationConfig {
  "bos_token_id": 1,
  "eos_token_id": 2
}

Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.39s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.34s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.35s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.35s/it]
[INFO|modeling_utils.py:4269] 2024-05-26 14:50:35,090 >> All model checkpoint weights were used when initializing MistralForCausalLM.

[INFO|modeling_utils.py:4277] 2024-05-26 14:50:35,090 >> All the weights of MistralForCausalLM were initialized from the model checkpoint at /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2.
If your task is similar to the task the model of the checkpoint was trained on, you can already use MistralForCausalLM for predictions without further training.
[INFO|configuration_utils.py:915] 2024-05-26 14:50:35,092 >> loading configuration file /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2/generation_config.json
[INFO|configuration_utils.py:962] 2024-05-26 14:50:35,092 >> Generate config GenerationConfig {
  "bos_token_id": 1,
  "eos_token_id": 2
}

05/26/2024 14:50:35 - INFO - llamafactory.model.utils.checkpointing - Gradient checkpointing enabled.
05/26/2024 14:50:35 - INFO - llamafactory.model.utils.attention - Using torch SDPA for faster training and inference.
05/26/2024 14:50:35 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
05/26/2024 14:50:35 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
05/26/2024 14:50:35 - INFO - llamafactory.model.loader - trainable params: 41943040 || all params: 7283675136 || trainable%: 0.5758
[INFO|trainer.py:641] 2024-05-26 14:50:35,755 >> Using auto half precision backend
[INFO|trainer.py:2078] 2024-05-26 14:50:35,940 >> ***** Running training *****
[INFO|trainer.py:2079] 2024-05-26 14:50:35,940 >>   Num examples = 49,500
[INFO|trainer.py:2080] 2024-05-26 14:50:35,940 >>   Num Epochs = 1
[INFO|trainer.py:2081] 2024-05-26 14:50:35,940 >>   Instantaneous batch size per device = 20
[INFO|trainer.py:2084] 2024-05-26 14:50:35,940 >>   Total train batch size (w. parallel, distributed & accumulation) = 40
[INFO|trainer.py:2085] 2024-05-26 14:50:35,940 >>   Gradient Accumulation steps = 2
[INFO|trainer.py:2086] 2024-05-26 14:50:35,940 >>   Total optimization steps = 1,237
[INFO|trainer.py:2087] 2024-05-26 14:50:35,943 >>   Number of trainable parameters = 41,943,040
  0%|          | 0/1237 [00:00<?, ?it/s]  0%|          | 1/1237 [00:14<4:56:41, 14.40s/it]  0%|          | 2/1237 [00:27<4:41:37, 13.68s/it]  0%|          | 3/1237 [00:48<5:49:25, 16.99s/it]  0%|          | 4/1237 [01:03<5:36:35, 16.38s/it]  0%|          | 5/1237 [01:17<5:18:26, 15.51s/it]  0%|          | 6/1237 [01:31<5:01:43, 14.71s/it]  1%|          | 7/1237 [01:42<4:37:10, 13.52s/it]  1%|          | 8/1237 [02:03<5:30:06, 16.12s/it]  1%|          | 9/1237 [02:21<5:36:56, 16.46s/it]  1%|          | 10/1237 [02:36<5:28:04, 16.04s/it]                                                     1%|          | 10/1237 [02:36<5:28:04, 16.04s/it]  1%|          | 11/1237 [02:50<5:16:12, 15.47s/it]  1%|          | 12/1237 [03:03<5:01:10, 14.75s/it]  1%|          | 13/1237 [03:21<5:24:20, 15.90s/it]  1%|          | 14/1237 [03:40<5:40:27, 16.70s/it]  1%|          | 15/1237 [03:55<5:30:58, 16.25s/it]  1%|▏         | 16/1237 [04:11<5:28:15, 16.13s/it]  1%|▏         | 17/1237 [04:26<5:20:29, 15.76s/it]  1%|▏         | 18/1237 [04:41<5:16:19, 15.57s/it]  2%|▏         | 19/1237 [04:55<5:06:14, 15.09s/it]  2%|▏         | 20/1237 [05:12<5:15:10, 15.54s/it]                                                     2%|▏         | 20/1237 [05:12<5:15:10, 15.54s/it]  2%|▏         | 21/1237 [05:28<5:16:56, 15.64s/it]  2%|▏         | 22/1237 [05:41<5:01:52, 14.91s/it]  2%|▏         | 23/1237 [05:57<5:08:59, 15.27s/it]  2%|▏         | 24/1237 [06:11<5:02:32, 14.97s/it]  2%|▏         | 25/1237 [06:24<4:50:31, 14.38s/it]  2%|▏         | 26/1237 [06:38<4:45:04, 14.12s/it]  2%|▏         | 27/1237 [06:51<4:38:18, 13.80s/it]  2%|▏         | 28/1237 [07:05<4:39:35, 13.88s/it]  2%|▏         | 29/1237 [07:23<5:03:40, 15.08s/it]  2%|▏         | 30/1237 [07:36<4:54:35, 14.64s/it]                                                     2%|▏         | 30/1237 [07:36<4:54:35, 14.64s/it]  3%|▎         | 31/1237 [07:49<4:45:05, 14.18s/it]  3%|▎         | 32/1237 [08:05<4:50:38, 14.47s/it]  3%|▎         | 33/1237 [08:26<5:30:07, 16.45s/it]  3%|▎         | 34/1237 [08:42<5:27:36, 16.34s/it]  3%|▎         | 35/1237 [08:55<5:08:15, 15.39s/it]  3%|▎         | 36/1237 [09:14<5:31:59, 16.59s/it]  3%|▎         | 37/1237 [09:31<5:32:13, 16.61s/it]  3%|▎         | 38/1237 [09:44<5:10:25, 15.53s/it]  3%|▎         | 39/1237 [10:02<5:25:22, 16.30s/it]  3%|▎         | 40/1237 [10:15<5:06:59, 15.39s/it]                                                     3%|▎         | 40/1237 [10:15<5:06:59, 15.39s/it]  3%|▎         | 41/1237 [10:29<4:56:32, 14.88s/it]  3%|▎         | 42/1237 [10:40<4:33:46, 13.75s/it]  3%|▎         | 43/1237 [10:56<4:49:13, 14.53s/it]  4%|▎         | 44/1237 [11:14<5:04:56, 15.34s/it]  4%|▎         | 45/1237 [11:27<4:50:40, 14.63s/it]  4%|▎         | 46/1237 [11:47<5:26:35, 16.45s/it]  4%|▍         | 47/1237 [12:01<5:09:22, 15.60s/it]  4%|▍         | 48/1237 [12:21<5:35:37, 16.94s/it]  4%|▍         | 49/1237 [12:35<5:20:26, 16.18s/it]  4%|▍         | 50/1237 [12:53<5:29:29, 16.66s/it]                                                     4%|▍         | 50/1237 [12:53<5:29:29, 16.66s/it]  4%|▍         | 51/1237 [13:10<5:29:00, 16.64s/it]  4%|▍         | 52/1237 [13:27<5:35:01, 16.96s/it]  4%|▍         | 53/1237 [13:40<5:11:15, 15.77s/it]  4%|▍         | 54/1237 [13:59<5:29:56, 16.73s/it]  4%|▍         | 55/1237 [14:22<6:03:55, 18.47s/it]  5%|▍         | 56/1237 [14:38<5:50:13, 17.79s/it]  5%|▍         | 57/1237 [14:53<5:32:17, 16.90s/it]  5%|▍         | 58/1237 [15:08<5:18:30, 16.21s/it]  5%|▍         | 59/1237 [15:24<5:19:55, 16.30s/it]  5%|▍         | 60/1237 [15:38<5:04:24, 15.52s/it]                                                     5%|▍         | 60/1237 [15:38<5:04:24, 15.52s/it]  5%|▍         | 61/1237 [15:53<5:02:35, 15.44s/it]  5%|▌         | 62/1237 [16:08<4:57:27, 15.19s/it]  5%|▌         | 63/1237 [16:25<5:09:48, 15.83s/it]  5%|▌         | 64/1237 [16:40<5:06:04, 15.66s/it]  5%|▌         | 65/1237 [16:55<4:59:45, 15.35s/it]  5%|▌         | 66/1237 [17:10<4:56:33, 15.20s/it]  5%|▌         | 67/1237 [17:22<4:36:33, 14.18s/it]  5%|▌         | 68/1237 [17:39<4:53:31, 15.07s/it]  6%|▌         | 69/1237 [17:50<4:33:53, 14.07s/it]  6%|▌         | 70/1237 [18:11<5:12:51, 16.09s/it]                                                     6%|▌         | 70/1237 [18:11<5:12:51, 16.09s/it]  6%|▌         | 71/1237 [18:26<5:07:25, 15.82s/it]  6%|▌         | 72/1237 [18:42<5:08:24, 15.88s/it]  6%|▌         | 73/1237 [18:56<4:55:14, 15.22s/it]  6%|▌         | 74/1237 [19:12<4:56:26, 15.29s/it]  6%|▌         | 75/1237 [19:30<5:13:47, 16.20s/it]  6%|▌         | 76/1237 [19:48<5:22:00, 16.64s/it]  6%|▌         | 77/1237 [20:06<5:34:16, 17.29s/it]  6%|▋         | 78/1237 [20:21<5:21:08, 16.62s/it]  6%|▋         | 79/1237 [20:37<5:16:56, 16.42s/it]  6%|▋         | 80/1237 [20:52<5:08:58, 16.02s/it]                                                     6%|▋         | 80/1237 [20:52<5:08:58, 16.02s/it]  7%|▋         | 81/1237 [21:09<5:14:03, 16.30s/it]  7%|▋         | 82/1237 [21:26<5:16:06, 16.42s/it]  7%|▋         | 83/1237 [21:44<5:22:06, 16.75s/it]  7%|▋         | 84/1237 [22:01<5:25:40, 16.95s/it]  7%|▋         | 85/1237 [22:17<5:17:44, 16.55s/it]  7%|▋         | 86/1237 [22:43<6:15:01, 19.55s/it]  7%|▋         | 87/1237 [22:59<5:53:05, 18.42s/it]  7%|▋         | 88/1237 [23:11<5:15:09, 16.46s/it]  7%|▋         | 89/1237 [23:33<5:48:05, 18.19s/it]  7%|▋         | 90/1237 [23:51<5:45:24, 18.07s/it]                                                     7%|▋         | 90/1237 [23:51<5:45:24, 18.07s/it]  7%|▋         | 91/1237 [24:09<5:42:39, 17.94s/it]  7%|▋         | 92/1237 [24:24<5:28:10, 17.20s/it]  8%|▊         | 93/1237 [24:41<5:26:32, 17.13s/it]  8%|▊         | 94/1237 [24:55<5:06:51, 16.11s/it]  8%|▊         | 95/1237 [25:08<4:51:58, 15.34s/it]  8%|▊         | 96/1237 [25:24<4:52:41, 15.39s/it]  8%|▊         | 97/1237 [25:41<5:01:28, 15.87s/it]  8%|▊         | 98/1237 [25:57<5:04:40, 16.05s/it]  8%|▊         | 99/1237 [26:13<5:03:15, 15.99s/it]  8%|▊         | 100/1237 [26:29<5:02:53, 15.98s/it]                                                      8%|▊         | 100/1237 [26:29<5:02:53, 15.98s/it][INFO|trainer.py:3410] 2024-05-26 15:17:05,474 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-100
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 15:17:05,637 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 15:17:05,638 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-100/special_tokens_map.json
  8%|▊         | 101/1237 [26:43<4:50:03, 15.32s/it]  8%|▊         | 102/1237 [27:00<4:59:35, 15.84s/it]  8%|▊         | 103/1237 [27:18<5:12:36, 16.54s/it]  8%|▊         | 104/1237 [27:38<5:32:08, 17.59s/it]  8%|▊         | 105/1237 [27:50<5:01:16, 15.97s/it]  9%|▊         | 106/1237 [28:06<4:58:09, 15.82s/it]  9%|▊         | 107/1237 [28:27<5:29:33, 17.50s/it]  9%|▊         | 108/1237 [28:40<5:04:10, 16.17s/it]  9%|▉         | 109/1237 [28:55<4:54:02, 15.64s/it]  9%|▉         | 110/1237 [29:09<4:47:23, 15.30s/it]                                                      9%|▉         | 110/1237 [29:09<4:47:23, 15.30s/it]  9%|▉         | 111/1237 [29:32<5:27:58, 17.48s/it]  9%|▉         | 112/1237 [29:48<5:22:13, 17.19s/it]  9%|▉         | 113/1237 [30:04<5:13:18, 16.72s/it]  9%|▉         | 114/1237 [30:19<5:04:31, 16.27s/it]  9%|▉         | 115/1237 [30:34<4:56:18, 15.85s/it]  9%|▉         | 116/1237 [30:47<4:41:48, 15.08s/it]  9%|▉         | 117/1237 [30:59<4:21:43, 14.02s/it] 10%|▉         | 118/1237 [31:12<4:14:48, 13.66s/it] 10%|▉         | 119/1237 [31:26<4:17:51, 13.84s/it] 10%|▉         | 120/1237 [31:40<4:17:07, 13.81s/it]                                                     10%|▉         | 120/1237 [31:40<4:17:07, 13.81s/it] 10%|▉         | 121/1237 [32:00<4:55:53, 15.91s/it] 10%|▉         | 122/1237 [32:20<5:15:18, 16.97s/it] 10%|▉         | 123/1237 [32:36<5:10:08, 16.70s/it] 10%|█         | 124/1237 [32:53<5:14:02, 16.93s/it] 10%|█         | 125/1237 [33:09<5:07:51, 16.61s/it] 10%|█         | 126/1237 [33:21<4:39:31, 15.10s/it] 10%|█         | 127/1237 [33:34<4:28:06, 14.49s/it] 10%|█         | 128/1237 [33:52<4:49:37, 15.67s/it] 10%|█         | 129/1237 [34:14<5:20:55, 17.38s/it] 11%|█         | 130/1237 [34:28<5:05:30, 16.56s/it]                                                     11%|█         | 130/1237 [34:28<5:05:30, 16.56s/it] 11%|█         | 131/1237 [34:47<5:14:35, 17.07s/it] 11%|█         | 132/1237 [34:59<4:49:07, 15.70s/it] 11%|█         | 133/1237 [35:17<4:59:26, 16.27s/it] 11%|█         | 134/1237 [35:31<4:49:51, 15.77s/it] 11%|█         | 135/1237 [35:48<4:52:28, 15.92s/it] 11%|█         | 136/1237 [36:07<5:11:51, 16.99s/it] 11%|█         | 137/1237 [36:24<5:09:58, 16.91s/it] 11%|█         | 138/1237 [36:38<4:55:30, 16.13s/it] 11%|█         | 139/1237 [36:57<5:08:51, 16.88s/it] 11%|█▏        | 140/1237 [37:18<5:30:51, 18.10s/it]                                                     11%|█▏        | 140/1237 [37:18<5:30:51, 18.10s/it] 11%|█▏        | 141/1237 [37:32<5:10:25, 16.99s/it] 11%|█▏        | 142/1237 [37:46<4:55:09, 16.17s/it] 12%|█▏        | 143/1237 [38:06<5:15:16, 17.29s/it] 12%|█▏        | 144/1237 [38:23<5:10:56, 17.07s/it] 12%|█▏        | 145/1237 [38:39<5:08:57, 16.98s/it] 12%|█▏        | 146/1237 [38:54<4:53:39, 16.15s/it] 12%|█▏        | 147/1237 [39:08<4:45:31, 15.72s/it] 12%|█▏        | 148/1237 [39:22<4:35:40, 15.19s/it] 12%|█▏        | 149/1237 [39:37<4:31:29, 14.97s/it] 12%|█▏        | 150/1237 [39:57<5:00:21, 16.58s/it]                                                     12%|█▏        | 150/1237 [39:57<5:00:21, 16.58s/it] 12%|█▏        | 151/1237 [40:17<5:18:44, 17.61s/it] 12%|█▏        | 152/1237 [40:32<5:01:48, 16.69s/it] 12%|█▏        | 153/1237 [40:45<4:44:52, 15.77s/it] 12%|█▏        | 154/1237 [40:59<4:31:10, 15.02s/it] 13%|█▎        | 155/1237 [41:12<4:24:07, 14.65s/it] 13%|█▎        | 156/1237 [41:26<4:17:54, 14.32s/it] 13%|█▎        | 157/1237 [41:53<5:25:16, 18.07s/it] 13%|█▎        | 158/1237 [42:08<5:09:24, 17.20s/it] 13%|█▎        | 159/1237 [42:26<5:16:04, 17.59s/it] 13%|█▎        | 160/1237 [42:42<5:05:11, 17.00s/it]                                                     13%|█▎        | 160/1237 [42:42<5:05:11, 17.00s/it] 13%|█▎        | 161/1237 [43:01<5:13:51, 17.50s/it] 13%|█▎        | 162/1237 [43:15<4:56:48, 16.57s/it] 13%|█▎        | 163/1237 [43:32<4:58:48, 16.69s/it] 13%|█▎        | 164/1237 [43:46<4:41:26, 15.74s/it] 13%|█▎        | 165/1237 [44:01<4:39:14, 15.63s/it] 13%|█▎        | 166/1237 [44:15<4:31:36, 15.22s/it] 14%|█▎        | 167/1237 [44:33<4:45:14, 16.00s/it] 14%|█▎        | 168/1237 [44:44<4:19:29, 14.56s/it] 14%|█▎        | 169/1237 [45:00<4:24:27, 14.86s/it] 14%|█▎        | 170/1237 [45:17<4:37:00, 15.58s/it]                                                     14%|█▎        | 170/1237 [45:17<4:37:00, 15.58s/it] 14%|█▍        | 171/1237 [45:32<4:35:09, 15.49s/it] 14%|█▍        | 172/1237 [45:45<4:17:23, 14.50s/it] 14%|█▍        | 173/1237 [45:57<4:07:15, 13.94s/it] 14%|█▍        | 174/1237 [46:16<4:35:14, 15.54s/it] 14%|█▍        | 175/1237 [46:31<4:30:28, 15.28s/it] 14%|█▍        | 176/1237 [46:44<4:19:56, 14.70s/it] 14%|█▍        | 177/1237 [46:58<4:11:47, 14.25s/it] 14%|█▍        | 178/1237 [47:13<4:16:59, 14.56s/it] 14%|█▍        | 179/1237 [47:30<4:30:34, 15.34s/it] 15%|█▍        | 180/1237 [47:43<4:14:49, 14.46s/it]                                                     15%|█▍        | 180/1237 [47:43<4:14:49, 14.46s/it] 15%|█▍        | 181/1237 [47:58<4:17:05, 14.61s/it] 15%|█▍        | 182/1237 [48:14<4:24:53, 15.06s/it] 15%|█▍        | 183/1237 [48:30<4:29:36, 15.35s/it] 15%|█▍        | 184/1237 [48:44<4:24:30, 15.07s/it] 15%|█▍        | 185/1237 [48:59<4:22:53, 14.99s/it] 15%|█▌        | 186/1237 [49:13<4:19:56, 14.84s/it] 15%|█▌        | 187/1237 [49:28<4:17:46, 14.73s/it] 15%|█▌        | 188/1237 [49:45<4:28:49, 15.38s/it] 15%|█▌        | 189/1237 [50:04<4:48:16, 16.50s/it] 15%|█▌        | 190/1237 [50:20<4:48:14, 16.52s/it]                                                     15%|█▌        | 190/1237 [50:20<4:48:14, 16.52s/it] 15%|█▌        | 191/1237 [50:34<4:31:43, 15.59s/it] 16%|█▌        | 192/1237 [50:48<4:24:03, 15.16s/it] 16%|█▌        | 193/1237 [51:04<4:26:34, 15.32s/it] 16%|█▌        | 194/1237 [51:18<4:18:33, 14.87s/it] 16%|█▌        | 195/1237 [51:31<4:13:05, 14.57s/it] 16%|█▌        | 196/1237 [51:52<4:44:13, 16.38s/it] 16%|█▌        | 197/1237 [52:11<4:59:54, 17.30s/it] 16%|█▌        | 198/1237 [52:31<5:09:20, 17.86s/it] 16%|█▌        | 199/1237 [52:52<5:25:09, 18.80s/it] 16%|█▌        | 200/1237 [53:05<4:59:17, 17.32s/it]                                                     16%|█▌        | 200/1237 [53:05<4:59:17, 17.32s/it][INFO|trainer.py:3410] 2024-05-26 15:43:41,904 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-200
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 15:43:42,065 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 15:43:42,065 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-200/special_tokens_map.json
 16%|█▌        | 201/1237 [53:27<5:23:17, 18.72s/it] 16%|█▋        | 202/1237 [53:45<5:16:46, 18.36s/it] 16%|█▋        | 203/1237 [53:57<4:43:39, 16.46s/it] 16%|█▋        | 204/1237 [54:12<4:37:57, 16.14s/it] 17%|█▋        | 205/1237 [54:31<4:49:28, 16.83s/it] 17%|█▋        | 206/1237 [54:46<4:40:21, 16.32s/it] 17%|█▋        | 207/1237 [55:05<4:52:01, 17.01s/it] 17%|█▋        | 208/1237 [55:19<4:39:36, 16.30s/it] 17%|█▋        | 209/1237 [55:33<4:26:21, 15.55s/it] 17%|█▋        | 210/1237 [55:48<4:24:43, 15.47s/it]                                                     17%|█▋        | 210/1237 [55:48<4:24:43, 15.47s/it] 17%|█▋        | 211/1237 [56:03<4:18:48, 15.14s/it] 17%|█▋        | 212/1237 [56:20<4:27:48, 15.68s/it] 17%|█▋        | 213/1237 [56:31<4:04:56, 14.35s/it] 17%|█▋        | 214/1237 [56:45<4:04:00, 14.31s/it] 17%|█▋        | 215/1237 [57:06<4:39:56, 16.43s/it] 17%|█▋        | 216/1237 [57:21<4:27:34, 15.72s/it] 18%|█▊        | 217/1237 [57:41<4:50:14, 17.07s/it] 18%|█▊        | 218/1237 [57:59<4:56:54, 17.48s/it] 18%|█▊        | 219/1237 [58:19<5:06:26, 18.06s/it] 18%|█▊        | 220/1237 [58:39<5:15:55, 18.64s/it]                                                     18%|█▊        | 220/1237 [58:39<5:15:55, 18.64s/it] 18%|█▊        | 221/1237 [58:57<5:12:37, 18.46s/it] 18%|█▊        | 222/1237 [59:12<4:58:45, 17.66s/it] 18%|█▊        | 223/1237 [59:30<5:00:06, 17.76s/it] 18%|█▊        | 224/1237 [59:47<4:56:01, 17.53s/it] 18%|█▊        | 225/1237 [1:00:04<4:52:25, 17.34s/it] 18%|█▊        | 226/1237 [1:00:20<4:44:26, 16.88s/it] 18%|█▊        | 227/1237 [1:00:34<4:26:51, 15.85s/it] 18%|█▊        | 228/1237 [1:00:52<4:41:15, 16.73s/it] 19%|█▊        | 229/1237 [1:01:12<4:56:12, 17.63s/it] 19%|█▊        | 230/1237 [1:01:32<5:07:26, 18.32s/it]                                                       19%|█▊        | 230/1237 [1:01:32<5:07:26, 18.32s/it] 19%|█▊        | 231/1237 [1:01:50<5:05:07, 18.20s/it] 19%|█▉        | 232/1237 [1:02:05<4:49:08, 17.26s/it] 19%|█▉        | 233/1237 [1:02:22<4:46:55, 17.15s/it] 19%|█▉        | 234/1237 [1:02:34<4:20:20, 15.57s/it] 19%|█▉        | 235/1237 [1:02:54<4:44:35, 17.04s/it] 19%|█▉        | 236/1237 [1:03:19<5:23:42, 19.40s/it] 19%|█▉        | 237/1237 [1:03:33<4:54:36, 17.68s/it] 19%|█▉        | 238/1237 [1:03:48<4:43:55, 17.05s/it] 19%|█▉        | 239/1237 [1:04:03<4:32:35, 16.39s/it] 19%|█▉        | 240/1237 [1:04:17<4:16:49, 15.46s/it]                                                       19%|█▉        | 240/1237 [1:04:17<4:16:49, 15.46s/it] 19%|█▉        | 241/1237 [1:04:31<4:09:49, 15.05s/it] 20%|█▉        | 242/1237 [1:04:48<4:22:54, 15.85s/it] 20%|█▉        | 243/1237 [1:05:08<4:39:19, 16.86s/it] 20%|█▉        | 244/1237 [1:05:24<4:37:10, 16.75s/it] 20%|█▉        | 245/1237 [1:05:43<4:47:04, 17.36s/it] 20%|█▉        | 246/1237 [1:05:56<4:23:41, 15.97s/it] 20%|█▉        | 247/1237 [1:06:15<4:39:45, 16.96s/it] 20%|██        | 248/1237 [1:06:30<4:30:02, 16.38s/it] 20%|██        | 249/1237 [1:06:44<4:17:01, 15.61s/it] 20%|██        | 250/1237 [1:06:58<4:10:50, 15.25s/it]                                                       20%|██        | 250/1237 [1:06:58<4:10:50, 15.25s/it] 20%|██        | 251/1237 [1:07:16<4:23:53, 16.06s/it] 20%|██        | 252/1237 [1:07:31<4:18:43, 15.76s/it] 20%|██        | 253/1237 [1:07:47<4:19:11, 15.80s/it] 21%|██        | 254/1237 [1:08:03<4:19:46, 15.86s/it] 21%|██        | 255/1237 [1:08:17<4:12:37, 15.44s/it] 21%|██        | 256/1237 [1:08:33<4:11:50, 15.40s/it] 21%|██        | 257/1237 [1:08:50<4:19:19, 15.88s/it] 21%|██        | 258/1237 [1:09:07<4:24:27, 16.21s/it] 21%|██        | 259/1237 [1:09:24<4:27:29, 16.41s/it] 21%|██        | 260/1237 [1:09:38<4:19:00, 15.91s/it]                                                       21%|██        | 260/1237 [1:09:38<4:19:00, 15.91s/it] 21%|██        | 261/1237 [1:09:50<3:56:13, 14.52s/it] 21%|██        | 262/1237 [1:10:13<4:39:42, 17.21s/it] 21%|██▏       | 263/1237 [1:10:32<4:47:59, 17.74s/it] 21%|██▏       | 264/1237 [1:10:49<4:42:00, 17.39s/it] 21%|██▏       | 265/1237 [1:11:03<4:26:11, 16.43s/it] 22%|██▏       | 266/1237 [1:11:23<4:44:05, 17.55s/it] 22%|██▏       | 267/1237 [1:11:35<4:18:30, 15.99s/it] 22%|██▏       | 268/1237 [1:11:54<4:30:40, 16.76s/it] 22%|██▏       | 269/1237 [1:12:10<4:25:57, 16.49s/it] 22%|██▏       | 270/1237 [1:12:33<4:58:17, 18.51s/it]                                                       22%|██▏       | 270/1237 [1:12:33<4:58:17, 18.51s/it] 22%|██▏       | 271/1237 [1:12:50<4:50:36, 18.05s/it] 22%|██▏       | 272/1237 [1:13:06<4:39:42, 17.39s/it] 22%|██▏       | 273/1237 [1:13:18<4:13:03, 15.75s/it] 22%|██▏       | 274/1237 [1:13:40<4:42:25, 17.60s/it] 22%|██▏       | 275/1237 [1:13:57<4:41:47, 17.58s/it] 22%|██▏       | 276/1237 [1:14:14<4:35:56, 17.23s/it] 22%|██▏       | 277/1237 [1:14:30<4:33:41, 17.11s/it] 22%|██▏       | 278/1237 [1:14:47<4:30:37, 16.93s/it] 23%|██▎       | 279/1237 [1:15:01<4:15:43, 16.02s/it] 23%|██▎       | 280/1237 [1:15:15<4:07:15, 15.50s/it]                                                       23%|██▎       | 280/1237 [1:15:15<4:07:15, 15.50s/it] 23%|██▎       | 281/1237 [1:15:32<4:13:52, 15.93s/it] 23%|██▎       | 282/1237 [1:15:49<4:19:01, 16.27s/it] 23%|██▎       | 283/1237 [1:16:05<4:15:57, 16.10s/it] 23%|██▎       | 284/1237 [1:16:23<4:24:20, 16.64s/it] 23%|██▎       | 285/1237 [1:16:41<4:30:59, 17.08s/it] 23%|██▎       | 286/1237 [1:17:01<4:45:24, 18.01s/it] 23%|██▎       | 287/1237 [1:17:17<4:35:22, 17.39s/it] 23%|██▎       | 288/1237 [1:17:31<4:19:44, 16.42s/it] 23%|██▎       | 289/1237 [1:17:49<4:26:35, 16.87s/it] 23%|██▎       | 290/1237 [1:18:03<4:14:11, 16.10s/it]                                                       23%|██▎       | 290/1237 [1:18:03<4:14:11, 16.10s/it] 24%|██▎       | 291/1237 [1:18:23<4:30:00, 17.13s/it] 24%|██▎       | 292/1237 [1:18:40<4:30:25, 17.17s/it] 24%|██▎       | 293/1237 [1:18:55<4:19:13, 16.48s/it] 24%|██▍       | 294/1237 [1:19:10<4:13:39, 16.14s/it] 24%|██▍       | 295/1237 [1:19:27<4:17:04, 16.37s/it] 24%|██▍       | 296/1237 [1:19:41<4:04:48, 15.61s/it] 24%|██▍       | 297/1237 [1:19:59<4:15:45, 16.32s/it] 24%|██▍       | 298/1237 [1:20:16<4:19:34, 16.59s/it] 24%|██▍       | 299/1237 [1:20:33<4:21:08, 16.70s/it] 24%|██▍       | 300/1237 [1:20:48<4:10:21, 16.03s/it]                                                       24%|██▍       | 300/1237 [1:20:48<4:10:21, 16.03s/it][INFO|trainer.py:3410] 2024-05-26 16:11:24,181 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-300
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 16:11:24,342 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 16:11:24,343 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-300/special_tokens_map.json
 24%|██▍       | 301/1237 [1:21:00<3:53:58, 15.00s/it] 24%|██▍       | 302/1237 [1:21:17<4:02:49, 15.58s/it] 24%|██▍       | 303/1237 [1:21:37<4:19:53, 16.70s/it] 25%|██▍       | 304/1237 [1:21:54<4:20:50, 16.77s/it] 25%|██▍       | 305/1237 [1:22:15<4:42:44, 18.20s/it] 25%|██▍       | 306/1237 [1:22:34<4:46:53, 18.49s/it] 25%|██▍       | 307/1237 [1:22:50<4:35:48, 17.79s/it] 25%|██▍       | 308/1237 [1:23:07<4:29:14, 17.39s/it] 25%|██▍       | 309/1237 [1:23:22<4:20:51, 16.87s/it] 25%|██▌       | 310/1237 [1:23:36<4:05:43, 15.90s/it]                                                       25%|██▌       | 310/1237 [1:23:36<4:05:43, 15.90s/it] 25%|██▌       | 311/1237 [1:23:52<4:04:35, 15.85s/it] 25%|██▌       | 312/1237 [1:24:06<3:58:29, 15.47s/it] 25%|██▌       | 313/1237 [1:24:22<3:59:42, 15.57s/it] 25%|██▌       | 314/1237 [1:24:40<4:09:44, 16.24s/it] 25%|██▌       | 315/1237 [1:24:52<3:50:13, 14.98s/it] 26%|██▌       | 316/1237 [1:25:09<3:58:50, 15.56s/it] 26%|██▌       | 317/1237 [1:25:24<3:56:20, 15.41s/it] 26%|██▌       | 318/1237 [1:25:40<3:59:59, 15.67s/it] 26%|██▌       | 319/1237 [1:25:54<3:49:21, 14.99s/it] 26%|██▌       | 320/1237 [1:26:07<3:39:30, 14.36s/it]                                                       26%|██▌       | 320/1237 [1:26:07<3:39:30, 14.36s/it] 26%|██▌       | 321/1237 [1:26:26<4:01:21, 15.81s/it] 26%|██▌       | 322/1237 [1:26:43<4:09:21, 16.35s/it] 26%|██▌       | 323/1237 [1:26:55<3:47:56, 14.96s/it] 26%|██▌       | 324/1237 [1:27:12<3:57:37, 15.62s/it] 26%|██▋       | 325/1237 [1:27:31<4:11:08, 16.52s/it] 26%|██▋       | 326/1237 [1:27:51<4:26:44, 17.57s/it] 26%|██▋       | 327/1237 [1:28:04<4:07:10, 16.30s/it] 27%|██▋       | 328/1237 [1:28:27<4:34:43, 18.13s/it] 27%|██▋       | 329/1237 [1:28:42<4:20:25, 17.21s/it] 27%|██▋       | 330/1237 [1:29:00<4:23:52, 17.46s/it]                                                       27%|██▋       | 330/1237 [1:29:00<4:23:52, 17.46s/it] 27%|██▋       | 331/1237 [1:29:14<4:08:44, 16.47s/it] 27%|██▋       | 332/1237 [1:29:33<4:21:32, 17.34s/it] 27%|██▋       | 333/1237 [1:29:50<4:20:19, 17.28s/it] 27%|██▋       | 334/1237 [1:30:09<4:26:14, 17.69s/it] 27%|██▋       | 335/1237 [1:30:27<4:25:22, 17.65s/it] 27%|██▋       | 336/1237 [1:30:42<4:16:23, 17.07s/it] 27%|██▋       | 337/1237 [1:30:57<4:03:23, 16.23s/it] 27%|██▋       | 338/1237 [1:31:16<4:15:08, 17.03s/it] 27%|██▋       | 339/1237 [1:31:30<4:01:32, 16.14s/it] 27%|██▋       | 340/1237 [1:31:43<3:48:05, 15.26s/it]                                                       27%|██▋       | 340/1237 [1:31:43<3:48:05, 15.26s/it] 28%|██▊       | 341/1237 [1:31:55<3:34:05, 14.34s/it] 28%|██▊       | 342/1237 [1:32:08<3:27:09, 13.89s/it] 28%|██▊       | 343/1237 [1:32:22<3:29:55, 14.09s/it] 28%|██▊       | 344/1237 [1:32:39<3:39:55, 14.78s/it] 28%|██▊       | 345/1237 [1:32:53<3:37:18, 14.62s/it] 28%|██▊       | 346/1237 [1:33:09<3:42:23, 14.98s/it] 28%|██▊       | 347/1237 [1:33:33<4:21:01, 17.60s/it] 28%|██▊       | 348/1237 [1:33:48<4:12:01, 17.01s/it] 28%|██▊       | 349/1237 [1:34:03<4:02:30, 16.39s/it] 28%|██▊       | 350/1237 [1:34:21<4:09:10, 16.86s/it]                                                       28%|██▊       | 350/1237 [1:34:21<4:09:10, 16.86s/it] 28%|██▊       | 351/1237 [1:34:37<4:03:06, 16.46s/it] 28%|██▊       | 352/1237 [1:34:53<4:04:24, 16.57s/it] 29%|██▊       | 353/1237 [1:35:14<4:23:16, 17.87s/it] 29%|██▊       | 354/1237 [1:35:27<4:01:18, 16.40s/it] 29%|██▊       | 355/1237 [1:35:42<3:51:29, 15.75s/it] 29%|██▉       | 356/1237 [1:36:02<4:11:08, 17.10s/it] 29%|██▉       | 357/1237 [1:36:20<4:16:59, 17.52s/it] 29%|██▉       | 358/1237 [1:36:38<4:19:06, 17.69s/it] 29%|██▉       | 359/1237 [1:36:50<3:54:05, 16.00s/it] 29%|██▉       | 360/1237 [1:37:08<4:02:32, 16.59s/it]                                                       29%|██▉       | 360/1237 [1:37:08<4:02:32, 16.59s/it] 29%|██▉       | 361/1237 [1:37:23<3:51:25, 15.85s/it] 29%|██▉       | 362/1237 [1:37:39<3:54:00, 16.05s/it] 29%|██▉       | 363/1237 [1:37:57<4:01:37, 16.59s/it] 29%|██▉       | 364/1237 [1:38:12<3:54:02, 16.09s/it] 30%|██▉       | 365/1237 [1:38:27<3:50:26, 15.86s/it] 30%|██▉       | 366/1237 [1:38:38<3:29:35, 14.44s/it] 30%|██▉       | 367/1237 [1:38:52<3:24:38, 14.11s/it] 30%|██▉       | 368/1237 [1:39:05<3:23:26, 14.05s/it] 30%|██▉       | 369/1237 [1:39:20<3:24:47, 14.16s/it] 30%|██▉       | 370/1237 [1:39:33<3:21:52, 13.97s/it]                                                       30%|██▉       | 370/1237 [1:39:33<3:21:52, 13.97s/it] 30%|██▉       | 371/1237 [1:39:48<3:25:46, 14.26s/it] 30%|███       | 372/1237 [1:40:05<3:33:54, 14.84s/it] 30%|███       | 373/1237 [1:40:26<4:03:46, 16.93s/it] 30%|███       | 374/1237 [1:40:49<4:27:55, 18.63s/it] 30%|███       | 375/1237 [1:41:10<4:38:58, 19.42s/it] 30%|███       | 376/1237 [1:41:27<4:25:55, 18.53s/it] 30%|███       | 377/1237 [1:41:47<4:31:27, 18.94s/it] 31%|███       | 378/1237 [1:41:59<4:01:40, 16.88s/it] 31%|███       | 379/1237 [1:42:13<3:52:24, 16.25s/it] 31%|███       | 380/1237 [1:42:25<3:32:28, 14.88s/it]                                                       31%|███       | 380/1237 [1:42:25<3:32:28, 14.88s/it] 31%|███       | 381/1237 [1:42:37<3:19:48, 14.01s/it] 31%|███       | 382/1237 [1:42:54<3:32:21, 14.90s/it] 31%|███       | 383/1237 [1:43:10<3:35:47, 15.16s/it] 31%|███       | 384/1237 [1:43:27<3:44:13, 15.77s/it] 31%|███       | 385/1237 [1:43:41<3:36:38, 15.26s/it] 31%|███       | 386/1237 [1:43:54<3:26:06, 14.53s/it] 31%|███▏      | 387/1237 [1:44:12<3:41:53, 15.66s/it] 31%|███▏      | 388/1237 [1:44:23<3:22:20, 14.30s/it] 31%|███▏      | 389/1237 [1:44:37<3:18:25, 14.04s/it] 32%|███▏      | 390/1237 [1:44:53<3:28:23, 14.76s/it]                                                       32%|███▏      | 390/1237 [1:44:53<3:28:23, 14.76s/it] 32%|███▏      | 391/1237 [1:45:10<3:35:18, 15.27s/it] 32%|███▏      | 392/1237 [1:45:25<3:34:55, 15.26s/it] 32%|███▏      | 393/1237 [1:45:44<3:50:36, 16.39s/it] 32%|███▏      | 394/1237 [1:46:05<4:09:42, 17.77s/it] 32%|███▏      | 395/1237 [1:46:18<3:50:04, 16.39s/it] 32%|███▏      | 396/1237 [1:46:35<3:52:09, 16.56s/it] 32%|███▏      | 397/1237 [1:46:48<3:36:44, 15.48s/it] 32%|███▏      | 398/1237 [1:47:03<3:32:47, 15.22s/it] 32%|███▏      | 399/1237 [1:47:15<3:21:27, 14.42s/it] 32%|███▏      | 400/1237 [1:47:31<3:26:38, 14.81s/it]                                                       32%|███▏      | 400/1237 [1:47:31<3:26:38, 14.81s/it][INFO|trainer.py:3410] 2024-05-26 16:38:07,378 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-400
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 16:38:07,538 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 16:38:07,538 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-400/special_tokens_map.json
 32%|███▏      | 401/1237 [1:47:47<3:33:26, 15.32s/it] 32%|███▏      | 402/1237 [1:48:00<3:20:03, 14.38s/it] 33%|███▎      | 403/1237 [1:48:20<3:45:06, 16.20s/it] 33%|███▎      | 404/1237 [1:48:35<3:37:40, 15.68s/it] 33%|███▎      | 405/1237 [1:48:47<3:25:59, 14.86s/it] 33%|███▎      | 406/1237 [1:49:03<3:27:58, 15.02s/it] 33%|███▎      | 407/1237 [1:49:16<3:19:58, 14.46s/it] 33%|███▎      | 408/1237 [1:49:33<3:30:23, 15.23s/it] 33%|███▎      | 409/1237 [1:49:49<3:32:27, 15.39s/it] 33%|███▎      | 410/1237 [1:50:11<3:59:15, 17.36s/it]                                                       33%|███▎      | 410/1237 [1:50:11<3:59:15, 17.36s/it] 33%|███▎      | 411/1237 [1:50:25<3:47:15, 16.51s/it] 33%|███▎      | 412/1237 [1:50:41<3:41:47, 16.13s/it] 33%|███▎      | 413/1237 [1:50:52<3:23:09, 14.79s/it] 33%|███▎      | 414/1237 [1:51:04<3:10:58, 13.92s/it] 34%|███▎      | 415/1237 [1:51:19<3:16:33, 14.35s/it] 34%|███▎      | 416/1237 [1:51:32<3:09:21, 13.84s/it] 34%|███▎      | 417/1237 [1:51:51<3:28:06, 15.23s/it] 34%|███▍      | 418/1237 [1:52:09<3:41:47, 16.25s/it] 34%|███▍      | 419/1237 [1:52:23<3:30:03, 15.41s/it] 34%|███▍      | 420/1237 [1:52:38<3:28:47, 15.33s/it]                                                       34%|███▍      | 420/1237 [1:52:38<3:28:47, 15.33s/it] 34%|███▍      | 421/1237 [1:52:49<3:09:54, 13.96s/it] 34%|███▍      | 422/1237 [1:53:04<3:16:03, 14.43s/it] 34%|███▍      | 423/1237 [1:53:20<3:20:21, 14.77s/it] 34%|███▍      | 424/1237 [1:53:32<3:09:30, 13.99s/it] 34%|███▍      | 425/1237 [1:53:44<3:02:54, 13.52s/it] 34%|███▍      | 426/1237 [1:54:04<3:26:13, 15.26s/it] 35%|███▍      | 427/1237 [1:54:23<3:44:51, 16.66s/it] 35%|███▍      | 428/1237 [1:54:39<3:38:09, 16.18s/it] 35%|███▍      | 429/1237 [1:54:58<3:49:37, 17.05s/it] 35%|███▍      | 430/1237 [1:55:12<3:39:04, 16.29s/it]                                                       35%|███▍      | 430/1237 [1:55:12<3:39:04, 16.29s/it] 35%|███▍      | 431/1237 [1:55:28<3:36:26, 16.11s/it] 35%|███▍      | 432/1237 [1:55:43<3:32:17, 15.82s/it] 35%|███▌      | 433/1237 [1:56:00<3:35:25, 16.08s/it] 35%|███▌      | 434/1237 [1:56:15<3:33:17, 15.94s/it] 35%|███▌      | 435/1237 [1:56:38<4:02:04, 18.11s/it] 35%|███▌      | 436/1237 [1:56:51<3:39:46, 16.46s/it] 35%|███▌      | 437/1237 [1:57:08<3:41:49, 16.64s/it] 35%|███▌      | 438/1237 [1:57:27<3:48:54, 17.19s/it] 35%|███▌      | 439/1237 [1:57:44<3:50:59, 17.37s/it] 36%|███▌      | 440/1237 [1:58:04<3:58:38, 17.97s/it]                                                       36%|███▌      | 440/1237 [1:58:04<3:58:38, 17.97s/it] 36%|███▌      | 441/1237 [1:58:17<3:38:37, 16.48s/it] 36%|███▌      | 442/1237 [1:58:34<3:41:59, 16.75s/it] 36%|███▌      | 443/1237 [1:58:47<3:27:59, 15.72s/it] 36%|███▌      | 444/1237 [1:59:05<3:33:24, 16.15s/it] 36%|███▌      | 445/1237 [1:59:19<3:26:14, 15.62s/it] 36%|███▌      | 446/1237 [1:59:32<3:17:36, 14.99s/it] 36%|███▌      | 447/1237 [1:59:53<3:38:24, 16.59s/it] 36%|███▌      | 448/1237 [2:00:07<3:30:15, 15.99s/it] 36%|███▋      | 449/1237 [2:00:24<3:31:34, 16.11s/it] 36%|███▋      | 450/1237 [2:00:45<3:50:44, 17.59s/it]                                                       36%|███▋      | 450/1237 [2:00:45<3:50:44, 17.59s/it] 36%|███▋      | 451/1237 [2:01:02<3:48:11, 17.42s/it] 37%|███▋      | 452/1237 [2:01:16<3:35:44, 16.49s/it] 37%|███▋      | 453/1237 [2:01:28<3:18:13, 15.17s/it] 37%|███▋      | 454/1237 [2:01:45<3:24:47, 15.69s/it] 37%|███▋      | 455/1237 [2:01:58<3:12:40, 14.78s/it] 37%|███▋      | 456/1237 [2:02:13<3:12:55, 14.82s/it] 37%|███▋      | 457/1237 [2:02:27<3:11:51, 14.76s/it] 37%|███▋      | 458/1237 [2:02:47<3:29:42, 16.15s/it] 37%|███▋      | 459/1237 [2:03:05<3:37:22, 16.76s/it] 37%|███▋      | 460/1237 [2:03:21<3:35:29, 16.64s/it]                                                       37%|███▋      | 460/1237 [2:03:21<3:35:29, 16.64s/it] 37%|███▋      | 461/1237 [2:03:36<3:25:48, 15.91s/it] 37%|███▋      | 462/1237 [2:03:50<3:21:21, 15.59s/it] 37%|███▋      | 463/1237 [2:04:02<3:07:14, 14.52s/it] 38%|███▊      | 464/1237 [2:04:15<2:58:45, 13.88s/it] 38%|███▊      | 465/1237 [2:04:26<2:49:33, 13.18s/it] 38%|███▊      | 466/1237 [2:04:44<3:08:10, 14.64s/it] 38%|███▊      | 467/1237 [2:05:02<3:21:09, 15.67s/it] 38%|███▊      | 468/1237 [2:05:17<3:17:52, 15.44s/it] 38%|███▊      | 469/1237 [2:05:33<3:19:55, 15.62s/it] 38%|███▊      | 470/1237 [2:05:52<3:31:22, 16.54s/it]                                                       38%|███▊      | 470/1237 [2:05:52<3:31:22, 16.54s/it] 38%|███▊      | 471/1237 [2:06:14<3:51:29, 18.13s/it] 38%|███▊      | 472/1237 [2:06:31<3:46:17, 17.75s/it] 38%|███▊      | 473/1237 [2:06:42<3:21:01, 15.79s/it] 38%|███▊      | 474/1237 [2:06:57<3:18:38, 15.62s/it] 38%|███▊      | 475/1237 [2:07:12<3:15:17, 15.38s/it] 38%|███▊      | 476/1237 [2:07:27<3:15:14, 15.39s/it] 39%|███▊      | 477/1237 [2:07:41<3:08:16, 14.86s/it] 39%|███▊      | 478/1237 [2:07:58<3:16:35, 15.54s/it] 39%|███▊      | 479/1237 [2:08:12<3:08:15, 14.90s/it] 39%|███▉      | 480/1237 [2:08:28<3:13:37, 15.35s/it]                                                       39%|███▉      | 480/1237 [2:08:28<3:13:37, 15.35s/it] 39%|███▉      | 481/1237 [2:08:41<3:05:53, 14.75s/it] 39%|███▉      | 482/1237 [2:08:53<2:55:34, 13.95s/it] 39%|███▉      | 483/1237 [2:09:08<2:59:34, 14.29s/it] 39%|███▉      | 484/1237 [2:09:25<3:07:18, 14.93s/it] 39%|███▉      | 485/1237 [2:09:39<3:05:42, 14.82s/it] 39%|███▉      | 486/1237 [2:09:57<3:14:38, 15.55s/it] 39%|███▉      | 487/1237 [2:10:15<3:23:29, 16.28s/it] 39%|███▉      | 488/1237 [2:10:33<3:32:08, 16.99s/it] 40%|███▉      | 489/1237 [2:10:50<3:28:48, 16.75s/it] 40%|███▉      | 490/1237 [2:11:07<3:30:50, 16.93s/it]                                                       40%|███▉      | 490/1237 [2:11:07<3:30:50, 16.93s/it] 40%|███▉      | 491/1237 [2:11:19<3:13:23, 15.55s/it] 40%|███▉      | 492/1237 [2:11:36<3:18:00, 15.95s/it] 40%|███▉      | 493/1237 [2:11:52<3:16:58, 15.89s/it] 40%|███▉      | 494/1237 [2:12:05<3:08:01, 15.18s/it] 40%|████      | 495/1237 [2:12:19<3:00:25, 14.59s/it] 40%|████      | 496/1237 [2:12:35<3:06:16, 15.08s/it] 40%|████      | 497/1237 [2:12:52<3:12:17, 15.59s/it] 40%|████      | 498/1237 [2:13:09<3:17:46, 16.06s/it] 40%|████      | 499/1237 [2:13:24<3:15:40, 15.91s/it] 40%|████      | 500/1237 [2:13:37<3:02:36, 14.87s/it]                                                       40%|████      | 500/1237 [2:13:37<3:02:36, 14.87s/it][INFO|trainer.py:3719] 2024-05-26 17:04:13,203 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-26 17:04:13,204 >>   Num examples = 500
[INFO|trainer.py:3724] 2024-05-26 17:04:13,204 >>   Batch size = 32
{'loss': 2.4165, 'grad_norm': 1.4866392612457275, 'learning_rate': 0.0001999683882835888, 'epoch': 0.01}
{'loss': 1.4927, 'grad_norm': 1.706534743309021, 'learning_rate': 0.0001998722931288996, 'epoch': 0.02}
{'loss': 1.4989, 'grad_norm': 1.246410608291626, 'learning_rate': 0.00019971177329856113, 'epoch': 0.02}
{'loss': 1.449, 'grad_norm': 1.420247197151184, 'learning_rate': 0.00019948693233918952, 'epoch': 0.03}
{'loss': 1.4711, 'grad_norm': 1.1656991243362427, 'learning_rate': 0.00019919791528906752, 'epoch': 0.04}
{'loss': 1.3966, 'grad_norm': 1.2232130765914917, 'learning_rate': 0.00019884490858458422, 'epoch': 0.05}
{'loss': 1.4256, 'grad_norm': 1.2926732301712036, 'learning_rate': 0.00019842813993997083, 'epoch': 0.06}
{'loss': 1.4601, 'grad_norm': 1.3992997407913208, 'learning_rate': 0.0001979478782004085, 'epoch': 0.06}
{'loss': 1.3858, 'grad_norm': 1.32399582862854, 'learning_rate': 0.00019740443316860467, 'epoch': 0.07}
{'loss': 1.3923, 'grad_norm': 1.431571125984192, 'learning_rate': 0.00019679815540494806, 'epoch': 0.08}
{'loss': 1.3475, 'grad_norm': 1.3081804513931274, 'learning_rate': 0.0001961294360013727, 'epoch': 0.09}
{'loss': 1.4147, 'grad_norm': 1.2556573152542114, 'learning_rate': 0.00019539870632907599, 'epoch': 0.1}
{'loss': 1.4422, 'grad_norm': 1.3482921123504639, 'learning_rate': 0.00019460643776025394, 'epoch': 0.11}
{'loss': 1.3219, 'grad_norm': 1.3357939720153809, 'learning_rate': 0.0001937531413640326, 'epoch': 0.11}
{'loss': 1.3695, 'grad_norm': 1.1410526037216187, 'learning_rate': 0.0001928393675767927, 'epoch': 0.12}
{'loss': 1.3889, 'grad_norm': 1.4066033363342285, 'learning_rate': 0.00019186570584709913, 'epoch': 0.13}
{'loss': 1.3359, 'grad_norm': 1.2461271286010742, 'learning_rate': 0.0001908327842554651, 'epoch': 0.14}
{'loss': 1.4038, 'grad_norm': 1.3533321619033813, 'learning_rate': 0.00018974126910919603, 'epoch': 0.15}
{'loss': 1.3474, 'grad_norm': 1.5268518924713135, 'learning_rate': 0.00018859186451257402, 'epoch': 0.15}
{'loss': 1.3691, 'grad_norm': 1.3125039339065552, 'learning_rate': 0.0001873853119126612, 'epoch': 0.16}
{'loss': 1.3003, 'grad_norm': 1.3159589767456055, 'learning_rate': 0.00018612238962101405, 'epoch': 0.17}
{'loss': 1.3445, 'grad_norm': 1.3571103811264038, 'learning_rate': 0.0001848039123116172, 'epoch': 0.18}
{'loss': 1.311, 'grad_norm': 1.4476022720336914, 'learning_rate': 0.00018343073049536163, 'epoch': 0.19}
{'loss': 1.3495, 'grad_norm': 1.4504717588424683, 'learning_rate': 0.00018200372997140488, 'epoch': 0.19}
{'loss': 1.3017, 'grad_norm': 1.24217689037323, 'learning_rate': 0.00018052383125576833, 'epoch': 0.2}
{'loss': 1.2842, 'grad_norm': 1.453284502029419, 'learning_rate': 0.00017899198898753912, 'epoch': 0.21}
{'loss': 1.294, 'grad_norm': 1.246279001235962, 'learning_rate': 0.00017740919131306073, 'epoch': 0.22}
{'loss': 1.2838, 'grad_norm': 1.3922739028930664, 'learning_rate': 0.00017577645924850903, 'epoch': 0.23}
{'loss': 1.327, 'grad_norm': 1.279564380645752, 'learning_rate': 0.00017409484602126454, 'epoch': 0.23}
{'loss': 1.3155, 'grad_norm': 1.2793627977371216, 'learning_rate': 0.00017254049663579653, 'epoch': 0.24}
{'loss': 1.3115, 'grad_norm': 1.1909184455871582, 'learning_rate': 0.00017076902320844667, 'epoch': 0.25}
{'loss': 1.3093, 'grad_norm': 1.2499796152114868, 'learning_rate': 0.00016895189876795405, 'epoch': 0.26}
{'loss': 1.2722, 'grad_norm': 1.3334912061691284, 'learning_rate': 0.00016709029548779173, 'epoch': 0.27}
{'loss': 1.2729, 'grad_norm': 1.1569807529449463, 'learning_rate': 0.0001651854142334225, 'epoch': 0.27}
{'loss': 1.3217, 'grad_norm': 1.3354676961898804, 'learning_rate': 0.0001632384837876561, 'epoch': 0.28}
{'loss': 1.3149, 'grad_norm': 1.5774250030517578, 'learning_rate': 0.0001612507600579975, 'epoch': 0.29}
{'loss': 1.3038, 'grad_norm': 1.2219210863113403, 'learning_rate': 0.00015922352526649803, 'epoch': 0.3}
{'loss': 1.2562, 'grad_norm': 1.3164446353912354, 'learning_rate': 0.00015715808712263155, 'epoch': 0.31}
{'loss': 1.2697, 'grad_norm': 1.30649733543396, 'learning_rate': 0.00015505577797972974, 'epoch': 0.32}
{'loss': 1.2779, 'grad_norm': 1.4202392101287842, 'learning_rate': 0.0001529179539755202, 'epoch': 0.32}
{'loss': 1.2618, 'grad_norm': 1.5437257289886475, 'learning_rate': 0.00015074599415732166, 'epoch': 0.33}
{'loss': 1.3044, 'grad_norm': 1.4253953695297241, 'learning_rate': 0.0001485412995924616, 'epoch': 0.34}
{'loss': 1.2815, 'grad_norm': 1.5245132446289062, 'learning_rate': 0.0001463052924644885, 'epoch': 0.35}
{'loss': 1.2871, 'grad_norm': 1.5653300285339355, 'learning_rate': 0.00014403941515576344, 'epoch': 0.36}
{'loss': 1.2419, 'grad_norm': 1.420809030532837, 'learning_rate': 0.00014174512931702167, 'epoch': 0.36}
{'loss': 1.2827, 'grad_norm': 1.4417420625686646, 'learning_rate': 0.00013942391492450455, 'epoch': 0.37}
{'loss': 1.2664, 'grad_norm': 1.3480806350708008, 'learning_rate': 0.0001370772693252707, 'epoch': 0.38}
{'loss': 1.288, 'grad_norm': 1.3146854639053345, 'learning_rate': 0.00013470670627130135, 'epoch': 0.39}
{'loss': 1.2391, 'grad_norm': 1.6215980052947998, 'learning_rate': 0.00013231375494302355, 'epoch': 0.4}
{'loss': 1.2713, 'grad_norm': 1.4817540645599365, 'learning_rate': 0.00012989995896288086, 'epoch': 0.4}

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:02<00:19,  1.38s/it][A
 19%|█▉        | 3/16 [00:07<00:34,  2.63s/it][A
 25%|██▌       | 4/16 [00:10<00:35,  2.96s/it][A
 31%|███▏      | 5/16 [00:13<00:31,  2.88s/it][A
 38%|███▊      | 6/16 [00:17<00:32,  3.24s/it][A
 44%|████▍     | 7/16 [00:19<00:26,  2.99s/it][A
 50%|█████     | 8/16 [00:23<00:26,  3.28s/it][A
 56%|█████▋    | 9/16 [00:27<00:24,  3.57s/it][A
 62%|██████▎   | 10/16 [00:31<00:22,  3.69s/it][A
 69%|██████▉   | 11/16 [00:36<00:20,  4.09s/it][A
 75%|███████▌  | 12/16 [00:40<00:15,  3.95s/it][A
 81%|████████▏ | 13/16 [00:43<00:11,  3.71s/it][A
 88%|████████▊ | 14/16 [00:47<00:07,  3.73s/it][A
 94%|█████████▍| 15/16 [00:50<00:03,  3.49s/it][A
100%|██████████| 16/16 [00:53<00:00,  3.31s/it][A                                                      
                                               [A 40%|████      | 500/1237 [2:14:37<3:02:36, 14.87s/it]
100%|██████████| 16/16 [00:53<00:00,  3.31s/it][A
                                               [A[INFO|trainer.py:3410] 2024-05-26 17:05:13,171 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-500
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 17:05:13,330 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 17:05:13,330 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-500/special_tokens_map.json
 41%|████      | 501/1237 [2:14:49<6:33:36, 32.09s/it] 41%|████      | 502/1237 [2:15:05<5:33:14, 27.20s/it] 41%|████      | 503/1237 [2:15:22<4:54:43, 24.09s/it] 41%|████      | 504/1237 [2:15:36<4:19:31, 21.24s/it] 41%|████      | 505/1237 [2:15:51<3:57:09, 19.44s/it] 41%|████      | 506/1237 [2:16:09<3:48:42, 18.77s/it] 41%|████      | 507/1237 [2:16:32<4:04:46, 20.12s/it] 41%|████      | 508/1237 [2:16:45<3:37:34, 17.91s/it] 41%|████      | 509/1237 [2:16:58<3:18:49, 16.39s/it] 41%|████      | 510/1237 [2:17:10<3:04:08, 15.20s/it]                                                       41%|████      | 510/1237 [2:17:10<3:04:08, 15.20s/it] 41%|████▏     | 511/1237 [2:17:26<3:06:46, 15.44s/it] 41%|████▏     | 512/1237 [2:17:41<3:04:53, 15.30s/it] 41%|████▏     | 513/1237 [2:17:56<3:02:28, 15.12s/it] 42%|████▏     | 514/1237 [2:18:11<3:03:45, 15.25s/it] 42%|████▏     | 515/1237 [2:18:24<2:56:24, 14.66s/it] 42%|████▏     | 516/1237 [2:18:37<2:49:14, 14.08s/it] 42%|████▏     | 517/1237 [2:18:52<2:49:50, 14.15s/it] 42%|████▏     | 518/1237 [2:19:06<2:51:59, 14.35s/it] 42%|████▏     | 519/1237 [2:19:22<2:56:48, 14.77s/it] 42%|████▏     | 520/1237 [2:19:35<2:49:08, 14.15s/it]                                                       42%|████▏     | 520/1237 [2:19:35<2:49:08, 14.15s/it] 42%|████▏     | 521/1237 [2:19:49<2:50:12, 14.26s/it] 42%|████▏     | 522/1237 [2:20:02<2:43:43, 13.74s/it] 42%|████▏     | 523/1237 [2:20:18<2:52:13, 14.47s/it] 42%|████▏     | 524/1237 [2:20:32<2:50:04, 14.31s/it] 42%|████▏     | 525/1237 [2:20:45<2:45:16, 13.93s/it] 43%|████▎     | 526/1237 [2:21:03<3:00:54, 15.27s/it] 43%|████▎     | 527/1237 [2:21:17<2:54:46, 14.77s/it] 43%|████▎     | 528/1237 [2:21:36<3:09:40, 16.05s/it] 43%|████▎     | 529/1237 [2:21:54<3:14:47, 16.51s/it] 43%|████▎     | 530/1237 [2:22:08<3:07:54, 15.95s/it]                                                       43%|████▎     | 530/1237 [2:22:08<3:07:54, 15.95s/it] 43%|████▎     | 531/1237 [2:22:24<3:06:32, 15.85s/it] 43%|████▎     | 532/1237 [2:22:36<2:51:32, 14.60s/it] 43%|████▎     | 533/1237 [2:22:51<2:53:20, 14.77s/it] 43%|████▎     | 534/1237 [2:23:04<2:46:07, 14.18s/it] 43%|████▎     | 535/1237 [2:23:18<2:48:08, 14.37s/it] 43%|████▎     | 536/1237 [2:23:35<2:55:35, 15.03s/it] 43%|████▎     | 537/1237 [2:23:59<3:28:20, 17.86s/it] 43%|████▎     | 538/1237 [2:24:19<3:33:38, 18.34s/it] 44%|████▎     | 539/1237 [2:24:39<3:40:46, 18.98s/it] 44%|████▎     | 540/1237 [2:24:54<3:26:34, 17.78s/it]                                                       44%|████▎     | 540/1237 [2:24:54<3:26:34, 17.78s/it] 44%|████▎     | 541/1237 [2:25:10<3:19:34, 17.21s/it] 44%|████▍     | 542/1237 [2:25:26<3:13:57, 16.74s/it] 44%|████▍     | 543/1237 [2:25:43<3:14:38, 16.83s/it] 44%|████▍     | 544/1237 [2:26:01<3:19:48, 17.30s/it] 44%|████▍     | 545/1237 [2:26:16<3:09:46, 16.45s/it] 44%|████▍     | 546/1237 [2:26:30<3:02:07, 15.81s/it] 44%|████▍     | 547/1237 [2:26:51<3:20:45, 17.46s/it] 44%|████▍     | 548/1237 [2:27:08<3:16:28, 17.11s/it] 44%|████▍     | 549/1237 [2:27:21<3:01:34, 15.83s/it] 44%|████▍     | 550/1237 [2:27:41<3:18:38, 17.35s/it]                                                       44%|████▍     | 550/1237 [2:27:41<3:18:38, 17.35s/it] 45%|████▍     | 551/1237 [2:27:59<3:20:27, 17.53s/it] 45%|████▍     | 552/1237 [2:28:21<3:33:14, 18.68s/it] 45%|████▍     | 553/1237 [2:28:36<3:21:27, 17.67s/it] 45%|████▍     | 554/1237 [2:28:50<3:09:09, 16.62s/it] 45%|████▍     | 555/1237 [2:29:02<2:54:11, 15.32s/it] 45%|████▍     | 556/1237 [2:29:20<3:00:49, 15.93s/it] 45%|████▌     | 557/1237 [2:29:37<3:05:22, 16.36s/it] 45%|████▌     | 558/1237 [2:29:54<3:06:14, 16.46s/it] 45%|████▌     | 559/1237 [2:30:09<3:02:57, 16.19s/it] 45%|████▌     | 560/1237 [2:30:24<2:57:21, 15.72s/it]                                                       45%|████▌     | 560/1237 [2:30:24<2:57:21, 15.72s/it] 45%|████▌     | 561/1237 [2:30:44<3:11:56, 17.04s/it] 45%|████▌     | 562/1237 [2:30:59<3:05:18, 16.47s/it] 46%|████▌     | 563/1237 [2:31:17<3:09:08, 16.84s/it] 46%|████▌     | 564/1237 [2:31:30<2:56:36, 15.75s/it] 46%|████▌     | 565/1237 [2:31:49<3:05:27, 16.56s/it] 46%|████▌     | 566/1237 [2:32:01<2:51:18, 15.32s/it] 46%|████▌     | 567/1237 [2:32:15<2:45:59, 14.86s/it] 46%|████▌     | 568/1237 [2:32:36<3:08:14, 16.88s/it] 46%|████▌     | 569/1237 [2:32:55<3:11:52, 17.23s/it] 46%|████▌     | 570/1237 [2:33:10<3:05:15, 16.67s/it]                                                       46%|████▌     | 570/1237 [2:33:10<3:05:15, 16.67s/it] 46%|████▌     | 571/1237 [2:33:26<3:03:23, 16.52s/it] 46%|████▌     | 572/1237 [2:33:42<3:01:30, 16.38s/it] 46%|████▋     | 573/1237 [2:33:54<2:47:19, 15.12s/it] 46%|████▋     | 574/1237 [2:34:16<3:09:12, 17.12s/it] 46%|████▋     | 575/1237 [2:34:29<2:55:09, 15.88s/it] 47%|████▋     | 576/1237 [2:34:47<3:02:50, 16.60s/it] 47%|████▋     | 577/1237 [2:35:14<3:35:52, 19.62s/it] 47%|████▋     | 578/1237 [2:35:26<3:08:39, 17.18s/it] 47%|████▋     | 579/1237 [2:35:43<3:10:37, 17.38s/it] 47%|████▋     | 580/1237 [2:36:07<3:32:29, 19.41s/it]                                                       47%|████▋     | 580/1237 [2:36:07<3:32:29, 19.41s/it] 47%|████▋     | 581/1237 [2:36:27<3:30:54, 19.29s/it] 47%|████▋     | 582/1237 [2:36:43<3:20:32, 18.37s/it] 47%|████▋     | 583/1237 [2:36:54<2:58:16, 16.36s/it] 47%|████▋     | 584/1237 [2:37:11<2:57:24, 16.30s/it] 47%|████▋     | 585/1237 [2:37:24<2:47:51, 15.45s/it] 47%|████▋     | 586/1237 [2:37:38<2:41:23, 14.87s/it] 47%|████▋     | 587/1237 [2:37:54<2:46:53, 15.40s/it] 48%|████▊     | 588/1237 [2:38:09<2:43:42, 15.13s/it] 48%|████▊     | 589/1237 [2:38:28<2:56:21, 16.33s/it] 48%|████▊     | 590/1237 [2:38:45<2:58:59, 16.60s/it]                                                       48%|████▊     | 590/1237 [2:38:45<2:58:59, 16.60s/it] 48%|████▊     | 591/1237 [2:38:59<2:50:56, 15.88s/it] 48%|████▊     | 592/1237 [2:39:14<2:47:11, 15.55s/it] 48%|████▊     | 593/1237 [2:39:27<2:37:04, 14.63s/it] 48%|████▊     | 594/1237 [2:39:39<2:30:48, 14.07s/it] 48%|████▊     | 595/1237 [2:39:55<2:36:03, 14.58s/it] 48%|████▊     | 596/1237 [2:40:09<2:33:49, 14.40s/it] 48%|████▊     | 597/1237 [2:40:22<2:29:55, 14.06s/it] 48%|████▊     | 598/1237 [2:40:37<2:32:03, 14.28s/it] 48%|████▊     | 599/1237 [2:40:51<2:31:25, 14.24s/it] 49%|████▊     | 600/1237 [2:41:08<2:38:06, 14.89s/it]                                                       49%|████▊     | 600/1237 [2:41:08<2:38:06, 14.89s/it][INFO|trainer.py:3410] 2024-05-26 17:31:44,108 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-600
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 17:31:44,268 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 17:31:44,268 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-600/special_tokens_map.json
 49%|████▊     | 601/1237 [2:41:24<2:41:41, 15.25s/it] 49%|████▊     | 602/1237 [2:41:41<2:48:11, 15.89s/it] 49%|████▊     | 603/1237 [2:41:55<2:40:46, 15.21s/it] 49%|████▉     | 604/1237 [2:42:10<2:41:34, 15.32s/it] 49%|████▉     | 605/1237 [2:42:27<2:46:09, 15.77s/it] 49%|████▉     | 606/1237 [2:42:47<3:00:00, 17.12s/it] 49%|████▉     | 607/1237 [2:43:07<3:08:25, 17.95s/it] 49%|████▉     | 608/1237 [2:43:24<3:05:30, 17.69s/it] 49%|████▉     | 609/1237 [2:43:44<3:10:54, 18.24s/it] 49%|████▉     | 610/1237 [2:43:59<3:01:43, 17.39s/it]                                                       49%|████▉     | 610/1237 [2:43:59<3:01:43, 17.39s/it] 49%|████▉     | 611/1237 [2:44:14<2:52:26, 16.53s/it] 49%|████▉     | 612/1237 [2:44:26<2:38:59, 15.26s/it] 50%|████▉     | 613/1237 [2:44:41<2:37:00, 15.10s/it] 50%|████▉     | 614/1237 [2:44:58<2:44:03, 15.80s/it] 50%|████▉     | 615/1237 [2:45:18<2:55:51, 16.96s/it] 50%|████▉     | 616/1237 [2:45:36<2:59:37, 17.36s/it] 50%|████▉     | 617/1237 [2:45:52<2:53:24, 16.78s/it] 50%|████▉     | 618/1237 [2:46:03<2:37:34, 15.27s/it] 50%|█████     | 619/1237 [2:46:16<2:27:28, 14.32s/it] 50%|█████     | 620/1237 [2:46:35<2:44:35, 16.00s/it]                                                       50%|█████     | 620/1237 [2:46:35<2:44:35, 16.00s/it] 50%|█████     | 621/1237 [2:46:48<2:32:28, 14.85s/it] 50%|█████     | 622/1237 [2:47:02<2:31:04, 14.74s/it] 50%|█████     | 623/1237 [2:47:18<2:35:39, 15.21s/it] 50%|█████     | 624/1237 [2:47:30<2:25:44, 14.26s/it] 51%|█████     | 625/1237 [2:47:45<2:25:28, 14.26s/it] 51%|█████     | 626/1237 [2:48:01<2:31:28, 14.88s/it] 51%|█████     | 627/1237 [2:48:17<2:34:03, 15.15s/it] 51%|█████     | 628/1237 [2:48:36<2:46:54, 16.44s/it] 51%|█████     | 629/1237 [2:48:50<2:39:11, 15.71s/it] 51%|█████     | 630/1237 [2:49:06<2:38:45, 15.69s/it]                                                       51%|█████     | 630/1237 [2:49:06<2:38:45, 15.69s/it] 51%|█████     | 631/1237 [2:49:22<2:38:41, 15.71s/it] 51%|█████     | 632/1237 [2:49:37<2:38:14, 15.69s/it] 51%|█████     | 633/1237 [2:49:52<2:35:41, 15.47s/it] 51%|█████▏    | 634/1237 [2:50:06<2:28:44, 14.80s/it] 51%|█████▏    | 635/1237 [2:50:20<2:27:20, 14.68s/it] 51%|█████▏    | 636/1237 [2:50:39<2:39:40, 15.94s/it] 51%|█████▏    | 637/1237 [2:50:56<2:43:31, 16.35s/it] 52%|█████▏    | 638/1237 [2:51:15<2:51:33, 17.18s/it] 52%|█████▏    | 639/1237 [2:51:29<2:40:47, 16.13s/it] 52%|█████▏    | 640/1237 [2:51:48<2:48:41, 16.95s/it]                                                       52%|█████▏    | 640/1237 [2:51:48<2:48:41, 16.95s/it] 52%|█████▏    | 641/1237 [2:52:02<2:39:50, 16.09s/it] 52%|█████▏    | 642/1237 [2:52:19<2:43:28, 16.49s/it] 52%|█████▏    | 643/1237 [2:52:33<2:34:48, 15.64s/it] 52%|█████▏    | 644/1237 [2:52:49<2:34:28, 15.63s/it] 52%|█████▏    | 645/1237 [2:53:03<2:31:14, 15.33s/it] 52%|█████▏    | 646/1237 [2:53:19<2:32:24, 15.47s/it] 52%|█████▏    | 647/1237 [2:53:36<2:37:38, 16.03s/it] 52%|█████▏    | 648/1237 [2:53:53<2:40:33, 16.36s/it] 52%|█████▏    | 649/1237 [2:54:09<2:39:08, 16.24s/it] 53%|█████▎    | 650/1237 [2:54:26<2:40:40, 16.42s/it]                                                       53%|█████▎    | 650/1237 [2:54:26<2:40:40, 16.42s/it] 53%|█████▎    | 651/1237 [2:54:45<2:46:01, 17.00s/it] 53%|█████▎    | 652/1237 [2:55:02<2:45:34, 16.98s/it] 53%|█████▎    | 653/1237 [2:55:22<2:54:20, 17.91s/it] 53%|█████▎    | 654/1237 [2:55:37<2:45:45, 17.06s/it] 53%|█████▎    | 655/1237 [2:55:53<2:42:09, 16.72s/it] 53%|█████▎    | 656/1237 [2:56:07<2:36:30, 16.16s/it] 53%|█████▎    | 657/1237 [2:56:19<2:23:50, 14.88s/it] 53%|█████▎    | 658/1237 [2:56:31<2:15:33, 14.05s/it] 53%|█████▎    | 659/1237 [2:56:49<2:26:16, 15.18s/it] 53%|█████▎    | 660/1237 [2:57:05<2:26:09, 15.20s/it]                                                       53%|█████▎    | 660/1237 [2:57:05<2:26:09, 15.20s/it] 53%|█████▎    | 661/1237 [2:57:22<2:31:09, 15.75s/it] 54%|█████▎    | 662/1237 [2:57:35<2:24:33, 15.08s/it] 54%|█████▎    | 663/1237 [2:57:53<2:33:15, 16.02s/it] 54%|█████▎    | 664/1237 [2:58:06<2:23:08, 14.99s/it] 54%|█████▍    | 665/1237 [2:58:23<2:29:27, 15.68s/it] 54%|█████▍    | 666/1237 [2:58:39<2:29:08, 15.67s/it] 54%|█████▍    | 667/1237 [2:58:54<2:28:27, 15.63s/it] 54%|█████▍    | 668/1237 [2:59:12<2:32:48, 16.11s/it] 54%|█████▍    | 669/1237 [2:59:26<2:28:19, 15.67s/it] 54%|█████▍    | 670/1237 [2:59:43<2:32:27, 16.13s/it]                                                       54%|█████▍    | 670/1237 [2:59:43<2:32:27, 16.13s/it] 54%|█████▍    | 671/1237 [3:00:03<2:40:57, 17.06s/it] 54%|█████▍    | 672/1237 [3:00:18<2:36:20, 16.60s/it] 54%|█████▍    | 673/1237 [3:00:36<2:40:12, 17.04s/it] 54%|█████▍    | 674/1237 [3:00:48<2:23:37, 15.31s/it] 55%|█████▍    | 675/1237 [3:01:06<2:32:55, 16.33s/it] 55%|█████▍    | 676/1237 [3:01:24<2:36:42, 16.76s/it] 55%|█████▍    | 677/1237 [3:01:46<2:50:25, 18.26s/it] 55%|█████▍    | 678/1237 [3:02:09<3:03:42, 19.72s/it] 55%|█████▍    | 679/1237 [3:02:24<2:51:07, 18.40s/it] 55%|█████▍    | 680/1237 [3:02:39<2:40:24, 17.28s/it]                                                       55%|█████▍    | 680/1237 [3:02:39<2:40:24, 17.28s/it] 55%|█████▌    | 681/1237 [3:02:52<2:28:33, 16.03s/it] 55%|█████▌    | 682/1237 [3:03:11<2:37:13, 17.00s/it] 55%|█████▌    | 683/1237 [3:03:25<2:28:18, 16.06s/it] 55%|█████▌    | 684/1237 [3:03:37<2:16:52, 14.85s/it] 55%|█████▌    | 685/1237 [3:03:54<2:20:45, 15.30s/it] 55%|█████▌    | 686/1237 [3:04:08<2:17:16, 14.95s/it] 56%|█████▌    | 687/1237 [3:04:26<2:25:36, 15.88s/it] 56%|█████▌    | 688/1237 [3:04:43<2:28:33, 16.24s/it] 56%|█████▌    | 689/1237 [3:04:58<2:24:09, 15.78s/it] 56%|█████▌    | 690/1237 [3:05:16<2:31:13, 16.59s/it]                                                       56%|█████▌    | 690/1237 [3:05:16<2:31:13, 16.59s/it] 56%|█████▌    | 691/1237 [3:05:28<2:19:30, 15.33s/it] 56%|█████▌    | 692/1237 [3:05:47<2:29:24, 16.45s/it] 56%|█████▌    | 693/1237 [3:06:02<2:25:04, 16.00s/it] 56%|█████▌    | 694/1237 [3:06:22<2:34:32, 17.08s/it] 56%|█████▌    | 695/1237 [3:06:41<2:39:10, 17.62s/it] 56%|█████▋    | 696/1237 [3:06:58<2:38:17, 17.56s/it] 56%|█████▋    | 697/1237 [3:07:13<2:30:08, 16.68s/it] 56%|█████▋    | 698/1237 [3:07:24<2:15:48, 15.12s/it] 57%|█████▋    | 699/1237 [3:07:41<2:19:45, 15.59s/it] 57%|█████▋    | 700/1237 [3:07:56<2:18:13, 15.44s/it]                                                       57%|█████▋    | 700/1237 [3:07:56<2:18:13, 15.44s/it][INFO|trainer.py:3410] 2024-05-26 17:58:32,610 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-700
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 17:58:32,770 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 17:58:32,770 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-700/special_tokens_map.json
 57%|█████▋    | 701/1237 [3:08:15<2:26:21, 16.38s/it] 57%|█████▋    | 702/1237 [3:08:29<2:20:05, 15.71s/it] 57%|█████▋    | 703/1237 [3:08:46<2:24:03, 16.19s/it] 57%|█████▋    | 704/1237 [3:09:03<2:24:12, 16.23s/it] 57%|█████▋    | 705/1237 [3:09:17<2:20:05, 15.80s/it] 57%|█████▋    | 706/1237 [3:09:30<2:11:51, 14.90s/it] 57%|█████▋    | 707/1237 [3:09:46<2:14:29, 15.22s/it] 57%|█████▋    | 708/1237 [3:09:58<2:05:54, 14.28s/it] 57%|█████▋    | 709/1237 [3:10:13<2:08:21, 14.59s/it] 57%|█████▋    | 710/1237 [3:10:26<2:01:33, 13.84s/it]                                                       57%|█████▋    | 710/1237 [3:10:26<2:01:33, 13.84s/it] 57%|█████▋    | 711/1237 [3:10:39<1:59:04, 13.58s/it] 58%|█████▊    | 712/1237 [3:11:01<2:22:58, 16.34s/it] 58%|█████▊    | 713/1237 [3:11:17<2:22:03, 16.27s/it] 58%|█████▊    | 714/1237 [3:11:32<2:17:21, 15.76s/it] 58%|█████▊    | 715/1237 [3:11:46<2:12:46, 15.26s/it] 58%|█████▊    | 716/1237 [3:12:00<2:10:16, 15.00s/it] 58%|█████▊    | 717/1237 [3:12:21<2:23:48, 16.59s/it] 58%|█████▊    | 718/1237 [3:12:34<2:15:13, 15.63s/it] 58%|█████▊    | 719/1237 [3:12:48<2:10:55, 15.17s/it] 58%|█████▊    | 720/1237 [3:13:06<2:16:22, 15.83s/it]                                                       58%|█████▊    | 720/1237 [3:13:06<2:16:22, 15.83s/it] 58%|█████▊    | 721/1237 [3:13:22<2:17:56, 16.04s/it] 58%|█████▊    | 722/1237 [3:13:35<2:08:23, 14.96s/it] 58%|█████▊    | 723/1237 [3:13:56<2:23:50, 16.79s/it] 59%|█████▊    | 724/1237 [3:14:09<2:14:44, 15.76s/it] 59%|█████▊    | 725/1237 [3:14:22<2:06:08, 14.78s/it] 59%|█████▊    | 726/1237 [3:14:38<2:10:19, 15.30s/it] 59%|█████▉    | 727/1237 [3:14:51<2:04:51, 14.69s/it] 59%|█████▉    | 728/1237 [3:15:07<2:07:03, 14.98s/it] 59%|█████▉    | 729/1237 [3:15:25<2:13:59, 15.83s/it] 59%|█████▉    | 730/1237 [3:15:39<2:09:17, 15.30s/it]                                                       59%|█████▉    | 730/1237 [3:15:39<2:09:17, 15.30s/it] 59%|█████▉    | 731/1237 [3:15:56<2:13:24, 15.82s/it] 59%|█████▉    | 732/1237 [3:16:09<2:07:12, 15.11s/it] 59%|█████▉    | 733/1237 [3:16:29<2:18:44, 16.52s/it] 59%|█████▉    | 734/1237 [3:16:47<2:21:42, 16.90s/it] 59%|█████▉    | 735/1237 [3:17:03<2:19:24, 16.66s/it] 59%|█████▉    | 736/1237 [3:17:18<2:14:53, 16.16s/it] 60%|█████▉    | 737/1237 [3:17:30<2:05:29, 15.06s/it] 60%|█████▉    | 738/1237 [3:17:44<2:00:59, 14.55s/it] 60%|█████▉    | 739/1237 [3:17:58<2:00:32, 14.52s/it] 60%|█████▉    | 740/1237 [3:18:16<2:07:42, 15.42s/it]                                                       60%|█████▉    | 740/1237 [3:18:16<2:07:42, 15.42s/it] 60%|█████▉    | 741/1237 [3:18:29<2:02:36, 14.83s/it] 60%|█████▉    | 742/1237 [3:18:44<2:01:41, 14.75s/it] 60%|██████    | 743/1237 [3:18:56<1:55:53, 14.08s/it] 60%|██████    | 744/1237 [3:19:08<1:48:34, 13.21s/it] 60%|██████    | 745/1237 [3:19:24<1:55:15, 14.06s/it] 60%|██████    | 746/1237 [3:19:43<2:07:57, 15.64s/it] 60%|██████    | 747/1237 [3:19:55<2:00:01, 14.70s/it] 60%|██████    | 748/1237 [3:20:16<2:15:15, 16.60s/it] 61%|██████    | 749/1237 [3:20:33<2:15:06, 16.61s/it] 61%|██████    | 750/1237 [3:20:45<2:02:28, 15.09s/it]                                                       61%|██████    | 750/1237 [3:20:45<2:02:28, 15.09s/it] 61%|██████    | 751/1237 [3:21:03<2:09:03, 15.93s/it] 61%|██████    | 752/1237 [3:21:16<2:02:41, 15.18s/it] 61%|██████    | 753/1237 [3:21:33<2:06:42, 15.71s/it] 61%|██████    | 754/1237 [3:21:46<2:00:08, 14.92s/it] 61%|██████    | 755/1237 [3:22:05<2:09:42, 16.15s/it] 61%|██████    | 756/1237 [3:22:21<2:09:00, 16.09s/it] 61%|██████    | 757/1237 [3:22:37<2:08:01, 16.00s/it] 61%|██████▏   | 758/1237 [3:22:50<2:00:58, 15.15s/it] 61%|██████▏   | 759/1237 [3:23:07<2:06:24, 15.87s/it] 61%|██████▏   | 760/1237 [3:23:25<2:09:19, 16.27s/it]                                                       61%|██████▏   | 760/1237 [3:23:25<2:09:19, 16.27s/it] 62%|██████▏   | 761/1237 [3:23:44<2:16:53, 17.26s/it] 62%|██████▏   | 762/1237 [3:23:57<2:06:11, 15.94s/it] 62%|██████▏   | 763/1237 [3:24:11<2:00:45, 15.29s/it] 62%|██████▏   | 764/1237 [3:24:28<2:04:28, 15.79s/it] 62%|██████▏   | 765/1237 [3:24:44<2:05:32, 15.96s/it] 62%|██████▏   | 766/1237 [3:24:56<1:56:36, 14.85s/it] 62%|██████▏   | 767/1237 [3:25:11<1:55:15, 14.71s/it] 62%|██████▏   | 768/1237 [3:25:26<1:56:49, 14.94s/it] 62%|██████▏   | 769/1237 [3:25:42<1:58:56, 15.25s/it] 62%|██████▏   | 770/1237 [3:25:57<1:57:11, 15.06s/it]                                                       62%|██████▏   | 770/1237 [3:25:57<1:57:11, 15.06s/it] 62%|██████▏   | 771/1237 [3:26:11<1:54:39, 14.76s/it] 62%|██████▏   | 772/1237 [3:26:23<1:48:04, 13.94s/it] 62%|██████▏   | 773/1237 [3:26:43<2:02:00, 15.78s/it] 63%|██████▎   | 774/1237 [3:27:00<2:05:09, 16.22s/it] 63%|██████▎   | 775/1237 [3:27:17<2:06:13, 16.39s/it] 63%|██████▎   | 776/1237 [3:27:31<2:00:55, 15.74s/it] 63%|██████▎   | 777/1237 [3:27:53<2:15:21, 17.66s/it] 63%|██████▎   | 778/1237 [3:28:08<2:07:09, 16.62s/it] 63%|██████▎   | 779/1237 [3:28:22<2:01:21, 15.90s/it] 63%|██████▎   | 780/1237 [3:28:36<1:58:10, 15.51s/it]                                                       63%|██████▎   | 780/1237 [3:28:36<1:58:10, 15.51s/it] 63%|██████▎   | 781/1237 [3:28:52<1:59:00, 15.66s/it] 63%|██████▎   | 782/1237 [3:29:07<1:55:39, 15.25s/it] 63%|██████▎   | 783/1237 [3:29:23<1:57:32, 15.53s/it] 63%|██████▎   | 784/1237 [3:29:39<1:58:07, 15.65s/it] 63%|██████▎   | 785/1237 [3:29:53<1:54:41, 15.22s/it] 64%|██████▎   | 786/1237 [3:30:05<1:46:53, 14.22s/it] 64%|██████▎   | 787/1237 [3:30:26<2:00:57, 16.13s/it] 64%|██████▎   | 788/1237 [3:30:39<1:53:52, 15.22s/it] 64%|██████▍   | 789/1237 [3:30:56<1:59:26, 16.00s/it] 64%|██████▍   | 790/1237 [3:31:11<1:56:01, 15.57s/it]                                                       64%|██████▍   | 790/1237 [3:31:11<1:56:01, 15.57s/it] 64%|██████▍   | 791/1237 [3:31:25<1:53:08, 15.22s/it] 64%|██████▍   | 792/1237 [3:31:42<1:56:57, 15.77s/it] 64%|██████▍   | 793/1237 [3:31:58<1:56:49, 15.79s/it] 64%|██████▍   | 794/1237 [3:32:13<1:54:53, 15.56s/it] 64%|██████▍   | 795/1237 [3:32:32<2:00:57, 16.42s/it] 64%|██████▍   | 796/1237 [3:32:45<1:54:40, 15.60s/it] 64%|██████▍   | 797/1237 [3:33:04<2:01:14, 16.53s/it] 65%|██████▍   | 798/1237 [3:33:20<1:59:08, 16.28s/it] 65%|██████▍   | 799/1237 [3:33:36<1:58:39, 16.25s/it] 65%|██████▍   | 800/1237 [3:33:53<1:59:04, 16.35s/it]                                                       65%|██████▍   | 800/1237 [3:33:53<1:59:04, 16.35s/it][INFO|trainer.py:3410] 2024-05-26 18:24:29,077 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-800
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 18:24:29,236 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 18:24:29,236 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-800/special_tokens_map.json
 65%|██████▍   | 801/1237 [3:34:08<1:55:47, 15.93s/it] 65%|██████▍   | 802/1237 [3:34:20<1:48:28, 14.96s/it] 65%|██████▍   | 803/1237 [3:34:35<1:47:14, 14.83s/it] 65%|██████▍   | 804/1237 [3:34:53<1:54:45, 15.90s/it] 65%|██████▌   | 805/1237 [3:35:10<1:57:16, 16.29s/it] 65%|██████▌   | 806/1237 [3:35:24<1:52:10, 15.62s/it] 65%|██████▌   | 807/1237 [3:35:38<1:47:35, 15.01s/it] 65%|██████▌   | 808/1237 [3:35:53<1:46:31, 14.90s/it] 65%|██████▌   | 809/1237 [3:36:13<1:57:34, 16.48s/it] 65%|██████▌   | 810/1237 [3:36:31<2:00:35, 16.95s/it]                                                       65%|██████▌   | 810/1237 [3:36:31<2:00:35, 16.95s/it] 66%|██████▌   | 811/1237 [3:36:43<1:50:45, 15.60s/it] 66%|██████▌   | 812/1237 [3:37:03<1:59:53, 16.93s/it] 66%|██████▌   | 813/1237 [3:37:21<2:01:18, 17.17s/it] 66%|██████▌   | 814/1237 [3:37:37<1:58:44, 16.84s/it] 66%|██████▌   | 815/1237 [3:37:51<1:52:15, 15.96s/it] 66%|██████▌   | 816/1237 [3:38:08<1:54:21, 16.30s/it] 66%|██████▌   | 817/1237 [3:38:22<1:48:33, 15.51s/it] 66%|██████▌   | 818/1237 [3:38:38<1:48:49, 15.58s/it] 66%|██████▌   | 819/1237 [3:38:53<1:47:40, 15.46s/it] 66%|██████▋   | 820/1237 [3:39:09<1:48:54, 15.67s/it]                                                       66%|██████▋   | 820/1237 [3:39:09<1:48:54, 15.67s/it] 66%|██████▋   | 821/1237 [3:39:26<1:51:34, 16.09s/it] 66%|██████▋   | 822/1237 [3:39:44<1:55:30, 16.70s/it] 67%|██████▋   | 823/1237 [3:40:01<1:54:38, 16.62s/it] 67%|██████▋   | 824/1237 [3:40:21<2:02:10, 17.75s/it] 67%|██████▋   | 825/1237 [3:40:37<1:57:44, 17.15s/it] 67%|██████▋   | 826/1237 [3:41:00<2:09:16, 18.87s/it] 67%|██████▋   | 827/1237 [3:41:15<2:02:35, 17.94s/it] 67%|██████▋   | 828/1237 [3:41:32<2:00:19, 17.65s/it] 67%|██████▋   | 829/1237 [3:41:50<2:00:01, 17.65s/it] 67%|██████▋   | 830/1237 [3:42:05<1:54:18, 16.85s/it]                                                       67%|██████▋   | 830/1237 [3:42:05<1:54:18, 16.85s/it] 67%|██████▋   | 831/1237 [3:42:21<1:53:23, 16.76s/it] 67%|██████▋   | 832/1237 [3:42:39<1:54:43, 17.00s/it] 67%|██████▋   | 833/1237 [3:42:55<1:51:21, 16.54s/it] 67%|██████▋   | 834/1237 [3:43:07<1:42:41, 15.29s/it] 68%|██████▊   | 835/1237 [3:43:24<1:45:50, 15.80s/it] 68%|██████▊   | 836/1237 [3:43:41<1:47:26, 16.08s/it] 68%|██████▊   | 837/1237 [3:43:55<1:44:18, 15.65s/it] 68%|██████▊   | 838/1237 [3:44:07<1:36:58, 14.58s/it] 68%|██████▊   | 839/1237 [3:44:25<1:42:42, 15.48s/it] 68%|██████▊   | 840/1237 [3:44:41<1:43:58, 15.71s/it]                                                       68%|██████▊   | 840/1237 [3:44:41<1:43:58, 15.71s/it] 68%|██████▊   | 841/1237 [3:44:54<1:37:48, 14.82s/it] 68%|██████▊   | 842/1237 [3:45:13<1:46:54, 16.24s/it] 68%|██████▊   | 843/1237 [3:45:27<1:40:46, 15.35s/it] 68%|██████▊   | 844/1237 [3:45:43<1:42:43, 15.68s/it] 68%|██████▊   | 845/1237 [3:45:58<1:40:56, 15.45s/it] 68%|██████▊   | 846/1237 [3:46:11<1:35:47, 14.70s/it] 68%|██████▊   | 847/1237 [3:46:25<1:33:57, 14.45s/it] 69%|██████▊   | 848/1237 [3:46:43<1:40:20, 15.48s/it] 69%|██████▊   | 849/1237 [3:46:59<1:41:17, 15.66s/it] 69%|██████▊   | 850/1237 [3:47:19<1:50:13, 17.09s/it]                                                       69%|██████▊   | 850/1237 [3:47:19<1:50:13, 17.09s/it] 69%|██████▉   | 851/1237 [3:47:37<1:50:24, 17.16s/it] 69%|██████▉   | 852/1237 [3:47:50<1:43:24, 16.12s/it] 69%|██████▉   | 853/1237 [3:48:14<1:58:00, 18.44s/it] 69%|██████▉   | 854/1237 [3:48:28<1:48:58, 17.07s/it] 69%|██████▉   | 855/1237 [3:48:40<1:38:46, 15.52s/it] 69%|██████▉   | 856/1237 [3:49:03<1:52:03, 17.65s/it] 69%|██████▉   | 857/1237 [3:49:14<1:40:17, 15.84s/it] 69%|██████▉   | 858/1237 [3:49:29<1:38:29, 15.59s/it] 69%|██████▉   | 859/1237 [3:49:54<1:55:31, 18.34s/it] 70%|██████▉   | 860/1237 [3:50:07<1:45:32, 16.80s/it]                                                       70%|██████▉   | 860/1237 [3:50:07<1:45:32, 16.80s/it] 70%|██████▉   | 861/1237 [3:50:21<1:39:57, 15.95s/it] 70%|██████▉   | 862/1237 [3:50:34<1:33:53, 15.02s/it] 70%|██████▉   | 863/1237 [3:50:48<1:31:52, 14.74s/it] 70%|██████▉   | 864/1237 [3:51:03<1:32:11, 14.83s/it] 70%|██████▉   | 865/1237 [3:51:17<1:30:10, 14.54s/it] 70%|███████   | 866/1237 [3:51:32<1:31:25, 14.79s/it] 70%|███████   | 867/1237 [3:51:46<1:29:20, 14.49s/it] 70%|███████   | 868/1237 [3:52:01<1:30:44, 14.76s/it] 70%|███████   | 869/1237 [3:52:17<1:31:59, 15.00s/it] 70%|███████   | 870/1237 [3:52:33<1:33:49, 15.34s/it]                                                       70%|███████   | 870/1237 [3:52:33<1:33:49, 15.34s/it] 70%|███████   | 871/1237 [3:52:46<1:28:32, 14.51s/it] 70%|███████   | 872/1237 [3:53:00<1:28:05, 14.48s/it] 71%|███████   | 873/1237 [3:53:17<1:32:18, 15.21s/it] 71%|███████   | 874/1237 [3:53:32<1:31:28, 15.12s/it] 71%|███████   | 875/1237 [3:53:51<1:38:15, 16.28s/it] 71%|███████   | 876/1237 [3:54:06<1:34:47, 15.76s/it] 71%|███████   | 877/1237 [3:54:34<1:56:38, 19.44s/it] 71%|███████   | 878/1237 [3:54:49<1:49:07, 18.24s/it] 71%|███████   | 879/1237 [3:55:04<1:42:21, 17.16s/it] 71%|███████   | 880/1237 [3:55:19<1:38:49, 16.61s/it]                                                       71%|███████   | 880/1237 [3:55:19<1:38:49, 16.61s/it] 71%|███████   | 881/1237 [3:55:34<1:35:55, 16.17s/it] 71%|███████▏  | 882/1237 [3:55:51<1:37:14, 16.44s/it] 71%|███████▏  | 883/1237 [3:56:13<1:45:47, 17.93s/it] 71%|███████▏  | 884/1237 [3:56:30<1:44:43, 17.80s/it] 72%|███████▏  | 885/1237 [3:56:44<1:37:41, 16.65s/it] 72%|███████▏  | 886/1237 [3:56:59<1:33:35, 16.00s/it] 72%|███████▏  | 887/1237 [3:57:10<1:25:45, 14.70s/it] 72%|███████▏  | 888/1237 [3:57:23<1:22:41, 14.22s/it] 72%|███████▏  | 889/1237 [3:57:38<1:22:36, 14.24s/it] 72%|███████▏  | 890/1237 [3:57:56<1:28:45, 15.35s/it]                                                       72%|███████▏  | 890/1237 [3:57:56<1:28:45, 15.35s/it] 72%|███████▏  | 891/1237 [3:58:09<1:25:53, 14.89s/it] 72%|███████▏  | 892/1237 [3:58:23<1:23:22, 14.50s/it] 72%|███████▏  | 893/1237 [3:58:41<1:29:43, 15.65s/it] 72%|███████▏  | 894/1237 [3:58:57<1:30:16, 15.79s/it] 72%|███████▏  | 895/1237 [3:59:18<1:38:51, 17.34s/it] 72%|███████▏  | 896/1237 [3:59:31<1:31:23, 16.08s/it] 73%|███████▎  | 897/1237 [3:59:44<1:25:37, 15.11s/it] 73%|███████▎  | 898/1237 [3:59:57<1:20:23, 14.23s/it] 73%|███████▎  | 899/1237 [4:00:18<1:33:05, 16.52s/it] 73%|███████▎  | 900/1237 [4:00:36<1:34:13, 16.78s/it]                                                       73%|███████▎  | 900/1237 [4:00:36<1:34:13, 16.78s/it][INFO|trainer.py:3410] 2024-05-26 18:51:12,205 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-900
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 18:51:12,364 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 18:51:12,364 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-900/special_tokens_map.json
 73%|███████▎  | 901/1237 [4:00:55<1:37:28, 17.41s/it] 73%|███████▎  | 902/1237 [4:01:10<1:34:05, 16.85s/it] 73%|███████▎  | 903/1237 [4:01:25<1:31:12, 16.38s/it] 73%|███████▎  | 904/1237 [4:01:41<1:29:20, 16.10s/it] 73%|███████▎  | 905/1237 [4:01:54<1:24:03, 15.19s/it] 73%|███████▎  | 906/1237 [4:02:10<1:24:37, 15.34s/it] 73%|███████▎  | 907/1237 [4:02:29<1:30:41, 16.49s/it] 73%|███████▎  | 908/1237 [4:02:46<1:31:11, 16.63s/it] 73%|███████▎  | 909/1237 [4:03:01<1:28:44, 16.23s/it] 74%|███████▎  | 910/1237 [4:03:16<1:26:06, 15.80s/it]                                                       74%|███████▎  | 910/1237 [4:03:16<1:26:06, 15.80s/it] 74%|███████▎  | 911/1237 [4:03:34<1:28:52, 16.36s/it] 74%|███████▎  | 912/1237 [4:03:47<1:23:33, 15.43s/it] 74%|███████▍  | 913/1237 [4:04:06<1:28:39, 16.42s/it] 74%|███████▍  | 914/1237 [4:04:26<1:34:32, 17.56s/it] 74%|███████▍  | 915/1237 [4:04:39<1:26:49, 16.18s/it] 74%|███████▍  | 916/1237 [4:04:51<1:19:33, 14.87s/it] 74%|███████▍  | 917/1237 [4:05:09<1:24:18, 15.81s/it] 74%|███████▍  | 918/1237 [4:05:24<1:24:07, 15.82s/it] 74%|███████▍  | 919/1237 [4:05:46<1:32:37, 17.48s/it] 74%|███████▍  | 920/1237 [4:06:01<1:28:51, 16.82s/it]                                                       74%|███████▍  | 920/1237 [4:06:01<1:28:51, 16.82s/it] 74%|███████▍  | 921/1237 [4:06:20<1:32:08, 17.49s/it] 75%|███████▍  | 922/1237 [4:06:36<1:28:50, 16.92s/it] 75%|███████▍  | 923/1237 [4:06:55<1:33:03, 17.78s/it] 75%|███████▍  | 924/1237 [4:07:15<1:35:50, 18.37s/it] 75%|███████▍  | 925/1237 [4:07:33<1:34:24, 18.15s/it] 75%|███████▍  | 926/1237 [4:07:52<1:35:29, 18.42s/it] 75%|███████▍  | 927/1237 [4:08:07<1:29:51, 17.39s/it] 75%|███████▌  | 928/1237 [4:08:19<1:20:42, 15.67s/it] 75%|███████▌  | 929/1237 [4:08:43<1:33:36, 18.23s/it] 75%|███████▌  | 930/1237 [4:08:58<1:29:18, 17.46s/it]                                                       75%|███████▌  | 930/1237 [4:08:58<1:29:18, 17.46s/it] 75%|███████▌  | 931/1237 [4:09:16<1:28:32, 17.36s/it] 75%|███████▌  | 932/1237 [4:09:31<1:25:07, 16.75s/it] 75%|███████▌  | 933/1237 [4:09:47<1:23:29, 16.48s/it] 76%|███████▌  | 934/1237 [4:10:07<1:28:56, 17.61s/it] 76%|███████▌  | 935/1237 [4:10:24<1:27:12, 17.33s/it] 76%|███████▌  | 936/1237 [4:10:39<1:23:25, 16.63s/it] 76%|███████▌  | 937/1237 [4:10:52<1:18:16, 15.65s/it] 76%|███████▌  | 938/1237 [4:11:11<1:23:36, 16.78s/it] 76%|███████▌  | 939/1237 [4:11:23<1:15:34, 15.22s/it] 76%|███████▌  | 940/1237 [4:11:42<1:21:11, 16.40s/it]                                                       76%|███████▌  | 940/1237 [4:11:42<1:21:11, 16.40s/it] 76%|███████▌  | 941/1237 [4:11:54<1:14:30, 15.10s/it] 76%|███████▌  | 942/1237 [4:12:07<1:11:32, 14.55s/it] 76%|███████▌  | 943/1237 [4:12:25<1:15:18, 15.37s/it] 76%|███████▋  | 944/1237 [4:12:45<1:22:54, 16.98s/it] 76%|███████▋  | 945/1237 [4:13:04<1:24:57, 17.46s/it] 76%|███████▋  | 946/1237 [4:13:20<1:22:51, 17.08s/it] 77%|███████▋  | 947/1237 [4:13:38<1:23:51, 17.35s/it] 77%|███████▋  | 948/1237 [4:13:53<1:20:14, 16.66s/it] 77%|███████▋  | 949/1237 [4:14:13<1:24:53, 17.69s/it] 77%|███████▋  | 950/1237 [4:14:27<1:18:32, 16.42s/it]                                                       77%|███████▋  | 950/1237 [4:14:27<1:18:32, 16.42s/it] 77%|███████▋  | 951/1237 [4:14:42<1:16:25, 16.03s/it] 77%|███████▋  | 952/1237 [4:14:59<1:18:04, 16.44s/it] 77%|███████▋  | 953/1237 [4:15:13<1:13:26, 15.52s/it] 77%|███████▋  | 954/1237 [4:15:30<1:16:14, 16.16s/it] 77%|███████▋  | 955/1237 [4:15:43<1:11:23, 15.19s/it] 77%|███████▋  | 956/1237 [4:16:00<1:12:35, 15.50s/it] 77%|███████▋  | 957/1237 [4:16:11<1:06:30, 14.25s/it] 77%|███████▋  | 958/1237 [4:16:25<1:06:35, 14.32s/it] 78%|███████▊  | 959/1237 [4:16:42<1:09:13, 14.94s/it] 78%|███████▊  | 960/1237 [4:16:55<1:06:06, 14.32s/it]                                                       78%|███████▊  | 960/1237 [4:16:55<1:06:06, 14.32s/it] 78%|███████▊  | 961/1237 [4:17:10<1:06:49, 14.53s/it] 78%|███████▊  | 962/1237 [4:17:25<1:07:31, 14.73s/it] 78%|███████▊  | 963/1237 [4:17:39<1:06:40, 14.60s/it] 78%|███████▊  | 964/1237 [4:17:53<1:06:02, 14.52s/it] 78%|███████▊  | 965/1237 [4:18:09<1:06:56, 14.76s/it] 78%|███████▊  | 966/1237 [4:18:21<1:03:24, 14.04s/it] 78%|███████▊  | 967/1237 [4:18:38<1:06:21, 14.75s/it] 78%|███████▊  | 968/1237 [4:18:50<1:03:10, 14.09s/it] 78%|███████▊  | 969/1237 [4:19:03<1:01:53, 13.86s/it] 78%|███████▊  | 970/1237 [4:19:23<1:08:57, 15.50s/it]                                                       78%|███████▊  | 970/1237 [4:19:23<1:08:57, 15.50s/it] 78%|███████▊  | 971/1237 [4:19:38<1:08:07, 15.37s/it] 79%|███████▊  | 972/1237 [4:19:53<1:07:02, 15.18s/it] 79%|███████▊  | 973/1237 [4:20:06<1:04:10, 14.58s/it] 79%|███████▊  | 974/1237 [4:20:23<1:07:06, 15.31s/it] 79%|███████▉  | 975/1237 [4:20:35<1:02:44, 14.37s/it] 79%|███████▉  | 976/1237 [4:20:53<1:07:24, 15.50s/it] 79%|███████▉  | 977/1237 [4:21:10<1:09:38, 16.07s/it] 79%|███████▉  | 978/1237 [4:21:22<1:04:01, 14.83s/it] 79%|███████▉  | 979/1237 [4:21:35<1:00:46, 14.13s/it] 79%|███████▉  | 980/1237 [4:21:47<58:22, 13.63s/it]                                                       79%|███████▉  | 980/1237 [4:21:47<58:22, 13.63s/it] 79%|███████▉  | 981/1237 [4:22:01<58:15, 13.65s/it] 79%|███████▉  | 982/1237 [4:22:16<59:16, 13.95s/it] 79%|███████▉  | 983/1237 [4:22:27<55:44, 13.17s/it] 80%|███████▉  | 984/1237 [4:22:42<57:57, 13.74s/it] 80%|███████▉  | 985/1237 [4:23:00<1:02:57, 14.99s/it] 80%|███████▉  | 986/1237 [4:23:15<1:02:57, 15.05s/it] 80%|███████▉  | 987/1237 [4:23:30<1:02:41, 15.05s/it] 80%|███████▉  | 988/1237 [4:23:48<1:06:05, 15.93s/it] 80%|███████▉  | 989/1237 [4:24:06<1:08:24, 16.55s/it] 80%|████████  | 990/1237 [4:24:23<1:08:11, 16.57s/it]                                                       80%|████████  | 990/1237 [4:24:23<1:08:11, 16.57s/it] 80%|████████  | 991/1237 [4:24:39<1:07:01, 16.35s/it] 80%|████████  | 992/1237 [4:24:58<1:10:34, 17.28s/it] 80%|████████  | 993/1237 [4:25:15<1:09:47, 17.16s/it] 80%|████████  | 994/1237 [4:25:30<1:06:38, 16.45s/it] 80%|████████  | 995/1237 [4:25:51<1:11:47, 17.80s/it] 81%|████████  | 996/1237 [4:26:12<1:15:24, 18.77s/it] 81%|████████  | 997/1237 [4:26:32<1:16:14, 19.06s/it] 81%|████████  | 998/1237 [4:26:52<1:17:37, 19.49s/it] 81%|████████  | 999/1237 [4:27:07<1:11:50, 18.11s/it] 81%|████████  | 1000/1237 [4:27:23<1:09:18, 17.54s/it]                                                        81%|████████  | 1000/1237 [4:27:23<1:09:18, 17.54s/it][INFO|trainer.py:3719] 2024-05-26 19:17:59,599 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-26 19:17:59,599 >>   Num examples = 500
[INFO|trainer.py:3724] 2024-05-26 19:17:59,599 >>   Batch size = 32
{'eval_loss': 1.2147271633148193, 'eval_runtime': 59.9668, 'eval_samples_per_second': 8.338, 'eval_steps_per_second': 0.267, 'epoch': 0.4}
{'loss': 1.2731, 'grad_norm': 1.208304762840271, 'learning_rate': 0.0001274668753995882, 'epoch': 0.41}
{'loss': 1.2281, 'grad_norm': 1.199459433555603, 'learning_rate': 0.0001250160737637122, 'epoch': 0.42}
{'loss': 1.256, 'grad_norm': 1.4971766471862793, 'learning_rate': 0.00012254913499522657, 'epoch': 0.43}
{'loss': 1.2693, 'grad_norm': 1.628132939338684, 'learning_rate': 0.00012006765044369419, 'epoch': 0.44}
{'loss': 1.1879, 'grad_norm': 1.2782323360443115, 'learning_rate': 0.00011757322084173415, 'epoch': 0.44}
{'loss': 1.2761, 'grad_norm': 1.3551346063613892, 'learning_rate': 0.00011506745527243648, 'epoch': 0.45}
{'loss': 1.3181, 'grad_norm': 1.3120129108428955, 'learning_rate': 0.00011255197013138999, 'epoch': 0.46}
{'loss': 1.2209, 'grad_norm': 1.195677399635315, 'learning_rate': 0.00011002838808399301, 'epoch': 0.47}
{'loss': 1.2311, 'grad_norm': 1.3398340940475464, 'learning_rate': 0.00010749833701871971, 'epoch': 0.48}
{'loss': 1.2379, 'grad_norm': 1.3429404497146606, 'learning_rate': 0.0001049634489970173, 'epoch': 0.48}
{'loss': 1.2538, 'grad_norm': 1.2639106512069702, 'learning_rate': 0.00010242535920051117, 'epoch': 0.49}
{'loss': 1.2428, 'grad_norm': 1.2196357250213623, 'learning_rate': 9.988570487619722e-05, 'epoch': 0.5}
{'loss': 1.2192, 'grad_norm': 1.3895295858383179, 'learning_rate': 9.734612428030234e-05, 'epoch': 0.51}
{'loss': 1.2162, 'grad_norm': 1.1662561893463135, 'learning_rate': 9.480825562149331e-05, 'epoch': 0.52}
{'loss': 1.229, 'grad_norm': 1.5834019184112549, 'learning_rate': 9.227373600411669e-05, 'epoch': 0.53}
{'loss': 1.2222, 'grad_norm': 1.290015459060669, 'learning_rate': 8.974420037215105e-05, 'epoch': 0.53}
{'loss': 1.2236, 'grad_norm': 1.4673360586166382, 'learning_rate': 8.72212804545527e-05, 'epoch': 0.54}
{'loss': 1.2179, 'grad_norm': 1.2742152214050293, 'learning_rate': 8.470660371267544e-05, 'epoch': 0.55}
{'loss': 1.205, 'grad_norm': 1.189751148223877, 'learning_rate': 8.220179229044307e-05, 'epoch': 0.56}
{'loss': 1.2125, 'grad_norm': 1.409848928451538, 'learning_rate': 7.970846196795226e-05, 'epoch': 0.57}
{'loss': 1.2181, 'grad_norm': 1.1863707304000854, 'learning_rate': 7.722822111918014e-05, 'epoch': 0.57}
{'loss': 1.1842, 'grad_norm': 1.5566178560256958, 'learning_rate': 7.47626696744699e-05, 'epoch': 0.58}
{'loss': 1.2664, 'grad_norm': 1.4495620727539062, 'learning_rate': 7.231339808846258e-05, 'epoch': 0.59}
{'loss': 1.2214, 'grad_norm': 1.3716371059417725, 'learning_rate': 6.988198631414176e-05, 'epoch': 0.6}
{'loss': 1.1893, 'grad_norm': 1.6015450954437256, 'learning_rate': 6.747000278365238e-05, 'epoch': 0.61}
{'loss': 1.2379, 'grad_norm': 1.364617943763733, 'learning_rate': 6.507900339655126e-05, 'epoch': 0.61}
{'loss': 1.193, 'grad_norm': 1.307382345199585, 'learning_rate': 6.271053051614233e-05, 'epoch': 0.62}
{'loss': 1.1873, 'grad_norm': 1.3472785949707031, 'learning_rate': 6.036611197454314e-05, 'epoch': 0.63}
{'loss': 1.2251, 'grad_norm': 1.4635794162750244, 'learning_rate': 5.8047260087125687e-05, 'epoch': 0.64}
{'loss': 1.176, 'grad_norm': 1.3978540897369385, 'learning_rate': 5.575547067696601e-05, 'epoch': 0.65}
{'loss': 1.188, 'grad_norm': 1.5004676580429077, 'learning_rate': 5.349222210993299e-05, 'epoch': 0.65}
{'loss': 1.1591, 'grad_norm': 1.3199485540390015, 'learning_rate': 5.125897434103795e-05, 'epoch': 0.66}
{'loss': 1.1798, 'grad_norm': 1.2958042621612549, 'learning_rate': 4.90571679726607e-05, 'epoch': 0.67}
{'loss': 1.1751, 'grad_norm': 1.3711655139923096, 'learning_rate': 4.688822332525924e-05, 'epoch': 0.68}
{'loss': 1.2189, 'grad_norm': 1.3152598142623901, 'learning_rate': 4.4753539521163046e-05, 'epoch': 0.69}
{'loss': 1.1525, 'grad_norm': 1.339796543121338, 'learning_rate': 4.265449358204035e-05, 'epoch': 0.69}
{'loss': 1.1895, 'grad_norm': 1.2095590829849243, 'learning_rate': 4.059243954062197e-05, 'epoch': 0.7}
{'loss': 1.2034, 'grad_norm': 1.1548678874969482, 'learning_rate': 3.8568707567254795e-05, 'epoch': 0.71}
{'loss': 1.1959, 'grad_norm': 1.4000160694122314, 'learning_rate': 3.6584603111847824e-05, 'epoch': 0.72}
{'loss': 1.2011, 'grad_norm': 1.1822184324264526, 'learning_rate': 3.4641406061765134e-05, 'epoch': 0.73}
{'loss': 1.167, 'grad_norm': 1.4777151346206665, 'learning_rate': 3.274036991620809e-05, 'epoch': 0.74}
{'loss': 1.1632, 'grad_norm': 1.2451432943344116, 'learning_rate': 3.0882720977619925e-05, 'epoch': 0.74}
{'loss': 1.2193, 'grad_norm': 1.2443715333938599, 'learning_rate': 2.9069657560634133e-05, 'epoch': 0.75}
{'loss': 1.2359, 'grad_norm': 1.3263095617294312, 'learning_rate': 2.730234921907707e-05, 'epoch': 0.76}
{'loss': 1.2614, 'grad_norm': 1.4389764070510864, 'learning_rate': 2.558193599152302e-05, 'epoch': 0.77}
{'loss': 1.2068, 'grad_norm': 1.324799656867981, 'learning_rate': 2.390952766588913e-05, 'epoch': 0.78}
{'loss': 1.208, 'grad_norm': 1.190992832183838, 'learning_rate': 2.2286203063543776e-05, 'epoch': 0.78}
{'loss': 1.1837, 'grad_norm': 1.3141560554504395, 'learning_rate': 2.071300934339051e-05, 'epoch': 0.79}
{'loss': 1.1727, 'grad_norm': 1.263756275177002, 'learning_rate': 1.919096132637709e-05, 'epoch': 0.8}
{'loss': 1.1392, 'grad_norm': 1.1329708099365234, 'learning_rate': 1.772104084086389e-05, 'epoch': 0.81}

  0%|          | 0/16 [00:00<?, ?it/s][A
 12%|█▎        | 2/16 [00:02<00:19,  1.39s/it][A
 19%|█▉        | 3/16 [00:07<00:34,  2.64s/it][A
 25%|██▌       | 4/16 [00:10<00:35,  2.97s/it][A
 31%|███▏      | 5/16 [00:13<00:31,  2.88s/it][A
 38%|███▊      | 6/16 [00:17<00:32,  3.24s/it][A
 44%|████▍     | 7/16 [00:19<00:26,  3.00s/it][A
 50%|█████     | 8/16 [00:23<00:26,  3.29s/it][A
 56%|█████▋    | 9/16 [00:27<00:25,  3.58s/it][A
 62%|██████▎   | 10/16 [00:31<00:22,  3.70s/it][A
 69%|██████▉   | 11/16 [00:36<00:20,  4.09s/it][A
 75%|███████▌  | 12/16 [00:40<00:15,  3.96s/it][A
 81%|████████▏ | 13/16 [00:43<00:11,  3.72s/it][A
 88%|████████▊ | 14/16 [00:47<00:07,  3.74s/it][A
 94%|█████████▍| 15/16 [00:50<00:03,  3.50s/it][A
100%|██████████| 16/16 [00:53<00:00,  3.31s/it][A                                                       
                                               [A 81%|████████  | 1000/1237 [4:28:23<1:09:18, 17.54s/it]
100%|██████████| 16/16 [00:53<00:00,  3.31s/it][A
                                               [A[INFO|trainer.py:3410] 2024-05-26 19:18:59,657 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1000
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 19:18:59,823 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 19:18:59,823 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1000/special_tokens_map.json
 81%|████████  | 1001/1237 [4:28:39<2:18:05, 35.11s/it] 81%|████████  | 1002/1237 [4:28:55<1:54:21, 29.20s/it] 81%|████████  | 1003/1237 [4:29:08<1:35:26, 24.47s/it] 81%|████████  | 1004/1237 [4:29:28<1:30:16, 23.25s/it] 81%|████████  | 1005/1237 [4:29:45<1:22:24, 21.31s/it] 81%|████████▏ | 1006/1237 [4:29:57<1:11:13, 18.50s/it] 81%|████████▏ | 1007/1237 [4:30:10<1:04:09, 16.74s/it] 81%|████████▏ | 1008/1237 [4:30:26<1:02:49, 16.46s/it] 82%|████████▏ | 1009/1237 [4:30:43<1:03:57, 16.83s/it] 82%|████████▏ | 1010/1237 [4:31:04<1:07:30, 17.84s/it]                                                        82%|████████▏ | 1010/1237 [4:31:04<1:07:30, 17.84s/it] 82%|████████▏ | 1011/1237 [4:31:19<1:04:27, 17.11s/it] 82%|████████▏ | 1012/1237 [4:31:32<59:58, 15.99s/it]   82%|████████▏ | 1013/1237 [4:31:46<57:23, 15.37s/it] 82%|████████▏ | 1014/1237 [4:32:01<56:40, 15.25s/it] 82%|████████▏ | 1015/1237 [4:32:18<58:01, 15.68s/it] 82%|████████▏ | 1016/1237 [4:32:32<55:27, 15.06s/it] 82%|████████▏ | 1017/1237 [4:32:47<55:13, 15.06s/it] 82%|████████▏ | 1018/1237 [4:33:05<58:17, 15.97s/it] 82%|████████▏ | 1019/1237 [4:33:18<55:39, 15.32s/it] 82%|████████▏ | 1020/1237 [4:33:39<1:00:48, 16.81s/it]                                                        82%|████████▏ | 1020/1237 [4:33:39<1:00:48, 16.81s/it] 83%|████████▎ | 1021/1237 [4:33:57<1:01:56, 17.20s/it] 83%|████████▎ | 1022/1237 [4:34:10<57:20, 16.00s/it]   83%|████████▎ | 1023/1237 [4:34:26<56:52, 15.95s/it] 83%|████████▎ | 1024/1237 [4:34:41<56:03, 15.79s/it] 83%|████████▎ | 1025/1237 [4:34:57<55:10, 15.62s/it] 83%|████████▎ | 1026/1237 [4:35:14<56:58, 16.20s/it] 83%|████████▎ | 1027/1237 [4:35:27<53:42, 15.34s/it] 83%|████████▎ | 1028/1237 [4:35:41<51:32, 14.80s/it] 83%|████████▎ | 1029/1237 [4:35:55<50:41, 14.62s/it] 83%|████████▎ | 1030/1237 [4:36:10<50:21, 14.60s/it]                                                      83%|████████▎ | 1030/1237 [4:36:10<50:21, 14.60s/it] 83%|████████▎ | 1031/1237 [4:36:24<49:29, 14.41s/it] 83%|████████▎ | 1032/1237 [4:36:38<49:11, 14.40s/it] 84%|████████▎ | 1033/1237 [4:36:56<52:29, 15.44s/it] 84%|████████▎ | 1034/1237 [4:37:12<52:29, 15.52s/it] 84%|████████▎ | 1035/1237 [4:37:27<52:32, 15.61s/it] 84%|████████▍ | 1036/1237 [4:37:44<52:59, 15.82s/it] 84%|████████▍ | 1037/1237 [4:38:05<58:28, 17.54s/it] 84%|████████▍ | 1038/1237 [4:38:18<53:24, 16.10s/it] 84%|████████▍ | 1039/1237 [4:38:38<56:36, 17.15s/it] 84%|████████▍ | 1040/1237 [4:38:55<56:31, 17.21s/it]                                                      84%|████████▍ | 1040/1237 [4:38:55<56:31, 17.21s/it] 84%|████████▍ | 1041/1237 [4:39:09<53:11, 16.28s/it] 84%|████████▍ | 1042/1237 [4:39:24<51:45, 15.93s/it] 84%|████████▍ | 1043/1237 [4:39:42<53:27, 16.53s/it] 84%|████████▍ | 1044/1237 [4:39:59<53:36, 16.67s/it] 84%|████████▍ | 1045/1237 [4:40:18<55:36, 17.38s/it] 85%|████████▍ | 1046/1237 [4:40:32<51:29, 16.18s/it] 85%|████████▍ | 1047/1237 [4:40:46<49:49, 15.73s/it] 85%|████████▍ | 1048/1237 [4:41:03<50:08, 15.92s/it] 85%|████████▍ | 1049/1237 [4:41:23<53:41, 17.13s/it] 85%|████████▍ | 1050/1237 [4:41:36<49:38, 15.93s/it]                                                      85%|████████▍ | 1050/1237 [4:41:36<49:38, 15.93s/it] 85%|████████▍ | 1051/1237 [4:41:53<50:50, 16.40s/it] 85%|████████▌ | 1052/1237 [4:42:06<47:17, 15.34s/it] 85%|████████▌ | 1053/1237 [4:42:20<45:39, 14.89s/it] 85%|████████▌ | 1054/1237 [4:42:36<46:04, 15.11s/it] 85%|████████▌ | 1055/1237 [4:42:47<42:53, 14.14s/it] 85%|████████▌ | 1056/1237 [4:43:01<41:44, 13.84s/it] 85%|████████▌ | 1057/1237 [4:43:13<40:18, 13.44s/it] 86%|████████▌ | 1058/1237 [4:43:24<37:49, 12.68s/it] 86%|████████▌ | 1059/1237 [4:43:41<41:11, 13.88s/it] 86%|████████▌ | 1060/1237 [4:43:54<40:52, 13.86s/it]                                                      86%|████████▌ | 1060/1237 [4:43:54<40:52, 13.86s/it] 86%|████████▌ | 1061/1237 [4:44:10<42:03, 14.34s/it] 86%|████████▌ | 1062/1237 [4:44:28<45:18, 15.53s/it] 86%|████████▌ | 1063/1237 [4:44:42<43:35, 15.03s/it] 86%|████████▌ | 1064/1237 [4:45:01<46:34, 16.15s/it] 86%|████████▌ | 1065/1237 [4:45:24<51:52, 18.10s/it] 86%|████████▌ | 1066/1237 [4:45:43<53:05, 18.63s/it] 86%|████████▋ | 1067/1237 [4:46:02<52:29, 18.53s/it] 86%|████████▋ | 1068/1237 [4:46:19<51:04, 18.13s/it] 86%|████████▋ | 1069/1237 [4:46:36<50:09, 17.91s/it] 86%|████████▋ | 1070/1237 [4:46:49<45:46, 16.45s/it]                                                      86%|████████▋ | 1070/1237 [4:46:49<45:46, 16.45s/it] 87%|████████▋ | 1071/1237 [4:47:06<45:59, 16.63s/it] 87%|████████▋ | 1072/1237 [4:47:23<45:29, 16.54s/it] 87%|████████▋ | 1073/1237 [4:47:36<42:49, 15.67s/it] 87%|████████▋ | 1074/1237 [4:47:50<41:19, 15.21s/it] 87%|████████▋ | 1075/1237 [4:48:12<46:33, 17.24s/it] 87%|████████▋ | 1076/1237 [4:48:26<43:13, 16.11s/it] 87%|████████▋ | 1077/1237 [4:48:44<44:09, 16.56s/it] 87%|████████▋ | 1078/1237 [4:48:58<41:58, 15.84s/it] 87%|████████▋ | 1079/1237 [4:49:13<41:17, 15.68s/it] 87%|████████▋ | 1080/1237 [4:49:29<41:00, 15.67s/it]                                                      87%|████████▋ | 1080/1237 [4:49:29<41:00, 15.67s/it] 87%|████████▋ | 1081/1237 [4:49:45<40:57, 15.75s/it] 87%|████████▋ | 1082/1237 [4:49:58<38:38, 14.96s/it] 88%|████████▊ | 1083/1237 [4:50:11<37:27, 14.59s/it] 88%|████████▊ | 1084/1237 [4:50:31<40:41, 15.96s/it] 88%|████████▊ | 1085/1237 [4:50:43<37:52, 14.95s/it] 88%|████████▊ | 1086/1237 [4:51:03<41:18, 16.41s/it] 88%|████████▊ | 1087/1237 [4:51:14<37:08, 14.86s/it] 88%|████████▊ | 1088/1237 [4:51:29<36:36, 14.74s/it] 88%|████████▊ | 1089/1237 [4:51:45<37:50, 15.34s/it] 88%|████████▊ | 1090/1237 [4:52:04<39:44, 16.22s/it]                                                      88%|████████▊ | 1090/1237 [4:52:04<39:44, 16.22s/it] 88%|████████▊ | 1091/1237 [4:52:21<40:11, 16.52s/it] 88%|████████▊ | 1092/1237 [4:52:35<37:50, 15.66s/it] 88%|████████▊ | 1093/1237 [4:52:52<38:48, 16.17s/it] 88%|████████▊ | 1094/1237 [4:53:06<37:14, 15.63s/it] 89%|████████▊ | 1095/1237 [4:53:28<41:00, 17.33s/it] 89%|████████▊ | 1096/1237 [4:53:48<43:14, 18.40s/it] 89%|████████▊ | 1097/1237 [4:54:08<43:43, 18.74s/it] 89%|████████▉ | 1098/1237 [4:54:23<40:30, 17.49s/it] 89%|████████▉ | 1099/1237 [4:54:39<39:48, 17.31s/it] 89%|████████▉ | 1100/1237 [4:54:52<36:08, 15.83s/it]                                                      89%|████████▉ | 1100/1237 [4:54:52<36:08, 15.83s/it][INFO|trainer.py:3410] 2024-05-26 19:45:28,304 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1100
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 19:45:28,466 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 19:45:28,466 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1100/special_tokens_map.json
 89%|████████▉ | 1101/1237 [4:55:09<37:05, 16.36s/it] 89%|████████▉ | 1102/1237 [4:55:28<38:03, 16.91s/it] 89%|████████▉ | 1103/1237 [4:55:46<38:26, 17.21s/it] 89%|████████▉ | 1104/1237 [4:56:03<38:23, 17.32s/it] 89%|████████▉ | 1105/1237 [4:56:18<36:09, 16.44s/it] 89%|████████▉ | 1106/1237 [4:56:35<36:35, 16.76s/it] 89%|████████▉ | 1107/1237 [4:56:47<33:19, 15.38s/it] 90%|████████▉ | 1108/1237 [4:56:59<30:59, 14.41s/it] 90%|████████▉ | 1109/1237 [4:57:12<29:41, 13.92s/it] 90%|████████▉ | 1110/1237 [4:57:25<28:36, 13.52s/it]                                                      90%|████████▉ | 1110/1237 [4:57:25<28:36, 13.52s/it] 90%|████████▉ | 1111/1237 [4:57:43<31:24, 14.96s/it] 90%|████████▉ | 1112/1237 [4:57:58<31:18, 15.03s/it] 90%|████████▉ | 1113/1237 [4:58:13<31:08, 15.07s/it] 90%|█████████ | 1114/1237 [4:58:35<34:55, 17.04s/it] 90%|█████████ | 1115/1237 [4:58:49<32:29, 15.98s/it] 90%|█████████ | 1116/1237 [4:59:08<34:28, 17.09s/it] 90%|█████████ | 1117/1237 [4:59:21<31:21, 15.68s/it] 90%|█████████ | 1118/1237 [4:59:39<32:36, 16.44s/it] 90%|█████████ | 1119/1237 [4:59:51<29:54, 15.21s/it] 91%|█████████ | 1120/1237 [5:00:07<29:59, 15.38s/it]                                                      91%|█████████ | 1120/1237 [5:00:07<29:59, 15.38s/it] 91%|█████████ | 1121/1237 [5:00:22<29:45, 15.39s/it] 91%|█████████ | 1122/1237 [5:00:35<28:02, 14.63s/it] 91%|█████████ | 1123/1237 [5:00:53<29:29, 15.52s/it] 91%|█████████ | 1124/1237 [5:01:14<32:12, 17.10s/it] 91%|█████████ | 1125/1237 [5:01:27<29:40, 15.89s/it] 91%|█████████ | 1126/1237 [5:01:47<31:43, 17.15s/it] 91%|█████████ | 1127/1237 [5:02:03<31:04, 16.95s/it] 91%|█████████ | 1128/1237 [5:02:15<27:51, 15.34s/it] 91%|█████████▏| 1129/1237 [5:02:33<29:22, 16.32s/it] 91%|█████████▏| 1130/1237 [5:02:46<27:05, 15.19s/it]                                                      91%|█████████▏| 1130/1237 [5:02:46<27:05, 15.19s/it] 91%|█████████▏| 1131/1237 [5:03:01<26:34, 15.04s/it] 92%|█████████▏| 1132/1237 [5:03:21<28:54, 16.52s/it] 92%|█████████▏| 1133/1237 [5:03:40<30:12, 17.42s/it] 92%|█████████▏| 1134/1237 [5:03:52<27:13, 15.86s/it] 92%|█████████▏| 1135/1237 [5:04:05<25:08, 14.78s/it] 92%|█████████▏| 1136/1237 [5:04:25<27:46, 16.50s/it] 92%|█████████▏| 1137/1237 [5:04:38<25:30, 15.31s/it] 92%|█████████▏| 1138/1237 [5:04:52<24:56, 15.11s/it] 92%|█████████▏| 1139/1237 [5:05:09<25:41, 15.72s/it] 92%|█████████▏| 1140/1237 [5:05:20<23:01, 14.25s/it]                                                      92%|█████████▏| 1140/1237 [5:05:20<23:01, 14.25s/it] 92%|█████████▏| 1141/1237 [5:05:35<23:09, 14.47s/it] 92%|█████████▏| 1142/1237 [5:05:54<25:01, 15.80s/it] 92%|█████████▏| 1143/1237 [5:06:07<23:25, 14.95s/it] 92%|█████████▏| 1144/1237 [5:06:18<21:11, 13.67s/it] 93%|█████████▎| 1145/1237 [5:06:32<20:57, 13.67s/it] 93%|█████████▎| 1146/1237 [5:06:45<20:44, 13.68s/it] 93%|█████████▎| 1147/1237 [5:07:03<22:08, 14.76s/it] 93%|█████████▎| 1148/1237 [5:07:25<25:19, 17.08s/it] 93%|█████████▎| 1149/1237 [5:07:42<24:59, 17.04s/it] 93%|█████████▎| 1150/1237 [5:07:56<23:14, 16.03s/it]                                                      93%|█████████▎| 1150/1237 [5:07:56<23:14, 16.03s/it] 93%|█████████▎| 1151/1237 [5:08:18<25:35, 17.85s/it] 93%|█████████▎| 1152/1237 [5:08:33<24:14, 17.11s/it] 93%|█████████▎| 1153/1237 [5:08:52<24:53, 17.78s/it] 93%|█████████▎| 1154/1237 [5:09:04<21:57, 15.87s/it] 93%|█████████▎| 1155/1237 [5:09:18<20:47, 15.21s/it] 93%|█████████▎| 1156/1237 [5:09:31<19:54, 14.74s/it] 94%|█████████▎| 1157/1237 [5:09:44<18:55, 14.19s/it] 94%|█████████▎| 1158/1237 [5:10:06<21:50, 16.59s/it] 94%|█████████▎| 1159/1237 [5:10:22<21:03, 16.19s/it] 94%|█████████▍| 1160/1237 [5:10:40<21:30, 16.76s/it]                                                      94%|█████████▍| 1160/1237 [5:10:40<21:30, 16.76s/it] 94%|█████████▍| 1161/1237 [5:10:54<20:22, 16.09s/it] 94%|█████████▍| 1162/1237 [5:11:10<19:53, 15.92s/it] 94%|█████████▍| 1163/1237 [5:11:25<19:15, 15.61s/it] 94%|█████████▍| 1164/1237 [5:11:37<17:56, 14.74s/it] 94%|█████████▍| 1165/1237 [5:11:52<17:35, 14.66s/it] 94%|█████████▍| 1166/1237 [5:12:10<18:29, 15.63s/it] 94%|█████████▍| 1167/1237 [5:12:24<17:51, 15.31s/it] 94%|█████████▍| 1168/1237 [5:12:39<17:29, 15.21s/it] 95%|█████████▍| 1169/1237 [5:12:50<15:38, 13.80s/it] 95%|█████████▍| 1170/1237 [5:13:03<15:18, 13.71s/it]                                                      95%|█████████▍| 1170/1237 [5:13:03<15:18, 13.71s/it] 95%|█████████▍| 1171/1237 [5:13:15<14:33, 13.23s/it] 95%|█████████▍| 1172/1237 [5:13:28<14:02, 12.96s/it] 95%|█████████▍| 1173/1237 [5:13:42<14:18, 13.42s/it] 95%|█████████▍| 1174/1237 [5:14:02<16:03, 15.30s/it] 95%|█████████▍| 1175/1237 [5:14:16<15:37, 15.12s/it] 95%|█████████▌| 1176/1237 [5:14:29<14:26, 14.21s/it] 95%|█████████▌| 1177/1237 [5:14:43<14:17, 14.29s/it] 95%|█████████▌| 1178/1237 [5:14:57<13:55, 14.16s/it] 95%|█████████▌| 1179/1237 [5:15:10<13:23, 13.85s/it] 95%|█████████▌| 1180/1237 [5:15:28<14:18, 15.07s/it]                                                      95%|█████████▌| 1180/1237 [5:15:28<14:18, 15.07s/it] 95%|█████████▌| 1181/1237 [5:15:44<14:12, 15.23s/it] 96%|█████████▌| 1182/1237 [5:15:56<13:03, 14.25s/it] 96%|█████████▌| 1183/1237 [5:16:08<12:23, 13.78s/it] 96%|█████████▌| 1184/1237 [5:16:25<13:02, 14.77s/it] 96%|█████████▌| 1185/1237 [5:16:39<12:37, 14.57s/it] 96%|█████████▌| 1186/1237 [5:16:58<13:24, 15.77s/it] 96%|█████████▌| 1187/1237 [5:17:17<14:01, 16.83s/it] 96%|█████████▌| 1188/1237 [5:17:36<14:06, 17.28s/it] 96%|█████████▌| 1189/1237 [5:17:51<13:16, 16.60s/it] 96%|█████████▌| 1190/1237 [5:18:06<12:46, 16.30s/it]                                                      96%|█████████▌| 1190/1237 [5:18:06<12:46, 16.30s/it] 96%|█████████▋| 1191/1237 [5:18:23<12:30, 16.32s/it] 96%|█████████▋| 1192/1237 [5:18:41<12:46, 17.04s/it] 96%|█████████▋| 1193/1237 [5:18:59<12:44, 17.39s/it] 97%|█████████▋| 1194/1237 [5:19:13<11:34, 16.16s/it] 97%|█████████▋| 1195/1237 [5:19:32<12:03, 17.22s/it] 97%|█████████▋| 1196/1237 [5:19:45<10:54, 15.96s/it] 97%|█████████▋| 1197/1237 [5:20:00<10:26, 15.67s/it] 97%|█████████▋| 1198/1237 [5:20:17<10:18, 15.85s/it] 97%|█████████▋| 1199/1237 [5:20:32<10:00, 15.81s/it] 97%|█████████▋| 1200/1237 [5:20:45<09:04, 14.71s/it]                                                      97%|█████████▋| 1200/1237 [5:20:45<09:04, 14.71s/it][INFO|trainer.py:3410] 2024-05-26 20:11:21,089 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1200
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 20:11:21,247 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 20:11:21,248 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/checkpoint-1200/special_tokens_map.json
 97%|█████████▋| 1201/1237 [5:21:10<10:48, 18.02s/it] 97%|█████████▋| 1202/1237 [5:21:25<09:58, 17.10s/it] 97%|█████████▋| 1203/1237 [5:21:45<10:04, 17.79s/it] 97%|█████████▋| 1204/1237 [5:21:59<09:14, 16.81s/it] 97%|█████████▋| 1205/1237 [5:22:15<08:48, 16.50s/it] 97%|█████████▋| 1206/1237 [5:22:33<08:48, 17.04s/it] 98%|█████████▊| 1207/1237 [5:22:51<08:34, 17.16s/it] 98%|█████████▊| 1208/1237 [5:23:05<07:49, 16.20s/it] 98%|█████████▊| 1209/1237 [5:23:21<07:32, 16.17s/it] 98%|█████████▊| 1210/1237 [5:23:36<07:07, 15.84s/it]                                                      98%|█████████▊| 1210/1237 [5:23:36<07:07, 15.84s/it] 98%|█████████▊| 1211/1237 [5:23:51<06:46, 15.65s/it] 98%|█████████▊| 1212/1237 [5:24:07<06:32, 15.69s/it] 98%|█████████▊| 1213/1237 [5:24:18<05:42, 14.28s/it] 98%|█████████▊| 1214/1237 [5:24:32<05:26, 14.21s/it] 98%|█████████▊| 1215/1237 [5:24:44<04:57, 13.53s/it] 98%|█████████▊| 1216/1237 [5:25:00<05:03, 14.46s/it] 98%|█████████▊| 1217/1237 [5:25:21<05:25, 16.26s/it] 98%|█████████▊| 1218/1237 [5:25:37<05:09, 16.27s/it] 99%|█████████▊| 1219/1237 [5:25:48<04:22, 14.58s/it] 99%|█████████▊| 1220/1237 [5:26:02<04:07, 14.55s/it]                                                      99%|█████████▊| 1220/1237 [5:26:02<04:07, 14.55s/it] 99%|█████████▊| 1221/1237 [5:26:20<04:09, 15.61s/it] 99%|█████████▉| 1222/1237 [5:26:33<03:41, 14.75s/it] 99%|█████████▉| 1223/1237 [5:26:48<03:27, 14.79s/it] 99%|█████████▉| 1224/1237 [5:27:03<03:13, 14.87s/it] 99%|█████████▉| 1225/1237 [5:27:18<02:57, 14.79s/it] 99%|█████████▉| 1226/1237 [5:27:35<02:50, 15.47s/it] 99%|█████████▉| 1227/1237 [5:27:56<02:52, 17.20s/it] 99%|█████████▉| 1228/1237 [5:28:09<02:22, 15.88s/it] 99%|█████████▉| 1229/1237 [5:28:27<02:12, 16.53s/it] 99%|█████████▉| 1230/1237 [5:28:41<01:51, 15.94s/it]                                                      99%|█████████▉| 1230/1237 [5:28:41<01:51, 15.94s/it]100%|█████████▉| 1231/1237 [5:29:00<01:41, 16.84s/it]100%|█████████▉| 1232/1237 [5:29:21<01:29, 17.95s/it]100%|█████████▉| 1233/1237 [5:29:36<01:08, 17.03s/it]100%|█████████▉| 1234/1237 [5:29:53<00:51, 17.18s/it]100%|█████████▉| 1235/1237 [5:30:12<00:35, 17.71s/it]100%|█████████▉| 1236/1237 [5:30:26<00:16, 16.50s/it]100%|██████████| 1237/1237 [5:30:38<00:00, 15.16s/it][INFO|trainer.py:2329] 2024-05-26 20:21:14,446 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                     100%|██████████| 1237/1237 [5:30:38<00:00, 15.16s/it]100%|██████████| 1237/1237 [5:30:38<00:00, 16.04s/it]
[INFO|trainer.py:3410] 2024-05-26 20:21:14,447 >> Saving model checkpoint to saves/mistral/qlora_sft_bitsandbytes_small
/home/xiaoyukou/anaconda3/envs/py3.10/lib/python3.10/site-packages/peft/utils/save_and_load.py:154: UserWarning: Could not find a config file in /data/xiaoyukou/alignment-handbook/ckpts/Mistral-7B-Instruct-v0.2 - will assume that the vocabulary was not modified.
  warnings.warn(
[INFO|tokenization_utils_base.py:2513] 2024-05-26 20:21:14,607 >> tokenizer config file saved in saves/mistral/qlora_sft_bitsandbytes_small/tokenizer_config.json
[INFO|tokenization_utils_base.py:2522] 2024-05-26 20:21:14,607 >> Special tokens file saved in saves/mistral/qlora_sft_bitsandbytes_small/special_tokens_map.json
[INFO|trainer.py:3719] 2024-05-26 20:21:14,799 >> ***** Running Evaluation *****
[INFO|trainer.py:3721] 2024-05-26 20:21:14,799 >>   Num examples = 500
[INFO|trainer.py:3724] 2024-05-26 20:21:14,799 >>   Batch size = 32
{'eval_loss': 1.1362779140472412, 'eval_runtime': 60.0577, 'eval_samples_per_second': 8.325, 'eval_steps_per_second': 0.266, 'epoch': 0.81}
{'loss': 1.1422, 'grad_norm': 1.4475637674331665, 'learning_rate': 1.630419608927568e-05, 'epoch': 0.82}
{'loss': 1.2093, 'grad_norm': 1.4530110359191895, 'learning_rate': 1.4941341036444012e-05, 'epoch': 0.82}
{'loss': 1.1286, 'grad_norm': 1.1588753461837769, 'learning_rate': 1.3633354820035471e-05, 'epoch': 0.83}
{'loss': 1.1077, 'grad_norm': 1.3247829675674438, 'learning_rate': 1.2381081183445775e-05, 'epoch': 0.84}
{'loss': 1.168, 'grad_norm': 1.344333291053772, 'learning_rate': 1.1185327931525858e-05, 'epoch': 0.85}
{'loss': 1.1818, 'grad_norm': 1.2120803594589233, 'learning_rate': 1.0046866409490684e-05, 'epoch': 0.86}
{'loss': 1.2127, 'grad_norm': 1.1823291778564453, 'learning_rate': 8.96643100534711e-06, 'epoch': 0.86}
{'loss': 1.1564, 'grad_norm': 1.4380011558532715, 'learning_rate': 7.944718676162e-06, 'epoch': 0.87}
{'loss': 1.2449, 'grad_norm': 1.3903417587280273, 'learning_rate': 6.982388498475456e-06, 'epoch': 0.88}
{'loss': 1.1582, 'grad_norm': 1.2613439559936523, 'learning_rate': 6.080061243150192e-06, 'epoch': 0.89}
{'loss': 1.163, 'grad_norm': 1.3639782667160034, 'learning_rate': 5.238318974930456e-06, 'epoch': 0.9}
{'loss': 1.1929, 'grad_norm': 1.4128601551055908, 'learning_rate': 4.457704676969099e-06, 'epoch': 0.91}
{'loss': 1.1549, 'grad_norm': 1.4592983722686768, 'learning_rate': 3.7387219005652786e-06, 'epoch': 0.91}
{'loss': 1.1639, 'grad_norm': 1.43412184715271, 'learning_rate': 3.0818344403382714e-06, 'epoch': 0.92}
{'loss': 1.1836, 'grad_norm': 1.0993975400924683, 'learning_rate': 2.4874660350472145e-06, 'epoch': 0.93}
{'loss': 1.1914, 'grad_norm': 1.1497774124145508, 'learning_rate': 1.9560000942497215e-06, 'epoch': 0.94}
{'loss': 1.1459, 'grad_norm': 1.4157557487487793, 'learning_rate': 1.4877794509757014e-06, 'epoch': 0.95}
{'loss': 1.1663, 'grad_norm': 1.2876397371292114, 'learning_rate': 1.0831061405757737e-06, 'epoch': 0.95}
{'loss': 1.1535, 'grad_norm': 1.2208688259124756, 'learning_rate': 7.422412058872396e-07, 'epoch': 0.96}
{'loss': 1.1076, 'grad_norm': 1.462353229522705, 'learning_rate': 4.6540452884303864e-07, 'epoch': 0.97}
{'loss': 1.2202, 'grad_norm': 1.7662098407745361, 'learning_rate': 2.527746886322957e-07, 'epoch': 0.98}
{'loss': 1.1627, 'grad_norm': 1.316198706626892, 'learning_rate': 1.0448884650426926e-07, 'epoch': 0.99}
{'loss': 1.1892, 'grad_norm': 1.4521149396896362, 'learning_rate': 2.0642657289560163e-08, 'epoch': 0.99}
{'train_runtime': 19838.5024, 'train_samples_per_second': 2.495, 'train_steps_per_second': 0.062, 'train_loss': 1.2632785687643189, 'epoch': 1.0}
***** train metrics *****
  epoch                    =       0.9996
  total_flos               = 1067345046GF
  train_loss               =       1.2633
  train_runtime            =   5:30:38.50
  train_samples_per_second =        2.495
  train_steps_per_second   =        0.062
Figure saved at: saves/mistral/qlora_sft_bitsandbytes_small/training_loss.png
Figure saved at: saves/mistral/qlora_sft_bitsandbytes_small/training_eval_loss.png
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:02<00:19,  1.39s/it] 19%|█▉        | 3/16 [00:07<00:34,  2.64s/it] 25%|██▌       | 4/16 [00:10<00:35,  2.97s/it] 31%|███▏      | 5/16 [00:13<00:31,  2.89s/it] 38%|███▊      | 6/16 [00:17<00:32,  3.24s/it] 44%|████▍     | 7/16 [00:19<00:26,  3.00s/it] 50%|█████     | 8/16 [00:23<00:26,  3.29s/it] 56%|█████▋    | 9/16 [00:28<00:25,  3.58s/it] 62%|██████▎   | 10/16 [00:31<00:22,  3.70s/it] 69%|██████▉   | 11/16 [00:36<00:20,  4.09s/it] 75%|███████▌  | 12/16 [00:40<00:15,  3.96s/it] 81%|████████▏ | 13/16 [00:43<00:11,  3.72s/it] 88%|████████▊ | 14/16 [00:47<00:07,  3.74s/it] 94%|█████████▍| 15/16 [00:50<00:03,  3.50s/it]100%|██████████| 16/16 [00:53<00:00,  3.32s/it]100%|██████████| 16/16 [00:53<00:00,  3.34s/it]
[INFO|modelcard.py:450] 2024-05-26 20:22:14,868 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
***** eval metrics *****
  epoch                   =     0.9996
  eval_loss               =     1.1297
  eval_runtime            = 0:01:00.06
  eval_samples_per_second =      8.324
  eval_steps_per_second   =      0.266
